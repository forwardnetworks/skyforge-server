version: "1"

# "Evidence packs" bundle parameterized NQE checks into a single run that can be exported.
# This is intended as a product-direction demo feature (governance-style reporting),
# not a replacement for Forward's built-in security analysis features.

packs:
  - id: "cloud-policy"
    title: "Cloud Policy Pack (AWS SG)"
    description: "CSPM-lite network posture checks for AWS Security Groups."
    checks:
      - id: "aws-sg-ingress-sensitive-ports.nqe"
      - id: "aws-sg-ingress-any-service.nqe"
      - id: "aws-sg-egress-any-service.nqe"

  - id: "policy-risk"
    title: "Policy Risk Pack"
    description: "High-signal modeled ACL risks that map to common audit questions."
    checks:
      - id: "acl-any-any-permit.nqe"
      - id: "acl-permit-any-service.nqe"
      - id: "acl-any-to-rfc1918-sensitive-ports.nqe"
      - id: "acl-rfc1918-to-internet-any-service.nqe"
      - id: "acl-rfc1918-to-internet-sensitive-ports.nqe"

  - id: "assurance-demo"
    title: "Assurance Demo Pack"
    description: "High-signal posture checks used by assurance summary demos."
    checks:
      - id: "acl-any-any-permit.nqe"
      - id: "acl-permit-any-service.nqe"
      - id: "acl-any-to-rfc1918-sensitive-ports.nqe"
      - id: "acl-rfc1918-to-internet-any-service.nqe"
      - id: "acl-rfc1918-to-internet-sensitive-ports.nqe"
      - id: "default-route-urpf-heuristic.nqe"
      - id: "ospf-passive-default.nqe"

  - id: "segmentation"
    title: "Segmentation Pack"
    description: "Zone boundary and any-to-zone exposure checks (parameterized by zone CIDRs)."
    checks:
      - id: "acl-zone-to-zone-any-service.nqe"
        parameters:
          srcSubnets: ["10.0.0.0/8"]
          dstSubnets: ["10.1.0.0/16"]
          firewallsOnly: true
          includeImplicitDefault: false
      - id: "acl-zone-to-zone-sensitive-ports.nqe"
        parameters:
          srcSubnets: ["10.0.0.0/8"]
          dstSubnets: ["10.1.0.0/16"]
          sensitivePorts: [22, 23, 3389, 445]
          firewallsOnly: true
          includeImplicitDefault: false
      - id: "acl-any-to-zone-any-service.nqe"
        parameters:
          dstSubnets: ["10.1.0.0/16"]
          firewallsOnly: true
          includeImplicitDefault: false
      - id: "acl-any-to-zone-sensitive-ports.nqe"
        parameters:
          dstSubnets: ["10.1.0.0/16"]
          sensitivePorts: [22, 23, 3389, 445]
          firewallsOnly: true
          includeImplicitDefault: false

  - id: "policy-analytics"
    title: "Policy Analytics Pack"
    description: "Rulebase analytics for hygiene and intent: flow lookup, shadowing, redundancy, and conflicts."
    checks:
      - id: "acl-flow-decision.nqe"
        parameters:
          srcIp: "10.0.0.1"
          dstIp: "10.0.0.2"
          ipProto: 6
          dstPort: 443
          firewallsOnly: true
          includeImplicitDefault: false
      - id: "acl-flow-to-rules.nqe"
        parameters:
          srcIp: "10.0.0.1"
          dstIp: "10.0.0.2"
          ipProto: 6
          dstPort: 443
          firewallsOnly: true
          includeImplicitDefault: false
      - id: "acl-shadowed-rules.nqe"
      - id: "acl-partial-shadowed-rules.nqe"
      - id: "acl-unreachable-rules.nqe"
      - id: "acl-redundant-rules.nqe"
      - id: "acl-overlap-conflicts.nqe"
      - id: "nat-flow-matches.nqe"
        parameters:
          srcIp: "10.0.0.1"
          dstIp: "10.0.0.2"
          ipProto: 6
          dstPort: 443

  - id: "policy-recert"
    title: "Policy Recert Pack"
    description: "Lifecycle and usage-based findings useful for quarterly rule recertification."
    checks:
      - id: "acl-unused-permits-days.nqe"
        parameters:
          daysWindow: 30
          includeUnknownUsage: true
      - id: "acl-never-hit-permits.nqe"

  - id: "routing-hardening"
    title: "Routing Hardening Pack"
    description: "Lightweight config heuristics (good for quick posture conversations)."
    checks:
      - id: "default-route-urpf-heuristic.nqe"
      - id: "ospf-passive-default.nqe"
