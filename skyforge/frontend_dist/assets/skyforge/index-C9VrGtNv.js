import{a as e}from"./rolldown-runtime-DAKAggwm.js";import{a as t,c as n,d as r,f as i,h as a,i as o,l as s,m as c,n as l,o as u,p as d,r as f,s as p,t as m,u as h}from"./tanstack-DvhJxH3r.js";import{$ as g,$t as _,A as v,An as y,At as b,B as ee,Bn as te,Bt as x,C as S,Cn as C,Ct as w,D as ne,Dn as T,Dt as re,E as ie,En as ae,Et as E,F as D,Fn as O,Ft as oe,G as se,Gn as ce,Gt as k,H as le,Hn as ue,Ht as de,I as fe,In as pe,It as me,J as he,Jn as ge,Jt as _e,K as ve,Kn as ye,Kt as be,L as xe,Ln as Se,Lt as Ce,M as we,Mn as Te,Mt as Ee,N as De,Nn as Oe,Nt as ke,O as A,On as Ae,Ot as je,P as Me,Pn as Ne,Pt as Pe,Q as Fe,Qn as Ie,Qt as Le,R as Re,Rn as ze,Rt as Be,S as Ve,Sn as He,St as Ue,T as We,Tn as Ge,Tt as Ke,U as qe,Un as Je,Ut as Ye,V as Xe,Vn as Ze,Vt as Qe,W as $e,Wn as et,Wt as tt,X as nt,Xn as rt,Xt as it,Y as at,Yn as ot,Yt as st,Z as ct,Zn as lt,Zt as ut,_ as dt,_n as ft,_t as pt,a as mt,an as ht,at as gt,b as _t,bn as vt,bt as yt,c as bt,cn as xt,ct as St,d as Ct,dn as wt,dt as Tt,en as Et,et as Dt,f as Ot,fn as kt,ft as At,g as jt,gn as Mt,gt as Nt,h as Pt,hn as Ft,ht as It,i as Lt,in as Rt,it as zt,j as Bt,jn as Vt,jt as Ht,k as Ut,kn as Wt,kt as Gt,l as Kt,ln as qt,lt as Jt,m as Yt,mn as Xt,mt as Zt,n as Qt,nn as $t,nr as en,nt as j,o as tn,on as nn,ot as rn,p as an,pn as on,pt as sn,q as cn,qn as ln,qt as un,r as dn,rn as fn,rt as pn,s as mn,sn as hn,st as gn,t as _n,tn as vn,tr as yn,tt as bn,u as xn,un as Sn,ut as Cn,v as wn,vn as Tn,vt as En,w as Dn,wn as On,wt as kn,x as An,xn as jn,xt as Mn,y as Nn,yn as Pn,yt as Fn,z as In,zn as Ln,zt as Rn}from"./react-D5RjkYAC.js";import{n as zn,r as Bn,t as Vn}from"./ui-utils-l2x0dF3k.js";import{a as Hn,c as Un,i as Wn,n as Gn,o as Kn,r as qn,s as Jn,t as Yn}from"./vendor-eD_tp6fL.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var Xn=e(Ie(),1),M=e(en(),1);function N(...e){return zn(Bn(e))}var P=yn(),Zn=Ke,Qn=kn,$n=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(w,{ref:n,className:N(`fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0`,e),...t}));$n.displayName=w.displayName;var er=M.forwardRef(({className:e,children:t,...n},r)=>(0,P.jsxs)(Qn,{children:[(0,P.jsx)($n,{}),(0,P.jsxs)(Mn,{ref:r,className:N(`fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg`,e),...n,children:[t,(0,P.jsxs)(yt,{className:`absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground`,children:[(0,P.jsx)(Gt,{className:`h-4 w-4`}),(0,P.jsx)(`span`,{className:`sr-only`,children:`Close`})]})]})]}));er.displayName=Mn.displayName;var tr=({className:e,...t})=>(0,P.jsx)(`div`,{className:N(`flex flex-col space-y-1.5 text-center sm:text-left`,e),...t});tr.displayName=`DialogHeader`;var nr=({className:e,...t})=>(0,P.jsx)(`div`,{className:N(`flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2`,e),...t});nr.displayName=`DialogFooter`;var rr=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(E,{ref:n,className:N(`text-lg font-semibold leading-none tracking-tight`,e),...t}));rr.displayName=E.displayName;var ir=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(Ue,{ref:n,className:N(`text-sm text-muted-foreground`,e),...t}));ir.displayName=Ue.displayName;var ar=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(En,{ref:n,className:N(`flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground`,e),...t}));ar.displayName=En.displayName;var or=({children:e,...t})=>(0,P.jsx)(Zn,{...t,children:(0,P.jsx)(er,{className:`overflow-hidden p-0 shadow-lg`,children:(0,P.jsx)(ar,{className:`[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5`,children:e})})}),sr=M.forwardRef(({className:e,...t},n)=>(0,P.jsxs)(`div`,{className:`flex items-center border-b px-3`,"cmdk-input-wrapper":``,children:[(0,P.jsx)(un,{className:`mr-2 h-4 w-4 shrink-0 opacity-50`}),(0,P.jsx)(En.Input,{ref:n,className:N(`flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50`,e),...t})]}));sr.displayName=En.Input.displayName;var cr=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(En.List,{ref:n,className:N(`max-h-[300px] overflow-y-auto overflow-x-hidden`,e),...t}));cr.displayName=En.List.displayName;var lr=M.forwardRef((e,t)=>(0,P.jsx)(En.Empty,{ref:t,className:`py-6 text-center text-sm`,...e}));lr.displayName=En.Empty.displayName;var ur=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(En.Group,{ref:n,className:N(`overflow-hidden p-1 text-popover-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground`,e),...t}));ur.displayName=En.Group.displayName;var dr=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(En.Separator,{ref:n,className:N(`-mx-1 h-px bg-border`,e),...t}));dr.displayName=En.Separator.displayName;var fr=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(En.Item,{ref:n,className:N(`relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50`,e),...t}));fr.displayName=En.Item.displayName;var pr=({className:e,...t})=>(0,P.jsx)(`span`,{className:N(`ml-auto text-xs tracking-widest text-muted-foreground`,e),...t});pr.displayName=`CommandShortcut`;function mr(){let[e,t]=M.useState(!1),r=n();M.useEffect(()=>{let e=e=>{e.key===`k`&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),t(e=>!e))};return document.addEventListener(`keydown`,e),()=>document.removeEventListener(`keydown`,e)},[]);let i=M.useCallback(e=>{t(!1),e()},[]);return(0,P.jsxs)(or,{open:e,onOpenChange:t,children:[(0,P.jsx)(sr,{placeholder:`Type a command or search...`}),(0,P.jsxs)(cr,{children:[(0,P.jsx)(lr,{children:`No results found.`}),(0,P.jsxs)(ur,{heading:`Suggestions`,children:[(0,P.jsxs)(fr,{onSelect:()=>i(()=>r({to:`/status`})),children:[(0,P.jsx)(wt,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Dashboard`})]}),(0,P.jsxs)(fr,{onSelect:()=>i(()=>r({to:`/dashboard/deployments`})),children:[(0,P.jsx)(He,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Deployments`})]}),(0,P.jsxs)(fr,{onSelect:()=>i(()=>r({to:`/status`})),children:[(0,P.jsx)(lt,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Platform Status`})]})]}),(0,P.jsx)(dr,{}),(0,P.jsxs)(ur,{heading:`Forward`,children:[(0,P.jsxs)(fr,{onSelect:()=>i(()=>r({to:`/dashboard/forward/credentials`})),children:[(0,P.jsx)(Rt,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Forward Credentials`})]}),(0,P.jsxs)(fr,{onSelect:()=>i(()=>r({to:`/dashboard/forward/collector`})),children:[(0,P.jsx)(Rt,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Forward Collector`})]}),(0,P.jsxs)(fr,{onSelect:()=>i(()=>r({to:`/dashboard/forward/analytics`})),children:[(0,P.jsx)(tt,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Forward Analytics`})]})]}),(0,P.jsx)(dr,{}),(0,P.jsx)(ur,{heading:`Infrastructure`,children:(0,P.jsxs)(fr,{onSelect:()=>i(()=>r({to:`/dashboard/s3`})),children:[(0,P.jsx)(be,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Artifacts (S3)`})]})}),(0,P.jsx)(dr,{}),(0,P.jsxs)(ur,{heading:`Events & Monitoring`,children:[(0,P.jsxs)(fr,{onSelect:()=>i(()=>r({to:`/notifications`})),children:[(0,P.jsx)(ge,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Notifications`})]}),(0,P.jsxs)(fr,{onSelect:()=>i(()=>r({to:`/webhooks`})),children:[(0,P.jsx)(Ht,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Webhooks`})]}),(0,P.jsxs)(fr,{onSelect:()=>i(()=>r({to:`/syslog`})),children:[(0,P.jsx)(Ft,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Syslog`})]}),(0,P.jsxs)(fr,{onSelect:()=>i(()=>r({to:`/snmp`})),children:[(0,P.jsx)(tt,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`SNMP Traps`})]})]})]})]})}function hr(){let e=s({select:e=>e.status===`pending`}),[t,n]=M.useState(!1);return M.useEffect(()=>{let t;return e?n(!0):t=setTimeout(()=>n(!1),500),()=>clearTimeout(t)},[e]),t?(0,P.jsx)(`div`,{className:N(`fixed top-0 left-0 z-[100] h-1 w-full bg-transparent overflow-hidden`),children:(0,P.jsx)(`div`,{className:N(`h-full w-full bg-primary/80 origin-left animate-progress`)})}):null}var gr=(0,M.createContext)({theme:`system`,setTheme:()=>null});function _r({children:e,defaultTheme:t=`system`,storageKey:n=`vite-ui-theme`}){let[r,i]=(0,M.useState)(()=>localStorage.getItem(n)||t);(0,M.useEffect)(()=>{let e=window.document.documentElement;if(e.classList.remove(`light`,`dark`),r===`system`){let t=window.matchMedia(`(prefers-color-scheme: dark)`).matches?`dark`:`light`;e.classList.add(t);return}e.classList.add(r)},[r]);let a={theme:r,setTheme:e=>{localStorage.setItem(n,e),i(e)}};return(0,P.jsx)(gr.Provider,{value:a,children:e})}const vr=()=>{let e=(0,M.useContext)(gr);if(e===void 0)throw Error(`useTheme must be used within a ThemeProvider`);return e};var yr=Vn(`inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0`,{variants:{variant:{default:`bg-primary text-primary-foreground hover:bg-primary/90`,destructive:`bg-destructive text-destructive-foreground hover:bg-destructive/90`,outline:`border border-input bg-background hover:bg-accent hover:text-accent-foreground`,secondary:`bg-secondary text-secondary-foreground hover:bg-secondary/80`,ghost:`hover:bg-accent hover:text-accent-foreground`,link:`text-primary underline-offset-4 hover:underline`},size:{default:`h-10 px-4 py-2`,sm:`h-9 rounded-md px-3`,lg:`h-11 rounded-md px-8`,icon:`h-10 w-10`}},defaultVariants:{variant:`default`,size:`default`}}),F=M.forwardRef(({className:e,variant:t,size:n,...r},i)=>(0,P.jsx)(`button`,{className:N(yr({variant:t,size:n,className:e})),ref:i,...r}));F.displayName=`Button`;var br=At,xr=pt,Sr=M.forwardRef(({className:e,inset:t,children:n,...r},i)=>(0,P.jsxs)(Nt,{ref:i,className:N(`flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent`,t&&`pl-8`,e),...r,children:[n,(0,P.jsx)(te,{className:`ml-auto h-4 w-4`})]}));Sr.displayName=Nt.displayName;var Cr=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(It,{ref:n,className:N(`z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2`,e),...t}));Cr.displayName=It.displayName;var wr=M.forwardRef(({className:e,sideOffset:t=4,...n},r)=>(0,P.jsx)(Jt,{children:(0,P.jsx)(zt,{ref:r,sideOffset:t,className:N(`z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2`,e),...n})}));wr.displayName=zt.displayName;var Tr=M.forwardRef(({className:e,inset:t,...n},r)=>(0,P.jsx)(rn,{ref:r,className:N(`relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50`,t&&`pl-8`,e),...n}));Tr.displayName=rn.displayName;var Er=M.forwardRef(({className:e,children:t,checked:n,...r},i)=>(0,P.jsxs)(pn,{ref:i,className:N(`relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50`,e),checked:n,...r,children:[(0,P.jsx)(`span`,{className:`absolute left-2 flex h-3.5 w-3.5 items-center justify-center`,children:(0,P.jsx)(gn,{children:(0,P.jsx)(Je,{className:`h-4 w-4`})})}),t]}));Er.displayName=pn.displayName;var Dr=M.forwardRef(({className:e,children:t,...n},r)=>(0,P.jsxs)(Tt,{ref:r,className:N(`relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50`,e),...n,children:[(0,P.jsx)(`span`,{className:`absolute left-2 flex h-3.5 w-3.5 items-center justify-center`,children:(0,P.jsx)(gn,{children:(0,P.jsx)(pe,{className:`h-2 w-2 fill-current`})})}),t]}));Dr.displayName=Tt.displayName;var Or=M.forwardRef(({className:e,inset:t,...n},r)=>(0,P.jsx)(St,{ref:r,className:N(`px-2 py-1.5 text-sm font-semibold`,t&&`pl-8`,e),...n}));Or.displayName=St.displayName;var kr=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(sn,{ref:n,className:N(`-mx-1 my-1 h-px bg-muted`,e),...t}));kr.displayName=sn.displayName;var Ar=({className:e,...t})=>(0,P.jsx)(`span`,{className:N(`ml-auto text-xs tracking-widest opacity-60`,e),...t});Ar.displayName=`DropdownMenuShortcut`;function jr(){let{setTheme:e}=vr();return(0,P.jsxs)(br,{children:[(0,P.jsx)(xr,{asChild:!0,children:(0,P.jsxs)(F,{variant:`outline`,size:`icon`,children:[(0,P.jsx)(Qe,{className:`h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0`}),(0,P.jsx)(ht,{className:`absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100`}),(0,P.jsx)(`span`,{className:`sr-only`,children:`Toggle theme`})]})}),(0,P.jsxs)(wr,{align:`end`,children:[(0,P.jsx)(Tr,{onClick:()=>e(`light`),children:`Light`}),(0,P.jsx)(Tr,{onClick:()=>e(`dark`),children:`Dark`}),(0,P.jsx)(Tr,{onClick:()=>e(`system`),children:`System`})]})]})}const Mr=`/api`;function Nr(e){let t=e.startsWith(`/`)?e:`/`;return`${Mr}/oidc/login?next=${encodeURIComponent(t)}`}var Pr=class extends Error{status;bodyText;constructor(e,t,n){super(e),this.name=`ApiError`,this.status=t,this.bodyText=n}};function Fr(e){let t=(e??``).trim();if(!t)return``;try{let e=JSON.parse(t);if(typeof e?.message==`string`&&e.message.trim())return e.message.trim();if(typeof e?.error?.message==`string`&&e.error.message.trim())return e.error.message.trim()}catch{}return t}async function I(e,t){let n=(t?.method??`GET`).toUpperCase(),r=await fetch(`${e}`,{credentials:`include`,...t,headers:{"Content-Type":`application/json`,...t?.headers??{}}});if(r.status===401){let e=await r.text().catch(()=>``);if(n===`GET`&&typeof window<`u`){let e=window.location.pathname+(window.location.search??``);window.location.href=Nr(e)}throw new Pr(`unauthorized`,r.status,e)}if(r.status===403){let e=await r.text().catch(()=>``),t=Fr(e);throw new Pr(t?`forbidden: ${t}`:`forbidden`,r.status,e)}if(!r.ok){let e=await r.text().catch(()=>``),t=Fr(e);throw new Pr(t?`request failed (${r.status}): ${t}`:`request failed (${r.status})`,r.status,e)}return r.status===204?{}:await r.json()}async function Ir(){return I(`/api/session`)}async function Lr(){let e=await fetch(`/auth/logout`,{method:`POST`,credentials:`include`,headers:{"Content-Type":`application/json`},body:`{}`});if(!e.ok){let t=await e.text().catch(()=>``);throw Error(`logout failed (${e.status}): ${t}`)}}async function Rr(){return I(`/api/dashboard/snapshot`)}async function zr(e,t){let n=new URLSearchParams;t?.include_read&&n.set(`include_read`,t.include_read),t?.limit&&n.set(`limit`,t.limit);let r=n.toString();return I(`/notifications/for-user/${encodeURIComponent(e)}${r?`?${r}`:``}`)}async function Br(e){return I(`/notifications/for-user/${encodeURIComponent(e)}/read-all`,{method:`PUT`})}async function Vr(e){return I(`/notifications/single/${encodeURIComponent(e)}/read`,{method:`PUT`})}async function Hr(e){return I(`/notifications/single/${encodeURIComponent(e)}`,{method:`DELETE`})}async function Ur(e){let t=new URLSearchParams;e?.server&&t.set(`server`,e.server),e?.path&&t.set(`path`,e.path),e?.recursive&&t.set(`recursive`,`true`);let n=t.toString();return I(`/api/eve/labs${n?`?${n}`:``}`)}async function Wr(e){return I(`/api/eve/import`,{method:`POST`,body:JSON.stringify(e)})}async function Gr(e){return I(`/api/eve/convert`,{method:`POST`,body:JSON.stringify(e)})}async function Kr(){return I(`/api/integrations/servicenow`)}async function qr(e){return I(`/api/integrations/servicenow`,{method:`PUT`,body:JSON.stringify(e)})}async function Jr(){return I(`/api/integrations/servicenow/install`,{method:`POST`,body:`{}`})}async function Yr(){return I(`/api/integrations/servicenow/pdiStatus`)}async function Xr(){return I(`/api/integrations/servicenow/schemaStatus`)}async function Zr(){return I(`/api/integrations/servicenow/wake`,{method:`POST`,body:`{}`})}async function Qr(){return I(`/api/integrations/servicenow/configureForwardTicketing`,{method:`POST`,body:`{}`})}async function $r(){return I(`/api/git-credentials`)}async function ei(){return I(`/api/settings`)}async function ti(e){let t=new URLSearchParams;e?.forwardCredentialProfileId&&t.set(`forwardCredentialProfileId`,e.forwardCredentialProfileId),e?.q&&t.set(`q`,e.q),typeof e?.limit==`number`&&e.limit>0&&t.set(`limit`,String(e.limit));let n=t.toString();return I(`/api/forward/source-networks${n?`?${n}`:``}`)}async function ni(){return I(`/api/aws/sso/config`)}async function ri(){return I(`/api/aws/sso/status`)}async function ii(){return I(`/api/aws/sso/start`,{method:`POST`,body:`{}`})}async function ai(e){return I(`/api/aws/sso/poll`,{method:`POST`,body:JSON.stringify(e)})}async function oi(){return I(`/api/aws/sso/logout`,{method:`POST`,body:`{}`})}async function si(){return I(`/api/cloud/aws-static`)}async function ci(e){return I(`/api/cloud/aws-static`,{method:`PUT`,body:JSON.stringify(e)})}async function li(){await I(`/api/cloud/aws-static`,{method:`DELETE`})}async function ui(){return I(`/api/cloud/aws-sso`)}async function di(e){return I(`/api/cloud/aws-sso`,{method:`PUT`,body:JSON.stringify(e)})}async function fi(){await I(`/api/cloud/aws-sso`,{method:`DELETE`})}async function pi(){return I(`/api/cloud/azure`)}async function mi(e){return I(`/api/cloud/azure`,{method:`PUT`,body:JSON.stringify(e)})}async function hi(){await I(`/api/cloud/azure`,{method:`DELETE`})}async function gi(){return I(`/api/cloud/gcp`)}async function _i(e){return I(`/api/cloud/gcp`,{method:`PUT`,body:JSON.stringify(e)})}async function vi(){await I(`/api/cloud/gcp`,{method:`DELETE`})}async function yi(){return I(`/api/cloud/ibm`)}async function bi(e){return I(`/api/cloud/ibm`,{method:`PUT`,body:JSON.stringify(e)})}async function xi(){await I(`/api/cloud/ibm`,{method:`DELETE`})}async function Si(){return I(`/api/netlab/servers`)}async function Ci(e){return I(`/api/netlab/servers`,{method:`PUT`,body:JSON.stringify(e)})}async function wi(e){await I(`/api/netlab/servers/${encodeURIComponent(e)}`,{method:`DELETE`})}async function Ti(){return I(`/api/eve/servers`)}async function Ei(e){return I(`/api/eve/servers`,{method:`PUT`,body:JSON.stringify(e)})}async function Di(e){await I(`/api/eve/servers/${encodeURIComponent(e)}`,{method:`DELETE`})}async function Oi(){return I(`/api/containerlab/servers`)}async function ki(e){return I(`/api/containerlab/servers`,{method:`PUT`,body:JSON.stringify(e)})}async function Ai(e){await I(`/api/containerlab/servers/${encodeURIComponent(e)}`,{method:`DELETE`})}async function ji(e,t){return I(`/api/deploy/${encodeURIComponent(e)}/forward`,{method:`PUT`,body:JSON.stringify(t)})}async function Mi(e){return I(`/api/deploy/${encodeURIComponent(e)}/forward/sync`,{method:`POST`,body:`{}`})}async function Ni(e){return I(`/api/deploy/${encodeURIComponent(e)}/cap/summary`)}async function Pi(e){return I(`/api/deploy/${encodeURIComponent(e)}/cap/rollups/refresh`,{method:`POST`,body:`{}`})}async function Fi(e){return I(`/api/deploy/${encodeURIComponent(e)}/cap/inventory`)}async function Ii(e,t){let n=new URLSearchParams;return n.set(`metric`,t.metric),n.set(`window`,t.window),t.objectType&&n.set(`objectType`,t.objectType),t.compareHours&&n.set(`compareHours`,String(t.compareHours)),t.limit&&n.set(`limit`,String(t.limit)),I(`/api/deploy/${encodeURIComponent(e)}/cap/growth?${n.toString()}`)}async function Li(e,t){return I(`/api/deploy/${encodeURIComponent(e)}/cap/perf/if-metrics`,{method:`POST`,body:JSON.stringify(t)})}async function Ri(e,t){return I(`/api/deploy/${encodeURIComponent(e)}/cap/perf/dev-metrics`,{method:`POST`,body:JSON.stringify(t)})}async function zi(e,t){let n=new URLSearchParams;t.snapshotId&&n.set(`snapshotId`,t.snapshotId),t.endTime&&n.set(`endTime`,t.endTime);let r=n.toString()?`?${n.toString()}`:``;return I(`/api/deploy/${encodeURIComponent(e)}/cap/perf/unhealthy-devices${r}`)}async function Bi(e,t){return I(`/api/deploy/${encodeURIComponent(e)}/links/impair`,{method:`POST`,body:JSON.stringify(t)})}async function Vi(e,t){return I(`/api/deploy/${encodeURIComponent(e)}/links/admin`,{method:`POST`,body:JSON.stringify(t)})}async function Hi(e,t){return I(`/api/deploy/${encodeURIComponent(e)}/links/capture`,{method:`POST`,body:JSON.stringify(t)})}async function Ui(e,t){return I(`/api/deploy/${encodeURIComponent(e)}/nodes/${encodeURIComponent(t)}/interfaces`)}async function Wi(e,t){return I(`/api/deploy/${encodeURIComponent(e)}/nodes/${encodeURIComponent(t)}/running-config`)}async function Gi(e,t=`json`){let n=new URLSearchParams;return n.set(`format`,t),I(`/api/deploy/${encodeURIComponent(e)}/inventory?${n.toString()}`)}async function Ki(e,t,n){let r=new URLSearchParams;n?.tail&&r.set(`tail`,String(n.tail)),n?.container&&r.set(`container`,n.container);let i=r.toString();return I(`/api/deploy/${encodeURIComponent(e)}/nodes/${encodeURIComponent(t)}/logs${i?`?${i}`:``}`)}async function qi(e,t){return I(`/api/deploy/${encodeURIComponent(e)}/nodes/${encodeURIComponent(t)}/describe`)}async function Ji(e,t){return I(`/api/deploy/${encodeURIComponent(e)}/nodes/${encodeURIComponent(t)}/save-config`,{method:`POST`,body:`{}`})}async function Yi(e){return I(`/api/deploy/${encodeURIComponent(e)}/links/stats`)}async function Xi(e){let t=new URLSearchParams;e?.source&&t.set(`source`,e.source),e?.repo&&t.set(`repo`,e.repo),e?.dir&&t.set(`dir`,e.dir);let n=t.toString();return I(`/api/netlab/templates${n?`?${n}`:``}`)}async function Zi(e){let t=new URLSearchParams;return e.source&&t.set(`source`,e.source),e.repo&&t.set(`repo`,e.repo),e.dir&&t.set(`dir`,e.dir),t.set(`template`,e.template),I(`/api/netlab/template?${t.toString()}`)}async function Qi(e){return I(`/api/netlab/validate`,{method:`POST`,body:JSON.stringify(e)})}async function $i(e){let t=new URLSearchParams;e?.source&&t.set(`source`,e.source),e?.repo&&t.set(`repo`,e.repo),e?.dir&&t.set(`dir`,e.dir);let n=t.toString();return I(`/api/containerlab/templates${n?`?${n}`:``}`)}async function ea(e){let t=new URLSearchParams;e?.source&&t.set(`source`,e.source),e?.repo&&t.set(`repo`,e.repo),e?.dir&&t.set(`dir`,e.dir);let n=t.toString();return I(`/api/terraform/templates${n?`?${n}`:``}`)}async function ta(e){let t=new URLSearchParams;return e.source&&t.set(`source`,e.source),e.repo&&t.set(`repo`,e.repo),e.dir&&t.set(`dir`,e.dir),t.set(`file`,e.file),I(`/api/containerlab/template?${t.toString()}`)}async function na(e){let t=new URLSearchParams;e?.source&&t.set(`source`,e.source),e?.repo&&t.set(`repo`,e.repo),e?.dir&&t.set(`dir`,e.dir);let n=t.toString();return I(`/api/eve-ng/templates${n?`?${n}`:``}`)}async function ra(e){return I(`/api/deploy`,{method:`POST`,body:JSON.stringify(e)})}async function ia(e){return I(`/api/containerlab/topologies`,{method:`POST`,body:JSON.stringify(e)})}async function aa(e){return I(`/api/design/clabernetes/from-template`,{method:`POST`,body:JSON.stringify(e)})}async function oa(e){return I(`/api/design/containerlab/from-template`,{method:`POST`,body:JSON.stringify(e)})}async function sa(e){return I(`/api/deploy/${encodeURIComponent(e)}/topology`)}async function ca(e){let t=new URLSearchParams;e?.q&&t.set(`q`,e.q),e?.n&&t.set(`n`,String(e.n));let n=t.toString();return I(`/api/registry/repos${n?`?${n}`:``}`)}async function la(e,t){let n=new URLSearchParams;t?.q&&n.set(`q`,t.q);let r=n.toString();return I(`/api/registry/repos/${encodeURIComponent(e)}/tags${r?`?${r}`:``}`)}async function ua(){return I(`/api/forward/collector-configs`)}async function da(e){return I(`/api/forward/collector-configs`,{method:`POST`,body:JSON.stringify(e)})}async function fa(e){return I(`/api/forward/collector-configs/${encodeURIComponent(e)}`,{method:`DELETE`})}async function pa(e,t){let n=new URLSearchParams;t&&t>0&&n.set(`tail`,String(t));let r=n.toString();return I(`/api/forward/collector-configs/${encodeURIComponent(e)}/logs${r?`?${r}`:``}`)}async function ma(e){return I(`/api/forward/collector-configs/${encodeURIComponent(e)}/restart`,{method:`POST`,body:`{}`})}async function ha(){return I(`/api/forward/credential-profiles`)}async function ga(e){return I(`/api/forward/credential-profiles`,{method:`POST`,body:JSON.stringify(e)})}async function _a(e){return I(`/api/forward/credential-profiles/${encodeURIComponent(e)}`,{method:`DELETE`})}async function va(e){let t=new URLSearchParams;e?.prefix&&t.set(`prefix`,e.prefix),e?.limit&&t.set(`limit`,e.limit);let n=t.toString();return I(`/api/artifacts${n?`?${n}`:``}`)}async function ya(e){return I(`/api/artifacts/download?${new URLSearchParams({key:e}).toString()}`)}async function ba(e){return I(`/api/artifacts/object`,{method:`POST`,body:JSON.stringify(e)})}async function xa(e){return I(`/api/artifacts/object?${new URLSearchParams({key:e}).toString()}`,{method:`DELETE`})}async function Sa(e){return I(`/api/artifacts/folder`,{method:`POST`,body:JSON.stringify({prefix:e})})}async function Ca(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit),e?.before_id&&t.set(`before_id`,e.before_id);let n=t.toString();return I(`/api/webhooks/events${n?`?${n}`:``}`)}async function wa(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit),e?.before_id&&t.set(`before_id`,e.before_id),e?.source_ip&&t.set(`source_ip`,e.source_ip),e?.unassigned&&t.set(`unassigned`,e.unassigned);let n=t.toString();return I(`/api/syslog/events${n?`?${n}`:``}`)}async function Ta(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit),e?.before_id&&t.set(`before_id`,e.before_id);let n=t.toString();return I(`/api/snmp/traps/events${n?`?${n}`:``}`)}async function Ea(){return I(`/api/admin/governance/summary`)}async function Da(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit);let n=t.toString();return I(`/api/admin/governance/resources${n?`?${n}`:``}`)}async function Oa(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit);let n=t.toString();return I(`/api/admin/governance/costs${n?`?${n}`:``}`)}async function ka(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit);let n=t.toString();return I(`/api/admin/governance/usage${n?`?${n}`:``}`)}async function Aa(){await I(`/api/admin/governance/sync`,{method:`POST`,body:`{}`})}async function ja(){return I(`/api/admin/config`)}async function Ma(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit);let n=t.toString();return I(`/api/admin/audit${n?`?${n}`:``}`)}async function Na(){return I(`/api/admin/impersonate/status`)}async function Pa(e){return I(`/api/admin/impersonate/start`,{method:`POST`,body:JSON.stringify(e)})}async function Fa(){return I(`/api/admin/impersonate/stop`,{method:`POST`,body:`{}`})}async function Ia(e){return I(`/api/admin/tasks/reconcile`,{method:`POST`,body:JSON.stringify(e)})}async function La(e){return I(`/api/admin/tasks/reconcile-running`,{method:`POST`,body:JSON.stringify(e)})}async function Ra(e){return I(`/api/admin/users/purge`,{method:`POST`,body:JSON.stringify(e)})}async function za(){return I(`/api/admin/governance/policy`)}async function Ba(e){return I(`/api/admin/governance/policy`,{method:`PUT`,body:JSON.stringify(e)})}async function Va(e){return I(`/api/deploy/${encodeURIComponent(e)}/start`,{method:`POST`,body:`{}`})}async function Ha(e){return I(`/api/deploy/${encodeURIComponent(e)}/stop`,{method:`POST`,body:`{}`})}async function Ua(e,t){let n=new URLSearchParams;t?.forwardDelete&&n.set(`forward_delete`,`true`);let r=n.toString();return I(`/api/deploy/${encodeURIComponent(e)}${r?`?${r}`:``}`,{method:`DELETE`})}async function Wa(){return I(`/api/ui/config`)}async function Ga(){return I(`/status/summary`)}async function Ka(e){return I(`/api/runs/${encodeURIComponent(String(e))}/cancel`,{method:`POST`,body:`{}`})}async function qa(){return I(`/api/variable-groups`)}async function Ja(e){return I(`/api/variable-groups`,{method:`POST`,body:JSON.stringify(e)})}async function Ya(e,t){return I(`/api/variable-groups/${encodeURIComponent(e)}`,{method:`PUT`,body:JSON.stringify(t)})}async function Xa(e){return I(`/api/variable-groups/${encodeURIComponent(e)}`,{method:`DELETE`})}async function Za(e,t){let n=new URLSearchParams;return n.set(`networkId`,e),typeof t==`number`&&n.set(`maxResults`,String(t)),I(`/api/forward/analytics/snapshots?${n.toString()}`)}async function Qa(e){return I(`/api/forward/cloud/run`,{method:`POST`,body:JSON.stringify(e)})}async function $a(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId);let n=t.toString();return I(`/api/forward/cloud/summary${n?`?${n}`:``}`)}async function eo(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId),e.snapshotId&&t.set(`snapshotId`,e.snapshotId),e.category&&t.set(`category`,e.category),e.severity&&t.set(`severity`,e.severity),e.status&&t.set(`status`,e.status),typeof e.limit==`number`&&t.set(`limit`,String(e.limit)),e.cursor&&t.set(`cursor`,e.cursor);let n=t.toString();return I(`/api/forward/cloud/priorities${n?`?${n}`:``}`)}async function to(e,t={}){let n=new URLSearchParams;t.forwardNetworkRef&&n.set(`forwardNetworkRef`,t.forwardNetworkRef),t.forwardNetworkId&&n.set(`forwardNetworkId`,t.forwardNetworkId);let r=n.toString();return I(`/api/forward/cloud/findings/${encodeURIComponent(e)}/evidence${r?`?${r}`:``}`)}async function no(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId),e.snapshotId&&t.set(`snapshotId`,e.snapshotId);let n=t.toString();return I(`/api/forward/cloud/queries${n?`?${n}`:``}`)}async function ro(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId);let n=t.toString();return I(`/api/forward/cloud/sources${n?`?${n}`:``}`)}async function io(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId);let n=t.toString();return I(`/api/forward/cloud/drift${n?`?${n}`:``}`)}async function ao(e){return I(`/api/forward/security/run`,{method:`POST`,body:JSON.stringify(e)})}async function oo(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId);let n=t.toString();return I(`/api/forward/security/summary${n?`?${n}`:``}`)}async function so(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId),e.snapshotId&&t.set(`snapshotId`,e.snapshotId),e.category&&t.set(`category`,e.category),e.severity&&t.set(`severity`,e.severity),e.status&&t.set(`status`,e.status),typeof e.limit==`number`&&t.set(`limit`,String(e.limit)),e.cursor&&t.set(`cursor`,e.cursor);let n=t.toString();return I(`/api/forward/security/priorities${n?`?${n}`:``}`)}async function co(e,t={}){let n=new URLSearchParams;t.forwardNetworkRef&&n.set(`forwardNetworkRef`,t.forwardNetworkRef),t.forwardNetworkId&&n.set(`forwardNetworkId`,t.forwardNetworkId);let r=n.toString();return I(`/api/forward/security/findings/${encodeURIComponent(e)}/evidence${r?`?${r}`:``}`)}async function lo(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId),e.snapshotId&&t.set(`snapshotId`,e.snapshotId);let n=t.toString();return I(`/api/forward/security/queries${n?`?${n}`:``}`)}async function uo(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId);let n=t.toString();return I(`/api/forward/security/sources${n?`?${n}`:``}`)}async function fo(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId);let n=t.toString();return I(`/api/forward/security/drift${n?`?${n}`:``}`)}async function po(e){return I(`/api/forward/routing/run`,{method:`POST`,body:JSON.stringify(e)})}async function mo(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId);let n=t.toString();return I(`/api/forward/routing/summary${n?`?${n}`:``}`)}async function ho(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId),e.snapshotId&&t.set(`snapshotId`,e.snapshotId),e.category&&t.set(`category`,e.category),e.severity&&t.set(`severity`,e.severity),e.status&&t.set(`status`,e.status),typeof e.limit==`number`&&t.set(`limit`,String(e.limit)),e.cursor&&t.set(`cursor`,e.cursor);let n=t.toString();return I(`/api/forward/routing/priorities${n?`?${n}`:``}`)}async function go(e,t={}){let n=new URLSearchParams;t.forwardNetworkRef&&n.set(`forwardNetworkRef`,t.forwardNetworkRef),t.forwardNetworkId&&n.set(`forwardNetworkId`,t.forwardNetworkId);let r=n.toString();return I(`/api/forward/routing/findings/${encodeURIComponent(e)}/evidence${r?`?${r}`:``}`)}async function _o(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId),e.snapshotId&&t.set(`snapshotId`,e.snapshotId);let n=t.toString();return I(`/api/forward/routing/queries${n?`?${n}`:``}`)}async function vo(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId);let n=t.toString();return I(`/api/forward/routing/sources${n?`?${n}`:``}`)}async function yo(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId);let n=t.toString();return I(`/api/forward/routing/drift${n?`?${n}`:``}`)}async function bo(e){return I(`/api/forward/capacity/run`,{method:`POST`,body:JSON.stringify(e)})}async function xo(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId);let n=t.toString();return I(`/api/forward/capacity/summary${n?`?${n}`:``}`)}async function So(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId),e.snapshotId&&t.set(`snapshotId`,e.snapshotId),e.category&&t.set(`category`,e.category),e.severity&&t.set(`severity`,e.severity),e.status&&t.set(`status`,e.status),typeof e.limit==`number`&&t.set(`limit`,String(e.limit)),e.cursor&&t.set(`cursor`,e.cursor);let n=t.toString();return I(`/api/forward/capacity/priorities${n?`?${n}`:``}`)}async function Co(e,t={}){let n=new URLSearchParams;t.forwardNetworkRef&&n.set(`forwardNetworkRef`,t.forwardNetworkRef),t.forwardNetworkId&&n.set(`forwardNetworkId`,t.forwardNetworkId);let r=n.toString();return I(`/api/forward/capacity/findings/${encodeURIComponent(e)}/evidence${r?`?${r}`:``}`)}async function wo(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId),e.snapshotId&&t.set(`snapshotId`,e.snapshotId);let n=t.toString();return I(`/api/forward/capacity/queries${n?`?${n}`:``}`)}async function To(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId);let n=t.toString();return I(`/api/forward/capacity/sources${n?`?${n}`:``}`)}async function Eo(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId);let n=t.toString();return I(`/api/forward/capacity/drift${n?`?${n}`:``}`)}function Do(e={}){let t=new URLSearchParams;return e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.forwardNetworkId&&t.set(`forwardNetworkId`,e.forwardNetworkId),e.snapshotId&&t.set(`snapshotId`,e.snapshotId),e.status&&t.set(`status`,e.status),e.audience&&t.set(`audience`,e.audience),typeof e.limit==`number`&&t.set(`limit`,String(e.limit)),t.toString()}async function Oo(e={}){let t=Do(e);return I(`/api/forward/analytics/executive${t?`?${t}`:``}`)}async function ko(e={}){let t=Do(e);return I(`/api/forward/analytics/briefing${t?`?${t}`:``}`)}async function Ao(e={}){let t=Do(e);return I(`/api/forward/analytics/actions${t?`?${t}`:``}`)}async function jo(e={}){let t=Do(e);return I(`/api/forward/analytics/campaigns${t?`?${t}`:``}`)}async function Mo(e={}){let t=Do(e);return I(`/api/forward/analytics/portfolio${t?`?${t}`:``}`)}async function No(e={}){let t=Do(e);return I(`/api/forward/analytics/validation${t?`?${t}`:``}`)}async function Po(e={}){let t=Do(e);return I(`/api/forward/analytics/trends${t?`?${t}`:``}`)}async function Fo(e){return I(`/api/forward/analytics/report`,{method:`POST`,body:JSON.stringify(e)})}async function Io(e){return I(`/api/forward/analytics/run-all`,{method:`POST`,body:JSON.stringify(e)})}async function Lo(e={}){let t=new URLSearchParams;e.forwardNetworkRef&&t.set(`forwardNetworkRef`,e.forwardNetworkRef),e.module&&t.set(`module`,e.module),e.status&&t.set(`status`,e.status),typeof e.limit==`number`&&t.set(`limit`,String(e.limit));let n=t.toString();return I(`/api/forward/analytics/run-history${n?`?${n}`:``}`)}async function Ro(e){return I(`/api/forward/networks`,{method:`POST`,body:JSON.stringify(e)})}async function zo(){return I(`/api/forward/networks`)}var Bo=[{label:`Dashboard`,href:`/status`,icon:wt},{label:`Deployments`,href:`/dashboard/deployments`,icon:He},{label:`Runs`,href:`/dashboard/runs`,icon:b},{label:`Designer`,href:`/dashboard/labs/designer`,icon:Mt,newTab:!0},{label:`Connect`,href:``,icon:b,children:[{label:`Overview`,href:`/dashboard/integrations`,icon:b},{label:`ServiceNow`,href:`/dashboard/servicenow`,icon:b},{label:`Artifacts`,href:`/dashboard/s3`,icon:be},{label:`Git`,href:`/api/gitea/public`,icon:Tn,external:!0},{label:`DNS`,href:`${Mr}/dns/sso?next=/dns/`,icon:Rt,external:!0},{label:`Coder`,href:`/coder/launch`,icon:Ne,external:!0},{label:`Coder Admin`,href:`/coder/`,icon:Ne,external:!0,adminOnly:!0}]},{label:`Forward`,href:``,icon:Rt,children:[{label:`Credentials`,href:`/dashboard/forward/credentials`,icon:k},{label:`Collector`,href:`/dashboard/forward/collector`,icon:Le},{label:`Cluster`,href:`https://skyforge-fwd.local.forwardnetworks.com`,icon:Rt,external:!0},{label:`Analytics`,href:`/dashboard/forward/analytics`,icon:tt}]},{label:`Tools`,href:``,icon:y,children:[{label:`Webhooks`,href:`/webhooks`,icon:Ht},{label:`Syslog`,href:`/syslog`,icon:Ft},{label:`SNMP`,href:`/snmp`,icon:tt},{label:`API Testing`,href:`/api-testing/`,icon:fn,external:!0},{label:`NetBox`,href:`/netbox/`,icon:Rt,external:!0},{label:`Nautobot`,href:`/nautobot/`,icon:Rt,external:!0},{label:`Docs`,href:`/dashboard/docs`,icon:ln}]},{label:`Settings`,href:``,icon:k,children:[{label:`My Settings`,href:`/dashboard/settings`,icon:k},{label:`Admin Settings`,href:`/admin/settings`,icon:k,adminOnly:!0},{label:`Governance`,href:`/admin/governance`,icon:tt,adminOnly:!0}]}];function Vo(e){let t=s({select:e=>e.location.pathname}),[n,r]=(0,M.useState)({Tools:!0,Connect:!0,Forward:!0}),i=`_blank`,a=`noreferrer noopener`,o=e=>!!e.external||!!e.newTab,c=e=>e?e===`/`?t===`/`:e.endsWith(`/`)?t.startsWith(e):t===e||t.startsWith(`${e}/`):!1,l=e=>{r(t=>({...t,[e]:!t[e]}))};return(0,P.jsx)(`nav`,{className:`grid items-start gap-2`,children:(0,P.jsx)(`div`,{className:`space-y-2`,children:(0,P.jsx)(`div`,{className:`grid gap-1`,children:Bo.filter(t=>t.adminOnly?!!e.isAdmin:!0).flatMap(t=>{let n=e.features;if(!n)return[t];if(t.label===`Connect`){let r=t.children?.filter(t=>t.label===`ServiceNow`?!!n.forwardEnabled:t.label===`Artifacts`?!!n.objectStorageEnabled:t.label===`Git`?!!n.giteaEnabled:t.label===`DNS`?!!n.dnsEnabled:t.label===`Coder`||t.label===`Coder Admin`?!!n.coderEnabled:t.adminOnly?!!e.isAdmin:!0)??[];return r.length===0?[]:[{...t,children:r}]}if(t.label===`Forward`){if(!n.forwardEnabled)return[];let r=t.children?.filter(t=>t.adminOnly?!!e.isAdmin:!0)??[];return r.length===0?[]:[{...t,children:r}]}if(t.label===`Tools`){let e=t.children?.filter(e=>e.label===`API Testing`?!!n.yaadeEnabled:e.label===`NetBox`?!!n.netboxEnabled:e.label===`Nautobot`?!!n.nautobotEnabled:!0)??[];return e.length===0?[]:[{...t,children:e}]}if(t.label===`Settings`){let n=t.children?.filter(t=>t.adminOnly?!!e.isAdmin:!0)??[];return n.length===0?[]:[{...t,children:n}]}return[t]}).map(t=>{let r=t.icon;if(t.children){let o=t.children.some(e=>c(e.href)),s=n[t.label];return e.collapsed?(0,P.jsxs)(br,{children:[(0,P.jsx)(xr,{asChild:!0,children:(0,P.jsx)(`button`,{className:N(`group flex items-center justify-center rounded-md px-2 py-2 text-sm font-medium transition-colors w-full`,`hover:bg-accent hover:text-accent-foreground`,o?`bg-accent text-accent-foreground`:`transparent`),title:t.label,children:(0,P.jsx)(r,{className:`h-5 w-5`})})}),(0,P.jsxs)(wr,{side:`right`,align:`start`,sideOffset:10,children:[(0,P.jsx)(Or,{children:t.label}),(0,P.jsx)(kr,{}),t.children.map(e=>(0,P.jsx)(Tr,{asChild:!0,children:e.external?(0,P.jsxs)(`a`,{href:e.href,target:i,rel:a,className:`flex items-center gap-2 cursor-pointer w-full`,children:[(0,P.jsx)(e.icon,{className:`h-4 w-4 mr-2`}),e.label]}):(0,P.jsxs)(p,{to:e.href,className:`flex items-center gap-2 cursor-pointer w-full`,children:[(0,P.jsx)(e.icon,{className:`h-4 w-4 mr-2`}),e.label]})},e.href))]})]},t.label):(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsxs)(`button`,{onClick:()=>l(t.label),className:N(`group flex w-full items-center justify-between rounded-md px-3 py-2 text-sm font-medium transition-colors`,`hover:bg-accent hover:text-accent-foreground`,o?`text-foreground font-semibold`:`text-muted-foreground`),children:[(0,P.jsxs)(`div`,{className:`flex items-center`,children:[(0,P.jsx)(r,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:t.label})]}),s?(0,P.jsx)(ue,{className:`h-4 w-4 opacity-50`}):(0,P.jsx)(te,{className:`h-4 w-4 opacity-50`})]}),s&&(0,P.jsx)(`div`,{className:`grid gap-1 pl-4 border-l ml-4 border-border/50`,children:t.children.map(e=>{let t=c(e.href),n=e.icon,r=N(`group flex items-center rounded-md px-3 py-2 text-sm font-medium transition-colors`,`hover:bg-accent hover:text-accent-foreground`,t?`bg-accent text-accent-foreground`:`text-muted-foreground`);return e.external?(0,P.jsxs)(`a`,{href:e.href,target:i,rel:a,className:r,children:[(0,P.jsx)(n,{className:`mr-2 h-4 w-4 opacity-70 group-hover:opacity-100`}),(0,P.jsx)(`span`,{children:e.label})]},e.href):(0,P.jsxs)(p,{to:e.href,className:r,children:[(0,P.jsx)(n,{className:`mr-2 h-4 w-4 opacity-70 group-hover:opacity-100`}),(0,P.jsx)(`span`,{children:e.label})]},e.href)})})]},t.label)}let s=N(`group flex items-center rounded-md px-3 py-2 text-sm font-medium transition-colors`,`hover:bg-accent hover:text-accent-foreground`,c(t.href)?`bg-accent`:`transparent`,e.collapsed&&`justify-center px-2`),u=N(`transition-transform duration-200 group-hover:scale-110 group-hover:text-primary`,e.collapsed?`h-5 w-5`:`mr-2 h-4 w-4`);return t.external?(0,P.jsxs)(`a`,{href:t.href,target:i,rel:a,className:s,title:e.collapsed?t.label:void 0,children:[(0,P.jsx)(r,{className:u}),e.collapsed?null:(0,P.jsx)(`span`,{children:t.label})]},t.href):(0,P.jsxs)(p,{to:t.href,className:s,title:e.collapsed?t.label:void 0,target:o(t)?i:void 0,rel:o(t)?a:void 0,children:[(0,P.jsx)(r,{className:u}),e.collapsed?null:(0,P.jsx)(`span`,{children:t.label})]},t.href)})})})})}var Ho=M.forwardRef(({...e},t)=>(0,P.jsx)(`nav`,{ref:t,"aria-label":`breadcrumb`,...e}));Ho.displayName=`Breadcrumb`;var Uo=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`ol`,{ref:n,className:N(`flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5`,e),...t}));Uo.displayName=`BreadcrumbList`;var Wo=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`li`,{ref:n,className:N(`inline-flex items-center gap-1.5`,e),...t}));Wo.displayName=`BreadcrumbItem`;var Go=M.forwardRef(({asChild:e,className:t,...n},r)=>(0,P.jsx)(e?Fn:`a`,{ref:r,className:N(`transition-colors hover:text-foreground`,t),...n}));Go.displayName=`BreadcrumbLink`;var Ko=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`span`,{ref:n,role:`link`,"aria-disabled":`true`,"aria-current":`page`,className:N(`font-normal text-foreground`,e),...t}));Ko.displayName=`BreadcrumbPage`;var qo=({children:e,className:t,...n})=>(0,P.jsx)(`li`,{role:`presentation`,"aria-hidden":`true`,className:N(`[&>svg]:size-3.5`,t),...n,children:e??(0,P.jsx)(te,{})});qo.displayName=`BreadcrumbSeparator`;var Jo=({className:e,...t})=>(0,P.jsxs)(`span`,{role:`presentation`,"aria-hidden":`true`,className:N(`flex h-9 w-9 items-center justify-center`,e),...t,children:[(0,P.jsx)(T,{className:`h-4 w-4`}),(0,P.jsx)(`span`,{className:`sr-only`,children:`More`})]});Jo.displayName=`BreadcrumbEllipsis`;var Yo=Vn(`rounded-lg border text-card-foreground shadow-sm`,{variants:{variant:{default:`bg-card`,elevated:`bg-card shadow-lg`,gradient:`bg-gradient-to-br from-card to-card/60`,glass:`bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60`,glow:`bg-card shadow-lg shadow-primary/10`,interactive:`bg-card hover:shadow-md transition-shadow cursor-pointer`,success:`border-green-500/50 bg-green-500/5`,warning:`border-amber-500/50 bg-amber-500/5`,danger:`border-red-500/50 bg-red-500/5`,info:`border-blue-500/50 bg-blue-500/5`,flat:`bg-card shadow-none`},size:{default:``,compact:`p-3`,comfortable:`p-6`}},defaultVariants:{variant:`default`,size:`default`}}),L=M.forwardRef(({className:e,variant:t,size:n,...r},i)=>(0,P.jsx)(`div`,{ref:i,className:N(Yo({variant:t,size:n,className:e})),...r}));L.displayName=`Card`;var R=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`div`,{ref:n,className:N(`flex flex-col space-y-1.5 p-6`,e),...t}));R.displayName=`CardHeader`;var z=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`div`,{ref:n,className:N(`text-2xl font-semibold leading-none tracking-tight`,e),...t}));z.displayName=`CardTitle`;var B=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`div`,{ref:n,className:N(`text-sm text-muted-foreground`,e),...t}));B.displayName=`CardDescription`;var V=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`div`,{ref:n,className:N(`p-6 pt-0`,e),...t}));V.displayName=`CardContent`;var Xo=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`div`,{ref:n,className:N(`flex items-center p-6 pt-0`,e),...t}));Xo.displayName=`CardFooter`;var Zo=Ke,Qo=re,$o=kn,es=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(w,{className:N(`fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0`,e),...t,ref:n}));es.displayName=w.displayName;var ts=Vn(`fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500`,{variants:{side:{top:`inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top`,bottom:`inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom`,left:`inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm`,right:`inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm`}},defaultVariants:{side:`right`}}),ns=M.forwardRef(({side:e=`right`,className:t,children:n,...r},i)=>(0,P.jsxs)($o,{children:[(0,P.jsx)(es,{}),(0,P.jsxs)(Mn,{ref:i,className:N(ts({side:e}),t),...r,children:[n,(0,P.jsxs)(yt,{className:`absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary`,children:[(0,P.jsx)(Gt,{className:`h-4 w-4`}),(0,P.jsx)(`span`,{className:`sr-only`,children:`Close`})]})]})]}));ns.displayName=Mn.displayName;var rs=({className:e,...t})=>(0,P.jsx)(`div`,{className:N(`flex flex-col space-y-2 text-center sm:text-left`,e),...t});rs.displayName=`SheetHeader`;var is=({className:e,...t})=>(0,P.jsx)(`div`,{className:N(`flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2`,e),...t});is.displayName=`SheetFooter`;var as=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(E,{ref:n,className:N(`text-lg font-semibold text-foreground`,e),...t}));as.displayName=E.displayName;var os=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(Ue,{ref:n,className:N(`text-sm text-muted-foreground`,e),...t}));os.displayName=Ue.displayName;var ss=({...e})=>(0,P.jsx)(bn,{className:`toaster group`,toastOptions:{classNames:{toast:`group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg`,description:`group-[.toast]:text-muted-foreground`,actionButton:`group-[.toast]:bg-primary group-[.toast]:text-primary-foreground`,cancelButton:`group-[.toast]:bg-muted group-[.toast]:text-muted-foreground`}},...e});async function cs(){try{let e=await fetch(`/api/session`,{credentials:`include`,headers:{"Content-Type":`application/json`}});return e.ok?await e.json():null}catch{return null}}async function ls(e){if(typeof window>`u`)return!1;let t=e.pollIntervalMs??750,n=e.timeoutMs??2*6e4;if((await cs())?.authenticated)return!0;let r=Math.max(0,Math.floor((window.screen.width-520)/2)),i=Math.max(0,Math.floor((window.screen.height-720)/2)),a=[`popup=yes`,`width=520`,`height=720`,`left=${r}`,`top=${i}`].join(`,`),o=window.open(e.loginHref,`skyforge_login`,a);if(!o)return!1;try{o.focus()}catch{}return await new Promise(e=>{let r=Date.now(),i=window.setInterval(async()=>{try{if(o.closed){window.clearInterval(i),e(!1);return}if(Date.now()-r>n){window.clearInterval(i);try{o.close()}catch{}e(!1);return}if((await cs())?.authenticated){window.clearInterval(i);try{o.close()}catch{}e(!0)}}catch{}},t)})}const H={session:()=>[`session`],uiConfig:()=>[`uiConfig`],dashboardSnapshot:()=>[`dashboardSnapshot`],statusSummary:()=>[`statusSummary`],runLogs:e=>[`runLogs`,e],deploymentTopology:e=>[`deploymentTopology`,e],deploymentUIEvents:e=>[`deploymentUIEvents`,e],deploymentCapacitySummary:e=>[`deploymentCapacitySummary`,e],deploymentCapacityInventory:e=>[`deploymentCapacityInventory`,e],deploymentCapacityGrowth:(e,t,n,r,i)=>[`deploymentCapacityGrowth`,e,t,n,String(r),i],userForwardNetworks:()=>[`userForwardNetworks`],forwardNetworkCapacitySummary:e=>[`forwardNetworkCapacitySummary`,e],forwardNetworkCapacityInventory:e=>[`forwardNetworkCapacityInventory`,e],forwardNetworkCapacityCoverage:e=>[`forwardNetworkCapacityCoverage`,e],forwardNetworkCapacitySnapshotDelta:e=>[`forwardNetworkCapacitySnapshotDelta`,e],forwardNetworkCapacityUpgradeCandidates:(e,t)=>[`forwardNetworkCapacityUpgradeCandidates`,e,t],userForwardNetworkCapacityPortfolio:()=>[`userForwardNetworkCapacityPortfolio`],forwardNetworkCapacityGrowth:(e,t,n,r,i)=>[`forwardNetworkCapacityGrowth`,e,t,n,String(r),i],forwardCollectors:()=>[`forwardCollectors`],userForwardCollector:()=>[`userForwardCollector`],userCollectorRuntime:()=>[`userCollectorRuntime`],userCollectorLogs:()=>[`userCollectorLogs`],userForwardCredentialProfiles:()=>[`userForwardCredentialProfiles`],userGitCredentials:()=>[`userGitCredentials`],userSettings:()=>[`userSettings`],userVariableGroups:()=>[`userVariableGroups`],userNetlabServers:()=>[`userNetlabServers`],userEveServers:()=>[`userEveServers`],userContainerlabServers:()=>[`userContainerlabServers`],userAwsStaticCredentials:()=>[`userAwsStaticCredentials`],userAwsSsoCredentials:()=>[`userAwsSsoCredentials`],awsSsoConfig:()=>[`awsSsoConfig`],awsSsoStatus:()=>[`awsSsoStatus`],userAzureCredentials:()=>[`userAzureCredentials`],userGcpCredentials:()=>[`userGcpCredentials`],userIbmCredentials:()=>[`userIbmCredentials`],userForwardCollectorConfigs:()=>[`userForwardCollectorConfigs`],userForwardSourceNetworks:(e,t,n)=>[`userForwardSourceNetworks`,e,t,String(n)],userForwardCollectorConfigRuntime:e=>[`userForwardCollectorConfigRuntime`,e],userForwardCollectorConfigLogs:e=>[`userForwardCollectorConfigLogs`,e],userServiceNowConfig:()=>[`userServiceNowConfig`],userServiceNowPdiStatus:()=>[`userServiceNowPdiStatus`],userServiceNowSchemaStatus:()=>[`userServiceNowSchemaStatus`],storageFiles:()=>[`storageFiles`],userArtifacts:e=>[`userArtifacts`,e],userEveLabs:(e,t,n)=>[`userEveLabs`,e,t,n?`1`:`0`],notifications:(e,t)=>[`notifications`,e?`1`:`0`,t??``],syslogEvents:e=>[`syslogEvents`,e??``],snmpTrapEvents:e=>[`snmpTrapEvents`,e??``],userTemplates:(e,t,n,r)=>[`userTemplates`,e,t,n??``,r??``],webhookEvents:e=>[`webhookEvents`,e??``],notificationSettings:()=>[`notificationSettings`],governanceSummary:()=>[`governanceSummary`],governanceResources:e=>[`governanceResources`,e??``],governanceCosts:e=>[`governanceCosts`,e??``],governanceUsage:e=>[`governanceUsage`,e??``],governancePolicy:()=>[`governancePolicy`],adminConfig:()=>[`adminConfig`],adminAudit:e=>[`adminAudit`,e??``],adminImpersonateStatus:()=>[`adminImpersonateStatus`],registryRepos:e=>[`registryRepos`,e],registryTags:(e,t)=>[`registryTags`,e,t],policyReportsChecks:()=>[`policyReportsChecks`],policyReportsPacks:()=>[`policyReportsPacks`],forwardCloudSummary:e=>[`forwardCloudSummary`,e],forwardCloudFindings:(e,t,n,r,i,a)=>[`forwardCloudFindings`,e,t??``,n??``,r??``,i??``,a??``],forwardCloudPriorities:(e,t,n,r,i,a)=>[`forwardCloudPriorities`,e,t??``,n??``,r??``,i??``,a??``],forwardCloudFindingEvidence:(e,t)=>[`forwardCloudFindingEvidence`,e,t],forwardCloudQueries:(e,t)=>[`forwardCloudQueries`,e,t??``],forwardCloudSources:e=>[`forwardCloudSources`,e],forwardCloudDrift:e=>[`forwardCloudDrift`,e],forwardSecuritySummary:e=>[`forwardSecuritySummary`,e],forwardSecurityFindings:(e,t,n,r,i,a)=>[`forwardSecurityFindings`,e,t??``,n??``,r??``,i??``,a??``],forwardSecurityPriorities:(e,t,n,r,i,a)=>[`forwardSecurityPriorities`,e,t??``,n??``,r??``,i??``,a??``],forwardSecurityFindingEvidence:(e,t)=>[`forwardSecurityFindingEvidence`,e,t],forwardSecurityQueries:(e,t)=>[`forwardSecurityQueries`,e,t??``],forwardSecuritySources:e=>[`forwardSecuritySources`,e],forwardSecurityDrift:e=>[`forwardSecurityDrift`,e],forwardRoutingSummary:e=>[`forwardRoutingSummary`,e],forwardRoutingFindings:(e,t,n,r,i,a)=>[`forwardRoutingFindings`,e,t??``,n??``,r??``,i??``,a??``],forwardRoutingPriorities:(e,t,n,r,i,a)=>[`forwardRoutingPriorities`,e,t??``,n??``,r??``,i??``,a??``],forwardRoutingFindingEvidence:(e,t)=>[`forwardRoutingFindingEvidence`,e,t],forwardRoutingQueries:(e,t)=>[`forwardRoutingQueries`,e,t??``],forwardRoutingSources:e=>[`forwardRoutingSources`,e],forwardRoutingDrift:e=>[`forwardRoutingDrift`,e],forwardCapacitySummary:e=>[`forwardCapacitySummary`,e],forwardCapacityFindings:(e,t,n,r,i,a)=>[`forwardCapacityFindings`,e,t??``,n??``,r??``,i??``,a??``],forwardCapacityPriorities:(e,t,n,r,i,a)=>[`forwardCapacityPriorities`,e,t??``,n??``,r??``,i??``,a??``],forwardCapacityFindingEvidence:(e,t)=>[`forwardCapacityFindingEvidence`,e,t],forwardCapacityQueries:(e,t)=>[`forwardCapacityQueries`,e,t??``],forwardCapacitySources:e=>[`forwardCapacitySources`,e],forwardCapacityDrift:e=>[`forwardCapacityDrift`,e],forwardAnalyticsExecutive:(e,t,n)=>[`forwardAnalyticsExecutive`,e,t??``,n??`exec`],forwardAnalyticsBriefing:(e,t,n)=>[`forwardAnalyticsBriefing`,e,t??``,n??`exec`],forwardAnalyticsActions:(e,t,n,r,i)=>[`forwardAnalyticsActions`,e,t??``,n??``,r??`exec`,String(i??0)],forwardAnalyticsCampaigns:(e,t,n,r,i)=>[`forwardAnalyticsCampaigns`,e,t??``,n??``,r??`exec`,String(i??0)],forwardAnalyticsPortfolio:(e,t,n)=>[`forwardAnalyticsPortfolio`,e,t??``,n??`exec`],forwardAnalyticsValidation:(e,t,n)=>[`forwardAnalyticsValidation`,e,t??``,n??`exec`],forwardAnalyticsTrends:(e,t,n)=>[`forwardAnalyticsTrends`,e,t??``,n??`exec`],forwardAnalyticsRunHistory:(e,t,n,r)=>[`forwardAnalyticsRunHistory`,e??``,t??``,n??``,String(r??0)],policyReportsSnapshots:e=>[`policyReportsSnapshots`,e],policyReportsRecertCampaigns:e=>[`policyReportsRecertCampaigns`,e??``],policyReportsRecertCampaign:e=>[`policyReportsRecertCampaign`,e],policyReportsRecertAssignments:(e,t,n)=>[`policyReportsRecertAssignments`,e??``,t??``,n??``],policyReportsExceptions:(e,t)=>[`policyReportsExceptions`,e??``,t??``],policyReportsZones:e=>[`policyReportsZones`,e],policyReportsRuns:(e,t,n)=>[`policyReportsRuns`,e??``,t??``,n??``],policyReportsRun:e=>[`policyReportsRun`,e],policyReportsRunFindings:(e,t)=>[`policyReportsRunFindings`,e,t??``],policyReportsFindings:(e,t,n)=>[`policyReportsFindings`,e??``,t??``,n??``]};var us=new Map;function ds(e){for(let[t,n]of e.handlers.entries())for(let r of n.values())e.es.addEventListener(t,r)}function fs(e){let t=new EventSource(e.url,{withCredentials:!0});return t.onopen=()=>{e.retryMs=500},t.onerror=()=>{if(e.closed||e.reconnectTimer)return;try{t.close()}catch{}let n=e.retryMs;e.retryMs=Math.min(e.retryMs*2,15e3),e.reconnectTimer=window.setTimeout(()=>{e.reconnectTimer=void 0,!e.closed&&(e.es=fs(e),ds(e))},n)},t}function ps(e){let t=us.get(e);if(t)return t.refs+=1,t;let n={url:e,es:void 0,refs:1,handlers:new Map,retryMs:500,closed:!1};return n.es=fs(n),us.set(e,n),n}function ms(e){let t=us.get(e);if(t&&(--t.refs,!(t.refs>0))){us.delete(e),t.closed=!0,t.reconnectTimer&&=(window.clearTimeout(t.reconnectTimer),void 0);try{t.es.close()}catch{}}}function hs(e,t){let n=ps(e);for(let[e,r]of Object.entries(t)){let t=n.handlers.get(e);t||(t=new Set,n.handlers.set(e,t)),t.add(r),n.es.addEventListener(e,r)}return{close:()=>{for(let[e,r]of Object.entries(t)){try{n.es.removeEventListener(e,r)}catch{}let t=n.handlers.get(e);t&&(t.delete(r),t.size===0&&n.handlers.delete(e))}ms(e)}}}function gs(e,t,n){let r=c(),i=(0,M.useMemo)(()=>{let e=new URLSearchParams;return e.set(`include_read`,t?`true`:`false`),e.set(`limit`,n),`${Mr}/notifications/events?${e.toString()}`},[t,n]);(0,M.useEffect)(()=>{if(!e)return;let a=hs(i,{snapshot:e=>{try{let i=JSON.parse(e.data);if(!i||!Array.isArray(i.notifications))return;r.setQueryData(H.notifications(t,n),i)}catch{}}});return()=>{a.close()}},[e,t,n,r,i])}const _s=u()({component:vs,errorComponent:bs,notFoundComponent:ys});function vs(){let e=s({select:e=>e.location}),t=n(),r=c(),[a,l]=(0,M.useState)(!1),[u,d]=(0,M.useState)(!1),[f,p]=(0,M.useState)(!1),[m,h]=(0,M.useState)(!1),g=(0,M.useMemo)(()=>e.pathname===`/dashboard/labs/designer`,[e.pathname]),_=(0,M.useMemo)(()=>g||e.pathname===`/dashboard/labs/map`,[g,e.pathname]);(0,M.useEffect)(()=>{g&&p(!0)},[g]),(0,M.useEffect)(()=>{window.location.pathname===`/index.html`&&t({to:`/`,replace:!0})},[t]);let v=i({queryKey:H.session(),queryFn:Ir,retry:!1,staleTime:3e4}),y=i({queryKey:H.uiConfig(),queryFn:Wa,staleTime:5*6e4}),b=!!y.data?.features?.giteaEnabled,ee=y.data?.productName||`Skyforge`,x=y.data?.productSubtitle||`Automation Platform`,S=(0,M.useMemo)(()=>`${e.pathname}${e.searchStr??``}${e.hash??``}`,[e.pathname,e.searchStr,e.hash]),C=(0,M.useMemo)(()=>Nr(S),[S]),w=(0,M.useMemo)(()=>[`/dashboard`,`/admin`,`/webhooks`,`/syslog`,`/snmp`].some(t=>e.pathname.startsWith(t)),[e.pathname]);(0,M.useEffect)(()=>{h(!1)},[e.pathname]);let ne=v.data?.displayName||v.data?.username||``,T=!!v.data?.isAdmin,re=w&&!v.isLoading&&!v.data?.authenticated,ie=v.data?.username??``;gs(!!ie,!1,`20`);let ae=i({queryKey:H.notifications(!1,`20`),enabled:!!ie,queryFn:async()=>({notifications:(await zr(ie,{include_read:`false`,limit:`20`})).notifications??[]}),staleTime:1/0,initialData:{notifications:[]}}),E=(0,M.useMemo)(()=>(ae.data?.notifications??[]).filter(e=>!e.is_read).length,[ae.data?.notifications]);return(0,P.jsx)(_r,{defaultTheme:`dark`,storageKey:`vite-ui-theme`,children:(0,P.jsxs)(`div`,{className:`min-h-full`,children:[(0,P.jsx)(hr,{}),(0,P.jsx)(`header`,{className:`sticky top-0 z-40 border-b glass-header`,children:(0,P.jsxs)(`div`,{className:`mx-auto flex h-16 max-w-[1600px] items-center justify-between gap-4 px-4`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-6`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,P.jsxs)(Zo,{open:m,onOpenChange:h,children:[(0,P.jsx)(Qo,{asChild:!0,children:(0,P.jsxs)(F,{variant:`ghost`,size:`icon`,className:`lg:hidden`,children:[(0,P.jsx)(nn,{className:`h-5 w-5`}),(0,P.jsx)(`span`,{className:`sr-only`,children:`Toggle menu`})]})}),(0,P.jsx)(ns,{side:`left`,className:`w-[240px] p-0`,children:(0,P.jsx)(`div`,{className:`px-2 py-6`,children:(0,P.jsx)(Vo,{collapsed:!1,isAdmin:T,features:y.data?.features})})})]}),(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`div`,{className:`text-[10px] uppercase tracking-wider text-muted-foreground leading-none`,children:x}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2 text-base font-semibold tracking-tight`,children:[(0,P.jsx)(rt,{className:`h-5 w-5 text-primary`}),(0,P.jsx)(`span`,{children:ee})]})]}),(0,P.jsx)(`div`,{className:`h-8 w-px bg-border hidden md:block`}),(0,P.jsx)(`img`,{src:`/assets/skyforge/FN-logo.svg`,alt:`Forward Networks`,className:`h-6 w-auto hidden sm:block`})]}),(0,P.jsxs)(F,{variant:`outline`,className:`hidden md:flex h-9 w-64 items-center justify-start px-3 text-sm text-muted-foreground font-normal`,onClick:()=>{let e=new KeyboardEvent(`keydown`,{key:`k`,metaKey:!0,bubbles:!0});document.dispatchEvent(e)},children:[(0,P.jsx)(un,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Search...`}),(0,P.jsxs)(`kbd`,{className:`pointer-events-none ml-auto inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100`,children:[(0,P.jsx)(`span`,{className:`text-xs`,children:``}),`K`]})]})]}),(0,P.jsxs)(`nav`,{className:`flex items-center gap-4 text-sm`,children:[(0,P.jsxs)(F,{variant:`ghost`,size:`icon`,className:`relative text-muted-foreground hover:text-foreground`,"aria-label":`Notifications`,onClick:()=>void t({to:`/notifications`}),children:[(0,P.jsx)(ge,{className:`h-4 w-4`}),E>0?(0,P.jsx)(`span`,{className:`absolute -right-1 -top-1 inline-flex h-4 min-w-[16px] items-center justify-center rounded-full bg-primary px-1 text-[10px] font-semibold text-primary-foreground`,children:E>99?`99+`:E}):null]}),(0,P.jsx)(jr,{}),v.data?.authenticated?(0,P.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,P.jsxs)(`div`,{className:`hidden md:flex flex-col items-end`,children:[(0,P.jsx)(`span`,{className:`text-[10px] text-muted-foreground uppercase leading-none`,children:`Signed in as`}),(0,P.jsx)(`span`,{className:`text-xs font-medium leading-none mt-1`,children:ne})]}),(0,P.jsx)(F,{variant:`outline`,size:`sm`,disabled:a,onClick:async()=>{try{l(!0),await Lr(),window.location.href=`/status?signin=1`}finally{l(!1)}},children:a?``:`Logout`})]}):(0,P.jsx)(F,{variant:`outline`,size:`sm`,disabled:u,onClick:async()=>{try{if(d(!0),!await ls({loginHref:C})){window.location.href=C;return}await r.invalidateQueries({queryKey:H.session()})}finally{d(!1)}},children:u?``:`Login`})]})]})}),(0,P.jsxs)(`div`,{className:N(`mx-auto flex min-h-[calc(100vh-4rem)]`,_?`max-w-none`:`max-w-[1600px]`),children:[v.data?.authenticated&&(0,P.jsx)(`aside`,{className:N(`hidden lg:block border-r bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60`,`transition-all duration-300 ease-in-out`,f?`w-[64px]`:`w-[220px]`),children:(0,P.jsxs)(`div`,{className:`relative h-full`,children:[(0,P.jsx)(`div`,{className:N(`h-full px-4 py-4`,f&&`px-2`),children:(0,P.jsx)(Vo,{collapsed:f,isAdmin:T,features:y.data?.features})}),(0,P.jsx)(`button`,{className:N(`absolute -right-3 top-4 flex h-7 w-7 items-center justify-center rounded-full border bg-background text-foreground shadow-sm`,`hover:bg-accent hover:text-accent-foreground transition-colors`),onClick:()=>p(e=>!e),"aria-label":f?`Expand navigation`:`Collapse navigation`,children:f?(0,P.jsx)(te,{className:`h-4 w-4`}):(0,P.jsx)(Ze,{className:`h-4 w-4`})})]})}),(0,P.jsx)(`main`,{className:N(`flex-1 w-full overflow-hidden flex flex-col`,_?`px-0 py-0`:`px-4 py-6`),children:re?(0,P.jsx)(`div`,{className:`mx-auto max-w-xl`,children:(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Login Required`}),(0,P.jsx)(B,{children:`Sign in to access this page.`})]}),(0,P.jsxs)(V,{className:`flex flex-col gap-3`,children:[(0,P.jsx)(F,{variant:`default`,disabled:u,onClick:async()=>{try{if(d(!0),!await ls({loginHref:C})){window.location.href=C;return}await r.invalidateQueries({queryKey:H.session()})}finally{d(!1)}},children:u?``:`Login`}),(0,P.jsx)(`a`,{className:`text-sm text-muted-foreground underline`,href:C,children:`Login with redirect instead`})]})]})}):(0,P.jsxs)(P.Fragment,{children:[_?null:(0,P.jsx)(`div`,{className:`mb-6`,children:(0,P.jsx)(Ho,{children:(0,P.jsxs)(Uo,{children:[(0,P.jsx)(Wo,{children:(0,P.jsx)(Go,{href:`/status`,children:`Dashboard`})}),` `,(()=>{let t=e.pathname.split(`/`).filter(Boolean),n=t;for(;n[0]===`dashboard`;)n=n.slice(1);let r=t[0]===`dashboard`?`/dashboard`:``;return n.map((e,t,n)=>{let i=`${r}/${n.slice(0,t+1).join(`/`)}`,a=t===n.length-1;return(0,P.jsxs)(M.Fragment,{children:[(0,P.jsx)(qo,{}),(0,P.jsx)(Wo,{children:a?(0,P.jsx)(Ko,{className:`capitalize`,children:e}):(0,P.jsx)(Go,{href:i,className:`capitalize`,children:e})})]},i)})})()]})})}),(0,P.jsx)(o,{}),_?null:(0,P.jsxs)(`footer`,{className:`mt-auto pt-12 pb-6 flex items-center justify-between text-xs text-muted-foreground border-t`,children:[(0,P.jsx)(`div`,{className:`flex gap-4`,children:(0,P.jsxs)(`span`,{children:[`Questions? Reach out at`,` `,(0,P.jsx)(`span`,{className:`font-mono text-primary`,children:`#ask-skyforge`})]})}),b?(0,P.jsx)(`a`,{className:`hover:text-foreground transition-colors underline hover:no-underline`,href:`/api/gitea/public`,target:`_blank`,rel:`noreferrer`,children:`Open Git`}):null]})]})})]}),(0,P.jsx)(mr,{}),(0,P.jsx)(ss,{})]})})}function ys(){return(0,P.jsx)(`div`,{className:`flex flex-col items-center justify-center min-h-[50vh] space-y-4 text-center`,children:(0,P.jsxs)(L,{variant:`glass`,className:`max-w-md`,children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{className:`text-2xl`,children:`Page not found`}),(0,P.jsx)(B,{children:`This route hasnt been migrated yet (or the URL is incorrect).`})]}),(0,P.jsxs)(V,{className:`flex flex-wrap justify-center gap-3`,children:[(0,P.jsx)(F,{variant:`default`,asChild:!0,children:(0,P.jsx)(p,{to:`/dashboard/deployments`,children:`Go to deployments`})}),(0,P.jsx)(F,{variant:`outline`,asChild:!0,children:(0,P.jsx)(p,{to:`/status`,children:`Platform status`})})]})]})})}function bs(e){let t=e.error instanceof Error?e.error.message:typeof e.error==`string`?e.error:`Unknown error`;return(0,P.jsxs)(`div`,{className:`space-y-6`,children:[(0,P.jsxs)(L,{variant:`danger`,children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Application error`}),(0,P.jsx)(B,{className:`text-red-200/80`,children:t})]}),(0,P.jsxs)(V,{className:`flex flex-wrap gap-3`,children:[(0,P.jsx)(F,{variant:`outline`,className:`border-red-500/50 bg-red-500/10 hover:bg-red-500/20 text-red-100`,onClick:()=>e.reset(),children:`Try again`}),(0,P.jsx)(F,{variant:`secondary`,asChild:!0,children:(0,P.jsx)(p,{to:`/dashboard/deployments`,children:`Go to deployments`})})]})]}),e.error instanceof Error&&e.error.stack&&(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{className:`text-sm`,children:`Error Stack Trace`})}),(0,P.jsx)(V,{children:(0,P.jsx)(`pre`,{className:`overflow-auto whitespace-pre-wrap text-xs text-muted-foreground p-4 rounded-md bg-muted`,children:e.error.stack})})]})]})}function xs(e){return e===void 0?`minmax(0, 1fr)`:typeof e==`number`?`${e}px`:e}function Ss({columns:e,rows:t,getRowId:n,onRowClick:r,getRowClassName:i,getRowAriaSelected:a,isLoading:o,emptyText:s=`No results.`,scrollable:c=!0,maxHeightClassName:l=`max-h-[70vh]`,minWidthClassName:u=`min-w-[900px]`,estimateRowHeight:d=34}){let f=M.useRef(null),p=u!==`min-w-0`,h=M.useMemo(()=>e.map(e=>xs(e.width)).join(` `),[e]),g=m({count:t.length,getScrollElement:()=>c?f.current:null,estimateSize:()=>d,overscan:10}),_=g.getVirtualItems();return(0,P.jsx)(`div`,{className:N(`w-full rounded-md border`,p?`overflow-x-auto overflow-y-hidden`:`overflow-hidden`),children:(0,P.jsx)(`div`,{className:N(u),children:(0,P.jsxs)(`div`,{role:`table`,"aria-rowcount":t.length,className:`w-full text-sm`,style:{gridTemplateColumns:h},children:[(0,P.jsx)(`div`,{role:`rowgroup`,className:`sticky top-0 z-10 border-b bg-background/90 backdrop-blur`,children:(0,P.jsx)(`div`,{role:`row`,className:`grid`,style:{gridTemplateColumns:h},children:e.map(e=>(0,P.jsx)(`div`,{role:`columnheader`,className:N(`px-3 py-2 text-xs font-medium uppercase tracking-wide text-muted-foreground`,e.align===`center`&&`text-center`,e.align===`right`&&`text-right`,e.headerClassName),children:e.header},e.id))})}),(0,P.jsx)(`div`,{role:`rowgroup`,ref:c?f:void 0,className:N(`relative`,c&&`overflow-auto`,c&&l),children:o?(0,P.jsx)(`div`,{className:`p-4 text-sm text-muted-foreground`,children:`Loading`}):t.length===0?(0,P.jsx)(`div`,{className:`p-4 text-sm text-muted-foreground`,children:s}):c?(0,P.jsx)(`div`,{className:`relative`,style:{height:`${g.getTotalSize()}px`},children:_.map(o=>{let s=t[o.index],c=n(s),l=!!r,u=i?.(s,o.index),d=a?.(s,o.index);return(0,P.jsx)(`div`,{role:`row`,"aria-rowindex":o.index+1,"aria-selected":d,className:N(`absolute left-0 right-0 grid border-b last:border-b-0`,o.index%2==0&&`bg-background`,o.index%2==1&&`bg-muted/20`,l&&`cursor-pointer hover:bg-muted/40`,u),style:{gridTemplateColumns:h,transform:`translateY(${o.start}px)`},onClick:l?()=>r?.(s):void 0,children:e.map(e=>(0,P.jsx)(`div`,{role:`cell`,className:N(`px-3 py-2 align-middle`,e.align===`center`&&`text-center`,e.align===`right`&&`text-right`,e.className),children:e.cell(s)},e.id))},c)})}):(0,P.jsx)(`div`,{className:`relative`,children:t.map((t,o)=>{let s=n(t),c=!!r,l=i?.(t,o),u=a?.(t,o);return(0,P.jsx)(`div`,{role:`row`,"aria-rowindex":o+1,"aria-selected":u,className:N(`grid border-b last:border-b-0`,o%2==0&&`bg-background`,o%2==1&&`bg-muted/20`,c&&`cursor-pointer hover:bg-muted/40`,l),style:{gridTemplateColumns:h},onClick:c?()=>r?.(t):void 0,children:e.map(e=>(0,P.jsx)(`div`,{role:`cell`,className:N(`px-3 py-2 align-middle`,e.align===`center`&&`text-center`,e.align===`right`&&`text-right`,e.className),children:e.cell(t)},e.id))},s)})})})]})})})}function Cs({title:e,description:t,icon:n,action:r,className:i,...a}){return(0,P.jsx)(`div`,{className:N(`flex min-h-[400px] flex-col items-center justify-center rounded-md border border-dashed p-8 text-center animate-in fade-in zoom-in duration-300`,i),...a,children:(0,P.jsxs)(`div`,{className:`mx-auto flex max-w-[420px] flex-col items-center justify-center text-center`,children:[n&&(0,P.jsx)(`div`,{className:`flex h-20 w-20 items-center justify-center rounded-full bg-muted`,children:(0,P.jsx)(n,{className:`h-10 w-10 text-muted-foreground`})}),(0,P.jsx)(`h3`,{className:`mt-4 text-lg font-semibold`,children:e}),t&&(0,P.jsx)(`p`,{className:`mb-4 mt-2 text-sm text-muted-foreground`,children:t}),r&&(0,P.jsx)(F,{onClick:r.onClick,variant:`outline`,size:`sm`,children:r.label})]})})}function U({className:e,...t}){return(0,P.jsx)(`div`,{className:N(`animate-pulse rounded-md bg-muted`,e),...t})}function ws(e,t){let n=c(),r=(0,M.useMemo)(()=>`${Mr}/webhooks/events/stream?limit=${encodeURIComponent(t)}`,[t]);(0,M.useEffect)(()=>{if(!e)return;let i=hs(r,{snapshot:e=>{try{let r=JSON.parse(e.data);n.setQueryData(H.webhookEvents(t),r)}catch{}}});return()=>{i.close()}},[e,t,n,r])}const Ts=t(`/webhooks`)({component:Es});function Es(){ws(!0,`200`);let e=i({queryKey:H.webhookEvents(`200`),queryFn:()=>Ca({limit:`200`}),staleTime:1/0}),t=e.data?.events??[];return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsx)(L,{variant:`glass`,children:(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Webhook inbox`}),(0,P.jsx)(B,{children:`Recent webhook events routed to your user.`})]})}),(0,P.jsx)(L,{children:(0,P.jsx)(V,{className:`p-0`,children:e.isLoading?(0,P.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,P.jsx)(U,{className:`h-12 w-full`}),(0,P.jsx)(U,{className:`h-12 w-full`}),(0,P.jsx)(U,{className:`h-12 w-full`})]}):e.isError?(0,P.jsx)(`div`,{className:`p-8 text-center text-destructive`,children:`Failed to load webhook events.`}):t.length===0?(0,P.jsx)(Cs,{icon:Ft,title:`No webhook events`,description:`No webhook events have been received yet.`}):(0,P.jsx)(Ss,{columns:[{id:`time`,header:`Time`,width:190,cell:e=>(0,P.jsx)(`span`,{className:`text-muted-foreground whitespace-nowrap text-xs`,children:e.receivedAt??``})},{id:`source`,header:`Source`,width:160,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.sourceIp??``})},{id:`event`,header:`Event`,cell:e=>(0,P.jsxs)(`span`,{className:`font-medium text-sm`,children:[e.method,` `,e.path]})},{id:`id`,header:`ID`,width:120,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs text-muted-foreground`,children:String(e.id)})}],rows:t,getRowId:e=>String(e.id),maxHeightClassName:`max-h-[65vh]`})})})]})}function Ds(e,t){let n=c(),r=(0,M.useMemo)(()=>`${Mr}/syslog/events/stream?limit=${encodeURIComponent(t)}`,[t]);(0,M.useEffect)(()=>{if(!e)return;let i=hs(r,{snapshot:e=>{try{let r=JSON.parse(e.data);n.setQueryData(H.syslogEvents(t),r)}catch{}}});return()=>{i.close()}},[e,t,n,r])}const Os=t(`/syslog`)({component:ks});function ks(){Ds(!0,`200`);let e=i({queryKey:H.syslogEvents(`200`),queryFn:()=>wa({limit:`200`}),staleTime:1/0}),t=e.data?.events??[];return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsx)(L,{variant:`glass`,children:(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Syslog inbox`}),(0,P.jsx)(B,{children:`Recent syslog events mapped to your user.`})]})}),(0,P.jsx)(L,{children:(0,P.jsx)(V,{className:`p-0`,children:e.isLoading?(0,P.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,P.jsx)(U,{className:`h-12 w-full`}),(0,P.jsx)(U,{className:`h-12 w-full`}),(0,P.jsx)(U,{className:`h-12 w-full`})]}):e.isError?(0,P.jsx)(`div`,{className:`p-8 text-center text-destructive`,children:`Failed to load syslog events.`}):t.length===0?(0,P.jsx)(Cs,{icon:Ft,title:`No syslog events`,description:`No syslog messages have been received yet.`}):(0,P.jsx)(Ss,{columns:[{id:`time`,header:`Time`,width:190,cell:e=>(0,P.jsx)(`span`,{className:`text-muted-foreground whitespace-nowrap text-xs`,children:e.receivedAt??``})},{id:`source`,header:`Source`,width:160,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.sourceIp??``})},{id:`app`,header:`App`,width:160,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.appName??``})},{id:`message`,header:`Message`,cell:e=>(0,P.jsx)(`span`,{className:`font-medium text-foreground text-sm line-clamp-2`,children:e.message??``})}],rows:t,getRowId:e=>String(e.id),maxHeightClassName:`max-h-[65vh]`})})})]})}var As=Vn(`inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2`,{variants:{variant:{default:`border-transparent bg-primary text-primary-foreground hover:bg-primary/80`,secondary:`border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80`,destructive:`border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80`,outline:`text-foreground`}},defaultVariants:{variant:`default`}});function W({className:e,variant:t,...n}){return(0,P.jsx)(`div`,{className:N(As({variant:t}),e),...n})}var js={blue:`from-blue-500/10 via-blue-500/5 to-transparent`,green:`from-emerald-500/10 via-emerald-500/5 to-transparent`,purple:`from-purple-500/10 via-purple-500/5 to-transparent`,orange:`from-orange-500/10 via-orange-500/5 to-transparent`,red:`from-red-500/10 via-red-500/5 to-transparent`};const Ms=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`div`,{ref:n,className:N(`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4`,e),...t}));Ms.displayName=`BentoGrid`;const Ns=M.forwardRef(({className:e,gradient:t=`blue`,children:n,...r},i)=>(0,P.jsx)(`div`,{ref:i,className:N(`relative overflow-hidden rounded-xl border border-border bg-card p-6`,`bg-gradient-to-br`,js[t],e),...r,children:n}));Ns.displayName=`BentoItem`;const Ps=M.forwardRef(({title:e,value:t,gradient:n=`blue`,icon:r,subtitle:i,trend:a,className:o},s)=>(0,P.jsxs)(Ns,{ref:s,gradient:n,className:o,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-2 mb-2`,children:[r&&(0,P.jsx)(`div`,{className:`text-muted-foreground`,children:r}),(0,P.jsx)(`h3`,{className:`text-sm font-medium text-muted-foreground/80`,children:e})]}),(0,P.jsxs)(`div`,{className:`flex items-end justify-between`,children:[(0,P.jsx)(`div`,{className:`text-3xl font-bold`,children:t}),a&&(0,P.jsxs)(`div`,{className:N(`flex items-center gap-1 text-sm`,a.direction===`up`?`text-emerald-500`:`text-red-500`),children:[a.direction===`up`?(0,P.jsx)(Ce,{className:`w-4 h-4`}):(0,P.jsx)(Be,{className:`w-4 h-4`}),a.value,`%`]})]}),i&&(0,P.jsx)(`p`,{className:`text-xs text-muted-foreground/70 mt-2`,children:i})]}));Ps.displayName=`BentoStatCard`;const Fs=M.forwardRef(({userName:e,subtitle:t,className:n},r)=>(0,P.jsx)(Ns,{ref:r,gradient:`purple`,className:N(`md:col-span-2`,n),children:(0,P.jsxs)(`div`,{className:`flex items-center gap-3 mb-3`,children:[(0,P.jsx)(`div`,{className:`p-2 rounded-full bg-purple-500/10`,children:(0,P.jsx)(Pe,{className:`w-5 h-5 text-purple-500`})}),(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`h2`,{className:`text-xl font-bold`,children:e?`Welcome back, ${e}`:`Welcome to Skyforge`}),t&&(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground/80`,children:t})]})]})}));Fs.displayName=`BentoWelcomeCard`;const Is=M.forwardRef(({actions:e,className:t},n)=>(0,P.jsxs)(Ns,{ref:n,gradient:`blue`,className:N(`md:col-span-2`,t),children:[(0,P.jsx)(`h3`,{className:`font-semibold mb-4`,children:`Quick Actions`}),(0,P.jsx)(`div`,{className:`grid grid-cols-2 gap-3`,children:e.map((e,t)=>(0,P.jsxs)(Dt.button,{onClick:e.onClick,className:`flex items-center gap-2 p-3 rounded-lg bg-muted/50 hover:bg-muted transition-colors text-left`,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.icon,(0,P.jsx)(`span`,{className:`text-sm font-medium`,children:e.label})]},t))})]}));Is.displayName=`BentoQuickActions`;const Ls=M.forwardRef(({servers:e,className:t},n)=>(0,P.jsxs)(Ns,{ref:n,gradient:`green`,className:N(`md:col-span-2`,t),children:[(0,P.jsx)(`h3`,{className:`font-semibold mb-4`,children:`Server Status`}),(0,P.jsx)(`div`,{className:`grid grid-cols-2 gap-3`,children:e.map((e,t)=>(0,P.jsxs)(`div`,{className:`flex items-center justify-between p-3 rounded-lg bg-muted/30`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(`div`,{className:N(`w-2 h-2 rounded-full`,e.status===`online`?`bg-emerald-500`:e.status===`degraded`?`bg-amber-500`:`bg-red-500`)}),(0,P.jsx)(`span`,{className:`text-sm font-medium`,children:e.name})]}),e.cpu!==void 0&&(0,P.jsxs)(W,{variant:`secondary`,className:`text-xs`,children:[e.cpu,`%`]})]},t))})]}));Ls.displayName=`BentoServerStatus`;function Rs(e){let t=c(),n=(0,M.useMemo)(()=>`/status/summary/events`,[]);(0,M.useEffect)(()=>{if(!e)return;let r=hs(n,{snapshot:e=>{try{let n=JSON.parse(e.data);t.setQueryData(H.statusSummary(),n)}catch{}}});return()=>{r.close()}},[e,t,n])}const zs=t(`/status`)({component:Bs});function Bs(){Rs(!0);let e=i({queryKey:H.statusSummary(),queryFn:Ga,staleTime:1/0}),t=i({queryKey:H.uiConfig(),queryFn:Wa,staleTime:1/0}),n=t.data?.features,r=e.data,a=r?.checks??[],o=a.filter(e=>e.status!==`up`&&e.status!==`ok`);return(0,P.jsxs)(`div`,{className:`space-y-8 p-6`,children:[(0,P.jsxs)(Ms,{className:`gap-4`,children:[(0,P.jsx)(Fs,{subtitle:`Here's what's happening with your infrastructure today.`}),e.isLoading?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Ns,{className:`h-32`,children:(0,P.jsx)(U,{className:`h-full w-full`})}),(0,P.jsx)(Ns,{className:`h-32`,children:(0,P.jsx)(U,{className:`h-full w-full`})}),(0,P.jsx)(Ns,{className:`h-32`,children:(0,P.jsx)(U,{className:`h-full w-full`})})]}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Ps,{title:`Active Deployments`,value:r?.deploymentsActive??0,gradient:`green`,icon:(0,P.jsx)(Ne,{className:`w-5 h-5`}),subtitle:`${r?.deploymentsTotal??0} total deployments`}),(0,P.jsx)(Ps,{title:`Services Operational`,value:`${r?.up??0} / ${a.length}`,gradient:r?.up===a.length?`green`:`orange`,icon:(0,P.jsx)(ze,{className:`w-5 h-5`})}),(0,P.jsx)(Ps,{title:`Services Down`,value:r?.down??0,gradient:r?.down?`red`:`blue`,icon:(0,P.jsx)(lt,{className:`w-5 h-5`})}),(0,P.jsxs)(Ns,{gradient:`purple`,className:`relative overflow-hidden`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between mb-3`,children:[(0,P.jsxs)(`h3`,{className:`font-semibold flex items-center gap-2 text-sm text-muted-foreground/80`,children:[(0,P.jsx)(je,{className:`w-4 h-4`}),`Platform Health`]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(`span`,{className:`relative flex h-2 w-2`,children:[(0,P.jsx)(`span`,{className:`animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75`}),(0,P.jsx)(`span`,{className:`relative inline-flex rounded-full h-2 w-2 bg-emerald-500`})]}),(0,P.jsx)(`span`,{className:`text-xs text-muted-foreground`,children:`Live`})]})]}),(0,P.jsx)(`div`,{className:`flex items-end gap-4`,children:(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`span`,{className:N(`text-3xl font-bold`,r?.status===`ok`?`text-emerald-500`:r?.status===`degraded`?`text-amber-500`:`text-muted-foreground`),children:(r?.status??`checking`).toUpperCase()}),(0,P.jsx)(`p`,{className:`text-xs text-muted-foreground mt-1`,children:r?.timestamp?`Refreshed ${new Date(r.timestamp).toLocaleTimeString()}`:`Checking...`})]})})]})]})]}),(0,P.jsxs)(`div`,{className:`grid gap-4 md:grid-cols-3`,children:[t.data?.externalUrl&&(0,P.jsxs)(L,{variant:`glass`,className:`border-green-500/20 bg-green-500/5`,children:[(0,P.jsx)(R,{children:(0,P.jsxs)(z,{className:`text-base flex items-center gap-2 text-green-500`,children:[(0,P.jsx)(ft,{className:`w-4 h-4`}),`Public Access`]})}),(0,P.jsxs)(V,{className:`text-sm text-muted-foreground space-y-3`,children:[(0,P.jsx)(`p`,{children:`This environment is securely accessible via Cloudflare Tunnel.`}),(0,P.jsx)(`div`,{className:`rounded bg-background/50 p-2 border`,children:(0,P.jsx)(`a`,{className:`text-primary hover:underline break-all font-mono text-xs`,href:t.data.externalUrl,target:`_blank`,rel:`noreferrer`,children:t.data.externalUrl})})]})]}),(0,P.jsxs)(L,{variant:`glass`,children:[(0,P.jsx)(R,{children:(0,P.jsxs)(z,{className:`text-base flex items-center gap-2`,children:[(0,P.jsx)(de,{className:`w-4 h-4 text-orange-500`}),`Skyforge at a Glance`]})}),(0,P.jsxs)(V,{className:`text-sm text-muted-foreground space-y-3`,children:[(0,P.jsx)(`p`,{children:`Skyforge coordinates lab + cloud tooling into repeatable, auditable workflows for platform teams.`}),(0,P.jsxs)(`ul`,{className:`list-disc pl-4 space-y-1`,children:[(0,P.jsx)(`li`,{children:`Teams can still run tools manually; Skyforge standardizes the "happy path".`}),(0,P.jsx)(`li`,{children:`Enables consistent lab delivery across on-prem and cloud environments.`}),(0,P.jsx)(`li`,{children:`Creates shared context for collaboration, troubleshooting, and handoffs.`})]})]})]}),(0,P.jsxs)(L,{variant:`glass`,children:[(0,P.jsx)(R,{children:(0,P.jsxs)(z,{className:`text-base flex items-center gap-2`,children:[(0,P.jsx)(C,{className:`w-4 h-4 text-blue-500`}),`What You Can Do Here`]})}),(0,P.jsxs)(V,{className:`text-sm text-muted-foreground space-y-2`,children:[(0,P.jsx)(p,{className:`text-primary hover:underline`,to:`/dashboard/deployments`,children:` Open the dashboard`}),(0,P.jsx)(p,{className:`text-primary hover:underline`,to:`/dashboard/deployments/new`,children:` Create a deployment`}),(0,P.jsx)(p,{className:`text-primary hover:underline`,to:`/dashboard/s3`,children:` Browse artifacts (S3)`}),(0,P.jsx)(`p`,{className:`text-xs text-muted-foreground mt-3`,children:`Status is refreshed automatically via Server-Sent Events.`})]})]}),(0,P.jsxs)(L,{variant:`glass`,children:[(0,P.jsx)(R,{children:(0,P.jsxs)(z,{className:`text-base flex items-center gap-2`,children:[(0,P.jsx)(b,{className:`w-4 h-4 text-purple-500`}),`How Workflows Run`]})}),(0,P.jsxs)(V,{className:`text-sm text-muted-foreground space-y-2`,children:[(0,P.jsx)(`p`,{children:`Skyforge connects source control, automation, and lab capacity into one delivery loop.`}),(0,P.jsxs)(`ol`,{className:`list-decimal pl-4 space-y-1`,children:[(0,P.jsx)(`li`,{children:`Choose a blueprint (Git).`}),(0,P.jsx)(`li`,{children:`Run deployments (native task engine).`}),(0,P.jsx)(`li`,{children:`Validate on lab servers (BYOS + In-Cluster).`}),(0,P.jsx)(`li`,{children:`Store artifacts + state (Skyforge storage).`})]})]})]})]}),(0,P.jsx)(Ms,{className:`gap-4`,children:(0,P.jsxs)(Ns,{gradient:`blue`,className:`md:col-span-4 hover-lift`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between mb-6`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,P.jsx)(`div`,{className:`p-2 rounded-lg bg-blue-500/10`,children:(0,P.jsx)(lt,{className:`w-5 h-5 text-blue-500`})}),(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`h3`,{className:`font-semibold`,children:`Integrated Toolchain & Status`}),(0,P.jsx)(`p`,{className:`text-xs text-muted-foreground`,children:`Live health checks for all platform services.`})]})]}),o.length>0&&(0,P.jsxs)(W,{variant:`destructive`,className:`animate-pulse`,children:[o.length,` Service`,o.length>1?`s`:``,` `,`Reporting Issues`]})]}),(0,P.jsx)(`div`,{className:`grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4`,children:[{id:`gitea`,name:`Git`,path:`/api/gitea/public`,icon:Tn,enabled:n?.giteaEnabled??!1,external:!0},{id:`netbox`,name:`NetBox`,path:`/netbox/`,icon:Rt,enabled:n?.netboxEnabled??!1,external:!0},{id:`nautobot`,name:`Nautobot`,path:`/nautobot/`,icon:Rt,enabled:n?.nautobotEnabled??!1,external:!0},{id:`coder`,name:`Coder`,path:`/coder/launch`,icon:Ne,enabled:n?.coderEnabled??!1,external:!0},{id:`yaade`,name:`API Testing`,path:`/api-testing/`,icon:je,enabled:n?.yaadeEnabled??!1,external:!0},{id:`webhooks`,name:`Webhooks`,path:`/webhooks`,icon:b,enabled:!0,external:!1}].filter(e=>e.enabled).map(e=>{let t=a.find(t=>t.name.toLowerCase().includes(e.id)),n=t?t.status===`up`||t.status===`ok`:!0,r=n?`bg-emerald-500`:`bg-red-500`,i=e.icon;return(0,P.jsxs)(`a`,{href:e.path,target:e.external?`_blank`:`_self`,rel:e.external?`noreferrer noopener`:void 0,className:`flex flex-col items-center justify-center p-4 rounded-lg bg-background/50 border hover:bg-background/80 transition-colors group relative overflow-hidden`,children:[(0,P.jsx)(`div`,{className:`absolute top-2 right-2 w-2 h-2 rounded-full ${r} ${n?``:`animate-pulse`}`}),(0,P.jsx)(i,{className:`w-6 h-6 mb-2 text-muted-foreground group-hover:text-primary transition-colors`}),(0,P.jsx)(`span`,{className:`text-sm font-medium`,children:e.name}),(0,P.jsx)(`span`,{className:N(`text-[10px] mt-1 capitalize font-medium`,n?`text-emerald-500/80`:`text-red-500`),children:t?.status??`Operational`})]},e.id)})}),o.length>0&&(0,P.jsxs)(`div`,{className:`mt-6 pt-6 border-t`,children:[(0,P.jsx)(`h4`,{className:`text-xs font-semibold uppercase tracking-wider text-muted-foreground mb-3`,children:`Service Alerts`}),(0,P.jsx)(`div`,{className:`flex flex-wrap gap-2`,children:o.map(e=>(0,P.jsxs)(W,{variant:`outline`,className:`text-[10px] border-red-500/30 text-red-400 bg-red-500/5`,children:[e.name,`: `,e.status]},e.name))})]})]})})]})}function Vs(e,t){let n=c(),r=(0,M.useMemo)(()=>`${Mr}/snmp/traps/events/stream?limit=${encodeURIComponent(t)}`,[t]);(0,M.useEffect)(()=>{if(!e)return;let i=hs(r,{snapshot:e=>{try{let r=JSON.parse(e.data);n.setQueryData(H.snmpTrapEvents(t),r)}catch{}}});return()=>{i.close()}},[e,t,n,r])}const Hs=t(`/snmp`)({component:Us});function Us(){Vs(!0,`200`);let e=i({queryKey:H.snmpTrapEvents(`200`),queryFn:()=>Ta({limit:`200`}),staleTime:1/0}),t=e.data?.events??[];return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsx)(L,{variant:`glass`,children:(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`SNMP trap inbox`}),(0,P.jsx)(B,{children:`Recent SNMP trap events routed to your user.`})]})}),(0,P.jsx)(L,{children:(0,P.jsx)(V,{className:`p-0`,children:e.isLoading?(0,P.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,P.jsx)(U,{className:`h-12 w-full`}),(0,P.jsx)(U,{className:`h-12 w-full`}),(0,P.jsx)(U,{className:`h-12 w-full`})]}):e.isError?(0,P.jsx)(`div`,{className:`p-8 text-center text-destructive`,children:`Failed to load SNMP trap events.`}):t.length===0?(0,P.jsx)(Cs,{icon:Ft,title:`No trap events`,description:`No SNMP traps have been received yet.`}):(0,P.jsx)(Ss,{columns:[{id:`time`,header:`Time`,width:190,cell:e=>(0,P.jsx)(`span`,{className:`text-muted-foreground whitespace-nowrap text-xs`,children:e.receivedAt??``})},{id:`source`,header:`Source`,width:160,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.sourceIp??``})},{id:`oid`,header:`OID`,cell:e=>(0,P.jsx)(`span`,{className:`font-medium text-foreground text-sm font-mono`,children:e.oid??``})},{id:`id`,header:`ID`,width:120,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs text-muted-foreground`,children:String(e.id)})}],rows:t,getRowId:e=>String(e.id),maxHeightClassName:`max-h-[65vh]`})})})]})}var Ws=ct,Gs=nt,Ks=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(at,{className:N(`fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0`,e),...t,ref:n}));Ks.displayName=at.displayName;var qs=M.forwardRef(({className:e,...t},n)=>(0,P.jsxs)(Gs,{children:[(0,P.jsx)(Ks,{}),(0,P.jsx)(cn,{ref:n,className:N(`fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg`,e),...t})]}));qs.displayName=cn.displayName;var Js=({className:e,...t})=>(0,P.jsx)(`div`,{className:N(`flex flex-col space-y-2 text-center sm:text-left`,e),...t});Js.displayName=`AlertDialogHeader`;var Ys=({className:e,...t})=>(0,P.jsx)(`div`,{className:N(`flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2`,e),...t});Ys.displayName=`AlertDialogFooter`;var Xs=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(Fe,{ref:n,className:N(`text-lg font-semibold`,e),...t}));Xs.displayName=Fe.displayName;var Zs=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(he,{ref:n,className:N(`text-sm text-muted-foreground`,e),...t}));Zs.displayName=he.displayName;var Qs=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(se,{ref:n,className:N(yr(),e),...t}));Qs.displayName=se.displayName;var $s=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(ve,{ref:n,className:N(yr({variant:`outline`}),`mt-2 sm:mt-0`,e),...t}));$s.displayName=ve.displayName;var ec=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(qe,{ref:n,className:N(`peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground`,e),...t,children:(0,P.jsx)($e,{className:N(`flex items-center justify-center text-current`),children:(0,P.jsx)(Je,{className:`h-4 w-4`})})}));ec.displayName=qe.displayName;var tc=Vn(`text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70`),G=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(le,{ref:n,className:N(tc(),e),...t}));G.displayName=le.displayName;var nc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(ee,{className:N(`peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input`,e),...t,ref:n,children:(0,P.jsx)(Xe,{className:N(`pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0`)})}));nc.displayName=ee.displayName;const rc=t(`/notifications`)({component:ic});function ic(){let[e,t]=(0,M.useState)(!1),[n,r]=(0,M.useState)(null),[a,o]=(0,M.useState)(!1),[s,l]=(0,M.useState)(new Set),u=c(),d=i({queryKey:H.session(),queryFn:Ir,staleTime:3e4,retry:!1}).data?.username??``;gs(!!d,e,`50`);let f=i({queryKey:H.notifications(e,`50`),enabled:!!d,queryFn:async()=>({notifications:(await zr(d,{include_read:e?`true`:`false`,limit:`50`})).notifications??[]}),staleTime:1/0,initialData:{notifications:[]}}),p=(0,M.useMemo)(()=>f.data?.notifications??[],[f.data?.notifications]),m=(0,M.useMemo)(()=>p.filter(e=>!e.is_read).length,[p]),h=e=>{l(e?new Set(p.map(e=>String(e.id))):new Set)},g=(e,t)=>{let n=new Set(s);t?n.add(e):n.delete(e),l(n)},_=async()=>{try{let t=Array.from(s).map(e=>Vr(e));await Promise.all(t),j.success(`${s.size} notifications marked as read`),l(new Set),await u.invalidateQueries({queryKey:H.notifications(e,`50`)})}catch(e){j.error(`Failed to mark selection as read`,{description:e.message})}},v=async()=>{try{let t=Array.from(s).map(e=>Hr(e));await Promise.all(t),j.success(`${s.size} notifications deleted`),l(new Set),await u.invalidateQueries({queryKey:H.notifications(e,`50`)})}catch(e){j.error(`Failed to delete selection`,{description:e.message})}},y=async()=>{try{await Br(d),j.success(`All notifications marked as read`)}catch(e){j.error(`Failed to mark notifications as read`,{description:e.message})}},b=async e=>{try{await Vr(e),j.success(`Notification marked as read`)}catch(e){j.error(`Failed to mark notification as read`,{description:e.message})}},ee=async()=>{if(n)try{await Hr(n),j.success(`Notification deleted`),o(!1),r(null)}catch(e){j.error(`Failed to delete notification`,{description:e.message})}},te=[{id:`select`,header:(0,P.jsx)(ec,{checked:p.length>0&&s.size===p.length,onCheckedChange:e=>h(!!e),"aria-label":`Select all`}),width:54,headerClassName:`px-2 py-0`,className:`px-2 py-0`,cell:e=>{let t=String(e.id);return(0,P.jsx)(ec,{checked:s.has(t),onCheckedChange:e=>g(t,e),"aria-label":`Select notification ${t}`})}},{id:`time`,header:`Time`,width:190,cell:e=>(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs whitespace-nowrap`,children:e.created_at??``})},{id:`message`,header:`Title & Message`,cell:e=>(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`div`,{className:`font-medium text-sm`,children:e.title??``}),e.message?(0,P.jsx)(`div`,{className:`mt-1 text-xs text-muted-foreground line-clamp-2`,children:e.message}):null]})},{id:`category`,header:`Category`,width:160,cell:e=>(0,P.jsx)(`span`,{className:`inline-flex items-center rounded-full bg-muted px-2 py-0.5 text-[10px] font-medium text-muted-foreground capitalize`,children:e.category??`System`})},{id:`actions`,header:`Actions`,width:120,align:`right`,cell:e=>{let t=String(e.id);return(0,P.jsxs)(br,{children:[(0,P.jsx)(xr,{asChild:!0,children:(0,P.jsxs)(F,{variant:`ghost`,size:`icon`,className:`h-8 w-8`,children:[(0,P.jsx)(T,{className:`h-4 w-4`}),(0,P.jsx)(`span`,{className:`sr-only`,children:`Open menu`})]})}),(0,P.jsxs)(wr,{align:`end`,children:[!e.is_read&&(0,P.jsxs)(Tr,{onClick:()=>b(t),children:[(0,P.jsx)(Je,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Mark as read`})]}),(0,P.jsxs)(Tr,{className:`text-destructive focus:text-destructive`,onClick:()=>{r(t),o(!0)},children:[(0,P.jsx)(Rn,{className:`mr-2 h-4 w-4`}),(0,P.jsx)(`span`,{children:`Delete`})]})]})]})}}];return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsx)(L,{variant:`glass`,children:(0,P.jsx)(R,{children:(0,P.jsxs)(`div`,{className:`flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,P.jsx)(`div`,{className:`p-2 rounded-full bg-primary/10`,children:(0,P.jsx)(ge,{className:`h-6 w-6 text-primary`})}),(0,P.jsxs)(`div`,{children:[(0,P.jsx)(z,{children:`Notifications`}),(0,P.jsx)(B,{children:`Stay updated with platform events and system alerts.`})]})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(nc,{id:`show-read`,checked:e,onCheckedChange:t}),(0,P.jsx)(G,{htmlFor:`show-read`,className:`cursor-pointer`,children:`Show read`})]}),(0,P.jsx)(F,{variant:`outline`,size:`sm`,disabled:!d||m===0,onClick:y,children:`Mark all read`})]})]})})}),s.size>0&&(0,P.jsxs)(`div`,{className:`fixed bottom-6 left-1/2 -translate-x-1/2 z-50 flex items-center gap-4 rounded-full border bg-background/95 p-2 px-6 shadow-xl backdrop-blur animate-in slide-in-from-bottom-10 fade-in duration-300`,children:[(0,P.jsxs)(`span`,{className:`text-sm font-medium`,children:[s.size,` selected`]}),(0,P.jsx)(`div`,{className:`h-4 w-px bg-border`}),(0,P.jsxs)(F,{size:`sm`,variant:`ghost`,onClick:_,children:[(0,P.jsx)(Je,{className:`mr-2 h-4 w-4`}),`Mark read`]}),(0,P.jsxs)(F,{size:`sm`,variant:`destructive`,onClick:v,children:[(0,P.jsx)(Rn,{className:`mr-2 h-4 w-4`}),`Delete`]}),(0,P.jsx)(F,{size:`sm`,variant:`ghost`,onClick:()=>l(new Set),children:`Cancel`})]}),(0,P.jsx)(L,{children:(0,P.jsx)(V,{className:`p-0`,children:f.isLoading?(0,P.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,P.jsx)(U,{className:`h-12 w-full`}),(0,P.jsx)(U,{className:`h-12 w-full`}),(0,P.jsx)(U,{className:`h-12 w-full`})]}):f.isError?(0,P.jsx)(`div`,{className:`p-8 text-center text-destructive`,children:`Failed to load notifications.`}):p.length===0?(0,P.jsx)(Cs,{icon:Ft,title:`No notifications`,description:e?`You don't have any notifications at the moment.`:`You've read all your notifications!`}):(0,P.jsx)(Ss,{columns:te,rows:p,getRowId:e=>String(e.id),getRowClassName:e=>{let t=String(e.id),n=s.has(t);return[e.is_read?`opacity-60 grayscale-[0.5]`:``,n?`bg-primary/10 hover:bg-primary/10`:``].filter(Boolean).join(` `)},getRowAriaSelected:e=>s.has(String(e.id)),maxHeightClassName:`max-h-[65vh]`,minWidthClassName:`min-w-[900px]`})})}),(0,P.jsx)(Ws,{open:a,onOpenChange:o,children:(0,P.jsxs)(qs,{children:[(0,P.jsxs)(Js,{children:[(0,P.jsx)(Xs,{children:`Delete notification?`}),(0,P.jsx)(Zs,{children:`This action cannot be undone.`})]}),(0,P.jsxs)(Ys,{children:[(0,P.jsx)($s,{children:`Cancel`}),(0,P.jsx)(Qs,{onClick:ee,className:yr({variant:`destructive`}),children:`Delete`})]})]})})]})}var K=M.forwardRef(({className:e,type:t,...n},r)=>(0,P.jsx)(`input`,{type:t,className:N(`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,e),ref:r,...n}));K.displayName=`Input`;var q=De,J=Re,Y=M.forwardRef(({className:e,children:t,...n},r)=>(0,P.jsxs)(xe,{ref:r,className:N(`flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1`,e),...n,children:[t,(0,P.jsx)(ne,{asChild:!0,children:(0,P.jsx)(ue,{className:`h-4 w-4 opacity-50`})})]}));Y.displayName=xe.displayName;var ac=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(D,{ref:n,className:N(`flex cursor-default items-center justify-center py-1`,e),...t,children:(0,P.jsx)(Ln,{className:`h-4 w-4`})}));ac.displayName=D.displayName;var oc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(Me,{ref:n,className:N(`flex cursor-default items-center justify-center py-1`,e),...t,children:(0,P.jsx)(ue,{className:`h-4 w-4`})}));oc.displayName=Me.displayName;var X=M.forwardRef(({className:e,children:t,position:n=`popper`,...r},i)=>(0,P.jsx)(we,{children:(0,P.jsxs)(We,{ref:i,className:N(`relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2`,n===`popper`&&`data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1`,e),position:n,...r,children:[(0,P.jsx)(ac,{}),(0,P.jsx)(In,{className:N(`p-1`,n===`popper`&&`h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]`),children:t}),(0,P.jsx)(oc,{})]})}));X.displayName=We.displayName;var sc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(Bt,{ref:n,className:N(`py-1.5 pl-8 pr-2 text-sm font-semibold`,e),...t}));sc.displayName=Bt.displayName;var Z=M.forwardRef(({className:e,children:t,...n},r)=>(0,P.jsxs)(A,{ref:r,className:N(`relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50`,e),...n,children:[(0,P.jsx)(`span`,{className:`absolute left-2 flex h-3.5 w-3.5 items-center justify-center`,children:(0,P.jsx)(Ut,{children:(0,P.jsx)(Je,{className:`h-4 w-4`})})}),(0,P.jsx)(v,{children:t})]}));Z.displayName=A.displayName;var cc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(fe,{ref:n,className:N(`-mx-1 my-1 h-px bg-muted`,e),...t}));cc.displayName=fe.displayName;var lc=S,uc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(Ve,{ref:n,className:N(`inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground`,e),...t}));uc.displayName=Ve.displayName;var dc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(Dn,{ref:n,className:N(`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm`,e),...t}));dc.displayName=Dn.displayName;var fc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(An,{ref:n,className:N(`mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2`,e),...t}));fc.displayName=An.displayName;const pc=t(`/design`)({component:mc});function mc(){return(0,P.jsxs)(`div`,{className:`space-y-10 p-6 pb-20`,children:[(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(`h1`,{className:`text-3xl font-bold tracking-tight`,children:`Design System`}),(0,P.jsx)(`p`,{className:`text-muted-foreground`,children:`A catalog of all reusable UI components available in the portal.`})]}),(0,P.jsxs)(`section`,{className:`space-y-4`,children:[(0,P.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Buttons`}),(0,P.jsxs)(`div`,{className:`flex flex-wrap gap-4`,children:[(0,P.jsx)(F,{variant:`default`,children:`Default`}),(0,P.jsx)(F,{variant:`secondary`,children:`Secondary`}),(0,P.jsx)(F,{variant:`destructive`,children:`Destructive`}),(0,P.jsx)(F,{variant:`outline`,children:`Outline`}),(0,P.jsx)(F,{variant:`ghost`,children:`Ghost`}),(0,P.jsx)(F,{variant:`link`,children:`Link`}),(0,P.jsx)(F,{size:`sm`,children:`Small`}),(0,P.jsx)(F,{size:`lg`,children:`Large`}),(0,P.jsx)(F,{size:`icon`,children:(0,P.jsx)(k,{className:`h-4 w-4`})}),(0,P.jsx)(F,{disabled:!0,children:`Disabled`}),(0,P.jsxs)(F,{variant:`outline`,className:`gap-2`,children:[(0,P.jsx)(hn,{className:`h-4 w-4`}),` With Icon`]})]})]}),(0,P.jsxs)(`section`,{className:`space-y-4`,children:[(0,P.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Badges`}),(0,P.jsxs)(`div`,{className:`flex flex-wrap gap-4`,children:[(0,P.jsx)(W,{children:`Default`}),(0,P.jsx)(W,{variant:`secondary`,children:`Secondary`}),(0,P.jsx)(W,{variant:`outline`,children:`Outline`}),(0,P.jsx)(W,{variant:`destructive`,children:`Destructive`})]})]}),(0,P.jsxs)(`section`,{className:`space-y-4`,children:[(0,P.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Cards`}),(0,P.jsxs)(`div`,{className:`grid gap-4 md:grid-cols-2 lg:grid-cols-4`,children:[(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Default Card`}),(0,P.jsx)(B,{children:`Standard container style`})]}),(0,P.jsx)(V,{children:`Content goes here`})]}),(0,P.jsxs)(L,{variant:`glass`,children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Glass Card`}),(0,P.jsx)(B,{children:`Backdrop blur effect`})]}),(0,P.jsx)(V,{children:`Popular for headers`})]}),(0,P.jsxs)(L,{variant:`flat`,children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Flat Card`}),(0,P.jsx)(B,{children:`No shadow, border only`})]}),(0,P.jsx)(V,{children:`Clean look`})]}),(0,P.jsxs)(L,{variant:`danger`,children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Danger Card`}),(0,P.jsx)(B,{children:`For error states`})]}),(0,P.jsx)(V,{className:`text-sm`,children:`Something went wrong`})]})]})]}),(0,P.jsxs)(`section`,{className:`space-y-4`,children:[(0,P.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Bento Grid`}),(0,P.jsxs)(Ms,{children:[(0,P.jsx)(Ps,{title:`Total Revenue`,value:`$45,231.89`,icon:(0,P.jsx)(Vt,{className:`h-4 w-4`}),gradient:`blue`}),(0,P.jsx)(Ps,{title:`Active Users`,value:`+2350`,icon:(0,P.jsx)(Pe,{className:`h-4 w-4`}),gradient:`green`}),(0,P.jsx)(Ns,{gradient:`purple`,className:`md:col-span-2`,children:(0,P.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,P.jsx)(`div`,{className:`p-2 bg-background/20 rounded-full`,children:(0,P.jsx)(Ne,{className:`h-6 w-6`})}),(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`h3`,{className:`font-semibold text-lg`,children:`Cloud Infrastructure`}),(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground/80`,children:`Manage your cloud resources and deployments from a single dashboard.`})]})]})})]})]}),(0,P.jsxs)(`section`,{className:`space-y-4`,children:[(0,P.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Form Inputs`}),(0,P.jsx)(L,{children:(0,P.jsxs)(V,{className:`pt-6 space-y-4 max-w-md`,children:[(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(G,{htmlFor:`email`,children:`Email address`}),(0,P.jsx)(K,{type:`email`,id:`email`,placeholder:`name@example.com`})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(G,{children:`Framework`}),(0,P.jsxs)(q,{children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select framework`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`react`,children:`React`}),(0,P.jsx)(Z,{value:`vue`,children:`Vue`}),(0,P.jsx)(Z,{value:`svelte`,children:`Svelte`})]})]})]}),(0,P.jsxs)(`div`,{className:`flex items-center space-x-2`,children:[(0,P.jsx)(nc,{id:`airplane-mode`}),(0,P.jsx)(G,{htmlFor:`airplane-mode`,children:`Airplane Mode`})]})]})})]}),(0,P.jsxs)(`section`,{className:`space-y-4`,children:[(0,P.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Tabs`}),(0,P.jsxs)(lc,{defaultValue:`profile`,className:`w-[400px]`,children:[(0,P.jsxs)(uc,{children:[(0,P.jsx)(dc,{value:`profile`,children:`Profile`}),(0,P.jsx)(dc,{value:`password`,children:`Password`})]}),(0,P.jsx)(fc,{value:`profile`,children:(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Profile`}),(0,P.jsx)(B,{children:`Make changes to your profile here.`})]}),(0,P.jsx)(V,{className:`space-y-2`,children:(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`name`,children:`Name`}),(0,P.jsx)(K,{id:`name`,defaultValue:`Pedro Duarte`})]})}),(0,P.jsx)(Xo,{children:(0,P.jsx)(F,{children:`Save changes`})})]})}),(0,P.jsx)(fc,{value:`password`,children:(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Password`}),(0,P.jsx)(B,{children:`Change your password here.`})]}),(0,P.jsx)(V,{className:`space-y-2`,children:(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`current`,children:`Current password`}),(0,P.jsx)(K,{id:`current`,type:`password`})]})}),(0,P.jsx)(Xo,{children:(0,P.jsx)(F,{children:`Save password`})})]})})]})]}),(0,P.jsxs)(`section`,{className:`space-y-4`,children:[(0,P.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Feedback & Status`}),(0,P.jsxs)(`div`,{className:`grid gap-6 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`space-y-4`,children:[(0,P.jsx)(`h3`,{className:`text-sm font-medium text-muted-foreground`,children:`Empty State`}),(0,P.jsx)(`div`,{className:`border rounded-lg p-4`,children:(0,P.jsx)(Cs,{icon:Ft,title:`No items found`,description:`You haven't created any items yet.`,action:{label:`Create Item`,onClick:()=>j(`Clicked create`)},className:`min-h-[200px]`})})]}),(0,P.jsxs)(`div`,{className:`space-y-4`,children:[(0,P.jsx)(`h3`,{className:`text-sm font-medium text-muted-foreground`,children:`Skeleton Loading`}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(U,{className:`h-5 w-[140px] mb-2`}),(0,P.jsx)(U,{className:`h-4 w-[250px]`})]}),(0,P.jsxs)(V,{className:`space-y-2`,children:[(0,P.jsx)(U,{className:`h-4 w-full`}),(0,P.jsx)(U,{className:`h-4 w-full`}),(0,P.jsx)(U,{className:`h-4 w-3/4`})]})]})]})]})]}),(0,P.jsxs)(`section`,{className:`space-y-4`,children:[(0,P.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Toast Notifications`}),(0,P.jsxs)(`div`,{className:`flex flex-wrap gap-4`,children:[(0,P.jsx)(F,{variant:`outline`,onClick:()=>j(`Event has been created`),children:`Simple Toast`}),(0,P.jsx)(F,{variant:`outline`,onClick:()=>j.success(`Event created successfully`),children:`Success`}),(0,P.jsx)(F,{variant:`outline`,onClick:()=>j.error(`Failed to create event`),children:`Error`}),(0,P.jsx)(F,{variant:`outline`,onClick:()=>j.info(`New updates available`,{description:`Refresh to see changes`}),children:`With Description`}),(0,P.jsx)(F,{variant:`outline`,onClick:()=>j(`Event deleted`,{action:{label:`Undo`,onClick:()=>console.log(`Undo`)}}),children:`With Action`})]})]}),(0,P.jsxs)(`section`,{className:`space-y-4`,children:[(0,P.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Breadcrumbs`}),(0,P.jsx)(`div`,{className:`p-4 border rounded-lg`,children:(0,P.jsx)(Ho,{children:(0,P.jsxs)(Uo,{children:[(0,P.jsx)(Wo,{children:(0,P.jsx)(Go,{href:`/status`,children:`Dashboard`})}),` `,(0,P.jsx)(qo,{}),(0,P.jsx)(Wo,{children:(0,P.jsx)(Go,{href:`/components`,children:`Components`})}),(0,P.jsx)(qo,{}),(0,P.jsx)(Wo,{children:(0,P.jsx)(Ko,{children:`Breadcrumb`})})]})})})]})]})}const hc=t(`/`)({component:gc});function gc(){let e=n(),t=i({queryKey:H.session(),queryFn:Ir,retry:!1,staleTime:3e4});return(0,M.useEffect)(()=>{t.isLoading||(t.data?.authenticated?e({to:`/dashboard/deployments`,replace:!0}):e({to:`/status`,replace:!0}))},[t.data?.authenticated,t.isLoading,e]),null}const _c=t(`/docs/`)({beforeLoad:()=>{throw h({to:`/dashboard/docs`})}}),vc=t(`/dashboard/`)({component:yc});function yc(){let e=n();return(0,M.useEffect)(()=>{e({to:`/status`,replace:!0})},[e]),null}const bc=t(`/admin/`)({component:xc});function xc(){let e=n();return(0,M.useEffect)(()=>{e({to:`/admin/settings`,replace:!0})},[e]),null}const Sc=t(`/docs/$slug`)({beforeLoad:({params:e})=>{let t=String(e.slug??``);throw h({to:`/dashboard/docs/$slug`,params:{slug:t.endsWith(`.html`)?t.slice(0,-5):t}})}});var Cc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`textarea`,{className:N(`flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,e),ref:n,...t}));Cc.displayName=`Textarea`;var wc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`div`,{className:`relative w-full overflow-auto`,children:(0,P.jsx)(`table`,{ref:n,className:N(`w-full caption-bottom text-sm`,e),...t})}));wc.displayName=`Table`;var Tc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`thead`,{ref:n,className:N(`[&_tr]:border-b`,e),...t}));Tc.displayName=`TableHeader`;var Ec=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`tbody`,{ref:n,className:N(`[&_tr:last-child]:border-0`,e),...t}));Ec.displayName=`TableBody`;var Dc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`tfoot`,{ref:n,className:N(`border-t bg-muted/50 font-medium [&>tr]:last:border-b-0`,e),...t}));Dc.displayName=`TableFooter`;var Oc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`tr`,{ref:n,className:N(`border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted`,e),...t}));Oc.displayName=`TableRow`;var Q=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`th`,{ref:n,className:N(`h-10 px-3 text-left align-middle text-xs font-medium uppercase tracking-wide text-muted-foreground [&:has([role=checkbox])]:pr-0`,e),...t}));Q.displayName=`TableHead`;var $=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`td`,{ref:n,className:N(`px-3 py-2 align-middle [&:has([role=checkbox])]:pr-0`,e),...t}));$.displayName=`TableCell`;var kc=M.forwardRef(({className:e,...t},n)=>(0,P.jsx)(`caption`,{ref:n,className:N(`mt-4 text-sm text-muted-foreground`,e),...t}));kc.displayName=`TableCaption`;function Ac({allowEdit:e}){let t=c(),[n,a]=(0,M.useState)(!1),[o,s]=(0,M.useState)(null),[l,u]=(0,M.useState)(null),d=i({queryKey:H.userVariableGroups(),queryFn:qa,staleTime:3e4}),f=d.data?.groups??[],p=r({mutationFn:async e=>Xa(e),onSuccess:()=>{j.success(`Variable group deleted`),t.invalidateQueries({queryKey:H.userVariableGroups()}),u(null)},onError:e=>j.error(`Failed to delete group`,{description:e.message})});return(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(z,{children:`Variable Groups`}),(0,P.jsx)(B,{children:`Define reusable environment variables for your deployments.`})]}),(0,P.jsxs)(F,{size:`sm`,onClick:()=>a(!0),disabled:!e,children:[(0,P.jsx)(Et,{className:`mr-2 h-4 w-4`}),`New Group`]})]})}),(0,P.jsx)(V,{children:d.isLoading?(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Loading groups`}):f.length===0?(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground border border-dashed rounded-lg p-8 text-center`,children:`No variable groups defined.`}):(0,P.jsx)(`div`,{className:`rounded-md border`,children:(0,P.jsxs)(wc,{children:[(0,P.jsx)(Tc,{children:(0,P.jsxs)(Oc,{children:[(0,P.jsx)(Q,{children:`Name`}),(0,P.jsx)(Q,{children:`Variables`}),(0,P.jsx)(Q,{className:`text-right`,children:`Actions`})]})}),(0,P.jsx)(Ec,{children:f.map(t=>(0,P.jsxs)(Oc,{children:[(0,P.jsx)($,{className:`font-medium`,children:t.name}),(0,P.jsxs)($,{className:`text-muted-foreground text-xs`,children:[Object.keys(t.variables??{}).length,` variables`]}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsxs)(`div`,{className:`flex justify-end gap-2`,children:[(0,P.jsx)(F,{variant:`ghost`,size:`icon`,className:`h-8 w-8`,onClick:()=>s(t),disabled:!e,children:(0,P.jsx)($t,{className:`h-4 w-4`})}),(0,P.jsx)(F,{variant:`ghost`,size:`icon`,className:`h-8 w-8 text-destructive hover:text-destructive`,onClick:()=>u(t),disabled:!e,children:(0,P.jsx)(Rn,{className:`h-4 w-4`})})]})})]},t.id))})]})})}),(0,P.jsx)(jc,{open:n,onOpenChange:a,allowEdit:e,mode:`create`}),o&&(0,P.jsx)(jc,{open:!!o,onOpenChange:e=>!e&&s(null),allowEdit:e,mode:`edit`,initialData:o}),(0,P.jsx)(Ws,{open:!!l,onOpenChange:e=>!e&&u(null),children:(0,P.jsxs)(qs,{children:[(0,P.jsxs)(Js,{children:[(0,P.jsx)(Xs,{children:`Delete variable group?`}),(0,P.jsxs)(Zs,{children:[`This will permanently delete `,(0,P.jsx)(`strong`,{children:l?.name}),`.`]})]}),(0,P.jsxs)(Ys,{children:[(0,P.jsx)($s,{children:`Cancel`}),(0,P.jsx)(Qs,{className:`bg-destructive text-destructive-foreground hover:bg-destructive/90`,onClick:()=>l&&p.mutate(l.id),children:p.isPending?`Deleting`:`Delete`})]})]})})]})}function jc({open:e,onOpenChange:t,allowEdit:n,mode:i,initialData:a}){let o=c(),[s,l]=(0,M.useState)(a?.name??``),[u,d]=(0,M.useState)(()=>a?.variables?Object.entries(a.variables).map(([e,t])=>({key:e,value:String(t??``)})):[{key:``,value:``}]),f=r({mutationFn:async()=>{let e={};for(let t of u)t.key.trim()&&(e[t.key.trim()]=t.value);let t={name:s.trim(),variables:e};return i===`create`?Ja(t):Ya(a?.id??0,t)},onSuccess:()=>{o.invalidateQueries({queryKey:H.userVariableGroups()}),j.success(i===`create`?`Variable group created`:`Saved`),t(!1)},onError:e=>j.error(`Failed to save group`,{description:e.message})}),p=(e,t)=>{d(n=>n.map((n,r)=>r===e?t:n))};return(0,P.jsx)(Zn,{open:e,onOpenChange:t,children:(0,P.jsxs)(er,{children:[(0,P.jsxs)(tr,{children:[(0,P.jsx)(rr,{children:i===`create`?`New variable group`:`Edit variable group`}),(0,P.jsx)(ir,{children:`Group common environment variables to reuse across deployments.`})]}),(0,P.jsxs)(`div`,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Name`}),(0,P.jsx)(K,{value:s,onChange:e=>l(e.target.value),placeholder:`Defaults`,disabled:!n})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsx)(G,{children:`Variables`}),(0,P.jsx)(F,{type:`button`,variant:`outline`,size:`sm`,onClick:()=>d(e=>[...e,{key:``,value:``}]),disabled:!n,children:`Add variable`})]}),(0,P.jsx)(`div`,{className:`space-y-2 max-h-[320px] overflow-y-auto pr-2`,children:u.map((e,t)=>(0,P.jsxs)(`div`,{className:`grid grid-cols-12 gap-2`,children:[(0,P.jsx)(K,{value:e.key,onChange:n=>p(t,{key:n.target.value,value:e.value}),placeholder:`KEY`,className:`col-span-5 font-mono text-xs`,disabled:!n}),(0,P.jsx)(Cc,{value:e.value,onChange:n=>p(t,{key:e.key,value:n.target.value}),placeholder:`Value`,rows:1,className:`col-span-7 text-xs`,disabled:!n})]},t))})]})]}),(0,P.jsxs)(nr,{children:[(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>t(!1),children:`Cancel`}),(0,P.jsx)(F,{type:`button`,onClick:()=>f.mutate(),disabled:!n||f.isPending,children:f.isPending?`Saving`:`Save`})]})]})})}const Mc=t(`/dashboard/settings`)({component:Pc});var Nc=`https://d-9067d98db1.awsapps.com/start/#`;function Pc(){let e=c(),t=i({queryKey:H.userAwsStaticCredentials(),queryFn:si,staleTime:1e4,retry:!1}),n=i({queryKey:H.awsSsoConfig(),queryFn:ni,staleTime:1e4,retry:!1}),a=i({queryKey:H.awsSsoStatus(),queryFn:ri,staleTime:1e4,retry:!1}),o=i({queryKey:H.userAwsSsoCredentials(),queryFn:ui,staleTime:1e4,retry:!1}),s=i({queryKey:H.userAzureCredentials(),queryFn:pi,staleTime:1e4,retry:!1}),l=i({queryKey:H.userGcpCredentials(),queryFn:gi,staleTime:1e4,retry:!1}),u=i({queryKey:H.userIbmCredentials(),queryFn:yi,staleTime:1e4,retry:!1}),d=i({queryKey:H.userNetlabServers(),queryFn:Si,staleTime:1e4,retry:!1}),f=i({queryKey:H.userEveServers(),queryFn:Ti,staleTime:1e4,retry:!1}),p=i({queryKey:H.userContainerlabServers(),queryFn:Oi,staleTime:1e4,retry:!1}),[m,h]=(0,M.useState)(``),[g,_]=(0,M.useState)(``),[v,y]=(0,M.useState)(``),[b,ee]=(0,M.useState)(``),[te,x]=(0,M.useState)(``),[S,C]=(0,M.useState)(``),[w,ne]=(0,M.useState)(``),[T,re]=(0,M.useState)(``),[ie,ae]=(0,M.useState)(``),[E,D]=(0,M.useState)(``),[O,oe]=(0,M.useState)(``),[se,ce]=(0,M.useState)(``),[k,le]=(0,M.useState)(``),[ue,de]=(0,M.useState)(``),[fe,pe]=(0,M.useState)(!0),[me,he]=(0,M.useState)(``),[ge,_e]=(0,M.useState)(``),[ve,ye]=(0,M.useState)(``),[be,xe]=(0,M.useState)(!0),[Se,Ce]=(0,M.useState)(``),[we,Te]=(0,M.useState)(``),[Ee,De]=(0,M.useState)(``),[Oe,ke]=(0,M.useState)(``),[A,Ae]=(0,M.useState)(!0),[je,Me]=(0,M.useState)(``),[Ne,Pe]=(0,M.useState)(``),Fe=e=>{try{return new URL(e).hostname||e}catch{return e}},Ie=r({mutationFn:async()=>ci({accessKeyId:m.trim(),secretAccessKey:g}),onSuccess:async()=>{_(``),await e.invalidateQueries({queryKey:H.userAwsStaticCredentials()}),j.success(`AWS static credentials saved`)},onError:e=>j.error(`Failed to save AWS static credentials`,{description:e instanceof Error?e.message:String(e)})}),Le=r({mutationFn:async()=>li(),onSuccess:async()=>{h(``),_(``),await e.invalidateQueries({queryKey:H.userAwsStaticCredentials()}),j.success(`AWS static credentials deleted`)},onError:e=>j.error(`Failed to delete AWS static credentials`,{description:e instanceof Error?e.message:String(e)})}),[Re,ze]=(0,M.useState)(null),[Be,Ve]=(0,M.useState)(``),He=!!(v.trim()&&b.trim());(0,M.useEffect)(()=>{let e=(o.data?.startUrl??``).trim(),t=(o.data?.region??``).trim(),r=(n.data?.startUrl??``).trim(),i=(n.data?.region??``).trim();y(e||r||Nc),ee(t||i)},[o.data?.startUrl,o.data?.region,n.data?.startUrl,n.data?.region]);let Ue=r({mutationFn:async()=>{let e=(o.data?.accountId??n.data?.accountId??``).trim(),t=(o.data?.roleName??n.data?.roleName??``).trim();return di({startUrl:v.trim(),region:b.trim(),accountId:e,roleName:t})},onSuccess:async()=>{await e.invalidateQueries({queryKey:H.userAwsSsoCredentials()}),await e.invalidateQueries({queryKey:H.awsSsoConfig()}),j.success(`AWS SSO settings saved`)},onError:e=>j.error(`Failed to save AWS SSO settings`,{description:e instanceof Error?e.message:String(e)})}),We=r({mutationFn:async()=>fi(),onSuccess:async()=>{y((n.data?.startUrl??``).trim()||Nc),ee((n.data?.region??``).trim()),await e.invalidateQueries({queryKey:H.userAwsSsoCredentials()}),await e.invalidateQueries({queryKey:H.awsSsoConfig()}),j.success(`AWS SSO settings reset`)},onError:e=>j.error(`Failed to reset AWS SSO settings`,{description:e instanceof Error?e.message:String(e)})}),Ge=r({mutationFn:ii,onSuccess:e=>{ze(e),Ve(`pending`),window.open(e.verificationUriComplete,`_blank`,`noopener,noreferrer`)},onError:e=>j.error(`Failed to start AWS SSO`,{description:e instanceof Error?e.message:String(e)})}),Ke=r({mutationFn:oi,onSuccess:async()=>{ze(null),Ve(``),await e.invalidateQueries({queryKey:H.awsSsoStatus()}),j.success(`AWS SSO disconnected`)},onError:e=>j.error(`Failed to disconnect AWS SSO`,{description:e instanceof Error?e.message:String(e)})});(0,M.useEffect)(()=>{if(!Re||!Re.requestId)return;let t=!1,n=null,r=async()=>{try{let i=await ai({requestId:Re.requestId});if(t)return;if(Ve(i.status),i.status===`ok`){ze(null),await e.invalidateQueries({queryKey:H.awsSsoStatus()}),j.success(`AWS SSO connected`);return}if(i.status===`pending`){n=setTimeout(r,Math.max(1,Re.intervalSeconds)*1e3);return}ze(null),j.error(`AWS SSO authorization did not complete`,{description:i.status})}catch(e){if(t)return;ze(null),j.error(`AWS SSO polling failed`,{description:e instanceof Error?e.message:String(e)})}};return n=setTimeout(r,Math.max(1,Re.intervalSeconds)*1e3),()=>{t=!0,n&&clearTimeout(n)}},[Re,e]);let qe=r({mutationFn:async()=>mi({tenantId:te.trim(),clientId:S.trim(),clientSecret:w,subscriptionId:T.trim()||void 0}),onSuccess:async()=>{ne(``),await e.invalidateQueries({queryKey:H.userAzureCredentials()}),j.success(`Azure credentials saved`)},onError:e=>j.error(`Failed to save Azure credentials`,{description:e instanceof Error?e.message:String(e)})}),Je=r({mutationFn:async()=>hi(),onSuccess:async()=>{x(``),C(``),ne(``),re(``),await e.invalidateQueries({queryKey:H.userAzureCredentials()}),j.success(`Azure credentials deleted`)},onError:e=>j.error(`Failed to delete Azure credentials`,{description:e instanceof Error?e.message:String(e)})}),Ye=r({mutationFn:async()=>_i({projectIdOverride:ie.trim()||void 0,serviceAccountJson:E}),onSuccess:async()=>{D(``),await e.invalidateQueries({queryKey:H.userGcpCredentials()}),j.success(`GCP credentials saved`)},onError:e=>j.error(`Failed to save GCP credentials`,{description:e instanceof Error?e.message:String(e)})}),Xe=r({mutationFn:async()=>vi(),onSuccess:async()=>{ae(``),D(``),await e.invalidateQueries({queryKey:H.userGcpCredentials()}),j.success(`GCP credentials deleted`)},onError:e=>j.error(`Failed to delete GCP credentials`,{description:e instanceof Error?e.message:String(e)})}),Ze=r({mutationFn:async()=>bi({apiKey:O,region:se.trim(),resourceGroupId:k.trim()||void 0}),onSuccess:async()=>{oe(``),await e.invalidateQueries({queryKey:H.userIbmCredentials()}),j.success(`IBM Cloud credentials saved`)},onError:e=>j.error(`Failed to save IBM Cloud credentials`,{description:e instanceof Error?e.message:String(e)})}),Qe=r({mutationFn:async()=>xi(),onSuccess:async()=>{oe(``),ce(``),le(``),await e.invalidateQueries({queryKey:H.userIbmCredentials()}),j.success(`IBM Cloud credentials deleted`)},onError:e=>j.error(`Failed to delete IBM Cloud credentials`,{description:e instanceof Error?e.message:String(e)})}),$e=r({mutationFn:async()=>Ci({name:Fe(ue).trim(),apiUrl:ue.trim(),apiInsecure:fe,apiUser:me.trim()||void 0,apiPassword:ge.trim()||void 0}),onSuccess:async()=>{de(``),pe(!0),he(``),_e(``),await e.invalidateQueries({queryKey:H.userNetlabServers()}),j.success(`Netlab server saved`)},onError:e=>j.error(`Failed to save Netlab server`,{description:e instanceof Error?e.message:String(e)})}),et=r({mutationFn:async e=>wi(e),onSuccess:async()=>{await e.invalidateQueries({queryKey:H.userNetlabServers()}),j.success(`Netlab server deleted`)},onError:e=>j.error(`Failed to delete Netlab server`,{description:e instanceof Error?e.message:String(e)})}),tt=r({mutationFn:async()=>ki({name:Fe(ve).trim(),apiUrl:ve.trim(),apiInsecure:be,apiUser:Se.trim()||void 0,apiPassword:we.trim()||void 0}),onSuccess:async()=>{ye(``),xe(!0),Ce(``),Te(``),await e.invalidateQueries({queryKey:H.userContainerlabServers()}),j.success(`Containerlab server saved`)},onError:e=>j.error(`Failed to save Containerlab server`,{description:e instanceof Error?e.message:String(e)})}),nt=r({mutationFn:async e=>Ai(e),onSuccess:async()=>{await e.invalidateQueries({queryKey:H.userContainerlabServers()}),j.success(`Containerlab server deleted`)},onError:e=>j.error(`Failed to delete Containerlab server`,{description:e instanceof Error?e.message:String(e)})}),rt=r({mutationFn:async()=>Ei({name:Fe(Ee).trim(),apiUrl:Ee.trim(),webUrl:Oe.trim()||void 0,skipTlsVerify:A,apiUser:je.trim()||void 0,apiPassword:Ne.trim()||void 0}),onSuccess:async()=>{De(``),ke(``),Ae(!0),Me(``),Pe(``),await e.invalidateQueries({queryKey:H.userEveServers()}),j.success(`EVE-NG server saved`)},onError:e=>j.error(`Failed to save EVE-NG server`,{description:e instanceof Error?e.message:String(e)})}),it=r({mutationFn:async e=>Di(e),onSuccess:async()=>{await e.invalidateQueries({queryKey:H.userEveServers()}),j.success(`EVE-NG server deleted`)},onError:e=>j.error(`Failed to delete EVE-NG server`,{description:e instanceof Error?e.message:String(e)})});return(0,P.jsxs)(`div`,{className:`mx-auto w-full max-w-4xl space-y-6 p-6`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`h1`,{className:`text-2xl font-bold tracking-tight`,children:`My Settings`}),(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`User-scoped credentials and integrations.`})]}),(0,P.jsx)(Ac,{allowEdit:!0}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{children:`Cloud Credentials`})}),(0,P.jsxs)(V,{className:`space-y-8`,children:[(0,P.jsxs)(`div`,{className:`grid gap-6 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`rounded border p-4 space-y-3`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`AWS (static)`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:t.data?.configured?`Configured (${t.data?.accessKeyLast4??``})`:`Not configured`})]}),(0,P.jsx)(K,{placeholder:`Access key id`,value:m,onChange:e=>h(e.target.value)}),(0,P.jsx)(K,{placeholder:`Secret access key`,type:`password`,value:g,onChange:e=>_(e.target.value)}),(0,P.jsxs)(`div`,{className:`flex gap-2`,children:[(0,P.jsx)(F,{type:`button`,onClick:()=>Ie.mutate(),disabled:Ie.isPending,children:`Save`}),(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>Le.mutate(),disabled:Le.isPending,children:`Delete`})]})]}),(0,P.jsxs)(`div`,{className:`rounded border p-4 space-y-3`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`AWS (SSO)`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:He?a.data?.connected?`Connected`:`Not connected`:`Not configured`})]}),(0,P.jsx)(K,{placeholder:`SSO start URL`,value:v,onChange:e=>y(e.target.value)}),(0,P.jsx)(K,{placeholder:`Region`,value:b,onChange:e=>ee(e.target.value)}),a.data?.lastAuthenticatedAt?(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Last authenticated:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:a.data.lastAuthenticatedAt})]}):null,a.data?.expiresAt?(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Expires:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:a.data.expiresAt})]}):null,Re?(0,P.jsxs)(`div`,{className:`rounded border bg-muted/30 p-3 text-xs space-y-1`,children:[(0,P.jsx)(`div`,{className:`font-medium`,children:`Complete sign-in`}),(0,P.jsxs)(`div`,{children:[`Code:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:Re.userCode})]}),(0,P.jsxs)(`div`,{className:`text-muted-foreground`,children:[`Open:`,` `,(0,P.jsx)(`span`,{className:`font-mono break-all`,children:Re.verificationUriComplete})]}),Be?(0,P.jsxs)(`div`,{className:`text-muted-foreground`,children:[`Status: `,Be]}):null]}):null,(0,P.jsxs)(`div`,{className:`flex gap-2`,children:[(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>Ue.mutate(),disabled:Ue.isPending,children:`Save`}),(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>We.mutate(),disabled:We.isPending,children:`Reset`}),(0,P.jsx)(F,{type:`button`,onClick:()=>Ge.mutate(),disabled:!He||Ge.isPending||!!Re,children:`Connect`}),(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>Ke.mutate(),disabled:!a.data?.connected||Ke.isPending,children:`Disconnect`})]})]})]}),(0,P.jsxs)(`div`,{className:`grid gap-6 md:grid-cols-3`,children:[(0,P.jsxs)(`div`,{className:`rounded border p-4 space-y-3`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Azure`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:s.data?.configured?`Configured`:`Not configured`})]}),(0,P.jsx)(K,{placeholder:`Tenant ID`,value:te,onChange:e=>x(e.target.value)}),(0,P.jsx)(K,{placeholder:`Client ID`,value:S,onChange:e=>C(e.target.value)}),(0,P.jsx)(K,{placeholder:`Client secret`,type:`password`,value:w,onChange:e=>ne(e.target.value)}),(0,P.jsx)(K,{placeholder:`Subscription ID (optional)`,value:T,onChange:e=>re(e.target.value)}),(0,P.jsxs)(`div`,{className:`flex gap-2`,children:[(0,P.jsx)(F,{type:`button`,onClick:()=>qe.mutate(),disabled:qe.isPending,children:`Save`}),(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>Je.mutate(),disabled:Je.isPending,children:`Delete`})]})]}),(0,P.jsxs)(`div`,{className:`rounded border p-4 space-y-3`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`GCP`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:l.data?.configured?`Configured`:`Not configured`})]}),(0,P.jsx)(K,{placeholder:`Project ID`,value:ie,onChange:e=>ae(e.target.value)}),(0,P.jsx)(Cc,{placeholder:`Service account JSON`,className:`min-h-[140px] font-mono text-xs`,value:E,onChange:e=>D(e.target.value)}),(0,P.jsxs)(`div`,{className:`flex gap-2`,children:[(0,P.jsx)(F,{type:`button`,onClick:()=>Ye.mutate(),disabled:Ye.isPending,children:`Save`}),(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>Xe.mutate(),disabled:Xe.isPending,children:`Delete`})]})]}),(0,P.jsxs)(`div`,{className:`rounded border p-4 space-y-3`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`IBM Cloud`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:u.data?.configured?`Configured`:`Not configured`})]}),(0,P.jsx)(K,{placeholder:`Region`,value:se,onChange:e=>ce(e.target.value)}),(0,P.jsx)(K,{placeholder:`API key`,type:`password`,value:O,onChange:e=>oe(e.target.value)}),(0,P.jsx)(K,{placeholder:`Resource group ID (optional)`,value:k,onChange:e=>le(e.target.value)}),(0,P.jsxs)(`div`,{className:`flex gap-2`,children:[(0,P.jsx)(F,{type:`button`,onClick:()=>Ze.mutate(),disabled:Ze.isPending,children:`Save`}),(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>Qe.mutate(),disabled:Qe.isPending,children:`Delete`})]})]})]})]})]}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{children:`BYOL Servers`})}),(0,P.jsxs)(V,{className:`space-y-8`,children:[(0,P.jsxs)(`div`,{className:`space-y-4`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Netlab`}),(0,P.jsxs)(`div`,{className:`grid gap-2 md:grid-cols-2`,children:[(0,P.jsx)(K,{placeholder:`https://netlab.example.com`,value:ue,onChange:e=>de(e.target.value)}),(0,P.jsx)(K,{placeholder:`API username (optional)`,value:me,onChange:e=>he(e.target.value)}),(0,P.jsx)(K,{placeholder:`API password (optional)`,type:`password`,value:ge,onChange:e=>_e(e.target.value)}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(`input`,{type:`checkbox`,checked:fe,onChange:e=>pe(e.target.checked)}),(0,P.jsx)(`div`,{className:`text-sm`,children:`Skip TLS verify`})]})]}),(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>$e.mutate(),disabled:!ue.trim()||$e.isPending,children:`Add/Update`}),(0,P.jsx)(`div`,{className:`space-y-2`,children:(d.data?.servers??[]).map(e=>(0,P.jsxs)(`div`,{className:`flex items-center justify-between rounded border px-3 py-2`,children:[(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsx)(`div`,{className:`truncate text-sm font-medium`,children:e.name}),(0,P.jsx)(`div`,{className:`truncate text-xs text-muted-foreground font-mono`,children:e.apiUrl})]}),(0,P.jsx)(F,{type:`button`,variant:`ghost`,size:`icon`,onClick:()=>e.id&&et.mutate(e.id),children:(0,P.jsx)(Rn,{className:`h-4 w-4`})})]},e.id))})]}),(0,P.jsxs)(`div`,{className:`space-y-4`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Containerlab`}),(0,P.jsxs)(`div`,{className:`grid gap-2 md:grid-cols-2`,children:[(0,P.jsx)(K,{placeholder:`https://clab.example.com`,value:ve,onChange:e=>ye(e.target.value)}),(0,P.jsx)(K,{placeholder:`API username (optional)`,value:Se,onChange:e=>Ce(e.target.value)}),(0,P.jsx)(K,{placeholder:`API password (optional)`,type:`password`,value:we,onChange:e=>Te(e.target.value)}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(`input`,{type:`checkbox`,checked:be,onChange:e=>xe(e.target.checked)}),(0,P.jsx)(`div`,{className:`text-sm`,children:`Skip TLS verify`})]})]}),(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>tt.mutate(),disabled:!ve.trim()||tt.isPending,children:`Add/Update`}),(0,P.jsx)(`div`,{className:`space-y-2`,children:(p.data?.servers??[]).map(e=>(0,P.jsxs)(`div`,{className:`flex items-center justify-between rounded border px-3 py-2`,children:[(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsx)(`div`,{className:`truncate text-sm font-medium`,children:e.name}),(0,P.jsx)(`div`,{className:`truncate text-xs text-muted-foreground font-mono`,children:e.apiUrl})]}),(0,P.jsx)(F,{type:`button`,variant:`ghost`,size:`icon`,onClick:()=>e.id&&nt.mutate(e.id),children:(0,P.jsx)(Rn,{className:`h-4 w-4`})})]},e.id))})]}),(0,P.jsxs)(`div`,{className:`space-y-4`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`EVE-NG`}),(0,P.jsxs)(`div`,{className:`grid gap-2 md:grid-cols-2`,children:[(0,P.jsx)(K,{placeholder:`https://eve.example.com/api`,value:Ee,onChange:e=>De(e.target.value)}),(0,P.jsx)(K,{placeholder:`Web URL (optional)`,value:Oe,onChange:e=>ke(e.target.value)}),(0,P.jsx)(K,{placeholder:`API username (optional)`,value:je,onChange:e=>Me(e.target.value)}),(0,P.jsx)(K,{placeholder:`API password (optional)`,type:`password`,value:Ne,onChange:e=>Pe(e.target.value)}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(`input`,{type:`checkbox`,checked:A,onChange:e=>Ae(e.target.checked)}),(0,P.jsx)(`div`,{className:`text-sm`,children:`Skip TLS verify`})]})]}),(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>rt.mutate(),disabled:!Ee.trim()||rt.isPending,children:`Add/Update`}),(0,P.jsx)(`div`,{className:`space-y-2`,children:(f.data?.servers??[]).map(e=>(0,P.jsxs)(`div`,{className:`flex items-center justify-between rounded border px-3 py-2`,children:[(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsx)(`div`,{className:`truncate text-sm font-medium`,children:e.name}),(0,P.jsx)(`div`,{className:`truncate text-xs text-muted-foreground font-mono`,children:e.apiUrl})]}),(0,P.jsx)(F,{type:`button`,variant:`ghost`,size:`icon`,onClick:()=>e.id&&it.mutate(e.id),children:(0,P.jsx)(Rn,{className:`h-4 w-4`})})]},e.id))})]})]})]})]})}const Fc=t(`/dashboard/servicenow`)({component:Ic});function Ic(){let e=c(),t=H.userServiceNowConfig(),n=H.userServiceNowPdiStatus(),a=H.userServiceNowSchemaStatus(),o=H.userForwardCollectorConfigs(),s=i({queryKey:t,queryFn:Kr,retry:!1}).data,[l,u]=(0,M.useState)(``),[d,f]=(0,M.useState)(``),[p,m]=(0,M.useState)(``),[h,g]=(0,M.useState)(``),[_,v]=(0,M.useState)(`collector`),[y,b]=(0,M.useState)(``),[ee,te]=(0,M.useState)(``),[x,S]=(0,M.useState)(!0);(0,M.useEffect)(()=>{s&&(u(s.instanceUrl??``),f(s.adminUsername??``),g(s.forwardCollectorConfigId??``),v(s.forwardCollectorConfigId?`collector`:s.forwardUsername?`custom`:`collector`),b(s.forwardUsername??``))},[s]);let C=i({queryKey:o,queryFn:ua,retry:!1,staleTime:3e4}),w=(0,M.useMemo)(()=>C.data?.collectors??[],[C.data]);(0,M.useEffect)(()=>{if(_!==`collector`||h)return;let e=w[0];e?.id&&g(e.id)},[s,w,h,_]);let ne=i({queryKey:n,queryFn:Yr,enabled:!!s?.configured,retry:!1,refetchOnWindowFocus:!0,staleTime:0,refetchInterval:e=>{if(document.visibilityState===`hidden`)return!1;let t=e.state.data?.status??``;return t===`awake`?12e4:t===`sleeping`||t===`waking`||t===`unreachable`?3e4:6e4}}),T=i({queryKey:a,queryFn:Xr,enabled:!!s?.configured,retry:!1,refetchOnWindowFocus:!0,staleTime:0}),re=(0,M.useMemo)(()=>(T.data?.missing??[]).some(e=>e.startsWith(`table:`)),[T.data?.missing]),ie=(0,M.useMemo)(()=>{let e=(l||s?.instanceUrl||``).trim().replace(/\/+$/,``);return e?`${e}/sp?id=connectivity_ticket`:``},[s?.instanceUrl,l]),ae=r({mutationFn:async()=>Zr(),onSuccess:async()=>{j.success(`Wake requested`),await e.invalidateQueries({queryKey:n})},onError:e=>j.error(`Failed to wake PDI`,{description:e.message})}),E=r({mutationFn:async()=>{if(!l.trim())throw Error(`ServiceNow instance URL is required`);if(!d.trim())throw Error(`ServiceNow admin username is required`);let e=_===`collector`;if(e){if(!h.trim())throw Error(`Select a Forward collector (or choose Custom)`)}else if(!y.trim())throw Error(`Forward username is required`);return qr({instanceUrl:l.trim(),adminUsername:d.trim(),adminPassword:p,forwardCollectorConfigId:e?h.trim():``,forwardUsername:e?``:y.trim(),forwardPassword:e?``:ee})},onSuccess:async()=>{j.success(`Saved ServiceNow settings`),m(``),te(``),await e.invalidateQueries({queryKey:t}),await e.invalidateQueries({queryKey:n}),await e.invalidateQueries({queryKey:a}),x&&O.mutate()},onError:e=>j.error(`Failed to save ServiceNow settings`,{description:e.message})}),D=r({mutationFn:async()=>Jr(),onSuccess:async r=>{r.installed?j.success(`ServiceNow demo installed`):j.error(`ServiceNow install failed`,{description:r.message}),await e.invalidateQueries({queryKey:t}),await e.invalidateQueries({queryKey:n}),await e.invalidateQueries({queryKey:a})},onError:e=>j.error(`Failed to install ServiceNow demo`,{description:e.message})}),O=r({mutationFn:async()=>Qr(),onSuccess:async e=>{e.configured?j.success(`Configured Forward ticketing integration`):j.error(`Failed to configure Forward`,{description:e.message})},onError:e=>j.error(`Failed to configure Forward`,{description:e.message})});return(0,P.jsxs)(`div`,{className:`p-6 space-y-6`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`h1`,{className:`text-2xl font-bold`,children:`ServiceNow`}),(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground mt-1`,children:`Install the Forward Connectivity Ticket demo into a ServiceNow PDI. ServiceNow calls Forward SaaS directly; Skyforge only installs and configures the app.`})]}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Quick links`}),(0,P.jsx)(B,{children:`Create a ServiceNow PDI (manual step).`})]}),(0,P.jsxs)(V,{className:`space-y-2`,children:[(0,P.jsx)(`a`,{className:`text-sm underline`,href:`https://developer.servicenow.com/dev.do#!/guides/now-platform/pdi-guide/obtaining-a-pdi`,target:`_blank`,rel:`noreferrer`,children:`Create a Personal Developer Instance (PDI)`}),(0,P.jsx)(`a`,{className:`text-sm underline`,href:`/dashboard/docs/servicenow`,target:`_blank`,rel:`noreferrer`,children:`Open Skyforge ServiceNow docs`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Create and wake your PDI in the ServiceNow portal; then paste the instance URL and admin creds below.`}),ie?(0,P.jsx)(`a`,{className:`text-sm underline`,href:ie,target:`_blank`,rel:`noreferrer`,children:`Open the demo portal page (after install)`}):null,s?.configured&&(l||s?.instanceUrl)?(0,P.jsx)(`a`,{className:`text-sm underline`,href:`${(l||s?.instanceUrl||``).replace(/\/+$/,``)}/sys_app_application_list.do?sysparm_query=title=Forward%20Connectivity%20Ticket`,target:`_blank`,rel:`noreferrer`,children:`Find the demo app menu in ServiceNow (after install)`}):null]})]}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`PDI status`}),(0,P.jsx)(B,{children:`ServiceNow PDIs can sleep after inactivity. Skyforge can detect this and attempt to wake the instance.`})]}),(0,P.jsxs)(V,{className:`space-y-3`,children:[(0,P.jsx)(`div`,{className:`text-sm`,children:s?.configured?(0,P.jsxs)(P.Fragment,{children:[`Status:`,` `,(0,P.jsx)(`span`,{className:`font-medium`,children:ne.data?.status??(ne.isFetching?`checking`:`unknown`)}),ne.data?.httpStatus?` (HTTP ${ne.data.httpStatus})`:``,ne.data?.detail?`  ${ne.data.detail}`:``]}):(0,P.jsx)(`span`,{className:`text-muted-foreground`,children:`Save configuration first.`})}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(F,{variant:`secondary`,onClick:()=>void ne.refetch(),disabled:!s?.configured||ne.isFetching||ae.isPending,children:`Check now`}),(0,P.jsx)(F,{variant:`secondary`,onClick:()=>ae.mutate(),disabled:!s?.configured||ae.isPending,children:`Wake up`})]})]})]}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Schema status`}),(0,P.jsx)(B,{children:`The demo requires two custom tables. Create the tables once in the PDI; Skyforge can auto-create the required fields and choice lists when you install the demo app.`})]}),(0,P.jsxs)(V,{className:`space-y-3`,children:[(0,P.jsx)(`div`,{className:`text-sm`,children:s?.configured?(0,P.jsxs)(P.Fragment,{children:[`Status:`,` `,(0,P.jsx)(`span`,{className:`font-medium`,children:T.data?.status??(T.isFetching?`checking`:`unknown`)}),T.data?.checkedAt?` (checked ${T.data.checkedAt})`:``,T.data?.detail?`  ${T.data.detail}`:``]}):(0,P.jsx)(`span`,{className:`text-muted-foreground`,children:`Save configuration first.`})}),s?.configured&&l?(0,P.jsxs)(`div`,{className:`text-sm text-muted-foreground`,children:[`Portal page:`,` `,(0,P.jsx)(`a`,{className:`underline`,href:`${l.replace(/\/+$/,``)}/sp?id=connectivity_ticket`,target:`_blank`,rel:`noreferrer`,children:`/sp?id=connectivity_ticket`})]}):null,s?.configured&&l?(0,P.jsxs)(`div`,{className:`text-sm text-muted-foreground`,children:[`Find records:`,` `,(0,P.jsx)(`a`,{className:`underline`,href:`${l.replace(/\/+$/,``)}/sp_widget_list.do?sysparm_query=name=Connectivity%20Ticket%20Analyzer`,target:`_blank`,rel:`noreferrer`,children:`widget`}),`  `,(0,P.jsx)(`a`,{className:`underline`,href:`${l.replace(/\/+$/,``)}/sp_page_list.do?sysparm_query=id=connectivity_ticket`,target:`_blank`,rel:`noreferrer`,children:`page`}),`  `,(0,P.jsx)(`a`,{className:`underline`,href:`${l.replace(/\/+$/,``)}/sys_rest_message_list.do?sysparm_query=name=Forward%20API`,target:`_blank`,rel:`noreferrer`,children:`REST message`})]}):null,T.data?.status===`missing`&&T.data.missing?.length?(0,P.jsxs)(`div`,{className:`rounded-md border p-3 bg-muted/30`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground mb-2`,children:`Missing items:`}),re?(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground mb-2`,children:[`Create the missing `,(0,P.jsx)(`span`,{className:`font-medium`,children:`tables`}),` `,`in ServiceNow first; then click`,` `,(0,P.jsx)(`span`,{className:`font-medium`,children:`Install demo app`}),` to let Skyforge auto-create the rest.`]}):(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground mb-2`,children:[`Click `,(0,P.jsx)(`span`,{className:`font-medium`,children:`Install demo app`}),` to let Skyforge auto-create these fields/choices.`]}),(0,P.jsx)(`ul`,{className:`text-xs font-mono space-y-1`,children:T.data.missing.map(e=>(0,P.jsxs)(`li`,{children:[`- `,e]},e))})]}):null,(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(F,{variant:`secondary`,onClick:()=>void T.refetch(),disabled:!s?.configured||T.isFetching,children:`Check schema`}),(0,P.jsx)(`a`,{className:`text-sm underline text-muted-foreground`,href:`/dashboard/docs/servicenow`,target:`_blank`,rel:`noreferrer`,children:`Docs`})]})]})]}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Configuration`}),(0,P.jsx)(B,{children:`Skyforge uses ServiceNow admin creds to install/configure. Forward creds are stored in ServiceNow as a Basic Auth credential for the demo REST Message.`})]}),(0,P.jsxs)(V,{className:`space-y-6`,children:[(0,P.jsxs)(`div`,{className:`grid gap-4 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(G,{children:`ServiceNow instance URL`}),(0,P.jsx)(K,{value:l,onChange:e=>u(e.target.value),placeholder:`https://dev12345.service-now.com`})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(G,{children:`ServiceNow admin username`}),(0,P.jsx)(K,{value:d,onChange:e=>f(e.target.value),placeholder:`admin`})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(G,{children:`ServiceNow admin password`}),(0,P.jsx)(K,{type:`password`,value:p,onChange:e=>m(e.target.value),placeholder:s?.hasAdminPassword?`(leave blank to keep stored)`:``})]})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(G,{children:`Forward credentials`}),(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Uses Forward SaaS (`,(0,P.jsx)(`code`,{children:`https://fwd.app`}),`).`]}),(0,P.jsxs)(q,{value:_===`custom`?`custom`:h||``,onValueChange:e=>{if(e===`custom`){v(`custom`),g(``);return}v(`collector`),g(e)},children:[(0,P.jsx)(Y,{className:`w-full`,children:(0,P.jsx)(J,{placeholder:`Select a collector`})}),(0,P.jsxs)(X,{children:[w.map(e=>(0,P.jsx)(Z,{value:e.id,children:e.name},e.id)),(0,P.jsx)(Z,{value:`custom`,children:`Custom`})]})]})]}),_===`custom`?(0,P.jsxs)(`div`,{className:`grid gap-4 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(G,{children:`Forward username`}),(0,P.jsx)(K,{value:y,onChange:e=>b(e.target.value),placeholder:`you@example.com`})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(G,{children:`Forward password`}),(0,P.jsx)(K,{type:`password`,value:ee,onChange:e=>te(e.target.value),placeholder:s?.hasForwardPassword?`(leave blank to keep stored)`:``})]})]}):null,(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(G,{children:`Forward integration`}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(ec,{id:`snow-configure-ticketing-on-save`,checked:x,onCheckedChange:e=>S(!!e)}),(0,P.jsx)(G,{htmlFor:`snow-configure-ticketing-on-save`,className:`font-normal text-sm`,children:`Configure Forward ticketing integration on save`})]}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Configures Forward SaaS to auto-create and auto-update incidents in this ServiceNow instance.`})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(F,{onClick:()=>E.mutate(),disabled:E.isPending||D.isPending,children:`Save`}),(0,P.jsx)(F,{variant:`secondary`,onClick:()=>D.mutate(),disabled:D.isPending||E.isPending||!s?.configured||re,children:`Install demo app`}),ie?(0,P.jsx)(F,{variant:`outline`,asChild:!0,disabled:!s?.configured||re,children:(0,P.jsx)(`a`,{href:ie,target:`_blank`,rel:`noreferrer`,children:`Open in ServiceNow`})}):null,(0,P.jsx)(F,{variant:`secondary`,onClick:()=>O.mutate(),disabled:O.isPending||E.isPending||!s?.configured,children:`Configure Forward (ticketing)`}),(0,P.jsx)(`a`,{className:`text-sm underline text-muted-foreground ml-2`,href:`/dashboard/docs/servicenow`,target:`_blank`,rel:`noreferrer`,children:`Docs`}),s?.lastInstallStatus?(0,P.jsxs)(`div`,{className:`text-sm text-muted-foreground`,children:[`Status: `,s.lastInstallStatus,s.lastInstallError?` (${s.lastInstallError})`:``]}):null]})]})]})]})}const Lc=t(`/dashboard/s3`)({component:Rc});function Rc(){let[e,t]=(0,M.useState)(``),n=i({queryKey:H.userArtifacts(e||``),queryFn:async()=>va({prefix:e||void 0}),staleTime:1e4}),r=n.data?.items??[],a=(0,M.useMemo)(()=>[{id:`object`,header:`Object`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.key})},{id:`actions`,header:`Actions`,width:300,align:`right`,cell:e=>(0,P.jsxs)(`div`,{className:`flex justify-end gap-2`,children:[e.key.toLowerCase().endsWith(`.json`)&&(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:async()=>{try{let t=await ya(e.key),n=atob(t.fileData),r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);let i=new TextDecoder().decode(r),a=JSON.stringify(JSON.parse(i),null,2),o=new Blob([a],{type:`application/json`}),s=URL.createObjectURL(o);window.open(s,`_blank`,`noopener,noreferrer`),window.setTimeout(()=>URL.revokeObjectURL(s),1e4)}catch(e){j.error(`View failed`,{description:e.message})}},children:[(0,P.jsx)(Ge,{className:`mr-2 h-3 w-3`}),`View`]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:async()=>{try{let t=await ya(e.key),n=atob(t.fileData),r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);let i=new Blob([r]),a=URL.createObjectURL(i),o=document.createElement(`a`);o.href=a,o.download=e.key.split(`/`).pop()||`artifact`,document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(a)}catch(e){j.error(`Download failed`,{description:e.message})}},children:[(0,P.jsx)(Ae,{className:`mr-2 h-3 w-3`}),`Download`]}),(0,P.jsxs)(F,{variant:`destructive`,size:`sm`,onClick:async()=>{if(confirm(`Delete ${e.key}?`))try{await xa(e.key),j.success(`Deleted`,{description:e.key}),await n.refetch()}catch(e){j.error(`Delete failed`,{description:e.message})}},children:[(0,P.jsx)(Rn,{className:`mr-2 h-3 w-3`}),`Delete`]})]})}],[n.refetch]),o=(0,P.jsx)(`div`,{className:`p-4 border-b flex flex-col gap-3 md:flex-row md:items-center md:justify-between`,children:(0,P.jsxs)(`div`,{className:`flex flex-col gap-2 sm:flex-row sm:items-center`,children:[(0,P.jsx)(K,{placeholder:`Prefix (e.g. topology/)`,value:e,onChange:e=>t(e.target.value),className:`w-[260px]`}),(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>n.refetch(),children:`Refresh`}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:async()=>{let e=window.prompt(`Folder prefix (e.g. uploads/)`);if(e)try{await Sa(e),j.success(`Folder created`),await n.refetch()}catch(e){j.error(`Create folder failed`,{description:e.message})}},children:[(0,P.jsx)(vt,{className:`mr-2 h-3 w-3`}),`Folder`]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>{let t=document.createElement(`input`);t.type=`file`,t.onchange=()=>{let r=t.files?.[0];r&&(async()=>{try{let t=new Uint8Array(await r.arrayBuffer()),i=``,a=32*1024;for(let e=0;e<t.length;e+=a){let n=t.subarray(e,e+a);i+=btoa(String.fromCharCode(...n))}let o=(e||``)+r.name;await ba({key:o,contentBase64:i,contentType:r.type||`application/octet-stream`}),j.success(`Uploaded`,{description:o}),await n.refetch()}catch(e){j.error(`Upload failed`,{description:e.message})}})()},t.click()},children:[(0,P.jsx)(me,{className:`mr-2 h-3 w-3`}),`Upload`]})]})});return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsx)(L,{variant:`glass`,children:(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`S3`}),(0,P.jsx)(B,{children:`User-scope artifacts and generated files (backed by the platform object store).`})]})}),(0,P.jsx)(L,{children:(0,P.jsx)(V,{className:`p-0`,children:n.isLoading?(0,P.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,P.jsx)(U,{className:`h-12 w-full`}),(0,P.jsx)(U,{className:`h-12 w-full`}),(0,P.jsx)(U,{className:`h-12 w-full`})]}):(0,P.jsxs)(`div`,{children:[o,n.isError?(0,P.jsx)(`div`,{className:`p-8 text-center text-destructive`,children:`Failed to list objects.`}):r.length===0?(0,P.jsx)(`div`,{className:`p-6`,children:(0,P.jsx)(Cs,{icon:Ft,title:`No objects found`,description:`No artifacts found for this user scope.`})}):(0,P.jsx)(Ss,{columns:a,rows:r,getRowId:e=>e.key,maxHeightClassName:`max-h-[60vh]`,minWidthClassName:`min-w-[900px]`})]})})})]})}const zc=t(`/dashboard/integrations`)({component:Bc});function Bc(){let e=i({queryKey:H.userServiceNowConfig(),queryFn:Kr,retry:!1,staleTime:1e4}),t=i({queryKey:H.userForwardCollectorConfigs(),queryFn:ua,retry:!1,staleTime:1e4}),n=t.data?.collectors?.length??0,r=n>0;return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`h1`,{className:`text-2xl font-bold`,children:`Integrations`}),(0,P.jsx)(`p`,{className:`mt-1 text-sm text-muted-foreground`,children:`Connect optional tools and services that enhance Skyforge workflows.`})]}),(0,P.jsxs)(`div`,{className:`grid gap-4 md:grid-cols-2`,children:[(0,P.jsxs)(L,{variant:`glass`,children:[(0,P.jsx)(R,{children:(0,P.jsxs)(z,{className:`flex items-center gap-2`,children:[(0,P.jsx)(b,{className:`h-5 w-5`}),`Forward`]})}),(0,P.jsxs)(V,{className:`space-y-3 text-sm`,children:[(0,P.jsx)(`div`,{className:`text-muted-foreground`,children:t.isLoading?`Loading`:r?`${n} collector(s) configured`:`No collectors configured`}),(0,P.jsxs)(`div`,{className:`flex gap-2`,children:[(0,P.jsx)(F,{asChild:!0,size:`sm`,children:(0,P.jsx)(p,{to:`/dashboard/forward/collector`,children:`Collector`})}),(0,P.jsx)(F,{asChild:!0,size:`sm`,variant:`secondary`,children:(0,P.jsx)(p,{to:`/dashboard/forward/credentials`,children:`Credentials`})})]})]})]}),(0,P.jsxs)(L,{variant:`glass`,children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{children:`ServiceNow`})}),(0,P.jsxs)(V,{className:`space-y-3 text-sm`,children:[(0,P.jsx)(`div`,{className:`text-muted-foreground`,children:e.isLoading?`Loading`:e.data?.configured?`Configured (${e.data.instanceUrl??`instance`})`:`Not configured`}),(0,P.jsxs)(`div`,{className:`flex gap-2`,children:[(0,P.jsx)(F,{asChild:!0,size:`sm`,children:(0,P.jsx)(p,{to:`/dashboard/servicenow`,children:`Open`})}),(0,P.jsx)(F,{asChild:!0,size:`sm`,variant:`secondary`,children:(0,P.jsx)(p,{to:`/dashboard/docs/$slug`,params:{slug:`servicenow`},children:`Docs`})})]})]})]}),(0,P.jsxs)(L,{variant:`glass`,children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{children:`Advanced settings`})}),(0,P.jsxs)(V,{className:`space-y-3 text-sm`,children:[(0,P.jsx)(`div`,{className:`text-muted-foreground`,children:`Cloud creds, BYOL servers, defaults, and external template repos.`}),(0,P.jsxs)(`div`,{className:`flex flex-wrap gap-2`,children:[(0,P.jsx)(F,{asChild:!0,size:`sm`,variant:`secondary`,children:(0,P.jsx)(p,{to:`/dashboard/settings`,children:`Open My Settings`})}),(0,P.jsx)(F,{asChild:!0,size:`sm`,variant:`secondary`,children:(0,P.jsxs)(`a`,{href:`/dashboard/docs/getting-started`,children:[`Getting started`,` `,(0,P.jsx)(ae,{className:`ml-1 inline h-4 w-4`})]})})]})]})]})]})]})}const Vc=t(`/admin/settings`)({component:Hc});function Hc(){let e=i({queryKey:H.session(),queryFn:Ir,staleTime:3e4,retry:!1}),t=!!e.data?.isAdmin,[n,a]=(0,M.useState)(`200`),o=i({queryKey:H.adminAudit(n),queryFn:()=>Ma({limit:n}),enabled:t,staleTime:15e3,retry:!1}),s=i({queryKey:H.adminConfig(),queryFn:ja,enabled:t,staleTime:15e3,retry:!1}),c=i({queryKey:H.adminImpersonateStatus(),queryFn:Na,enabled:t,staleTime:5e3,retry:!1}),l=r({mutationFn:async e=>Ia({limit:e}),onSuccess:e=>{j.success(`Reconciled queued tasks`,{description:`Considered ${e.consideredTasks}, republished ${e.republished}, errors ${e.publishErrors}`})},onError:e=>{j.error(`Failed to reconcile queued tasks`,{description:e.message})}}),u=r({mutationFn:async e=>La({limit:e.limit,hardMaxRuntimeMinutes:e.hardMaxRuntimeMinutes,maxIdleMinutes:e.maxIdleMinutes}),onSuccess:e=>{j.success(`Reconciled running tasks`,{description:`Considered ${e.consideredTasks}, marked failed ${e.markedFailed}, errors ${e.finishErrors}`})},onError:e=>{j.error(`Failed to reconcile running tasks`,{description:e.message})}}),[d,f]=(0,M.useState)(``),p=r({mutationFn:async()=>Pa({username:d}),onSuccess:()=>{j.success(`Impersonation started`),c.refetch(),window.location.reload()},onError:e=>{j.error(`Failed to impersonate`,{description:e.message})}}),m=r({mutationFn:async()=>Fa(),onSuccess:()=>{j.success(`Impersonation stopped`),c.refetch(),window.location.reload()},onError:e=>{j.error(`Failed to stop impersonation`,{description:e.message})}}),[h,g]=(0,M.useState)(``),_=r({mutationFn:async()=>Ra({username:h,confirm:h}),onSuccess:e=>{j.success(`User purged`,{description:`Deleted user scopes: ${e.deletedScopes}`})},onError:e=>{j.error(`Failed to purge user`,{description:e.message})}}),v=(0,M.useMemo)(()=>[{id:`createdAt`,header:`Time`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs text-muted-foreground`,children:e.createdAt}),width:220},{id:`actor`,header:`Actor`,cell:e=>(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(`span`,{className:`font-medium`,children:e.actorUsername}),e.actorIsAdmin?(0,P.jsx)(W,{variant:`secondary`,children:`admin`}):null,e.impersonatedUsername?(0,P.jsxs)(W,{variant:`outline`,children:[`as `,e.impersonatedUsername]}):null]}),width:260},{id:`action`,header:`Action`,cell:e=>e.action,width:260},{id:`userId`,header:`User ID`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs text-muted-foreground`,children:String(e.scopeId??e.actorUsername??``)}),width:220},{id:`details`,header:`Details`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs text-muted-foreground`,children:e.details})}],[]);return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsx)(L,{variant:`glass`,children:(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`System settings`}),(0,P.jsx)(B,{children:`Admin-only settings for Skyforge.`})]})}),!t&&(0,P.jsx)(L,{variant:`danger`,children:(0,P.jsx)(V,{className:`pt-6`,children:(0,P.jsx)(`div`,{className:`text-center font-medium`,children:`Admin access required.`})})}),t&&(0,P.jsxs)(lc,{defaultValue:`overview`,children:[(0,P.jsxs)(uc,{children:[(0,P.jsx)(dc,{value:`overview`,children:`Overview`}),(0,P.jsx)(dc,{value:`audit`,children:`Audit`}),(0,P.jsx)(dc,{value:`tasks`,children:`Tasks`}),(0,P.jsx)(dc,{value:`users`,children:`Users`})]}),(0,P.jsxs)(fc,{value:`overview`,className:`space-y-6`,children:[(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Effective config`}),(0,P.jsx)(B,{children:`Read-only view of the running server's non-secret Encore config.`})]}),(0,P.jsx)(V,{children:s.isLoading?(0,P.jsx)(U,{className:`h-40 w-full`}):s.data?(0,P.jsxs)(`div`,{className:`space-y-3`,children:[s.data.missing?.length?(0,P.jsxs)(`div`,{className:`rounded-md border border-destructive/40 bg-destructive/10 p-3 text-sm`,children:[(0,P.jsx)(`div`,{className:`font-medium`,children:`Missing config`}),(0,P.jsx)(`ul`,{className:`list-disc pl-5 text-muted-foreground`,children:s.data.missing.map(e=>(0,P.jsx)(`li`,{children:e},e))})]}):null,(0,P.jsx)(`pre`,{className:`max-h-[420px] overflow-auto rounded-md border bg-muted/50 p-3 text-xs`,children:JSON.stringify(s.data,null,2)})]}):(0,P.jsx)(Cs,{title:`No config`,description:`Could not load effective config.`})})]}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Impersonation`}),(0,P.jsx)(B,{children:`Impersonate another user to reproduce issues or verify UX.`})]}),(0,P.jsxs)(V,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,P.jsx)(Ye,{className:`h-5 w-5 text-muted-foreground`}),(0,P.jsxs)(`div`,{className:`text-sm`,children:[(0,P.jsx)(`span`,{className:`font-medium`,children:c.data?.actorUsername||e.data?.username||``}),c.data?.impersonating?(0,P.jsxs)(P.Fragment,{children:[` `,``,` `,(0,P.jsx)(`span`,{className:`font-medium`,children:c.data.effectiveUsername}),(0,P.jsx)(W,{className:`ml-2`,variant:`secondary`,children:`impersonating`})]}):(0,P.jsx)(W,{className:`ml-2`,variant:`outline`,children:`not impersonating`})]})]}),(0,P.jsxs)(`div`,{className:`flex flex-col gap-2 sm:flex-row sm:items-center`,children:[(0,P.jsx)(K,{placeholder:`user@example.com`,value:d,onChange:e=>f(e.target.value)}),(0,P.jsxs)(F,{onClick:()=>p.mutate(),disabled:p.isPending||!d.trim()||c.data?.impersonating,children:[(0,P.jsx)(oe,{className:`mr-2 h-4 w-4`}),`Impersonate`]}),(0,P.jsx)(F,{variant:`outline`,onClick:()=>m.mutate(),disabled:m.isPending||!c.data?.impersonating,children:`Stop`})]})]})]})]}),(0,P.jsx)(fc,{value:`audit`,className:`space-y-6`,children:(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Audit log`}),(0,P.jsx)(B,{children:`Recent admin and user actions.`})]}),(0,P.jsxs)(V,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(`span`,{className:`text-sm text-muted-foreground`,children:`Limit`}),(0,P.jsx)(K,{className:`w-28`,value:n,onChange:e=>a(e.target.value)})]}),(0,P.jsx)(W,{variant:`outline`,children:o.data?.timestamp??``})]}),(0,P.jsx)(Ss,{rows:o.data?.events??[],columns:v,getRowId:e=>String(e.id),isLoading:o.isLoading,emptyText:`No audit events.`,minWidthClassName:`min-w-[1100px]`})]})]})}),(0,P.jsx)(fc,{value:`tasks`,className:`space-y-6`,children:(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Task reconciliation`}),(0,P.jsx)(B,{children:`Manual guardrails for stuck queued/running jobs.`})]}),(0,P.jsxs)(V,{className:`space-y-6`,children:[(0,P.jsxs)(`div`,{className:`flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`div`,{className:`font-medium`,children:`Queued tasks`}),(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Republish missing queue events.`})]}),(0,P.jsx)(F,{variant:`outline`,disabled:l.isPending,onClick:()=>l.mutate(200),children:l.isPending?`Running`:`Reconcile queued`})]}),(0,P.jsxs)(`div`,{className:`flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`div`,{className:`font-medium`,children:`Running tasks`}),(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Mark long-running/no-log tasks failed.`})]}),(0,P.jsx)(F,{variant:`outline`,disabled:u.isPending,onClick:()=>u.mutate({limit:50,hardMaxRuntimeMinutes:720,maxIdleMinutes:120}),children:u.isPending?`Running`:`Reconcile running`})]})]})]})}),(0,P.jsx)(fc,{value:`users`,className:`space-y-6`,children:(0,P.jsxs)(L,{variant:`danger`,children:[(0,P.jsxs)(R,{children:[(0,P.jsxs)(z,{className:`flex items-center gap-2`,children:[(0,P.jsx)(ke,{className:`h-5 w-5`}),`Purge user (dev-only)`]}),(0,P.jsx)(B,{children:`Removes user state and associated user-scope records to rerun first-login bootstrap.`})]}),(0,P.jsxs)(V,{className:`space-y-3`,children:[(0,P.jsx)(K,{placeholder:`user@example.com`,value:h,onChange:e=>g(e.target.value)}),(0,P.jsx)(F,{variant:`destructive`,disabled:!h.trim()||_.isPending,onClick:()=>_.mutate(),children:_.isPending?`Purging`:`Purge user`})]})]})})]})]})}function Uc(e){let t=Number(e);if(!Number.isFinite(t)||t<=0)return``;if(t<60)return`${Math.round(t)}s`;let n=Math.round(t/60);if(n<60)return`${n}m`;let r=Math.round(n/60);return r<48?`${r}h`:`${Math.round(r/24)}d`}var Wc=Jn({q:Un().optional().catch(``),tab:Kn([`policy`,`resources`,`costs`,`usage`]).optional().catch(`policy`)});const Gc=t(`/admin/governance`)({validateSearch:e=>Wc.parse(e),loaderDeps:({search:{q:e,tab:t}})=>({q:e,tab:t}),loader:async({context:{queryClient:e}})=>{(await e.ensureQueryData({queryKey:H.session(),queryFn:Ir,staleTime:3e4,retry:!1}))?.isAdmin&&await Promise.all([e.ensureQueryData({queryKey:H.governancePolicy(),queryFn:za}),e.ensureQueryData({queryKey:H.governanceSummary(),queryFn:Ea}),e.ensureQueryData({queryKey:H.governanceResources(`500`),queryFn:()=>Da({limit:`500`})}),e.ensureQueryData({queryKey:H.governanceCosts(`50`),queryFn:()=>Oa({limit:`50`})}),e.ensureQueryData({queryKey:H.governanceUsage(`500`),queryFn:()=>ka({limit:`500`})})])},component:Kc});function Kc(){let e=c(),t=Gc.useNavigate(),{q:n,tab:a}=Gc.useSearch(),o=!!i({queryKey:H.session(),queryFn:Ir,staleTime:3e4,retry:!1}).data?.isAdmin,s=i({queryKey:H.governanceSummary(),queryFn:Ea,staleTime:3e4,enabled:o}),l=i({queryKey:H.governancePolicy(),queryFn:za,staleTime:3e4,enabled:o,retry:!1}),u=i({queryKey:H.governanceResources(`500`),queryFn:()=>Da({limit:`500`}),staleTime:3e4,enabled:o}),d=i({queryKey:H.governanceCosts(`50`),queryFn:()=>Oa({limit:`50`}),staleTime:3e4,enabled:o}),f=i({queryKey:H.governanceUsage(`500`),queryFn:()=>ka({limit:`500`}),staleTime:3e4,enabled:o}),p=f.data?.usage??[],m=(0,M.useMemo)(()=>{let e=new Map;for(let t of p){if(t.scopeType!==`cluster`)continue;let n=String(t.metric??``);if(!n)continue;let r=e.get(n);if(!r){e.set(n,t);continue}new Date(String(t.collectedAt)).getTime()>new Date(String(r.collectedAt)).getTime()&&e.set(n,t)}return e},[p]),h=(0,M.useMemo)(()=>{let e=new Map;for(let t of p){if(t.scopeType!==`user`)continue;let n=String(t.scopeId??``).trim();if(!n)continue;let r=String(t.metric??``).trim();if(!r)continue;let i=Number(t.value??0),a=String(t.collectedAt??``),o=e.get(n)??{user:n,deploymentsActive:0,deploymentsTotal:0,collectorsTotal:0,tasksRunning:0,lastSeenAt:a};switch(r){case`deployments.active`:o.deploymentsActive=i;break;case`deployments.total`:o.deploymentsTotal=i;break;case`collectors.total`:o.collectorsTotal=i;break;case`tasks.running`:o.tasksRunning=i;break;default:break}new Date(a).getTime()>new Date(o.lastSeenAt).getTime()&&(o.lastSeenAt=a),e.set(n,o)}return Array.from(e.values()).sort((e,t)=>t.deploymentsActive===e.deploymentsActive?t.tasksRunning===e.tasksRunning?e.user.localeCompare(t.user):t.tasksRunning-e.tasksRunning:t.deploymentsActive-e.deploymentsActive)},[p]),g=(0,M.useMemo)(()=>{let e=u.data?.resources??[],t=n?.trim().toLowerCase()||``;return t?e.filter(e=>[e.name,e.resourceId,e.resourceType,e.username,e.owner,e.provider].filter(Boolean).join(` `).toLowerCase().includes(t)):e},[u.data?.resources,n]),_=r({mutationFn:async()=>{await Aa()},onSuccess:async()=>{j.success(`Governance sources synced`,{description:`Resource inventory updated.`}),await Promise.all([e.invalidateQueries({queryKey:H.governanceSummary()}),e.invalidateQueries({queryKey:H.governanceResources(`500`)}),e.invalidateQueries({queryKey:H.governanceCosts(`50`)}),e.invalidateQueries({queryKey:H.governanceUsage(`500`)})])},onError:e=>{j.error(`Failed to sync governance sources`,{description:e.message})}}),[v,b]=(0,M.useState)({maxDeploymentsPerUser:0,maxCollectorsPerUser:0,allowUserByosNetlabServers:!0,allowUserByosContainerlabServers:!0,allowUserExternalTemplateRepos:!0,allowCustomTemplateRepos:!0});(0,M.useEffect)(()=>{l.data?.policy&&b({maxDeploymentsPerUser:l.data.policy.maxDeploymentsPerUser??0,maxCollectorsPerUser:l.data.policy.maxCollectorsPerUser??0,allowUserByosNetlabServers:l.data.policy.allowUserByosNetlabServers??!0,allowUserByosContainerlabServers:l.data.policy.allowUserByosContainerlabServers??!0,allowUserExternalTemplateRepos:l.data.policy.allowUserExternalTemplateRepos??!0,allowCustomTemplateRepos:l.data.policy.allowCustomTemplateRepos??!0})},[l.data?.policy?.maxDeploymentsPerUser,l.data?.policy?.maxCollectorsPerUser,l.data?.policy?.allowUserByosNetlabServers,l.data?.policy?.allowUserByosContainerlabServers,l.data?.policy?.allowUserExternalTemplateRepos,l.data?.policy?.allowCustomTemplateRepos]);let ee=r({mutationFn:async()=>Ba({policy:{maxDeploymentsPerUser:Math.max(0,v.maxDeploymentsPerUser),maxCollectorsPerUser:Math.max(0,v.maxCollectorsPerUser),allowUserByosNetlabServers:!!v.allowUserByosNetlabServers,allowUserByosContainerlabServers:!!v.allowUserByosContainerlabServers,allowUserExternalTemplateRepos:!!v.allowUserExternalTemplateRepos,allowCustomTemplateRepos:!!v.allowCustomTemplateRepos}}),onSuccess:async()=>{j.success(`Governance policy saved`),await e.invalidateQueries({queryKey:H.governancePolicy()})},onError:e=>{j.error(`Failed to save governance policy`,{description:e.message})}}),te=s.data,x=e=>{t({search:t=>({...t,q:e}),replace:!0})};return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsx)(L,{variant:`glass`,children:(0,P.jsx)(R,{children:(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(z,{children:`Governance`}),(0,P.jsx)(B,{children:`Admin-only guardrails, inventory, cost, and usage telemetry.`})]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,disabled:_.isPending||!o,onClick:()=>_.mutate(),children:[(0,P.jsx)(ut,{className:`mr-2 h-4 w-4 ${_.isPending?`animate-spin`:``}`}),_.isPending?`Syncing`:`Sync sources`]})]})})}),!o&&(0,P.jsx)(L,{variant:`danger`,children:(0,P.jsx)(V,{className:`pt-6`,children:(0,P.jsx)(`div`,{className:`text-center font-medium text-destructive`,children:`Admin access required.`})})}),(l.isError||s.isError||u.isError||d.isError||f.isError)&&(0,P.jsx)(L,{variant:`danger`,children:(0,P.jsx)(V,{className:`pt-6`,children:(0,P.jsx)(`div`,{className:`text-center font-medium`,children:`Failed to load governance data.`})})}),s.isLoading?(0,P.jsx)(Ms,{children:[1,2,3,4].map(e=>(0,P.jsxs)(Ns,{className:`h-32`,children:[(0,P.jsx)(U,{className:`h-4 w-24 mb-4`}),(0,P.jsx)(U,{className:`h-8 w-16`})]},e))}):(0,P.jsxs)(Ms,{children:[(0,P.jsx)(Ps,{title:`Resources tracked`,value:String(te?.resourceCount??``),icon:(0,P.jsx)(y,{className:`h-5 w-5`}),gradient:`blue`}),(0,P.jsx)(Ps,{title:`Active resources`,value:String(te?.activeResources??``),icon:(0,P.jsx)(lt,{className:`h-5 w-5`}),gradient:`green`}),(0,P.jsx)(Ps,{title:`Users tracked`,value:String(te?.usersTracked??``),icon:(0,P.jsx)(kt,{className:`h-5 w-5`}),gradient:`purple`}),(0,P.jsx)(Ps,{title:`Last 30d spend`,value:te?`${te.costLast30Days} ${te.costCurrency}`:``,icon:(0,P.jsx)(Wt,{className:`h-5 w-5`}),gradient:`orange`})]}),(0,P.jsxs)(lc,{value:a,onValueChange:e=>{t({search:t=>({...t,tab:e}),replace:!0})},className:`space-y-6`,children:[(0,P.jsxs)(uc,{children:[(0,P.jsxs)(dc,{value:`policy`,className:`gap-2`,children:[(0,P.jsx)(Ft,{className:`h-4 w-4`}),`Policy`]}),(0,P.jsxs)(dc,{value:`resources`,className:`gap-2`,children:[(0,P.jsx)(y,{className:`h-4 w-4`}),`Resources`]}),(0,P.jsxs)(dc,{value:`costs`,className:`gap-2`,children:[(0,P.jsx)(Vt,{className:`h-4 w-4`}),`Financials`]}),(0,P.jsxs)(dc,{value:`usage`,className:`gap-2`,children:[(0,P.jsx)(et,{className:`h-4 w-4`}),`Telemetry`]})]}),(0,P.jsx)(fc,{value:`policy`,className:`space-y-6 animate-in fade-in-50`,children:(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Policy`}),(0,P.jsx)(B,{children:`Optional guardrails. Use 0 for unlimited.`})]}),(0,P.jsxs)(V,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`grid gap-4 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Max deployments per user`}),(0,P.jsx)(K,{inputMode:`numeric`,value:String(v.maxDeploymentsPerUser),onChange:e=>b(t=>({...t,maxDeploymentsPerUser:Number.parseInt(e.target.value||`0`,10)||0}))}),(0,P.jsx)(`p`,{className:`text-xs text-muted-foreground`,children:`Applies when creating new deployment definitions.`})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Max collectors per user`}),(0,P.jsx)(K,{inputMode:`numeric`,value:String(v.maxCollectorsPerUser),onChange:e=>b(t=>({...t,maxCollectorsPerUser:Number.parseInt(e.target.value||`0`,10)||0}))}),(0,P.jsx)(`p`,{className:`text-xs text-muted-foreground`,children:`Applies when creating in-cluster Forward collectors.`})]})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3 space-y-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Feature access`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Global toggles for user-scoped integrations. Admin users are not restricted by these flags.`}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between rounded-md border p-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`User BYOS Netlab servers`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:"Allows using user-scoped Netlab BYOS servers (serverRef = `user:...`)."})]}),(0,P.jsx)(nc,{checked:v.allowUserByosNetlabServers,onCheckedChange:e=>b(t=>({...t,allowUserByosNetlabServers:!!e})),disabled:!o})]}),(0,P.jsxs)(`div`,{className:`flex items-center justify-between rounded-md border p-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`User BYOS Containerlab servers`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:"Allows using user-scoped Containerlab BYOS servers (serverRef = `user:...`)."})]}),(0,P.jsx)(nc,{checked:v.allowUserByosContainerlabServers,onCheckedChange:e=>b(t=>({...t,allowUserByosContainerlabServers:!!e})),disabled:!o})]}),(0,P.jsxs)(`div`,{className:`flex items-center justify-between rounded-md border p-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`User external template repos`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:"Allows `templateSource=external` using repos configured in user settings."})]}),(0,P.jsx)(nc,{checked:v.allowUserExternalTemplateRepos,onCheckedChange:e=>b(t=>({...t,allowUserExternalTemplateRepos:!!e})),disabled:!o})]}),(0,P.jsxs)(`div`,{className:`flex items-center justify-between rounded-md border p-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Custom template repos`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:"Allows `templateSource=custom`. Keep disabled unless you trust users to reference safe repos."})]}),(0,P.jsx)(nc,{checked:v.allowCustomTemplateRepos,onCheckedChange:e=>b(t=>({...t,allowCustomTemplateRepos:!!e})),disabled:!o})]})]})]}),(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:l.data?.retrievedAt?`Loaded ${l.data.retrievedAt}`:``}),(0,P.jsx)(F,{onClick:()=>ee.mutate(),disabled:ee.isPending||!o,children:ee.isPending?`Saving`:`Save policy`})]})]})]})}),(0,P.jsx)(fc,{value:`resources`,className:`space-y-6 animate-in fade-in-50`,children:(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsxs)(`div`,{className:`flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between`,children:[(0,P.jsx)(z,{children:`Resource Inventory`}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(`div`,{className:`relative`,children:[(0,P.jsx)(un,{className:`absolute left-2 top-2.5 h-4 w-4 text-muted-foreground`}),(0,P.jsx)(K,{className:`pl-8 w-full sm:w-[300px]`,placeholder:`Search resources`,value:n||``,onChange:e=>x(e.target.value)})]}),!u.isLoading&&(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground whitespace-nowrap hidden sm:block`,children:[g.length,` shown`]})]})]})}),(0,P.jsx)(V,{children:u.isLoading?(0,P.jsxs)(`div`,{className:`space-y-4`,children:[(0,P.jsx)(U,{className:`h-10 w-full`}),(0,P.jsx)(U,{className:`h-10 w-full`}),(0,P.jsx)(U,{className:`h-10 w-full`})]}):g.length===0?(0,P.jsx)(Cs,{icon:Ft,title:`No resources found`,description:`No resources match your search criteria.`}):(0,P.jsx)(Ss,{columns:[{id:`name`,header:`Name`,width:`minmax(220px, 1fr)`,cell:e=>(0,P.jsx)(`span`,{className:`font-medium`,children:e.name})},{id:`provider`,header:`Provider`,width:140,cell:e=>e.provider},{id:`type`,header:`Type`,width:160,cell:e=>e.resourceType},{id:`userScope`,header:`User Scope`,width:200,cell:e=>e.username},{id:`owner`,header:`Owner`,width:160,cell:e=>e.owner},{id:`status`,header:`Status`,width:120,cell:e=>(0,P.jsx)(W,{variant:e.status===`active`?`default`:`secondary`,children:e.status??`unknown`})}],rows:g.slice(0,500),getRowId:e=>String(e.resourceId),maxHeightClassName:`max-h-[60vh]`,minWidthClassName:`min-w-[1100px]`})})]})}),(0,P.jsx)(fc,{value:`costs`,className:`space-y-6 animate-in fade-in-50`,children:(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Cost Snapshots`}),(0,P.jsx)(B,{children:`Historical spend data per provider.`})]}),(0,P.jsx)(V,{children:d.isLoading?(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(U,{className:`h-12 w-full`}),(0,P.jsx)(U,{className:`h-12 w-full`})]}):(d.data?.costs??[]).length===0?(0,P.jsx)(Cs,{icon:Vt,title:`No cost data`,description:`No financial snapshots available.`}):(0,P.jsx)(Ss,{columns:[{id:`provider`,header:`Provider`,width:180,cell:e=>(0,P.jsx)(`span`,{className:`font-medium`,children:e.provider})},{id:`currency`,header:`Currency`,width:120,cell:e=>e.currency},{id:`amount`,header:`Amount`,width:140,cell:e=>e.amount},{id:`periodEnd`,header:`Period End`,width:200,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-muted-foreground`,children:e.periodEnd})}],rows:(d.data?.costs??[]).slice(0,50),getRowId:e=>`${e.provider}:${e.periodEnd}:${e.amount}`,maxHeightClassName:`max-h-[50vh]`,minWidthClassName:`min-w-[900px]`})})]})}),(0,P.jsx)(fc,{value:`usage`,className:`space-y-6 animate-in fade-in-50`,children:(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Usage Telemetry`}),(0,P.jsx)(B,{children:`Lightweight snapshots of cluster load and user activity (no Prometheus).`})]}),(0,P.jsx)(V,{children:f.isLoading?(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(U,{className:`h-12 w-full`}),(0,P.jsx)(U,{className:`h-12 w-full`})]}):(f.data?.usage??[]).length===0?(0,P.jsx)(Cs,{icon:et,title:`No usage data`,description:`No telemetry snapshots available.`}):(0,P.jsxs)(`div`,{className:`space-y-6`,children:[(0,P.jsxs)(Ms,{children:[(0,P.jsx)(Ps,{title:`CPU p95`,value:m.get(`node.cpu_active.p95`)?.value??``,subtitle:`Last snapshot`,icon:(0,P.jsx)(lt,{className:`h-4 w-4`})}),(0,P.jsx)(Ps,{title:`Mem p95`,value:m.get(`node.mem_used.p95`)?.value??``,subtitle:`Last snapshot`,icon:(0,P.jsx)(kt,{className:`h-4 w-4`})}),(0,P.jsx)(Ps,{title:`Disk p95`,value:m.get(`node.disk_used.p95`)?.value??``,subtitle:`Last snapshot`,icon:(0,P.jsx)(y,{className:`h-4 w-4`})}),(0,P.jsx)(Ps,{title:`Active users (24h)`,value:m.get(`users.active_24h`)?.value??``,subtitle:`Distinct users`,icon:(0,P.jsx)(Ft,{className:`h-4 w-4`})}),(0,P.jsx)(Ps,{title:`Active deployments`,value:m.get(`deployments.active`)?.value??``,subtitle:`Last snapshot`,icon:(0,P.jsx)(lt,{className:`h-4 w-4`}),gradient:`green`}),(0,P.jsx)(Ps,{title:`Queued tasks`,value:m.get(`tasks.queued`)?.value??``,subtitle:`Oldest: ${Uc(m.get(`tasks.oldest_queued_age_seconds`)?.value)}`,icon:(0,P.jsx)(O,{className:`h-4 w-4`}),gradient:`orange`}),(0,P.jsx)(Ps,{title:`Pods`,value:m.get(`k8s.pods.total`)?.value??``,subtitle:`Pending: ${m.get(`k8s.pods.pending`)?.value??``}`,icon:(0,P.jsx)(ce,{className:`h-4 w-4`}),gradient:`purple`}),(0,P.jsx)(Ps,{title:`User-scope pods`,value:m.get(`k8s.pods.ws.total`)?.value??``,subtitle:`Pending: ${m.get(`k8s.pods.ws.pending`)?.value??``}`,icon:(0,P.jsx)(ce,{className:`h-4 w-4`}),gradient:`purple`}),(0,P.jsx)(Ps,{title:`User namespaces`,value:m.get(`k8s.namespaces.ws`)?.value??``,subtitle:`All namespaces: ${m.get(`k8s.namespaces.total`)?.value??``}`,icon:(0,P.jsx)(ce,{className:`h-4 w-4`}),gradient:`purple`})]}),(0,P.jsxs)(L,{variant:`glass`,children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{className:`text-base`,children:`Top Users`}),(0,P.jsx)(B,{children:`Latest per-user activity snapshots (sorted by active deployments).`})]}),(0,P.jsx)(V,{children:h.length===0?(0,P.jsx)(Cs,{icon:et,title:`No user activity`,description:`No per-user snapshots available yet.`}):(0,P.jsx)(Ss,{columns:[{id:`user`,header:`User`,width:240,cell:e=>(0,P.jsx)(`span`,{className:`font-medium`,children:e.user})},{id:`deploymentsActive`,header:`Active Deployments`,width:180,cell:e=>e.deploymentsActive},{id:`tasksRunning`,header:`Running Tasks`,width:160,cell:e=>e.tasksRunning},{id:`collectorsTotal`,header:`Collectors`,width:140,cell:e=>e.collectorsTotal},{id:`deploymentsTotal`,header:`Total Deployments`,width:170,cell:e=>e.deploymentsTotal},{id:`lastSeenAt`,header:`Last Updated`,align:`right`,width:220,cell:e=>(0,P.jsx)(`span`,{className:`text-muted-foreground`,children:e.lastSeenAt})}],rows:h.slice(0,50),getRowId:e=>e.user,maxHeightClassName:`max-h-[45vh]`,minWidthClassName:`min-w-[1000px]`})})]}),(0,P.jsxs)(L,{variant:`glass`,children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{className:`text-base`,children:`Raw Snapshots`}),(0,P.jsx)(B,{children:`Most recent usage snapshot records (for debugging).`})]}),(0,P.jsx)(V,{children:(0,P.jsx)(Ss,{columns:[{id:`scope`,header:`Scope`,width:180,cell:e=>e.scopeType===`user`?`user:${e.scopeId??``}`:e.scopeType},{id:`metric`,header:`Metric`,cell:e=>e.metric},{id:`value`,header:`Value`,width:160,cell:e=>typeof e.value==`number`?e.value:String(e.value)},{id:`collectedAt`,header:`Collected At`,width:220,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-muted-foreground`,children:e.collectedAt})}],rows:(f.data?.usage??[]).slice(0,200),getRowId:e=>`${e.provider}:${e.scopeType}:${e.scopeId??``}:${e.metric}:${e.collectedAt}`,maxHeightClassName:`max-h-[50vh]`,minWidthClassName:`min-w-[900px]`})})]})]})})]})})]})]})}function qc(e){let t=c(),n=(0,M.useMemo)(()=>`${Mr}/dashboard/events`,[]);(0,M.useEffect)(()=>{if(!e)return;let r=hs(n,{snapshot:e=>{try{let n=JSON.parse(e.data);t.setQueryData(H.dashboardSnapshot(),n)}catch{}}});return()=>{r.close()}},[e,t,n])}const Jc=t(`/dashboard/runs/`)({component:Yc});function Yc(){qc(!0);let e=c(),t=i({queryKey:H.dashboardSnapshot(),queryFn:Rr,initialData:()=>e.getQueryData(H.dashboardSnapshot())??null,retry:!1,staleTime:1/0}),n=t.data?.runs??[],[r,a]=(0,M.useState)(``),o=(0,M.useMemo)(()=>{let e=r.trim().toLowerCase();return e?n.filter(t=>JSON.stringify(t).toLowerCase().includes(e)):n},[r,n]);return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`h1`,{className:`text-2xl font-bold tracking-tight`,children:`Runs`}),(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Recent task runs across all deployments.`})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,P.jsx)(K,{placeholder:`Filter runs`,value:r,onChange:e=>a(e.target.value)}),(0,P.jsxs)(`div`,{className:`text-sm text-muted-foreground`,children:[o.length,` shown`]})]}),t.data?o.length===0?(0,P.jsx)(L,{className:`border-dashed`,children:(0,P.jsx)(V,{className:`pt-6 text-sm text-muted-foreground`,children:`No runs match your filter.`})}):(0,P.jsx)(`div`,{className:`space-y-3`,children:o.map(e=>{let t=String(e.id??``),n=String(e.status??``),r=String(e.tpl_alias??e.type??``),i=String(e.created??``),a=String(e.start??``),o=String(e.end??``);return(0,P.jsxs)(L,{variant:`glass`,children:[(0,P.jsx)(R,{children:(0,P.jsxs)(`div`,{className:`flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between`,children:[(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsx)(z,{className:`truncate`,children:(0,P.jsxs)(p,{className:`underline`,to:`/dashboard/runs/$runId`,params:{runId:t},children:[`Run `,t]})}),(0,P.jsx)(B,{className:`truncate`,children:r||`run`})]}),(0,P.jsx)(W,{variant:Xc(n),children:n||`unknown`})]})}),(0,P.jsxs)(V,{className:`grid gap-2 text-sm text-muted-foreground md:grid-cols-3`,children:[(0,P.jsxs)(`div`,{className:`truncate`,children:[`Created: `,i||``]}),(0,P.jsxs)(`div`,{className:`truncate`,children:[`Started: `,a||``]}),(0,P.jsxs)(`div`,{className:`truncate`,children:[`Finished: `,o||``]})]})]},t)})}):(0,P.jsx)(L,{className:`border-dashed`,children:(0,P.jsx)(V,{className:`pt-6 text-sm text-muted-foreground`,children:`Loading dashboard`})})]})}function Xc(e){let t=e.toLowerCase();return t===`success`||t===`succeeded`||t===`complete`?`default`:t===`failed`||t===`error`?`destructive`:t===`running`?`default`:`secondary`}const Zc=t(`/dashboard/forward/`)({component:Qc});function Qc(){let e=n();return(0,M.useEffect)(()=>{e({to:`/dashboard/forward/credentials`,replace:!0})},[e]),null}var $c=[{slug:`getting-started`,title:`Getting started`,description:`First-time flow: configure settings, select templates, deploy.`,tags:[`start`,`deployments`,`settings`]},{slug:`my-settings`,title:`My Settings`,description:`Per-user defaults, external repos, BYOL servers, credentials.`,tags:[`settings`,`repos`,`byol`,`cloud`]},{slug:`deployments`,title:`Deployments`,description:`Create deployments, validate templates, and understand statuses.`,tags:[`deployments`,`templates`,`validate`]},{slug:`servicenow`,title:`ServiceNow demo workflow`,description:`Install and configure the Forward Connectivity Ticket demo into a ServiceNow PDI.`,tags:[`servicenow`,`forward`,`workflow`]}];const el=t(`/dashboard/docs/`)({component:tl});function tl(){let[e,t]=(0,M.useState)(``),n=(0,M.useMemo)(()=>{let t=e.trim().toLowerCase();return t?$c.filter(e=>`${e.title} ${e.description} ${e.tags.join(` `)}`.toLowerCase().includes(t)):$c},[e]);return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsxs)(L,{variant:`glass`,children:[(0,P.jsx)(R,{children:(0,P.jsxs)(z,{className:`flex items-center gap-2`,children:[(0,P.jsx)(ln,{className:`h-5 w-5`}),`Docs & Workflows`]})}),(0,P.jsxs)(V,{className:`space-y-4`,children:[(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Practical guides for first-time users and repeatable workflows.`}),(0,P.jsx)(K,{placeholder:`Search docs`,value:e,onChange:e=>t(e.target.value)})]})]}),(0,P.jsx)(`div`,{className:`grid gap-4 md:grid-cols-2`,children:n.map(e=>(0,P.jsx)(p,{to:`/dashboard/docs/$slug`,params:{slug:e.slug},className:`group`,children:(0,P.jsxs)(L,{className:`h-full transition-colors hover:bg-accent/40`,children:[(0,P.jsx)(R,{children:(0,P.jsxs)(z,{className:`flex items-center justify-between gap-2 text-base`,children:[(0,P.jsx)(`span`,{className:`truncate`,children:e.title}),(0,P.jsx)(te,{className:`h-4 w-4 text-muted-foreground group-hover:text-foreground`})]})}),(0,P.jsxs)(V,{className:`space-y-2`,children:[(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:e.description}),(0,P.jsx)(`div`,{className:`flex flex-wrap gap-2`,children:e.tags.slice(0,4).map(e=>(0,P.jsx)(`span`,{className:`rounded border px-2 py-0.5 text-[10px] text-muted-foreground`,children:e},e))})]})]})},e.slug))})]})}const nl=t(`/dashboard/deployments/`)({component:rl});function rl(){qc(!0);let e=n(),t=c(),r=i({queryKey:H.dashboardSnapshot(),queryFn:Rr,initialData:()=>t.getQueryData(H.dashboardSnapshot())??null,retry:!1,staleTime:1/0}),[a,o]=(0,M.useState)(null),[s,l]=(0,M.useState)(!1),[u,d]=(0,M.useState)(!1);i({queryKey:H.session(),queryFn:Ir,staleTime:3e4,retry:!1});let[f,m]=(0,M.useState)(``),[h,g]=(0,M.useState)(`all`),[_,v]=(0,M.useState)(`all`),[y,b]=(0,M.useState)(!0),ee=(0,M.useMemo)(()=>r.data?.deployments??[],[r.data?.deployments]),x=(0,M.useMemo)(()=>ee.filter(e=>{if(f&&!e.name.toLowerCase().includes(f.toLowerCase()))return!1;if(h!==`all`){let t=(e.activeTaskStatus??e.lastStatus??`unknown`).toLowerCase();if(h===`running`&&![`running`,`active`,`healthy`].includes(t)||h===`stopped`&&![`created`,`stopped`,`success`,`succeeded`,`ready`].includes(t)||h===`failed`&&![`failed`,`error`,`crashloopbackoff`].includes(t))return!1}return!(_!==`all`&&(_===`netlab`&&!e.type.startsWith(`netlab`)||_===`containerlab`&&![`containerlab`,`clabernetes`].includes(e.type)||_===`terraform`&&e.type!==`terraform`))}),[ee,f,h,_]),S=async e=>{try{await Va(e.id),j.success(`Deployment starting`,{description:`${e.name} is queued to start.`})}catch(e){j.error(`Failed to start`,{description:e.message})}},C=async e=>{try{await Ha(e.id),j.success(`Deployment stopping`,{description:`${e.name} is queued to stop.`})}catch(e){j.error(`Failed to stop`,{description:e.message})}},w=(0,M.useMemo)(()=>[{id:`name`,header:`Name`,width:`minmax(240px, 1fr)`,cell:e=>(0,P.jsx)(p,{to:`/dashboard/deployments/$deploymentId`,params:{deploymentId:e.id},className:`hover:underline flex items-center gap-2 font-medium text-foreground`,children:e.name})},{id:`type`,header:`Type`,width:160,cell:e=>(0,P.jsx)(`span`,{className:`text-muted-foreground`,children:ae(e.type)})},{id:`status`,header:`Status`,width:150,cell:e=>(0,P.jsx)(il,{status:e.activeTaskStatus??e.lastStatus??`unknown`})},{id:`actions`,header:`Actions`,width:120,align:`right`,cell:t=>{let n=(t.activeTaskStatus??t.lastStatus??`unknown`).toLowerCase(),r=[`running`,`active`,`healthy`].includes(n),i=!!t.activeTaskId;return(0,P.jsxs)(br,{children:[(0,P.jsx)(xr,{asChild:!0,children:(0,P.jsxs)(F,{variant:`ghost`,size:`icon`,className:`h-8 w-8`,children:[(0,P.jsx)(T,{className:`h-4 w-4`}),(0,P.jsx)(`span`,{className:`sr-only`,children:`Open menu`})]})}),(0,P.jsxs)(wr,{align:`end`,children:[(0,P.jsx)(Or,{children:`Actions`}),(0,P.jsxs)(Tr,{onClick:()=>e({to:`/dashboard/deployments/$deploymentId`,params:{deploymentId:t.id}}),children:[(0,P.jsx)(Xt,{className:`mr-2 h-4 w-4`}),`Details`]}),(0,P.jsx)(kr,{}),(0,P.jsxs)(Tr,{onClick:()=>S(t),disabled:i||r,children:[(0,P.jsx)(vn,{className:`mr-2 h-4 w-4`}),`Start`]}),(0,P.jsxs)(Tr,{onClick:()=>C(t),disabled:i||!r,children:[(0,P.jsx)(Se,{className:`mr-2 h-4 w-4`}),`Stop`]}),(0,P.jsx)(kr,{}),(0,P.jsxs)(Tr,{onClick:()=>{o(t),l(!0)},className:`text-destructive focus:text-destructive`,disabled:i,children:[(0,P.jsx)(Rn,{className:`mr-2 h-4 w-4`}),`Delete`]})]})]})}}],[S,C,e]),ne=(0,M.useMemo)(()=>r.data?.runs??[],[r.data?.runs]),re=Nr(window.location.pathname+window.location.search),ie=async()=>{if(a)try{await Ua(a.id,{forwardDelete:u}),j.success(`Deployment deleted`,{description:`${a.name} has been removed.`}),await t.invalidateQueries({queryKey:H.dashboardSnapshot()}),l(!1),o(null),d(!1)}catch(e){j.error(`Failed to delete`,{description:e.message})}},ae=e=>{switch(e){case`netlab`:return`Netlab (BYOS)`;case`netlab-c9s`:return`Netlab`;case`containerlab`:return`Containerlab (BYOS)`;case`clabernetes`:return`Containerlab`;default:return e}},E=!!a?.config?.forwardNetworkId;return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsx)(`div`,{className:`flex flex-col gap-4 md:flex-row md:items-center md:justify-between border-b pb-6`,children:(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`h1`,{className:`text-2xl font-bold tracking-tight`,children:`Deployments`}),(0,P.jsx)(`p`,{className:`text-muted-foreground text-sm`,children:`Manage deployments and monitor activity.`})]})}),!r.data&&(0,P.jsx)(L,{className:`border-dashed`,children:(0,P.jsx)(V,{className:`pt-6`,children:(0,P.jsxs)(`div`,{className:`flex flex-col items-center justify-center space-y-4 py-8`,children:[(0,P.jsx)(U,{className:`h-4 w-64`}),(0,P.jsxs)(`div`,{className:`text-center text-muted-foreground`,children:[`Loading dashboard`,(0,P.jsxs)(`div`,{className:`mt-2 text-xs`,children:[`If you are logged out,`,` `,(0,P.jsx)(`a`,{className:`text-primary underline hover:no-underline`,href:re,onClick:e=>{e.preventDefault(),(async()=>{if(!await ls({loginHref:re})){window.location.href=re;return}await t.invalidateQueries({queryKey:H.session()})})()},children:`login`}),`.`]})]})]})})}),(0,P.jsxs)(`div`,{className:`flex flex-col lg:flex-row gap-6 relative items-start`,children:[(0,P.jsxs)(`div`,{className:`flex-1 min-w-0 space-y-4 w-full`,children:[(0,P.jsxs)(`div`,{className:`flex flex-col sm:flex-row gap-3`,children:[(0,P.jsxs)(`div`,{className:`relative flex-1`,children:[(0,P.jsx)(un,{className:`absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground`}),(0,P.jsx)(K,{placeholder:`Search deployments...`,className:`pl-9`,value:f,onChange:e=>m(e.target.value)})]}),(0,P.jsxs)(q,{value:h,onValueChange:g,children:[(0,P.jsxs)(Y,{className:`w-[140px]`,children:[(0,P.jsx)(Pn,{className:`mr-2 h-4 w-4 text-muted-foreground`}),(0,P.jsx)(J,{placeholder:`Status`})]}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`all`,children:`All Status`}),(0,P.jsx)(Z,{value:`running`,children:`Running`}),(0,P.jsx)(Z,{value:`stopped`,children:`Stopped`}),(0,P.jsx)(Z,{value:`failed`,children:`Failed`})]})]}),(0,P.jsxs)(q,{value:_,onValueChange:v,children:[(0,P.jsxs)(Y,{className:`w-[140px]`,children:[(0,P.jsx)(ye,{className:`mr-2 h-4 w-4 text-muted-foreground`}),(0,P.jsx)(J,{placeholder:`Type`})]}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`all`,children:`All Types`}),(0,P.jsx)(Z,{value:`netlab`,children:`Netlab`}),(0,P.jsx)(Z,{value:`containerlab`,children:`Containerlab`}),(0,P.jsx)(Z,{value:`terraform`,children:`Terraform`})]})]}),(0,P.jsxs)(p,{to:`/dashboard/deployments/new`,className:yr({variant:`default`}),children:[(0,P.jsx)(Et,{className:`mr-2 h-4 w-4`}),` Create`]})]}),(0,P.jsx)(L,{children:(0,P.jsx)(V,{className:`p-0`,children:r.data?x.length===0?(0,P.jsx)(Cs,{icon:Ft,title:`No deployments found`,description:f||h!==`all`?`Try adjusting your filters.`:`You haven't created any deployments yet.`,action:!f&&h===`all`?{label:`Create deployment`,onClick:()=>e({to:`/dashboard/deployments/new`})}:void 0}):(0,P.jsx)(Ss,{columns:w,rows:x,getRowId:e=>e.id,minWidthClassName:`min-w-0`,scrollable:!1}):(0,P.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,P.jsx)(U,{className:`h-10 w-full`}),(0,P.jsx)(U,{className:`h-10 w-full`}),(0,P.jsx)(U,{className:`h-10 w-full`})]})})})]}),(0,P.jsxs)(`div`,{className:N(`transition-all duration-300 ease-in-out border-l space-y-4 shrink-0`,y?`w-full lg:w-80 xl:w-96 pl-6 opacity-100`:`w-0 lg:w-12 pl-0 opacity-100 border-none lg:border-l`),children:[(0,P.jsx)(`div`,{className:N(`flex items-center gap-2 h-[40px]`,!y&&`justify-center`),children:y?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(lt,{className:`h-4 w-4 text-muted-foreground`}),(0,P.jsx)(`h3`,{className:`flex-1 text-sm font-semibold text-muted-foreground uppercase tracking-wider`,children:`Activity Feed`}),(0,P.jsx)(F,{variant:`ghost`,size:`icon`,className:`h-6 w-6 text-muted-foreground hover:text-foreground`,onClick:()=>b(!1),title:`Collapse feed`,children:(0,P.jsx)(te,{className:`h-4 w-4`})})]}):(0,P.jsx)(F,{variant:`ghost`,size:`icon`,className:`h-8 w-8 text-muted-foreground hover:text-foreground`,onClick:()=>b(!0),title:`Expand activity feed`,children:(0,P.jsx)(Ze,{className:`h-4 w-4`})})}),(0,P.jsx)(`div`,{className:N(`space-y-3`,!y&&`hidden`),children:r.data?ne.length===0?(0,P.jsx)(L,{children:(0,P.jsx)(V,{className:`p-6 text-center text-sm text-muted-foreground`,children:`No recent activity.`})}):(0,P.jsx)(`div`,{className:`space-y-3`,children:ne.slice(0,15).map(e=>([`success`,`failed`,`canceled`,`error`].includes(String(e.status??``).toLowerCase()),(0,P.jsx)(p,{to:`/dashboard/runs/$runId`,params:{runId:String(e.id??``)},className:`block group`,children:(0,P.jsx)(L,{className:`hover:border-primary/50 transition-colors`,children:(0,P.jsxs)(V,{className:`p-3`,children:[(0,P.jsxs)(`div`,{className:`flex items-start justify-between gap-2`,children:[(0,P.jsxs)(`div`,{className:`flex flex-col gap-1 min-w-0`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(`span`,{className:`font-mono text-xs font-medium text-foreground`,children:[`#`,String(e.id??``)]}),(0,P.jsx)(`span`,{className:`text-xs text-muted-foreground truncate max-w-[120px]`,children:String(e.tpl_alias??e.type??`Run`)})]}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground truncate`,children:String(e.message||`No message`)})]}),(0,P.jsx)(il,{status:String(e.status??``),size:`xs`})]}),(0,P.jsxs)(`div`,{className:`mt-2 flex items-center justify-between text-[10px] text-muted-foreground`,children:[(0,P.jsx)(`span`,{children:String(e.user_name??`system`)}),(0,P.jsx)(`span`,{children:new Date(String(e.created)).toLocaleString(void 0,{month:`short`,day:`numeric`,hour:`numeric`,minute:`numeric`})})]})]})})},String(e.id??Math.random()))))}):(0,P.jsxs)(`div`,{className:`space-y-3`,children:[(0,P.jsx)(U,{className:`h-20 w-full`}),(0,P.jsx)(U,{className:`h-20 w-full`})]})})]})]}),(0,P.jsx)(Ws,{open:s,onOpenChange:l,children:(0,P.jsxs)(qs,{children:[(0,P.jsxs)(Js,{children:[(0,P.jsx)(Xs,{children:`Delete deployment?`}),(0,P.jsxs)(Zs,{children:[`This will remove "`,a?.name,`" from Skyforge and trigger provider cleanup. This action cannot be undone.`]})]}),E&&(0,P.jsxs)(`div`,{className:`flex items-start gap-3 rounded-md border p-3`,children:[(0,P.jsx)(ec,{checked:u,onCheckedChange:e=>d(!!e),id:`delete-forward-network`}),(0,P.jsx)(`label`,{htmlFor:`delete-forward-network`,className:`text-sm leading-tight cursor-pointer`,children:`Also delete the Forward network associated with this deployment.`})]}),(0,P.jsxs)(Ys,{children:[(0,P.jsx)($s,{children:`Cancel`}),(0,P.jsx)(Qs,{onClick:ie,className:yr({variant:`destructive`}),children:`Delete`})]})]})})]})}function il({status:e,size:t=`default`}){let n=`secondary`,r=e.toLowerCase(),i=r===`success`||r===`succeeded`?`ready`:r===`crashloopbackoff`?`crashloop`:e;return[`running`,`active`,`healthy`].includes(r)&&(n=`default`),[`failed`,`error`,`crashloopbackoff`].includes(r)&&(n=`destructive`),(0,P.jsx)(W,{variant:n,className:`capitalize ${t===`xs`?`px-1.5 py-0 text-[10px] h-5`:``}`,children:i})}function al(e,t){let n=c(),r=(0,M.useMemo)(()=>`${Mr}/runs/${encodeURIComponent(e)}/events`,[e]);(0,M.useEffect)(()=>{if(!t||!e)return;let i=hs(r,{output:t=>{try{console.log(`Run event:`,t.data);let r=JSON.parse(t.data);if(!r||!Array.isArray(r.entries))return;n.setQueryData(H.runLogs(e),e=>{let t=(e?.entries??[]).concat(r.entries);return{cursor:Number(r.cursor??e?.cursor??0),entries:t}})}catch{}}});return()=>{i.close()}},[t,n,e,r])}const ol=t(`/dashboard/runs/$runId`)({component:sl});function sl(){let{runId:e}=ol.useParams();al(e,!0);let t=c(),r=n(),a=i({queryKey:H.dashboardSnapshot(),queryFn:Rr,initialData:()=>t.getQueryData(H.dashboardSnapshot())??null,retry:!1,staleTime:1/0}),o=(a.data?.runs??[]).find(t=>String(t.id??``)===e),s=String(o?.status??``).toLowerCase(),l=s===`queued`||s===`running`,u=i({queryKey:H.runLogs(e),queryFn:async()=>({cursor:0,entries:[]}),retry:!1,staleTime:1/0}),d=Nr(window.location.pathname+window.location.search);return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsx)(L,{variant:`glass`,children:(0,P.jsx)(R,{children:(0,P.jsxs)(`div`,{className:`flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between`,children:[(0,P.jsx)(`div`,{children:(0,P.jsxs)(z,{children:[`Run `,e]})}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(p,{className:yr({variant:`outline`,size:`sm`}),to:`/dashboard/deployments`,children:`Back`}),(0,P.jsx)(F,{variant:`destructive`,size:`sm`,disabled:!o||!l,onClick:()=>{o&&(async()=>{try{await Ka(e),j.success(`Run canceled`),await t.invalidateQueries({queryKey:H.dashboardSnapshot()}),r({to:`/dashboard/deployments`})}catch(e){j.error(`Cancel failed`,{description:e.message})}})()},children:`Cancel`}),(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>t.setQueryData(H.runLogs(e),{cursor:0,entries:[]}),children:`Clear`})]})]})})}),!a.data&&(0,P.jsx)(L,{className:`border-dashed`,children:(0,P.jsxs)(V,{className:`pt-6 text-center text-muted-foreground`,children:[`Loading dashboard`,(0,P.jsxs)(`div`,{className:`mt-2 text-xs`,children:[`If you are logged out,`,` `,(0,P.jsx)(`a`,{className:`text-primary underline hover:no-underline`,href:d,onClick:e=>{e.preventDefault(),(async()=>{if(!await ls({loginHref:d})){window.location.href=d;return}await t.invalidateQueries({queryKey:H.session()})})()},children:`login`}),`.`]})]})}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsx)(z,{children:`Metadata`}),(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Cursor: `,String(u.data?.cursor??0)]})]})}),(0,P.jsx)(V,{children:(0,P.jsxs)(`div`,{className:`grid grid-cols-1 gap-4 md:grid-cols-3`,children:[(0,P.jsx)(cl,{label:`Type`,value:String(o?.tpl_alias??``)}),(0,P.jsx)(cl,{label:`Status`,value:String(o?.status??``)}),(0,P.jsx)(cl,{label:`User ID`,value:String(o?.scopeId??``)}),(0,P.jsx)(cl,{label:`Created`,value:String(o?.created??``)}),(0,P.jsx)(cl,{label:`Started`,value:String(o?.start??``)}),(0,P.jsx)(cl,{label:`Finished`,value:String(o?.end??``)})]})})]}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{children:`Output`})}),(0,P.jsx)(V,{children:(0,P.jsx)(`div`,{className:`rounded-md border bg-zinc-950 p-4 font-mono text-xs text-zinc-100`,children:(0,P.jsx)(ll,{entries:u.data?.entries??[]})})})]})]})}function cl(e){return(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`text-[11px] uppercase tracking-wide text-muted-foreground`,children:e.label}),(0,P.jsx)(`div`,{className:`break-all font-medium text-sm`,children:e.value||``})]})}function ll(e){let t=(0,M.useRef)(null);return(0,M.useEffect)(()=>{let e=t.current;e&&(e.scrollTop=e.scrollHeight)},[e.entries.length]),e.entries.length===0?(0,P.jsx)(`div`,{className:`text-zinc-500`,children:`Waiting for output`}):(0,P.jsx)(`div`,{ref:t,className:`max-h-[65vh] overflow-auto whitespace-pre-wrap`,children:e.entries.map((e,t)=>(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`span`,{className:`text-zinc-500 select-none`,children:e.time?`${e.time} `:``}),(0,P.jsx)(`span`,{children:e.output})]},`${e.time}-${t}`))})}function ul({deploymentId:e,nodeId:t,nodeKind:n,nodeIp:r,onClose:a,className:o}){let s=(0,M.useMemo)(()=>{let e=[t];return n&&e.push(String(n)),e.join(`  `)},[t,n]),c=i({queryKey:[`deploymentNodeDescribe`,e,t],enabled:!!e&&!!t,queryFn:async()=>qi(e,t),refetchOnWindowFocus:!1,retry:1});return(0,P.jsxs)(`div`,{className:`flex flex-col h-full w-full ${o??``}`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2 p-2 border-b bg-muted/40 text-xs`,children:[(0,P.jsxs)(`div`,{className:`truncate flex items-center gap-2`,children:[(0,P.jsx)(`span`,{className:`font-mono font-medium`,children:s}),r?(0,P.jsx)(`span`,{className:`font-mono text-muted-foreground`,children:r}):null]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(F,{variant:`outline`,size:`sm`,className:`h-7`,onClick:()=>c.refetch(),disabled:c.isFetching,children:[(0,P.jsx)(it,{className:c.isFetching?`mr-2 h-3 w-3 animate-spin`:`mr-2 h-3 w-3`}),`Refresh`]}),a?(0,P.jsx)(F,{variant:`ghost`,size:`sm`,className:`h-7`,onClick:a,children:`Close`}):null]})]}),(0,P.jsx)(`div`,{className:`flex-1 overflow-auto bg-muted/10 p-4`,children:(0,P.jsx)(`pre`,{className:`text-xs font-mono whitespace-pre-wrap`,children:c.isLoading?`Loading`:c.isError?`Failed to load node status: ${String(c.error)}`:JSON.stringify(c.data??{},null,2)})})]})}function dl({open:e,onOpenChange:t,deploymentId:n,nodeId:r,nodeKind:i,nodeIp:a}){return(0,P.jsx)(Zn,{open:e,onOpenChange:t,children:(0,P.jsxs)(er,{className:`max-w-5xl h-[70vh] flex flex-col p-0 gap-0 overflow-hidden`,children:[(0,P.jsx)(tr,{className:`px-6 py-4 border-b`,children:(0,P.jsxs)(rr,{className:`flex items-center gap-2`,children:[(0,P.jsx)(x,{className:`h-4 w-4`}),`Node status`]})}),(0,P.jsx)(`div`,{className:`flex-1 min-h-0`,children:e?(0,P.jsx)(ul,{deploymentId:n,nodeId:r,nodeKind:i,nodeIp:a,onClose:()=>t(!1)}):null})]})})}function fl({deploymentId:e,nodeId:t,nodeKind:n,nodeIp:r,onClose:a,className:o}){let s=(0,M.useMemo)(()=>{let e=[t];return n&&e.push(String(n)),e.join(`  `)},[t,n]),c=i({queryKey:[`deploymentNodeLogs`,e,t,400],enabled:!!e&&!!t,queryFn:async()=>Ki(e,t,{tail:400,container:t}),refetchOnWindowFocus:!1,retry:1});return(0,P.jsxs)(`div`,{className:`flex flex-col h-full w-full ${o??``}`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2 p-2 border-b bg-muted/40 text-xs`,children:[(0,P.jsxs)(`div`,{className:`truncate flex items-center gap-2`,children:[(0,P.jsx)(`span`,{className:`font-mono font-medium`,children:s}),r?(0,P.jsx)(`span`,{className:`font-mono text-muted-foreground`,children:r}):null,c.data?.namespace&&c.data?.podName?(0,P.jsxs)(`span`,{className:`text-muted-foreground`,children:[c.data.namespace,`/`,c.data.podName]}):null]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(F,{variant:`outline`,size:`sm`,className:`h-7`,onClick:()=>c.refetch(),disabled:c.isFetching,children:[(0,P.jsx)(it,{className:c.isFetching?`mr-2 h-3 w-3 animate-spin`:`mr-2 h-3 w-3`}),`Refresh`]}),a?(0,P.jsx)(F,{variant:`ghost`,size:`sm`,className:`h-7`,onClick:a,children:`Close`}):null]})]}),(0,P.jsx)(`div`,{className:`flex-1 overflow-auto bg-muted/10 p-4`,children:(0,P.jsx)(`pre`,{className:`text-xs font-mono whitespace-pre-wrap`,children:c.isLoading?`Loading`:c.isError?`Failed to load logs: ${String(c.error)}`:c.data?.logs||``})})]})}function pl({open:e,onOpenChange:t,deploymentId:n,nodeId:r,nodeKind:i,nodeIp:a}){return(0,P.jsx)(Zn,{open:e,onOpenChange:t,children:(0,P.jsxs)(er,{className:`max-w-5xl h-[70vh] flex flex-col p-0 gap-0 overflow-hidden`,children:[(0,P.jsx)(tr,{className:`px-6 py-4 border-b`,children:(0,P.jsxs)(rr,{className:`flex items-center gap-2`,children:[(0,P.jsx)(x,{className:`h-4 w-4`}),`Node logs`]})}),(0,P.jsx)(`div`,{className:`flex-1 min-h-0`,children:e?(0,P.jsx)(fl,{deploymentId:n,nodeId:r,nodeKind:i,nodeIp:a,onClose:()=>t(!1)}):null})]})})}var ml=Wn(),hl=qn();function gl({deploymentId:e,nodeId:t,nodeKind:n,onClose:r,className:i}){let a=(0,M.useRef)(null),o=(0,M.useRef)(null),s=(0,M.useRef)(null),c=(0,M.useRef)(null),[l,u]=(0,M.useState)(`disconnected`),d=(0,M.useMemo)(()=>`cli`,[]),f=(0,M.useMemo)(()=>{if(!e||!t)return``;let n=`${window.location.protocol===`https:`?`wss`:`ws`}://${window.location.host}/api/deploy/${encodeURIComponent(e)}/terminal/ws`,r=new URLSearchParams;return r.set(`node`,t),r.set(`command`,d),`${n}?${r.toString()}`},[d,e,t]);return(0,M.useEffect)(()=>{if(!a.current||!f)return;let e=new hl.Terminal({convertEol:!0,cursorBlink:!0,fontFamily:`ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace`,fontSize:12,theme:{background:`#09090b`}}),n=new ml.FitAddon;e.loadAddon(n),e.open(a.current),n.fit(),e.writeln(`\x1B[1mSkyforge Terminal\x1B[0m`),e.writeln(`Node: ${t}  Command: ${d}`),e.writeln(``),o.current=e,s.current=n;let r=new WebSocket(f);c.current=r,u(`connecting`);let i=()=>{let e=o.current;if(!e)return;let t=e.cols??80,n=e.rows??24;try{r.send(JSON.stringify({type:`resize`,cols:t,rows:n}))}catch{}};r.onopen=()=>{u(`connected`),i(),e.focus()},r.onmessage=t=>{let n=null;try{n=JSON.parse(String(t.data))}catch{e.write(String(t.data));return}if(n){if(n.type===`output`){e.write(n.data??``);return}if(n.type===`info`){e.writeln(`\r\n[info] ${n.data??``}`);return}if(n.type===`error`){e.writeln(`\r\n[error] ${n.data??``}`);return}}},r.onclose=t=>{u(`closed`);let n=typeof t.code==`number`?t.code:0,r=t.reason?` ${t.reason}`:``;e.writeln(`\r\n[disconnected]${n?` (code ${n})`:``}${r}`)},r.onerror=()=>{u(`error`),e.writeln(`\r
[error] websocket error (check browser console/network)`)};let l=e.onData(e=>{try{r.send(JSON.stringify({type:`stdin`,data:e}))}catch{}}),p=()=>{n.fit(),i()};return window.addEventListener(`resize`,p),()=>{window.removeEventListener(`resize`,p),l.dispose();try{r.close()}catch{}c.current=null,e.dispose(),o.current=null,s.current=null,u(`disconnected`)}},[d,t,f]),(0,P.jsxs)(`div`,{className:`flex flex-col h-full w-full ${i??``}`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2 p-2 text-xs text-muted-foreground bg-zinc-900 border-b border-zinc-800`,children:[(0,P.jsxs)(`div`,{className:`truncate`,children:[(0,P.jsx)(`span`,{className:`font-mono text-zinc-300`,children:t}),(0,P.jsx)(`span`,{className:`mx-2 text-zinc-600`,children:`/`}),(0,P.jsx)(`span`,{children:l})]}),r?(0,P.jsx)(F,{variant:`ghost`,size:`sm`,className:`h-6 px-2 text-xs`,onClick:()=>{let e=c.current;if(e&&e.readyState===WebSocket.OPEN)try{e.close()}catch{}r()},children:`Close`}):null]}),(0,P.jsx)(`div`,{className:`flex-1 bg-zinc-950 p-2 min-h-0`,children:(0,P.jsx)(`div`,{ref:a,className:`h-full w-full`})})]})}function _l({open:e,onOpenChange:t,deploymentId:n,nodeId:r,nodeKind:i}){let a=`${n}-${r}-${e}`;return(0,P.jsx)(Zn,{open:e,onOpenChange:t,children:(0,P.jsxs)(er,{className:`max-w-5xl h-[70vh] flex flex-col p-0 gap-0 overflow-hidden`,children:[(0,P.jsx)(tr,{className:`px-6 py-4 border-b`,children:(0,P.jsxs)(rr,{className:`flex items-center gap-2`,children:[(0,P.jsx)(x,{className:`h-4 w-4`}),`Terminal`]})}),(0,P.jsx)(`div`,{className:`flex-1 min-h-0`,children:e?(0,P.jsx)(gl,{deploymentId:n,nodeId:r,nodeKind:i,onClose:()=>t(!1)},a):null})]})})}function vl(){return{downloadImage:(0,M.useCallback)((e,t)=>{e&&Gn(e,{cacheBust:!0,backgroundColor:`#18181b`}).then(e=>{let n=document.createElement(`a`);n.download=t,n.href=e,n.click()}).catch(e=>{console.error(`Failed to download image`,e)})},[])}}function yl(e,t){let n=c(),r=(0,M.useMemo)(()=>`${Mr}/deploy/${encodeURIComponent(e)}/ui-events/events`,[e]);(0,M.useEffect)(()=>{if(!t||!e)return;let i=t=>{try{let r=JSON.parse(t.data);if(!r||!Array.isArray(r.events))return;n.setQueryData(H.deploymentUIEvents(e),e=>{let t=(e?.events??[]).concat(r.events),n=t.slice(Math.max(0,t.length-300));return{cursor:Number(r.cursor??e?.cursor??0),events:n}})}catch{}},a=hs(r,{"ui-events":i});return()=>a.close()},[e,t,n,r])}var bl={custom:({data:e})=>{let t=e.icon===`switch`?Rt:e.icon===`cloud`?Ne:e.icon===`client`?on:be,n=e.status===`running`?`default`:e.status===`stopped`?`secondary`:`destructive`,r=!!e?.highlight,i=String(e?.vendor??``);return(0,P.jsxs)(L,{className:`min-w-[180px] border-2 shadow-md ${r?`border-primary ring-2 ring-primary/30`:``}`,children:[(0,P.jsx)(R,{className:`p-3 pb-2`,children:(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(({vendor:e})=>{let t=String(e).toLowerCase();return t===`cisco`?(0,P.jsx)(`div`,{className:`h-6 w-6 rounded-md flex items-center justify-center`,title:`Cisco`,style:{background:`rgba(0, 142, 204, 0.15)`,color:`rgb(0, 142, 204)`},children:(0,P.jsx)(`svg`,{viewBox:`0 0 24 24`,width:`16`,height:`16`,"aria-hidden":`true`,children:[{x:4,h:8},{x:7,h:10},{x:10,h:12},{x:13,h:10},{x:16,h:8}].map(e=>(0,P.jsx)(`rect`,{x:e.x,y:14-e.h,width:`2`,height:e.h,rx:`1`,fill:`currentColor`},e.x))})}):t===`arista`?(0,P.jsx)(`div`,{className:`h-6 w-6 rounded-md flex items-center justify-center`,title:`Arista`,style:{background:`rgba(232, 43, 44, 0.14)`,color:`rgb(232, 43, 44)`},children:(0,P.jsx)(`svg`,{viewBox:`0 0 24 24`,width:`16`,height:`16`,"aria-hidden":`true`,children:(0,P.jsx)(`path`,{d:`M12 3 4.5 21h3.6l1.6-4h4.6l1.6 4h3.6L12 3zm-1 11 1-2.6 1 2.6h-2z`,fill:`currentColor`})})}):t===`linux`?(0,P.jsx)(`div`,{className:`h-6 w-6 rounded-md flex items-center justify-center`,title:`Linux`,style:{background:`rgba(34, 197, 94, 0.12)`,color:`rgb(34, 197, 94)`},children:(0,P.jsxs)(`svg`,{viewBox:`0 0 24 24`,width:`16`,height:`16`,"aria-hidden":`true`,children:[(0,P.jsx)(`circle`,{cx:`12`,cy:`9`,r:`4`,fill:`#111827`}),(0,P.jsx)(`ellipse`,{cx:`12`,cy:`16`,rx:`5`,ry:`6`,fill:`#111827`}),(0,P.jsx)(`ellipse`,{cx:`12`,cy:`17`,rx:`3.3`,ry:`4.2`,fill:`#ffffff`}),(0,P.jsx)(`path`,{d:`M12 10l2 1-2 1-2-1 2-1z`,fill:`#f59e0b`})]})}):(0,P.jsx)(`div`,{className:`h-6 w-6 rounded-md flex items-center justify-center bg-muted text-[11px] font-bold`,title:`Unknown`,children:`?`})},{vendor:i}),(0,P.jsx)(`div`,{className:`p-1.5 bg-muted rounded-md`,title:String(e?.kind??``),children:(0,P.jsx)(t,{className:`w-4 h-4`})})]}),(0,P.jsx)(W,{variant:n,className:`text-[10px] h-5`,children:String(e.status)})]})}),(0,P.jsxs)(V,{className:`p-3 pt-0`,children:[(0,P.jsx)(z,{className:`text-sm font-bold truncate`,children:String(e.label)}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground mt-1 truncate font-mono`,children:String(e.ip||`10.0.0.x`)}),(0,P.jsx)(an,{type:`target`,position:Nn.Top,className:`!bg-muted-foreground`}),(0,P.jsx)(an,{type:`source`,position:Nn.Bottom,className:`!bg-muted-foreground`})]})]})}};function xl({topology:e,deploymentId:t,enableTerminal:n,fullHeight:a,className:o}){let s=(0,M.useCallback)(e=>{let t=String(e??``).toLowerCase();return t?t.includes(`arista`)||t.includes(`eos`)||t.includes(`ceos`)||t.includes(`veos`)?`arista`:t.includes(`cisco`)||t.includes(`ios`)||t.includes(`nxos`)||t.includes(`csr`)||t.includes(`c8k`)||t.includes(`iosxr`)?`cisco`:t.includes(`linux`)||t.includes(`ubuntu`)||t.includes(`debian`)||t.includes(`alpine`)||t.includes(`rocky`)||t.includes(`centos`)?`linux`:`unknown`:`unknown`},[]),c=(0,M.useMemo)(()=>{if(!e||!Array.isArray(e.nodes)||e.nodes.length===0)return{nodes:[],edges:[]};let t=Math.max(1,Math.ceil(Math.sqrt(e.nodes.length)));return{nodes:e.nodes.map((e,n)=>{let r=n%t,i=Math.floor(n/t),a=String(e.kind??``),o=s(a),c=o===`linux`?`client`:o===`arista`||o===`cisco`?`switch`:`server`,l=String(e.status??`unknown`),u=String(e.pingIp??e.mgmtIp??``),d=String(e.mgmtHost??``);return{id:String(e.id),position:{x:r*240,y:i*160},data:{label:String(e.label??e.id),icon:c,status:l,ip:u,mgmtHost:d,kind:a,vendor:o},type:`custom`}}),edges:(e.edges??[]).map(e=>({id:String(e.id),source:String(e.source),target:String(e.target),label:e.label?String(e.label):void 0,animated:!1}))}},[e,s]),[l,u,d]=wn(c.nodes),[f,p,m]=dt(c.edges),h=(0,M.useRef)(null),{downloadImage:g}=vl(),[_,v]=(0,M.useState)(null),[y,b]=(0,M.useState)(null),[ee,te]=(0,M.useState)(null),[x,S]=(0,M.useState)(null),[C,w]=(0,M.useState)(null),[ne,T]=(0,M.useState)(null),[re,ie]=(0,M.useState)(!1),[ae,E]=(0,M.useState)(!1),[D,O]=(0,M.useState)(!1),[oe,se]=(0,M.useState)(null),[ce,k]=(0,M.useState)({}),le=(0,M.useRef)(null),ue=(0,M.useRef)({}),de=(0,M.useRef)(!1),[fe,pe]=(0,M.useState)(``),[me,he]=(0,M.useState)(`grid`),ge=(0,M.useMemo)(()=>t?`skyforge.topology.positions.${t}`:``,[t]),[_e,ve]=(0,M.useState)(()=>({})),[ye,be]=(0,M.useState)(null),[xe,Se]=(0,M.useState)(!1),[Ce,we]=(0,M.useState)(null),[Te,Ee]=(0,M.useState)(!1),[De,Oe]=(0,M.useState)(!1),[ke,A]=(0,M.useState)(null),[je,Me]=(0,M.useState)({side:`source`,duration:`10`,packets:`2500`,snaplen:`192`}),[Ne,Pe]=(0,M.useState)(!1),[Fe,Ie]=(0,M.useState)(null),[Le,Re]=(0,M.useState)({delayMs:``,jitterMs:``,lossPct:``,dupPct:``,corruptPct:``,reorderPct:``,rateKbps:``});(0,M.useEffect)(()=>{if(ge)try{let e=window.localStorage.getItem(ge);if(!e)return;let t=JSON.parse(e);t&&typeof t==`object`&&ve(t)}catch{}},[ge]);let ze=!!t;yl(t??``,ze);let Be=i({queryKey:t?H.deploymentUIEvents(t):[`deploymentUIEvents`,`none`],queryFn:async()=>({cursor:0,events:[]}),initialData:{cursor:0,events:[]},staleTime:1/0,enabled:ze}),Ve=(0,M.useMemo)(()=>wl(Be.data?.events??[]),[Be.data?.events]);(0,M.useEffect)(()=>{u(El(c.nodes,me,_e,fe)),ue.current=Object.fromEntries(c.edges.map(e=>[String(e.id),typeof e.label==`string`?e.label:void 0])),p(Tl(c.edges,ce,D,ue.current,Ve))},[c.edges,c.nodes,Ve,ce,me,_e,fe,p,u,D]),(0,M.useEffect)(()=>{p(e=>Tl(e,ce,D,ue.current,Ve))},[Ve,ce,p,D]),(0,M.useEffect)(()=>{if(!t||de.current)return;let e=new URLSearchParams(window.location.search),n=e.get(`node`)?.trim(),r=e.get(`action`)?.trim();if(!n||!r){de.current=!0;return}r===`terminal`&&v({id:n}),r===`logs`&&b({id:n}),r===`describe`&&te({id:n}),r===`interfaces`&&(be({id:n}),Se(!0)),r===`running-config`&&(we({id:n}),Ee(!0)),de.current=!0,e.delete(`node`),e.delete(`action`);let i=e.toString(),a=`${window.location.pathname}${i?`?${i}`:``}${window.location.hash||``}`;window.history.replaceState(null,``,a)},[t]),(0,M.useEffect)(()=>{if(!x)return;let e=()=>S(null),t=e=>{e.key===`Escape`&&S(null)};return window.addEventListener(`click`,e),window.addEventListener(`keydown`,t),()=>{window.removeEventListener(`click`,e),window.removeEventListener(`keydown`,t)}},[x]);let He=r({mutationFn:async e=>{if(!t)throw Error(`missing context/deployment`);return Ji(t,e)},onSuccess:(e,t)=>{if(e?.skipped){j.message(`Save config skipped`,{description:e.message||`Node ${t}`});return}j.success(`Save config queued/applied`,{description:e.stdout||`Node ${t}`})},onError:e=>{j.error(`Save config failed`,{description:e?.message??String(e)})}}),Ue=r({mutationFn:async e=>{if(!t)throw Error(`missing context/deployment`);return Vi(t,e)},onSuccess:e=>{let t=e.results.filter(e=>e.error);if(t.length){j.error(`Link admin applied with errors`,{description:t.map(e=>`${e.node}: ${e.error}`).join(`; `)});return}j.success(`Link ${e.action} applied`)},onError:e=>j.error(`Link admin failed`,{description:e?.message??String(e)})}),We=r({mutationFn:async e=>{if(!t)throw Error(`missing context/deployment`);return Hi(t,e)},onSuccess:e=>{j.success(`Pcap captured`,{description:`${e.sizeBytes} bytes  ${e.artifactKey}`})},onError:e=>j.error(`Pcap capture failed`,{description:e?.message??String(e)})}),Ge=r({mutationFn:async e=>{if(!t)throw Error(`missing context/deployment`);return Ui(t,e)},onError:e=>j.error(`Failed to load interfaces`,{description:e?.message??String(e)})}),Ke=r({mutationFn:async e=>{if(!t)throw Error(`missing context/deployment`);return Wi(t,e)},onError:e=>j.error(`Failed to load running config`,{description:e?.message??String(e)})}),qe=(0,M.useCallback)(async e=>{let t=await ya(e),n=String(t?.fileData??``);if(!n)throw Error(`missing fileData`);let r=Uint8Array.from(atob(n),e=>e.charCodeAt(0)),i=new Blob([r],{type:`application/vnd.tcpdump.pcap`}),a=URL.createObjectURL(i),o=document.createElement(`a`);o.href=a,o.download=e.split(`/`).pop()||`capture.pcap`,o.click(),URL.revokeObjectURL(a)},[]),Je=(0,M.useCallback)(async()=>{if(!t)return;let e=await Gi(t,`csv`),n=String(e.csv??``);if(!n.trim())throw Error(`empty inventory csv`);let r=new Blob([n],{type:`text/csv`}),i=URL.createObjectURL(r),a=document.createElement(`a`);a.href=i,a.download=`${t}-inventory.csv`,a.click(),URL.revokeObjectURL(i)},[t]);(0,M.useEffect)(()=>{if(!C)return;let e=()=>w(null),t=e=>{e.key===`Escape`&&w(null)};return window.addEventListener(`click`,e),window.addEventListener(`keydown`,t),()=>{window.removeEventListener(`click`,e),window.removeEventListener(`keydown`,t)}},[C]),(0,M.useEffect)(()=>{xe&&ye?.id&&Ge.mutate(ye.id)},[Ge,ye?.id,xe]),(0,M.useEffect)(()=>{if(!xe||!Ne||!ye?.id)return;let e=window.setInterval(()=>{Ge.mutate(ye.id)},2e3);return()=>window.clearInterval(e)},[Ge,Ne,ye?.id,xe]),(0,M.useEffect)(()=>{Te&&Ce?.id&&Ke.mutate(Ce.id)},[Ke,Ce?.id,Te]);let Ye=(0,M.useCallback)(e=>p(t=>_t(e,t)),[p]),Xe=(0,M.useCallback)((e,n)=>{if(e.preventDefault(),!t)return;let r=h.current?.getBoundingClientRect();w({x:r?e.clientX-r.left:e.clientX,y:r?e.clientY-r.top:e.clientY,node:n})},[t]),Ze=(0,M.useCallback)((e,n)=>{if(!t)return;e.preventDefault();let r=h.current?.getBoundingClientRect();S({x:r?e.clientX-r.left:e.clientX,y:r?e.clientY-r.top:e.clientY,edge:n})},[t]),Qe=(0,M.useCallback)(async(e,n)=>{if(t)try{E(!0);let r={edgeId:n,action:e};if(e===`set`){let e=Le.delayMs.trim()?Number(Le.delayMs.trim()):void 0,t=Le.jitterMs.trim()?Number(Le.jitterMs.trim()):void 0,n=Le.lossPct.trim()?Number(Le.lossPct.trim()):void 0,i=Le.dupPct.trim()?Number(Le.dupPct.trim()):void 0,a=Le.corruptPct.trim()?Number(Le.corruptPct.trim()):void 0,o=Le.reorderPct.trim()?Number(Le.reorderPct.trim()):void 0,s=Le.rateKbps.trim()?Number(Le.rateKbps.trim()):void 0;Number.isFinite(e)&&(r.delayMs=e),Number.isFinite(t)&&(r.jitterMs=t),Number.isFinite(n)&&(r.lossPct=n),Number.isFinite(i)&&(r.dupPct=i),Number.isFinite(a)&&(r.corruptPct=a),Number.isFinite(o)&&(r.reorderPct=o),Number.isFinite(s)&&(r.rateKbps=s)}let i=(await Bi(t,r)).results.filter(e=>e.error);i.length?j.error(`Link impairment applied with errors`,{description:i.map(e=>`${e.node}: ${e.error}`).join(`; `)}):j.success(e===`clear`?`Link impairment cleared`:`Link impairment applied`)}catch(e){j.error(`Failed to apply link impairment`,{description:e?.message??String(e)})}finally{E(!1)}},[t,Le.corruptPct,Le.delayMs,Le.dupPct,Le.jitterMs,Le.lossPct,Le.rateKbps,Le.reorderPct]);return(0,M.useEffect)(()=>{if(!D||!t)return;se(null),le.current=null;let e=`/api/deploy/${encodeURIComponent(t)}/links/stats/events`,n=new EventSource(e,{withCredentials:!0}),r=e=>{try{let t=JSON.parse(String(e.data??`{}`));if(t.type===`error`){se(t.error||`failed to stream link stats`);return}if(t.type!==`snapshot`||!t.snapshot)return;let n=t.snapshot,r=Date.parse(n.generatedAt||``);if(!Number.isFinite(r))return;let i={};for(let e of n.edges??[])i[String(e.edgeId)]=e;let a=le.current;if(le.current={atMs:r,byEdge:i},!a)return;let o=(r-a.atMs)/1e3;if(!(o>0))return;let s={};for(let[e,t]of Object.entries(i)){let n=a.byEdge[e];if(!n)continue;let r=(e,t)=>Math.max(0,e-t),i=r(t.sourceTxBytes,n.sourceTxBytes),c=r(t.sourceRxBytes,n.sourceRxBytes),l=r(t.targetTxBytes,n.targetTxBytes),u=r(t.targetRxBytes,n.targetRxBytes),d=Math.max(i,u)+Math.max(l,c),f=r(t.sourceTxPackets,n.sourceTxPackets),p=r(t.sourceRxPackets,n.sourceRxPackets),m=r(t.targetTxPackets,n.targetTxPackets),h=r(t.targetRxPackets,n.targetRxPackets),g=(Math.max(f,h)+Math.max(m,p))/o,_=(r(t.sourceRxDropped,n.sourceRxDropped)+r(t.sourceTxDropped,n.sourceTxDropped)+r(t.targetRxDropped,n.targetRxDropped)+r(t.targetTxDropped,n.targetTxDropped))/o;s[e]={bps:d*8/o,pps:g,drops:_}}k(s)}catch(e){se(e?.message??String(e))}};return n.addEventListener(`stats`,r),n.onerror=()=>se(`link stats stream disconnected`),Yi(t).catch(()=>{}),()=>{n.removeEventListener(`stats`,r),n.close()}},[t,D]),(0,P.jsxs)(`div`,{className:`w-full bg-background/50 overflow-hidden relative ${a?`h-full`:`h-[600px]`} border rounded-xl ${o??``}`,ref:h,children:[(0,P.jsxs)(jt,{nodes:l,edges:f,onNodesChange:d,onEdgesChange:m,onConnect:Ye,onNodeContextMenu:Xe,onEdgeContextMenu:Ze,onEdgeMouseEnter:(e,t)=>{let n=h.current?.getBoundingClientRect(),r=n?e.clientX-n.left:e.clientX,i=n?e.clientY-n.top:e.clientY;Ie({id:String(t.id),x:r,y:i})},onEdgeMouseMove:e=>{if(!Fe)return;let t=h.current?.getBoundingClientRect(),n=t?e.clientX-t.left:e.clientX,r=t?e.clientY-t.top:e.clientY;Ie(e=>e?{...e,x:n,y:r}:null)},onEdgeMouseLeave:()=>Ie(null),onNodeDragStop:(e,t)=>{ge&&ve(e=>{let n={...e,[String(t.id)]:{x:t.position.x,y:t.position.y}};try{window.localStorage.setItem(ge,JSON.stringify(n))}catch{}return n})},nodeTypes:bl,fitView:!0,className:`bg-muted/10`,children:[(0,P.jsx)(Pt,{position:`top-right`,children:(0,P.jsxs)(L,{className:`shadow-sm border bg-background/85 backdrop-blur`,children:[(0,P.jsx)(R,{className:`p-3 pb-2`,children:(0,P.jsx)(z,{className:`text-sm`,children:`Tools`})}),(0,P.jsxs)(V,{className:`p-3 pt-0 space-y-2`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-2 rounded-md border bg-background/70 px-2 py-1`,children:[(0,P.jsx)(un,{className:`h-4 w-4 text-muted-foreground`}),(0,P.jsx)(K,{value:fe,onChange:e=>pe(e.target.value),placeholder:`Search nodes`,className:`h-7 w-56 border-0 bg-transparent p-0 text-sm focus-visible:ring-0`}),fe.trim()?(0,P.jsx)(F,{variant:`ghost`,size:`sm`,className:`h-7 px-2`,onClick:()=>pe(``),children:`Clear`}):null]}),(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(F,{variant:D?`default`:`outline`,size:`sm`,onClick:()=>{O(e=>{let t=!e;return t||(se(null),k({}),le.current=null),t})},disabled:!t,title:`Show live link utilization (SSE)`,children:[(0,P.jsx)(lt,{className:`mr-2 h-4 w-4`}),`Live stats`]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>he(e=>e===`grid`?`circle`:`grid`),title:`Toggle layout`,children:[(0,P.jsx)(Sn,{className:`mr-2 h-4 w-4`}),me===`grid`?`Grid`:`Circle`]}),(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>{if(ve({}),ge)try{window.localStorage.removeItem(ge)}catch{}},title:`Reset pinned node positions`,children:`Reset`}),(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>Je().catch(e=>j.error(`Failed to download inventory`,{description:e.message})),disabled:!t,title:`Download inventory CSV`,children:`Inventory`}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>h.current&&g(h.current,`topology.png`),children:[(0,P.jsx)(Ae,{className:`mr-2 h-4 w-4`}),`PNG`]})]}),(0,P.jsx)(`div`,{className:`text-[11px] text-muted-foreground`,children:`Tip: Right-click a node or link for actions.`})]})]})}),(0,P.jsx)(Ot,{}),(0,P.jsx)(Yt,{zoomable:!0,pannable:!0,className:`bg-background border rounded-lg`}),(0,P.jsx)(Ct,{gap:12,size:1})]}),D&&oe?(0,P.jsxs)(`div`,{className:`absolute bottom-2 left-2 z-40 rounded-md border bg-background/90 px-3 py-2 text-xs text-muted-foreground shadow-sm`,children:[`Live stats: `,oe]}):null,Fe&&D&&ce[Fe.id]?(0,P.jsxs)(`div`,{className:`absolute z-40 rounded-md border bg-background/90 px-3 py-2 text-xs shadow-sm`,style:{left:Fe.x+12,top:Fe.y+12},children:[(0,P.jsx)(`div`,{className:`font-mono`,children:Fe.id}),(0,P.jsxs)(`div`,{className:`text-muted-foreground`,children:[Sl(ce[Fe.id].bps),` `,` `,Math.round(ce[Fe.id].pps),` pps `,` `,ce[Fe.id].drops.toFixed(1),` drops/s`]})]}):null,ze&&(Be.data?.events?.length??0)>0?(0,P.jsx)(`div`,{className:`absolute bottom-2 right-2 z-40 w-[420px] max-w-[92vw]`,children:(0,P.jsxs)(L,{className:`shadow-sm border bg-background/90 backdrop-blur`,children:[(0,P.jsx)(R,{className:`p-3 pb-2`,children:(0,P.jsx)(z,{className:`text-sm`,children:`Recent activity`})}),(0,P.jsx)(V,{className:`p-3 pt-0 space-y-2`,children:(Be.data?.events??[]).slice(-8).reverse().map(e=>(0,P.jsxs)(`div`,{className:`flex items-start justify-between gap-2 text-xs`,children:[(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsx)(`div`,{className:`font-mono truncate`,children:e.eventType}),(0,P.jsx)(`div`,{className:`text-muted-foreground truncate`,children:e.createdAt})]}),(0,P.jsx)(`div`,{className:`text-muted-foreground font-mono truncate`,children:e.createdBy?e.createdBy:``})]},String(e.id)))})]})}):null,n&&t?(0,P.jsx)(_l,{open:!!_,onOpenChange:e=>{e||v(null)},deploymentId:t,nodeId:_?.id??``,nodeKind:_?.kind??``}):null,t?(0,P.jsx)(pl,{open:!!y,onOpenChange:e=>{e||b(null)},deploymentId:t,nodeId:y?.id??``,nodeKind:y?.kind??``,nodeIp:y?.ip??``}):null,t?(0,P.jsx)(dl,{open:!!ee,onOpenChange:e=>{e||te(null)},deploymentId:t,nodeId:ee?.id??``,nodeKind:ee?.kind??``,nodeIp:ee?.ip??``}):null,(0,P.jsx)(Zn,{open:xe,onOpenChange:e=>{Se(e),e||be(null)},children:(0,P.jsxs)(er,{className:`max-w-3xl`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{children:`Interfaces`})}),(0,P.jsx)(Dl,{node:ye?.id??``,data:Ge.data,loading:Ge.isPending,error:Ge.isError?Ge.error?.message??`failed`:``,autoRefresh:Ne,onToggleAutoRefresh:()=>Pe(e=>!e)})]})}),(0,P.jsx)(Zn,{open:Te,onOpenChange:e=>{Ee(e),e||we(null)},children:(0,P.jsxs)(er,{className:`max-w-4xl`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{children:`Running config`})}),(0,P.jsx)(Ol,{node:Ce?.id??``,data:Ke.data,loading:Ke.isPending,error:Ke.isError?Ke.error?.message??`failed`:``})]})}),C&&t?(0,P.jsx)(`div`,{className:`absolute z-50`,style:{left:C.x,top:C.y},onContextMenu:e=>e.preventDefault(),children:(0,P.jsxs)(L,{className:`w-64 shadow-lg border bg-background/95 backdrop-blur`,children:[(0,P.jsxs)(R,{className:`p-3 pb-2`,children:[(0,P.jsx)(z,{className:`text-sm`,children:`Node Actions`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:String(C.node?.data?.label??C.node.id)})]}),(0,P.jsxs)(V,{className:`p-3 pt-0 space-y-2`,children:[(0,P.jsx)(F,{size:`sm`,className:`w-full`,disabled:!n,onClick:()=>{let e=String(C.node?.data?.kind??``);w(null),v({id:String(C.node.id),kind:e})},children:`Open terminal`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,className:`w-full`,disabled:!n,onClick:()=>{let e=String(C.node.id),t=`${window.location.pathname}?node=${encodeURIComponent(e)}&action=terminal`;window.open(t,`_blank`,`noopener,noreferrer`),w(null)},children:`Open terminal (new tab)`}),(0,P.jsx)(F,{size:`sm`,variant:`secondary`,className:`w-full`,onClick:()=>{let e=String(C.node?.data?.kind??``),t=String(C.node?.data?.ip??``);w(null),b({id:String(C.node.id),kind:e,ip:t})},children:`View logs`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{let e=String(C.node.id),t=`${window.location.pathname}?node=${encodeURIComponent(e)}&action=logs`;window.open(t,`_blank`,`noopener,noreferrer`),w(null)},children:`View logs (new tab)`}),(0,P.jsx)(F,{size:`sm`,variant:`secondary`,className:`w-full`,onClick:()=>{let e=String(C.node?.data?.kind??``),t=String(C.node?.data?.ip??``);w(null),te({id:String(C.node.id),kind:e,ip:t})},children:`Describe`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{let e=String(C.node.id),t=`${window.location.pathname}?node=${encodeURIComponent(e)}&action=describe`;window.open(t,`_blank`,`noopener,noreferrer`),w(null)},children:`Describe (new tab)`}),(0,P.jsx)(F,{size:`sm`,variant:`secondary`,className:`w-full`,onClick:()=>{let e=String(C.node?.data?.kind??``),t=String(C.node?.data?.ip??``),n=String(C.node.id);w(null),be({id:n,kind:e,ip:t}),Se(!0)},children:`Interfaces`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{let e=String(C.node.id),t=`${window.location.pathname}?node=${encodeURIComponent(e)}&action=interfaces`;window.open(t,`_blank`,`noopener,noreferrer`),w(null)},children:`Interfaces (new tab)`}),(0,P.jsx)(F,{size:`sm`,variant:`secondary`,className:`w-full`,disabled:He.isPending,onClick:()=>{let e=String(C.node.id);w(null),He.mutate(e)},children:He.isPending?`Saving`:`Save config`}),(0,P.jsx)(F,{size:`sm`,variant:`secondary`,className:`w-full`,onClick:()=>{let e=String(C.node.id);w(null),we({id:e}),Ee(!0)},children:`Running config`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{let e=String(C.node.id),t=`${window.location.pathname}?node=${encodeURIComponent(e)}&action=running-config`;window.open(t,`_blank`,`noopener,noreferrer`),w(null)},children:`Running config (new tab)`}),(0,P.jsx)(F,{size:`sm`,variant:`ghost`,className:`w-full`,onClick:()=>{let e=String(C.node?.data?.ip??``).trim();if(!e){j.error(`No management IP available`);return}navigator.clipboard?.writeText(e),j.success(`Copied management IP`),w(null)},children:`Copy management IP`}),(0,P.jsx)(F,{size:`sm`,variant:`ghost`,className:`w-full`,onClick:()=>{let e=String(C.node.id);navigator.clipboard?.writeText(e),j.success(`Copied node name`),w(null)},children:`Copy node name`}),(0,P.jsx)(F,{size:`sm`,variant:`ghost`,className:`w-full`,onClick:()=>{let e=String(C.node?.data?.ip??``).trim();if(!e){j.error(`No management IP available`);return}let t=`ssh admin@${e}`;navigator.clipboard?.writeText(t),j.success(`Copied SSH command`),w(null)},children:`Copy SSH command`}),(0,P.jsx)(F,{size:`sm`,variant:`ghost`,className:`w-full`,onClick:()=>w(null),children:`Close`})]})]})}):null,x&&t?(0,P.jsx)(`div`,{className:`absolute z-50`,style:{left:x.x,top:x.y},onContextMenu:e=>e.preventDefault(),children:(0,P.jsxs)(L,{className:`w-64 shadow-lg border bg-background/95 backdrop-blur`,children:[(0,P.jsxs)(R,{className:`p-3 pb-2`,children:[(0,P.jsx)(z,{className:`text-sm`,children:`Link Actions`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:String(x.edge.label??x.edge.id)})]}),(0,P.jsxs)(V,{className:`p-3 pt-0 space-y-2`,children:[(0,P.jsx)(F,{size:`sm`,variant:Ve.edgeDown.has(String(x.edge.id))?`secondary`:`destructive`,className:`w-full`,disabled:Ue.isPending,onClick:()=>{let e=String(x.edge.id),t=Ve.edgeDown.has(e);S(null),Ue.mutate({edgeId:e,action:t?`up`:`down`})},children:Ve.edgeDown.has(String(x.edge.id))?`Bring link up`:`Bring link down`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,className:`w-full`,disabled:We.isPending,onClick:()=>{A({id:String(x.edge.id),label:String(x.edge.label??``)}),S(null),Oe(!0)},children:`Capture pcap`}),Ve.lastCaptureByEdge[String(x.edge.id)]?(0,P.jsx)(F,{size:`sm`,variant:`secondary`,className:`w-full`,onClick:()=>{let e=Ve.lastCaptureByEdge[String(x.edge.id)];S(null),qe(e).catch(e=>j.error(`Failed to download pcap`,{description:e.message}))},children:`Download last pcap`}):null,(0,P.jsx)(F,{size:`sm`,className:`w-full`,onClick:()=>{T({id:String(x.edge.id),label:String(x.edge.label??``)}),S(null),ie(!0)},children:`Configure impairment`}),(0,P.jsx)(F,{size:`sm`,variant:`secondary`,className:`w-full`,disabled:ae,onClick:()=>{let e=String(x.edge.id);S(null),Qe(`clear`,e)},children:`Clear impairment`}),(0,P.jsx)(F,{size:`sm`,variant:`ghost`,className:`w-full`,onClick:()=>S(null),children:`Close`})]})]})}):null,(0,P.jsx)(Zn,{open:De,onOpenChange:e=>{Oe(e),e||A(null)},children:(0,P.jsxs)(er,{className:`max-w-lg`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{children:`Capture pcap`})}),(0,P.jsxs)(`div`,{className:`space-y-4`,children:[ke?.label?(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:ke.label}):null,(0,P.jsxs)(`div`,{className:`grid grid-cols-2 gap-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`capSide`,children:`Side`}),(0,P.jsxs)(`select`,{id:`capSide`,className:`h-9 w-full rounded-md border bg-background px-3 text-sm`,value:je.side,onChange:e=>Me(t=>({...t,side:e.target.value})),children:[(0,P.jsx)(`option`,{value:`source`,children:`Source`}),(0,P.jsx)(`option`,{value:`target`,children:`Target`})]})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`capDuration`,children:`Duration (s)`}),(0,P.jsx)(K,{id:`capDuration`,inputMode:`numeric`,value:je.duration,onChange:e=>Me(t=>({...t,duration:e.target.value}))})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`capPackets`,children:`Max packets`}),(0,P.jsx)(K,{id:`capPackets`,inputMode:`numeric`,value:je.packets,onChange:e=>Me(t=>({...t,packets:e.target.value}))})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`capSnaplen`,children:`Snaplen`}),(0,P.jsx)(K,{id:`capSnaplen`,inputMode:`numeric`,value:je.snaplen,onChange:e=>Me(t=>({...t,snaplen:e.target.value}))})]})]}),(0,P.jsxs)(`div`,{className:`flex gap-2 justify-end`,children:[(0,P.jsx)(F,{variant:`secondary`,onClick:()=>Oe(!1),disabled:We.isPending,children:`Cancel`}),(0,P.jsx)(F,{onClick:()=>{let e=String(ke?.id??``);if(!e){j.error(`No link selected`);return}let t=Number(je.duration.trim()||`10`),n=Number(je.packets.trim()||`2500`),r=Number(je.snaplen.trim()||`192`);We.mutateAsync({edgeId:e,side:je.side,durationSeconds:t,maxPackets:n,snaplen:r}).then(e=>(j.success(`Pcap ready`,{description:e.artifactKey}),qe(e.artifactKey).catch(()=>{}))).finally(()=>Oe(!1))},disabled:We.isPending,children:We.isPending?`Capturing`:`Capture`})]})]})]})}),(0,P.jsx)(Zn,{open:re,onOpenChange:e=>{ie(e),e||T(null)},children:(0,P.jsxs)(er,{className:`max-w-lg`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{children:`Configure Link Impairment`})}),(0,P.jsxs)(`div`,{className:`space-y-4`,children:[ne?.label?(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:ne.label}):null,(0,P.jsxs)(`div`,{className:`grid grid-cols-2 gap-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`delayMs`,children:`Delay (ms)`}),(0,P.jsx)(K,{id:`delayMs`,inputMode:`numeric`,placeholder:`e.g. 50`,value:Le.delayMs,onChange:e=>Re(t=>({...t,delayMs:e.target.value}))})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`jitterMs`,children:`Jitter (ms)`}),(0,P.jsx)(K,{id:`jitterMs`,inputMode:`numeric`,placeholder:`e.g. 10`,value:Le.jitterMs,onChange:e=>Re(t=>({...t,jitterMs:e.target.value}))})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`lossPct`,children:`Loss (%)`}),(0,P.jsx)(K,{id:`lossPct`,inputMode:`decimal`,placeholder:`e.g. 1.0`,value:Le.lossPct,onChange:e=>Re(t=>({...t,lossPct:e.target.value}))})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`dupPct`,children:`Duplicate (%)`}),(0,P.jsx)(K,{id:`dupPct`,inputMode:`decimal`,placeholder:`e.g. 0.1`,value:Le.dupPct,onChange:e=>Re(t=>({...t,dupPct:e.target.value}))})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`corruptPct`,children:`Corrupt (%)`}),(0,P.jsx)(K,{id:`corruptPct`,inputMode:`decimal`,placeholder:`e.g. 0.05`,value:Le.corruptPct,onChange:e=>Re(t=>({...t,corruptPct:e.target.value}))})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`reorderPct`,children:`Reorder (%)`}),(0,P.jsx)(K,{id:`reorderPct`,inputMode:`decimal`,placeholder:`e.g. 0.2`,value:Le.reorderPct,onChange:e=>Re(t=>({...t,reorderPct:e.target.value}))})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{htmlFor:`rateKbps`,children:`Rate (kbit/s)`}),(0,P.jsx)(K,{id:`rateKbps`,inputMode:`numeric`,placeholder:`e.g. 100000`,value:Le.rateKbps,onChange:e=>Re(t=>({...t,rateKbps:e.target.value}))})]})]}),(0,P.jsxs)(`div`,{className:`flex gap-2 justify-end`,children:[(0,P.jsx)(F,{variant:`secondary`,onClick:()=>ie(!1),disabled:ae,children:`Cancel`}),(0,P.jsx)(F,{onClick:()=>{let e=String(ne?.id??``);if(!e){j.error(`No link selected`);return}Qe(`set`,e).finally(()=>ie(!1))},disabled:ae,children:`Apply`})]})]}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Tip: Right-click a link in the topology to configure impairment.`})]})})]})}function Sl(e){return e>0?e>=1e9?`${(e/1e9).toFixed(2)} Gbps`:e>=1e6?`${(e/1e6).toFixed(1)} Mbps`:e>=1e3?`${(e/1e3).toFixed(0)} Kbps`:`${Math.round(e)} bps`:`0 bps`}function Cl(e){if(!Number.isFinite(e)||e<=0)return`0 B`;let t=[`B`,`KB`,`MB`,`GB`,`TB`],n=e,r=0;for(;n>=1024&&r<t.length-1;)n/=1024,r++;let i=r===0||r===1?0:1;return`${n.toFixed(i)} ${t[r]}`}function wl(e){let t=new Set,n={};for(let r of e??[]){let e=String(r?.eventType??``),i=r?.payload??{},a=String(i?.edgeId??``).trim();if(a&&(e===`link.down`&&t.add(a),e===`link.up`&&t.delete(a),e===`link.capture`)){let e=String(i?.artifactKey??``).trim();e&&(n[a]=e)}}return{edgeDown:t,lastCaptureByEdge:n}}function Tl(e,t,n,r,i){return e.map(e=>{let a=String(e.id),o=r[a]??(typeof e.label==`string`?e.label:void 0),s=i.edgeDown.has(a);if(!n)return{...e,label:s?o?`${o}  DOWN`:`DOWN`:o,animated:!1,style:s?{stroke:`hsl(var(--destructive))`,strokeWidth:2,strokeDasharray:`6 6`}:void 0};let c=t[a];if(!c)return{...e,label:s?o?`${o}  DOWN`:`DOWN`:o,animated:!1,style:s?{stroke:`hsl(var(--destructive))`,strokeWidth:2,strokeDasharray:`6 6`}:void 0};let l=c.bps??0,u=1+Math.min(9,Math.log10(Math.max(1,l))/1.2),d=o?`${o}  ${Sl(l)}`:Sl(l),f=s?`${d}  DOWN`:d;return{...e,label:f,animated:!s&&l>0,style:{...e.style??{},strokeWidth:u,...s?{stroke:`hsl(var(--destructive))`,strokeDasharray:`6 6`}:{}}}})}function El(e,t,n,r){let i=r.trim().toLowerCase(),a=new Set;if(i)for(let t of e){let e=String(t?.data?.label??t.id).toLowerCase(),n=String(t.id).toLowerCase(),r=String(t?.data?.ip??``).toLowerCase();(e.includes(i)||n.includes(i)||r.includes(i))&&a.add(String(t.id))}let o=e.length||1,s=Math.max(260,o*30);return e.map((e,r)=>{let c=String(e.id),l=n[c],u=l??e.position;if(!l&&t===`circle`){let e=r/o*Math.PI*2;u={x:Math.cos(e)*s,y:Math.sin(e)*s}}let d=i?a.has(c):!1,f=i?!a.has(c):!1;return{...e,position:u,data:{...e.data,highlight:d},style:f?{...e.style??{},opacity:.25}:e.style}})}function Dl(e){if(e.loading)return(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Loading`});if(e.error)return(0,P.jsx)(`div`,{className:`text-sm text-destructive`,children:e.error});let t=e.data?.interfaces??[];return t.length?(0,P.jsxs)(`div`,{className:`space-y-3`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:e.node}),(0,P.jsx)(F,{size:`sm`,variant:e.autoRefresh?`default`:`outline`,onClick:e.onToggleAutoRefresh,children:e.autoRefresh?`Auto refresh: on`:`Auto refresh: off`})]}),(0,P.jsx)(`div`,{className:`rounded-md border overflow-auto max-h-[60vh]`,children:(0,P.jsxs)(`table`,{className:`w-full text-xs`,children:[(0,P.jsx)(`thead`,{className:`bg-muted/50 sticky top-0`,children:(0,P.jsxs)(`tr`,{children:[(0,P.jsx)(`th`,{className:`text-left p-2`,children:`Interface`}),(0,P.jsx)(`th`,{className:`text-left p-2`,children:`Peer`}),(0,P.jsx)(`th`,{className:`text-left p-2`,children:`State`}),(0,P.jsx)(`th`,{className:`text-right p-2`,children:`RX`}),(0,P.jsx)(`th`,{className:`text-right p-2`,children:`TX`}),(0,P.jsx)(`th`,{className:`text-right p-2`,children:`Drops`})]})}),(0,P.jsx)(`tbody`,{children:t.map(e=>(0,P.jsxs)(`tr`,{className:`border-t`,children:[(0,P.jsx)(`td`,{className:`p-2 font-mono`,children:e.ifName}),(0,P.jsx)(`td`,{className:`p-2 font-mono text-muted-foreground`,children:e.peerNode?`${e.peerNode}:${e.peerIf??``}`:``}),(0,P.jsx)(`td`,{className:`p-2`,children:e.operState??``}),(0,P.jsx)(`td`,{className:`p-2 text-right font-mono`,children:Cl(Number(e.rxBytes??0))}),(0,P.jsx)(`td`,{className:`p-2 text-right font-mono`,children:Cl(Number(e.txBytes??0))}),(0,P.jsx)(`td`,{className:`p-2 text-right font-mono`,children:Number(e.rxDropped??0)+Number(e.txDropped??0)})]},e.ifName))})]})})]}):(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`No interfaces found.`})}function Ol(e){if(e.loading)return(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Loading`});if(e.error)return(0,P.jsx)(`div`,{className:`text-sm text-destructive`,children:e.error});if(e.data?.skipped)return(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:e.data.message||`Skipped`});let t=String(e.data?.stdout??``);return(0,P.jsxs)(`div`,{className:`space-y-3`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:e.node}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,onClick:()=>{navigator.clipboard?.writeText(t),j.success(`Copied running config`)},disabled:!t,children:`Copy`})]}),(0,P.jsx)(`pre`,{className:`max-h-[65vh] overflow-auto rounded-md border bg-zinc-950 p-4 font-mono text-xs text-zinc-100 whitespace-pre-wrap`,children:t||`No output`}),e.data?.stderr?(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground whitespace-pre-wrap`,children:e.data.stderr}):null]})}var kl=Jn({source:Un().optional().catch(`user`),dir:Un().optional().catch(`containerlab/designer`),file:Un().optional().catch(``)});const Al=t(`/dashboard/labs/map`)({validateSearch:e=>kl.parse(e),component:Ml});function jl(e){let t=Yn.parse(String(e??``))?.topology??{},n=t?.nodes??{},r=Object.entries(n).map(([e,t])=>{let n=String(t?.kind??``);return{id:String(e),label:String(e),kind:n,status:`unknown`,mgmtIp:``}}),i=[],a=Array.isArray(t?.links)?t.links:[];for(let e=0;e<a.length;e++){let t=a[e],n=Array.isArray(t?.endpoints)?t.endpoints:[];if(n.length!==2)continue;let r=String(n[0]??``),o=String(n[1]??``),s=r.split(`:`)[0],c=o.split(`:`)[0];!s||!c||i.push({id:`e${e+1}`,source:s,target:c,label:`${r}  ${o}`})}return{nodes:r,edges:i}}function Ml(){let{source:e,dir:t,file:n}=Al.useSearch(),r=`self`,a=i({queryKey:[`containerlabTemplateMap`,r,e,t,n],queryFn:async()=>{if(!n)throw Error(`file is required`);return ta({source:e,dir:t,file:n})},enabled:!!n,retry:!1,staleTime:3e4}),o=(0,M.useMemo)(()=>{if(!a.data?.yaml)return null;try{return jl(a.data.yaml)}catch{return null}},[a.data?.yaml]);return n?a.isLoading||a.isFetching?(0,P.jsxs)(`div`,{className:`h-screen w-screen p-6`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,P.jsx)(U,{className:`h-9 w-9`}),(0,P.jsx)(U,{className:`h-8 w-64`})]}),(0,P.jsx)(`div`,{className:`mt-6`,children:(0,P.jsx)(U,{className:`h-[75vh] w-full`})})]}):!a.data||!o?(0,P.jsx)(`div`,{className:`h-screen w-screen p-6`,children:(0,P.jsx)(Cs,{title:`Map unavailable`,description:a.isError?`Failed to load template.`:`Template YAML could not be parsed into a topology.`,action:{label:`Close`,onClick:()=>window.close()}})}):(0,P.jsxs)(`div`,{className:`h-screen w-screen flex flex-col bg-background`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3 border-b px-4 py-3`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-3 min-w-0`,children:[(0,P.jsx)(p,{to:`/dashboard/labs/designer`,className:yr({variant:`outline`,size:`icon`,className:`h-9 w-9`}),title:`Back to designer`,children:(0,P.jsx)(ot,{className:`h-4 w-4`})}),(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsx)(`div`,{className:`font-semibold truncate`,children:`Lab map`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:a.data.path})]})]}),(0,P.jsx)(`div`,{className:`flex items-center gap-2`,children:(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>{navigator.clipboard?.writeText(a.data.yaml)},children:`Copy YAML`})})]}),(0,P.jsxs)(`div`,{className:`flex-1 min-h-0 grid grid-cols-1 lg:grid-cols-[1fr_520px]`,children:[(0,P.jsx)(`div`,{className:`min-h-0 p-3`,children:(0,P.jsx)(`div`,{className:`h-full rounded-xl border overflow-hidden`,children:(0,P.jsx)(xl,{topology:o,enableTerminal:!1,fullHeight:!0})})}),(0,P.jsx)(`div`,{className:`min-h-0 border-l bg-background p-3`,children:(0,P.jsxs)(L,{className:`h-full`,children:[(0,P.jsx)(R,{className:`pb-3`,children:(0,P.jsx)(z,{children:`YAML`})}),(0,P.jsx)(V,{className:`h-[calc(100%-56px)]`,children:(0,P.jsx)(Cc,{value:a.data.yaml,readOnly:!0,className:`h-full font-mono text-xs`})})]})})]})]}):(0,P.jsx)(`div`,{className:`h-screen w-screen p-6`,children:(0,P.jsxs)(`div`,{className:`max-w-2xl space-y-4`,children:[(0,P.jsx)(`div`,{className:`text-2xl font-bold tracking-tight`,children:`Lab map`}),(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Open this page from the Lab Designer Open map button, or provide query params.`}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{children:`Parameters`})}),(0,P.jsxs)(V,{className:`space-y-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`User scope`}),(0,P.jsx)(K,{value:r,readOnly:!0,placeholder:`self`})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`File`}),(0,P.jsx)(K,{value:n,readOnly:!0,placeholder:`file missing`})]}),(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`For repo source, `,(0,P.jsx)(`span`,{className:`font-mono`,children:`source=user`}),` `,`maps to your user repo scope.`]}),(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Example:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:`/dashboard/labs/map?source=user&dir=containerlab/designer&file=lab.clab.yml`})]})]})]})]})})}function Nl(e){let[t,n]=(0,M.useState)(``),[r,a]=(0,M.useState)(``),[o,s]=(0,M.useState)(``),c=i({queryKey:H.registryRepos(t),queryFn:async()=>ca({q:t,n:500}),retry:!1,staleTime:3e4}),l=i({queryKey:o?H.registryTags(o,r):[`registryTags`,`none`],queryFn:async()=>la(o,{q:r}),enabled:!!o,retry:!1,staleTime:3e4}),u=(0,M.useMemo)(()=>{let t=(e.value||``).trim(),n=t.lastIndexOf(`:`);return n<=0?{repo:t,tag:``}:{repo:t.slice(0,n),tag:t.slice(n+1)}},[e.value]);return(0,P.jsxs)(`div`,{className:`space-y-3 ${e.className??``}`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Image`}),(0,P.jsx)(K,{value:e.value,onChange:t=>e.onChange(t.target.value),placeholder:`repo:tag`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:"Registry-backed picker. Requires server env `SKYFORGE_REGISTRY_URL`."})]}),(0,P.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,P.jsx)(G,{children:`Repository`}),(0,P.jsx)(F,{size:`sm`,variant:`ghost`,onClick:()=>{u.repo&&(s(u.repo),j.message(`Repository selected`,{description:u.repo}))},children:`Use current`})]}),(0,P.jsx)(K,{value:t,onChange:e=>n(e.target.value),placeholder:`Search repos`}),(0,P.jsx)(`div`,{className:`max-h-40 overflow-auto rounded-md border`,children:c.isError?(0,P.jsx)(`div`,{className:`p-2 text-xs text-destructive`,children:`Failed to load repos.`}):c.isLoading?(0,P.jsx)(`div`,{className:`p-2 text-xs text-muted-foreground`,children:`Loading`}):(0,P.jsx)(`div`,{className:`divide-y`,children:(c.data?.repositories??[]).slice(0,200).map(e=>(0,P.jsx)(`button`,{type:`button`,className:`w-full text-left px-2 py-1.5 text-xs font-mono hover:bg-accent ${o===e?`bg-accent`:``}`,onClick:()=>s(e),children:e},e))})})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,P.jsx)(G,{children:`Tag`}),(0,P.jsx)(F,{size:`sm`,variant:`ghost`,onClick:()=>{if(!o)return;let t=`${o}:${u.tag||`latest`}`;e.onChange(t)},disabled:!o,children:`Set image`})]}),(0,P.jsx)(K,{value:r,onChange:e=>a(e.target.value),placeholder:`Search tags`,disabled:!o}),(0,P.jsx)(`div`,{className:`max-h-40 overflow-auto rounded-md border`,children:o?l.isError?(0,P.jsx)(`div`,{className:`p-2 text-xs text-destructive`,children:`Failed to load tags.`}):l.isLoading?(0,P.jsx)(`div`,{className:`p-2 text-xs text-muted-foreground`,children:`Loading`}):(0,P.jsx)(`div`,{className:`divide-y`,children:(l.data?.tags??[]).slice(0,300).map(t=>(0,P.jsx)(`button`,{type:`button`,className:`w-full text-left px-2 py-1.5 text-xs font-mono hover:bg-accent`,onClick:()=>e.onChange(`${o}:${t}`),children:t},t))}):(0,P.jsx)(`div`,{className:`p-2 text-xs text-muted-foreground`,children:`Select a repo`})})]})]})]})}function Pl(e){let t=String(e??``).trim();return t&&t.toLowerCase().replace(/[^a-z0-9-]+/g,`-`).replace(/^-+|-+$/g,``).slice(0,48)||`node`}function Fl(e){let t=new Set,n=new Map;for(let r of e){let e=Pl(r.id||r.label||`node`),i=e,a=2;for(;t.has(i);)i=`${e}-${a++}`;t.add(i),n.set(r.id,i)}return n}function Il(e){let t=[],n=Pl(e.name||`lab`),r=Fl(e.nodes),i=new Map,a=e=>{let t=(i.get(e)??0)+1;return i.set(e,t),`eth${t}`},o={};for(let n of e.nodes){let e=r.get(n.id)||Pl(n.id),i=String(n.id||n.label||``).trim();i&&Pl(i)!==i&&t.push(`Node ${i}: name will be '${Pl(i)}'`),i&&Pl(i)!==e&&t.push(`Node ${i}: name adjusted to '${e}'`);let a=(n.kind||``).trim()||void 0,s=(n.image||``).trim()||void 0;s||t.push(`Node ${e}: missing image`),o[e]={...a?{kind:a}:{},...s?{image:s}:{},...n.env&&Object.keys(n.env).length?{env:n.env}:{},...n.mgmtIpv4?{mgmt_ipv4:n.mgmtIpv4}:{}}}let s=[];for(let n of e.links){let e=r.get(n.source),i=r.get(n.target);if(!e||!i){t.push(`Link ${n.id}: missing endpoint(s)`);continue}let o=a(n.source),c=a(n.target);s.push({endpoints:[`${e}:${o}`,`${i}:${c}`]})}let c={name:n,topology:{nodes:o,...s.length?{links:s}:{}}},l=(e,t=0)=>{let n=`  `.repeat(t);if(e==null)return`null`;if(typeof e==`string`)return JSON.stringify(e);if(typeof e==`number`||typeof e==`boolean`)return String(e);if(Array.isArray(e))return e.length===0?`[]`:e.map(e=>{if(typeof e==`object`&&e&&!Array.isArray(e)){let r=l(e,t+1).split(`
`);return`${n}- ${r[0].trimStart()}\n${r.slice(1).map(e=>`${n}  ${e}`).join(`
`)}`}return`${n}- ${l(e,0)}`}).join(`
`);if(typeof e==`object`){let r=Object.keys(e);return r.length===0?`{}`:r.map(r=>{let i=e[r];return i===void 0?``:typeof i==`object`&&i?`${n}${r}:\n${l(i,t+1)}`:`${n}${r}: ${l(i,0)}`}).filter(Boolean).join(`
`)}return JSON.stringify(String(e))};return{yaml:l(c,0)+`
`,warnings:t}}var Ll=Jn({importDeploymentId:Un().optional().catch(``)});const Rl=t(`/dashboard/labs/designer`)({validateSearch:e=>Ll.parse(e),component:Gl});var zl=`application/x-skyforge-palette-item`;function Bl(e){let t=String(e??``).trim();if(!t)return``;try{return new URL(t).hostname||t}catch{return t.replace(/^https?:\/\//,``).split(`/`)[0]??t}}function Vl(e){let t=String(e??``).trim().replace(/^\/+|\/+$/g,``),n=t.toLowerCase(),r=t.split(`/`).pop()??t,i=e=>({id:`${e.kind}:${e.repo??``}`,...e});return n.includes(`endhost`)||n.includes(`linux`)||n.includes(`ubuntu`)||n.includes(`alpine`)?i({label:`Host  ${r}`,category:`Hosts`,kind:`linux`,repo:t,vendor:`Linux`,model:r,role:`host`}):r===`ceos`||n.endsWith(`/ceos`)||n.includes(`/ceos:`)?i({label:`Switch  Arista cEOS`,category:`Switches`,kind:`ceos`,repo:t,vendor:`Arista`,model:`cEOS`,role:`switch`}):n.includes(`vrnetlab/cisco_iol`)?i({label:`Router  Cisco IOL (IOS)`,category:`Routers`,kind:`cisco_iol`,repo:t,vendor:`Cisco`,model:`IOL`,role:`router`}):n.includes(`vrnetlab/cisco_viosl2`)?i({label:`Switch  Cisco vIOS L2`,category:`Switches`,kind:`cisco_viosl2`,repo:t,vendor:`Cisco`,model:`vIOS L2`,role:`switch`}):n.includes(`vrnetlab/vr-n9kv`)||n.includes(`vrnetlab/nxos`)?i({label:`Switch  Cisco NX-OSv (N9Kv)`,category:`Switches`,kind:`vr-n9kv`,repo:t,vendor:`Cisco`,model:`NX-OSv9k`,role:`switch`}):n.includes(`vrnetlab/vr-vmx`)||n.includes(`/vr-vmx`)?i({label:`Router  Juniper vMX`,category:`Routers`,kind:`vr-vmx`,repo:t,vendor:`Juniper`,model:`vMX`,role:`router`}):n.includes(`vrnetlab/juniper_vjunos-router`)?i({label:`Router  Juniper vJunos Router`,category:`Routers`,kind:`juniper_vjunos-router`,repo:t,vendor:`Juniper`,model:`vJunos-router`,role:`router`}):n.includes(`vrnetlab/juniper_vjunos-switch`)?i({label:`Switch  Juniper vJunos Switch`,category:`Switches`,kind:`juniper_vjunos-switch`,repo:t,vendor:`Juniper`,model:`vJunos-switch`,role:`switch`}):n.includes(`vrnetlab/juniper_vsrx`)||n.includes(`vr-vsrx`)||n.includes(`vsrx`)||n.includes(`/srx`)?i({label:`Firewall  Juniper SRX`,category:`Firewalls`,kind:`vr-vsrx`,repo:t,vendor:`Juniper`,model:`SRX`,role:`firewall`}):n.includes(`vrnetlab/vr-fortios`)||n.includes(`fortios`)?i({label:`Firewall  Fortinet FortiOS`,category:`Firewalls`,kind:`vr-fortios`,repo:t,vendor:`Fortinet`,model:`FortiOS`,role:`firewall`}):n.includes(`vrnetlab/vr-ftosv`)||n.includes(`os10`)?i({label:`Switch  Dell OS10`,category:`Switches`,kind:`vr-ftosv`,repo:t,vendor:`Dell`,model:`OS10`,role:`switch`}):n.includes(`vrnetlab/`)&&(n.includes(`asa`)||n.includes(`pan`)||n.includes(`palo`)||n.includes(`checkpoint`))?i({label:`Firewall  ${r}`,category:`Firewalls`,kind:r,repo:t,role:`firewall`}):i({label:`Node  ${r}`,category:`Other`,kind:r,repo:t,role:`other`})}function Hl(e){let t=e.item,n=t.role===`firewall`?Ye:t.role===`host`?be:Ee,r=t.vendor?`${t.vendor}${t.model?`  ${t.model}`:``}`:t.label,i=t.role===`router`?`Router`:t.role===`switch`?`Switch`:t.role===`firewall`?`Firewall`:t.role===`host`?`Host`:`Node`;return(0,P.jsx)(`div`,{className:`cursor-grab select-none rounded-lg border bg-background px-3 py-2 text-sm hover:bg-accent`,draggable:!0,onDragStart:e=>{e.dataTransfer.setData(zl,JSON.stringify(t)),e.dataTransfer.effectAllowed=`copy`},title:t.repo?`${t.label}\n${t.repo}`:t.label,children:(0,P.jsxs)(`div`,{className:`flex items-start gap-2`,children:[(0,P.jsx)(n,{className:`mt-0.5 h-4 w-4 text-muted-foreground`}),(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsxs)(`div`,{className:`truncate flex items-center gap-2`,children:[(0,P.jsx)(`span`,{className:`truncate`,children:r}),(0,P.jsx)(`span`,{className:`shrink-0 rounded-full bg-muted px-2 py-0.5 text-[10px] font-medium text-muted-foreground`,children:i})]}),(0,P.jsx)(`div`,{className:`truncate text-[11px] text-muted-foreground font-mono`,children:t.repo??t.kind})]})]})})}async function Ul(e){let t=String(e.repo??``).trim().replace(/^\/+|\/+$/g,``);if(!t)return`latest`;try{let n=await e.queryClient.fetchQuery({queryKey:H.registryTags(t,``),queryFn:async()=>la(t,{q:``}),retry:!1,staleTime:3e4}),r=Array.isArray(n?.tags)?n.tags:[];return r.includes(`latest`)?`latest`:r.length>0?String(r[r.length-1]):`latest`}catch{return`latest`}}function Wl(e){let t=String(e.data?.kind??``),n=String(e.data?.label??e.id),r=t.toLowerCase(),i=r.includes(`forti`)||r.includes(`vsrx`)||r.includes(`srx`)||r.includes(`asa`)||r.includes(`pan`),a=r.includes(`linux`)||r.includes(`host`),o=i?Ye:a?be:Te,s=i?`border-amber-500/60`:a?`border-emerald-500/60`:`border-sky-500/60`;return(0,P.jsxs)(`div`,{className:[`rounded-xl border bg-background/95 px-3 py-2 shadow-sm min-w-[140px]`,e.selected?`ring-2 ring-primary/60`:``,s].join(` `),children:[(0,P.jsx)(an,{type:`target`,position:Nn.Top}),(0,P.jsx)(an,{type:`target`,position:Nn.Left}),(0,P.jsx)(an,{type:`source`,position:Nn.Right}),(0,P.jsx)(an,{type:`source`,position:Nn.Bottom}),(0,P.jsxs)(`div`,{className:`flex items-start gap-2`,children:[(0,P.jsx)(`div`,{className:`mt-0.5 rounded-md border bg-muted p-1.5`,children:(0,P.jsx)(o,{className:`h-4 w-4`})}),(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsx)(`div`,{className:`font-medium leading-tight truncate`,children:n}),(0,P.jsx)(`div`,{className:`text-[11px] text-muted-foreground truncate`,children:t||`node`})]})]})]})}function Gl(){let e=Rl.useSearch(),t=String(e.importDeploymentId??``).trim(),n=`skyforge.labDesigner.v1`,a=(0,M.useRef)(null),o=c(),s=i({queryKey:H.dashboardSnapshot(),queryFn:Rr,retry:!1,staleTime:3e4}),[l,u]=(0,M.useState)(`lab`),[d,f]=(0,M.useState)(`self`),[p,m]=(0,M.useState)(`clabernetes`),[h,g]=(0,M.useState)(``),[_,v]=(0,M.useState)(!0),[y,b]=(0,M.useState)(null),[ee,te]=(0,M.useState)(`containerlab/designer`),[x,S]=(0,M.useState)(``),[C,w]=(0,M.useState)(!0),[ne,T]=(0,M.useState)(``),[re,ie]=(0,M.useState)(`all`),[E,D]=(0,M.useState)(`all`),[O,oe]=(0,M.useState)(null),[se,ce]=(0,M.useState)(``),[k,le]=(0,M.useState)(!1),[ue,de]=(0,M.useState)(``),[fe,pe]=(0,M.useState)(`generated`),[me,he]=(0,M.useState)(``),[ge,ve]=(0,M.useState)(!1),[ye,be]=(0,M.useState)(`blueprints`),[xe,Se]=(0,M.useState)(`containerlab`),[Ce,we]=(0,M.useState)(``),[Te,De]=(0,M.useState)(!1),[ke,A]=(0,M.useState)(`clos`),[je,Me]=(0,M.useState)(2),[Ne,Pe]=(0,M.useState)(4),[Fe,Ie]=(0,M.useState)(1),[Le,Re]=(0,M.useState)(`ceos`),[ze,Be]=(0,M.useState)(``),[Ve,He]=(0,M.useState)(`linux`),[Ue,We]=(0,M.useState)(``),[Ge,Ke]=(0,M.useState)(!0),[qe,Je]=(0,M.useState)(null),[Ye,Xe]=(0,M.useState)(null),[Ze,Qe]=(0,M.useState)(null),[$e,et]=(0,M.useState)(!1),[tt,nt,rt]=wn([{id:`r1`,position:{x:80,y:80},data:{label:`r1`,kind:`linux`,image:``},type:`designerNode`}]),[it,at,ot]=dt([]),ct=(0,M.useCallback)(()=>{et(!0)},[]),lt=(0,M.useCallback)(e=>{e.some(e=>e.type!==`select`)&&ct(),rt(e)},[ct,rt]),ut=(0,M.useCallback)(e=>{e.some(e=>e.type!==`select`)&&ct(),ot(e)},[ct,ot]),ft=(0,M.useMemo)(()=>tt.find(e=>e.id===se)??null,[tt,se]),pt=(0,M.useMemo)(()=>({name:l,nodes:tt.map(e=>({id:String(e.id),label:String(e.data?.label??e.id),kind:String(e.data?.kind??``),image:String(e.data?.image??``),position:{x:e.position.x,y:e.position.y}})),links:it.map(e=>({id:String(e.id),source:String(e.source),target:String(e.target)}))}),[it,l,tt]),{yaml:mt,warnings:ht}=(0,M.useMemo)(()=>Il(pt),[pt]),gt=(0,M.useMemo)(()=>ht.filter(e=>e.toLowerCase().includes(`missing image`)),[ht]),vt=(0,M.useMemo)(()=>ht.filter(e=>!e.toLowerCase().includes(`missing image`)),[ht]),yt=(0,M.useMemo)(()=>fe===`custom`?String(me??``):mt,[me,mt,fe]),bt=(0,M.useMemo)(()=>String(ee??``).trim().replace(/^\/+|\/+$/g,``)||`containerlab/designer`,[ee]),xt=(0,M.useMemo)(()=>{let e=String(x??``).trim()||`${l||`lab`}.clab.yml`;return e.endsWith(`.yml`)||e.endsWith(`.yaml`)?e:`${e}.yml`},[l,x]);(0,M.useEffect)(()=>{if(!ge||!d)return;let e=`skyforge.labDesigner.importPrefs.${d}`;try{let t=window.localStorage.getItem(e);if(!t)return;let n=JSON.parse(t);(n?.source===`user`||n?.source===`blueprints`)&&be(n.source),typeof n?.dir==`string`&&Se(n.dir)}catch{}},[ge,d]),(0,M.useEffect)(()=>{if(!d)return;let e=`skyforge.labDesigner.importPrefs.${d}`;try{window.localStorage.setItem(e,JSON.stringify({source:ye,dir:xe}))}catch{}},[xe,ye,d]);let St=()=>{let e=tt.length+1,t=`n${e}`,n=new Set(tt.map(e=>e.id));for(;n.has(t);)e++,t=`n${e}`;let r={x:120+tt.length*40,y:120+tt.length*30},i={id:t,position:r,data:{label:t,kind:`linux`,image:``},type:`designerNode`};nt(e=>[...e,i]),ce(t)},wt=()=>{let e=Math.max(1,Math.min(16,Number.isFinite(je)?je:2)),t=Math.max(1,Math.min(64,Number.isFinite(Ne)?Ne:4)),n=Math.max(0,Math.min(16,Number.isFinite(Fe)?Fe:1));u((ke||`clos`).trim()||`clos`);let r=(e,t,n,r,i)=>({id:e,position:{x:t,y:n},data:{label:e,kind:r,image:i},type:`designerNode`}),i=[],a=[],o=Array.from({length:e},(e,t)=>`s${t+1}`),s=Array.from({length:t},(e,t)=>`l${t+1}`);for(let e=0;e<o.length;e++)i.push(r(o[e],120+e*260,120,Le,ze));for(let e=0;e<s.length;e++)i.push(r(s[e],120+e*260,320,Le,ze));for(let e of s)for(let t of o)a.push({id:`e-${e}-${t}`,source:e,target:t});let c=1;for(let e=0;e<s.length;e++){let t=s[e];for(let o=0;o<n;o++){let n=`h${c++}`,s=120+e*260+o*70;i.push(r(n,s,520,Ve,Ue)),a.push({id:`e-${n}-${t}`,source:n,target:t})}}nt(i),at(a),pe(`generated`),he(``),ce(``),De(!1),requestAnimationFrame(()=>O?.fitView({padding:.15,duration:250})),i.filter(e=>!String(e.data?.image??``).trim()).length?j.message(`Quickstart created (missing images)`,{description:`Pick images per-node (or use defaults) before deploying.`}):j.success(`Starter topology created`)},Tt=()=>{let e=tt.length;if(!e)return;let t=Math.max(1,Math.ceil(Math.sqrt(e)));nt(e=>e.map((e,n)=>({...e,position:{x:120+n%t*260,y:120+Math.floor(n/t)*180}}))),requestAnimationFrame(()=>O?.fitView({padding:.15,duration:300}))},Dt=()=>{Je(null),Xe(null),Qe(null)},kt=e=>{if(!t)return;let n=new URLSearchParams;n.set(`action`,e.action),n.set(`node`,e.node);let r=`/dashboard/deployments/${encodeURIComponent(t)}?${n.toString()}`;window.open(r,`_blank`,`noopener,noreferrer`)},At=e=>{let t=tt.find(t=>String(t.id)===e);if(!t)return;let n=String(t.data?.label??t.id),r=window.prompt(`Node name`,n);if(r==null)return;let i=r.trim();if(!i)return;let a=new Set(tt.map(e=>String(e.id)));a.delete(e);let o=i,s=2;for(;a.has(o);)o=`${i}-${s++}`;nt(t=>t.map(t=>String(t.id)===e?{...t,id:o,data:{...t.data,label:i}}:t)),at(t=>t.map(t=>({...t,source:String(t.source)===e?o:t.source,target:String(t.target)===e?o:t.target,label:String(t.source)===e||String(t.target)===e?`${String(t.source)===e?o:t.source}  ${String(t.target)===e?o:t.target}`:t.label}))),se===e&&ce(o),Je(t=>t&&t.nodeId===e?{...t,nodeId:o}:t)};(0,M.useEffect)(()=>{let e=e=>{e.key===`Escape`&&Dt()};return window.addEventListener(`keydown`,e),()=>window.removeEventListener(`keydown`,e)},[]);let Mt=()=>{let e=new Blob([yt],{type:`text/yaml`}),t=document.createElement(`a`);t.href=URL.createObjectURL(e),t.download=`${l||`lab`}.clab.yml`,document.body.appendChild(t),t.click(),t.remove(),setTimeout(()=>URL.revokeObjectURL(t.href),5e3)};(0,M.useEffect)(()=>{let t=String(e.importDeploymentId??``).trim();if(!t||((s.data?.deployments??[]).find(e=>String(e?.id??``)===t),!d))return;v(!1),b(null);let n=!1;return(async()=>{try{let e=await sa(t);if(n)return;let r=(e.nodes??[]).map((e,t)=>({id:String(e.id),position:{x:120+t%4*260,y:120+Math.floor(t/4)*180},data:{label:String(e.label||e.id),kind:String(e.kind||``),image:``},type:`designerNode`})),i=(e.edges??[]).map(e=>({id:String(e.id),source:String(e.source),target:String(e.target),label:e.label||`${e.source}  ${e.target}`}));if(!r.length)throw Error(`No nodes found in deployment topology`);nt(r),at(i),ce(String(r[0].id)),j.success(`Imported running topology`,{description:`Deployment ${t}`}),requestAnimationFrame(()=>O?.fitView({padding:.15,duration:250}))}catch(e){if(n)return;j.error(`Failed to import deployment topology`,{description:e.message})}})(),()=>{n=!0}},[e.importDeploymentId,s.data?.deployments]);let Nt=()=>{try{let e={labName:l,scopeId:d,runtime:p,containerlabServer:h,useSavedConfig:_,lastSaved:y,nodes:tt,edges:it};window.localStorage.setItem(n,JSON.stringify(e)),j.success(`Draft saved`)}catch(e){j.error(`Failed to save draft`,{description:e.message})}},Pt=()=>{try{let e=window.localStorage.getItem(n);if(!e){j.message(`No saved draft`);return}let t=JSON.parse(e);typeof t?.labName==`string`&&u(t.labName),(t?.runtime===`clabernetes`||t?.runtime===`containerlab`)&&m(t.runtime),typeof t?.containerlabServer==`string`?g(t.containerlabServer):typeof t?.netlabServer==`string`&&g(t.netlabServer),typeof t?.useSavedConfig==`boolean`&&v(t.useSavedConfig),t?.lastSaved&&typeof t.lastSaved==`object`&&b({scopeId:d,templatesDir:String(t.lastSaved?.templatesDir??``),template:String(t.lastSaved?.template??``),filePath:String(t.lastSaved?.filePath??``),branch:String(t.lastSaved?.branch??``)}),Array.isArray(t?.nodes)&&nt(t.nodes),Array.isArray(t?.edges)&&at(t.edges),j.success(`Draft loaded`)}catch(e){j.error(`Failed to load draft`,{description:e.message})}},Ft=i({queryKey:H.registryRepos(``),queryFn:async()=>ca({q:``,n:2e3}),retry:!1,staleTime:6e4}),It=i({queryKey:H.userContainerlabServers(),queryFn:Oi,enabled:p===`containerlab`,retry:!1,staleTime:3e4}),Lt=i({queryKey:d?[`containerlabTemplates`,d,ye,xe]:[`containerlabTemplates`,`none`],queryFn:async()=>$i({source:ye,dir:xe}),enabled:!!d&&ge,retry:!1,staleTime:3e4}),Rt=i({queryKey:d?[`containerlabTemplate`,d,ye,xe,Ce]:[`containerlabTemplate`,`none`],queryFn:async()=>{if(!d)throw Error(`missing user scope`);return Ce?ta({source:ye,dir:xe,file:Ce}):null},enabled:!!d&&ge&&!!Ce,retry:!1,staleTime:3e4}),zt=r({mutationFn:async()=>{if(!d)throw Error(`No user scope available.`);if(!yt.trim())throw Error(`YAML is empty`);if(!/^\s*topology\s*:/m.test(yt))throw Error(`YAML must contain a top-level 'topology:' section`);if(bt!==`containerlab`&&!bt.startsWith(`containerlab/`))throw Error(`Repo path must be under containerlab/`);let e=_&&y?.scopeId===d?y:await ia({name:l,topologyYAML:yt,templatesDir:bt,template:xt}).then(e=>{let t={scopeId:d,templatesDir:e.templatesDir,template:e.template,filePath:e.filePath,branch:e.branch};return b(t),t});if(p===`containerlab`){if(!h)throw Error(`Select a containerlab server`);return oa({name:l,netlabServer:h,templateSource:`user`,templatesDir:e.templatesDir,template:e.template,autoDeploy:!0})}return aa({name:l,templateSource:`user`,templatesDir:e.templatesDir,template:e.template,autoDeploy:!0})},onSuccess:async e=>{j.success(`Deployment created`,{description:e.deployment?.name??l}),await o.invalidateQueries({queryKey:H.dashboardSnapshot()});let t=e.deployment?.id;Ge&&t&&window.open(`/dashboard/deployments/${t}`,`_blank`,`noopener,noreferrer`)},onError:e=>j.error(`Create deployment failed`,{description:e.message})}),Bt=r({mutationFn:async()=>{if(!d)throw Error(`No user scope available.`);if(!yt.trim())throw Error(`YAML is empty`);if(!/^\s*topology\s*:/m.test(yt))throw Error(`YAML must contain a top-level 'topology:' section`);if(bt!==`containerlab`&&!bt.startsWith(`containerlab/`))throw Error(`Repo path must be under containerlab/`);return ia({name:l,topologyYAML:yt,templatesDir:bt,template:xt})},onSuccess:e=>{b({scopeId:d,templatesDir:e.templatesDir,template:e.template,filePath:e.filePath,branch:e.branch}),j.success(`Saved to repo`,{description:`${e.filePath} (${e.branch})`})},onError:e=>j.error(`Save failed`,{description:e.message})}),Vt=r({mutationFn:async()=>{if(!d)throw Error(`No user scope available.`);let e=Ce.trim();if(!e)throw Error(`Select a template`);return ta({source:ye,dir:xe,file:e})},onSuccess:e=>{pe(`custom`),he(e.yaml),ve(!1),j.success(`Template imported`,{description:e.path})},onError:e=>j.error(`Import failed`,{description:e.message})}),Ht=e=>{e.preventDefault(),e.dataTransfer.dropEffect=`move`},Ut=async e=>{if(e.preventDefault(),!a.current||!O)return;let t=e.dataTransfer.getData(zl),n=t?(()=>{try{return JSON.parse(t)}catch{return null}})():null,r=n?.kind;if(!r)return;let i=a.current.getBoundingClientRect(),s=O.screenToFlowPosition({x:e.clientX-i.left,y:e.clientY-i.top}),c=n?.role,l=c===`host`?`h`:c===`router`?`r`:c===`switch`?`s`:c===`firewall`?`f`:r===`linux`?`h`:`n`,u=tt.length+1,d=`${l}${u}`,f=new Set(tt.map(e=>e.id));for(;f.has(d);)u++,d=`${l}${u}`;let p=String(n?.repo??``).trim(),m=p?await Ul({repo:p,queryClient:o}):``,h=p?`${p}:${m}`:``,g={id:d,position:s,data:{label:d,kind:r,image:h},type:`designerNode`};ct(),nt(e=>[...e,g]),ce(d)},Wt=async()=>{if(!d){j.error(`No user scope available.`);return}try{let e=y?.scopeId===d?y:await ia({name:l,topologyYAML:yt,templatesDir:bt,template:xt}).then(e=>{let t={scopeId:d,templatesDir:e.templatesDir,template:e.template,filePath:e.filePath,branch:e.branch};return b(t),t}),t=new URLSearchParams;t.set(`source`,`user`),t.set(`dir`,e.templatesDir),t.set(`file`,e.template);let n=`/dashboard/labs/map?${t.toString()}`;window.open(n,`_blank`,`noopener,noreferrer`)}catch(e){j.error(`Failed to open map`,{description:e.message})}},Gt=e=>{let t=e.target,n=t?.tagName?.toUpperCase?.()??``;if(n===`INPUT`||n===`TEXTAREA`||t?.isContentEditable)return;if(e.key===`Escape`){Dt();return}if(e.key!==`Delete`&&e.key!==`Backspace`)return;let r=new Set(tt.filter(e=>e.selected).map(e=>String(e.id))),i=new Set(it.filter(e=>e.selected).map(e=>String(e.id)));r.size===0&&i.size===0||(e.preventDefault(),nt(e=>e.filter(e=>!r.has(String(e.id)))),at(e=>e.filter(e=>!(i.has(String(e.id))||r.has(String(e.source))||r.has(String(e.target))))))},Kt=(0,M.useMemo)(()=>({designerNode:Wl}),[]),Jt=(0,M.useMemo)(()=>(Ft.isError?[]:Ft.data?.repositories??[]).map(Vl),[Ft.data?.repositories,Ft.isError]),Xt=(0,M.useMemo)(()=>{let e=new Set;for(let t of Jt){let n=String(t.vendor??``).trim();n&&e.add(n)}return Array.from(e).sort((e,t)=>e.localeCompare(t))},[Jt]),Zt=(0,M.useMemo)(()=>{let e=Jt,t=ne.trim().toLowerCase(),n=e.filter(e=>re===`all`?!0:String(e.vendor??``)===re).filter(e=>E===`all`?!0:String(e.role??`other`)===E).filter(e=>t?`${e.label} ${e.kind} ${e.category} ${e.repo??``}`.toLowerCase().includes(t):!0),r={Hosts:0,Routers:1,Switches:2,Firewalls:3,Other:4};return n.sort((e,t)=>{let n=r[e.category]??99,i=r[t.category]??99;return n===i?e.label.localeCompare(t.label):n-i})},[Jt,E,ne,re]),Qt=Jt.length>0&&Zt.length===0,$t=Ft.isError?Ft.error?.message||`Registry unavailable.`:``;return(0,P.jsxs)(`div`,{className:`h-full w-full p-4 flex flex-col gap-4 min-h-0`,children:[(0,P.jsxs)(`div`,{className:`flex flex-col gap-3 md:flex-row md:items-center md:justify-between`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`text-2xl font-bold tracking-tight`,children:`Lab Designer (Containerlab)`}),(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Drag nodes, wire links, generate Containerlab YAML, and deploy.`})]}),(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>De(!0),children:[(0,P.jsx)(Ee,{className:`mr-2 h-4 w-4`}),`Get started`]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>ve(!0),disabled:!d,children:[(0,P.jsx)(jn,{className:`mr-2 h-4 w-4`}),`Import template`]}),(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:Pt,children:`Load draft`}),(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:Nt,children:`Save draft`}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>Bt.mutate(),disabled:Bt.isPending,children:[(0,P.jsx)(_e,{className:`mr-2 h-4 w-4`}),`Save config`]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:Mt,children:[(0,P.jsx)(Ae,{className:`mr-2 h-4 w-4`}),`Download YAML`]})]})]}),(0,P.jsxs)(`div`,{className:`grid gap-4 lg:grid-cols-[1fr_420px] flex-1 min-h-0`,children:[(0,P.jsxs)(L,{className:`flex flex-col min-h-0`,children:[(0,P.jsx)(R,{className:`pb-3`,children:(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,P.jsx)(z,{children:`Topology`}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(F,{size:`sm`,variant:`outline`,onClick:()=>w(e=>!e),children:C?`Snap: on`:`Snap: off`}),(0,P.jsxs)(F,{size:`sm`,variant:k?`default`:`outline`,onClick:()=>{le(e=>{let t=!e;return t||de(``),t})},title:`Create links by clicking a source node, then a target node`,children:[(0,P.jsx)(qt,{className:`mr-2 h-4 w-4`}),k?`Link: on`:`Link: off`]}),(0,P.jsxs)(F,{size:`sm`,variant:`outline`,onClick:Tt,disabled:tt.length<2,children:[(0,P.jsx)(Sn,{className:`mr-2 h-4 w-4`}),`Auto-layout`]}),(0,P.jsxs)(F,{size:`sm`,variant:`outline`,onClick:St,children:[(0,P.jsx)(Et,{className:`mr-2 h-4 w-4`}),`Add node`]})]})]})}),(0,P.jsx)(V,{className:`flex-1 min-h-0`,children:(0,P.jsxs)(`div`,{className:`flex h-full w-full border rounded-xl overflow-hidden bg-background/50`,children:[(0,P.jsxs)(`div`,{className:`w-[180px] border-r bg-background p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs font-semibold text-muted-foreground`,children:`Palette`}),(0,P.jsx)(`div`,{className:`mt-2`,children:(0,P.jsx)(K,{value:ne,onChange:e=>T(e.target.value),placeholder:`Search`,className:`h-8`})}),(0,P.jsxs)(`div`,{className:`mt-2 grid gap-2`,children:[(0,P.jsxs)(q,{value:re,onValueChange:ie,children:[(0,P.jsx)(Y,{className:`h-8`,children:(0,P.jsx)(J,{placeholder:`Vendor`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`all`,children:`All vendors`}),Xt.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))]})]}),(0,P.jsxs)(q,{value:E,onValueChange:D,children:[(0,P.jsx)(Y,{className:`h-8`,children:(0,P.jsx)(J,{placeholder:`Role`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`all`,children:`All roles`}),(0,P.jsx)(Z,{value:`router`,children:`Routers`}),(0,P.jsx)(Z,{value:`switch`,children:`Switches`}),(0,P.jsx)(Z,{value:`firewall`,children:`Firewalls`}),(0,P.jsx)(Z,{value:`host`,children:`Hosts`}),(0,P.jsx)(Z,{value:`other`,children:`Other`})]})]})]}),(0,P.jsx)(`div`,{className:`mt-3 space-y-2`,children:Ft.isLoading?(0,P.jsx)(`div`,{className:`rounded-lg border bg-background px-3 py-2 text-xs text-muted-foreground`,children:`Loading images`}):Zt.length===0?(0,P.jsx)(`div`,{className:`rounded-lg border bg-background px-3 py-2 text-xs text-muted-foreground`,children:Ft.isError?(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`font-medium text-foreground`,children:`Registry not available`}),(0,P.jsx)(`div`,{children:$t}),(0,P.jsx)(`div`,{children:`Set SKYFORGE_REGISTRY_URL (e.g. https://ghcr.io) and optional credentials.`})]}):Qt?(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`font-medium text-foreground`,children:`No matches`}),(0,P.jsx)(`div`,{children:`Try clearing filters or search terms.`})]}):(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`font-medium text-foreground`,children:`No images yet`}),(0,P.jsx)(`div`,{children:`Add container images to your registry (e.g. GHCR) or adjust registry repo prefixes.`})]})}):(0,P.jsx)(`div`,{className:`space-y-3`,children:[`Hosts`,`Routers`,`Switches`,`Firewalls`,`Other`].map(e=>({category:e,items:Zt.filter(t=>t.category===e)})).filter(e=>e.items.length>0).map(e=>(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`text-[11px] font-semibold text-muted-foreground`,children:e.category}),(0,P.jsx)(`div`,{className:`space-y-2`,children:e.items.slice(0,60).map(e=>(0,P.jsx)(Hl,{item:e},e.id))})]},e.category))})})]}),(0,P.jsxs)(`div`,{className:`flex-1 outline-none relative`,ref:a,onDrop:Ut,onDragOver:Ht,tabIndex:0,onKeyDown:Gt,onMouseDown:e=>{e.currentTarget.focus(),Dt()},onContextMenu:e=>e.preventDefault(),children:[k?(0,P.jsx)(`div`,{className:`absolute z-10 m-3 rounded-lg border bg-background/80 px-3 py-2 text-xs text-muted-foreground backdrop-blur`,children:ue?(0,P.jsxs)(P.Fragment,{children:[`Link mode: select target for`,` `,(0,P.jsx)(`span`,{className:`font-mono text-foreground`,children:ue})]}):(0,P.jsx)(P.Fragment,{children:`Link mode: click a source node, then click a target node`})}):null,(0,P.jsxs)(jt,{nodes:tt,edges:it,onNodesChange:lt,onEdgesChange:ut,onConnect:e=>{let t=e.source&&e.target?`${e.source}  ${e.target}`:void 0;at(n=>_t({...e,label:t},n))},fitView:!0,onNodeClick:(e,t)=>{let n=String(t.id);if(k){if(!ue){de(n);return}if(ue===n){de(``);return}let e=`e-${ue}-${n}-${Date.now()}`;at(t=>_t({id:e,source:ue,target:n,label:`${ue}  ${n}`},t)),de(``);return}ce(n)},onNodeContextMenu:(e,t)=>{e.preventDefault();let n=a.current?.getBoundingClientRect();Je({x:n?e.clientX-n.left:e.clientX,y:n?e.clientY-n.top:e.clientY,nodeId:String(t.id)}),Xe(null),Qe(null)},onEdgeContextMenu:(e,t)=>{e.preventDefault();let n=a.current?.getBoundingClientRect();Xe({x:n?e.clientX-n.left:e.clientX,y:n?e.clientY-n.top:e.clientY,edgeId:String(t.id)}),Je(null),Qe(null)},onPaneContextMenu:e=>{e.preventDefault();let t=a.current?.getBoundingClientRect();Qe({x:t?e.clientX-t.left:e.clientX,y:t?e.clientY-t.top:e.clientY}),Je(null),Xe(null)},onInit:oe,snapToGrid:C,snapGrid:[12,12],nodeTypes:Kt,children:[(0,P.jsx)(Ot,{}),(0,P.jsx)(Yt,{zoomable:!0,pannable:!0,className:`bg-background border rounded-lg`}),(0,P.jsx)(Ct,{gap:12,size:1})]}),qe?(0,P.jsx)(`div`,{className:`absolute z-50`,style:{left:qe.x,top:qe.y},onContextMenu:e=>e.preventDefault(),children:(0,P.jsxs)(L,{className:`w-64 shadow-lg border bg-background/95 backdrop-blur`,children:[(0,P.jsxs)(R,{className:`p-3 pb-2`,children:[(0,P.jsx)(z,{className:`text-sm`,children:`Node`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:String(tt.find(e=>String(e.id)===qe.nodeId)?.data?.label??qe.nodeId)})]}),(0,P.jsxs)(V,{className:`p-3 pt-0 space-y-2`,children:[(0,P.jsx)(F,{size:`sm`,className:`w-full`,onClick:()=>{ce(qe.nodeId),Dt()},children:`Edit`}),t?(0,P.jsxs)(`div`,{className:`grid grid-cols-3 gap-2`,children:[(0,P.jsx)(F,{size:`sm`,variant:`outline`,onClick:()=>{kt({action:`terminal`,node:qe.nodeId}),Dt()},children:`Terminal`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,onClick:()=>{kt({action:`logs`,node:qe.nodeId}),Dt()},children:`Logs`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,onClick:()=>{kt({action:`describe`,node:qe.nodeId}),Dt()},children:`Describe`})]}):null,(0,P.jsx)(F,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{At(qe.nodeId),Dt()},children:`Rename`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{let e=tt.find(e=>String(e.id)===qe.nodeId);if(!e)return;let t=new Set(tt.map(e=>String(e.id))),n=tt.length+1,r=`${String(e.id)}-${n}`;for(;t.has(r);)n++,r=`${String(e.id)}-${n}`;let i={...e,id:r,position:{x:e.position.x+32,y:e.position.y+32},data:{...e.data,label:r}};nt(e=>[...e,i]),ce(r),Dt()},children:`Duplicate`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{le(!0),de(qe.nodeId),Dt()},children:`Start link`}),(0,P.jsx)(F,{size:`sm`,variant:`secondary`,className:`w-full`,onClick:()=>{let e=tt.find(e=>String(e.id)===qe.nodeId)?.data?.label??qe.nodeId;navigator.clipboard?.writeText(String(e)),j.success(`Copied`),Dt()},children:`Copy name`}),(0,P.jsx)(F,{size:`sm`,variant:`destructive`,className:`w-full`,onClick:()=>{let e=qe.nodeId;nt(t=>t.filter(t=>String(t.id)!==e)),at(t=>t.filter(t=>String(t.source)!==e&&String(t.target)!==e)),se===e&&ce(``),Dt()},children:`Delete`})]})]})}):null,Ye?(0,P.jsx)(`div`,{className:`absolute z-50`,style:{left:Ye.x,top:Ye.y},onContextMenu:e=>e.preventDefault(),children:(0,P.jsxs)(L,{className:`w-60 shadow-lg border bg-background/95 backdrop-blur`,children:[(0,P.jsxs)(R,{className:`p-3 pb-2`,children:[(0,P.jsx)(z,{className:`text-sm`,children:`Link`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:it.find(e=>String(e.id)===Ye.edgeId)?.label??Ye.edgeId})]}),(0,P.jsxs)(V,{className:`p-3 pt-0 space-y-2`,children:[(0,P.jsx)(F,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{let e=it.find(e=>String(e.id)===Ye.edgeId);if(!e)return;let t=window.prompt(`Link label`,String(e.label??``));t!=null&&(at(e=>e.map(e=>String(e.id)===Ye.edgeId?{...e,label:t}:e)),Dt())},children:`Rename`}),(0,P.jsx)(F,{size:`sm`,variant:`destructive`,className:`w-full`,onClick:()=>{at(e=>e.filter(e=>String(e.id)!==Ye.edgeId)),Dt()},children:`Delete`})]})]})}):null,Ze?(0,P.jsx)(`div`,{className:`absolute z-50`,style:{left:Ze.x,top:Ze.y},onContextMenu:e=>e.preventDefault(),children:(0,P.jsxs)(L,{className:`w-60 shadow-lg border bg-background/95 backdrop-blur`,children:[(0,P.jsx)(R,{className:`p-3 pb-2`,children:(0,P.jsx)(z,{className:`text-sm`,children:`Canvas`})}),(0,P.jsxs)(V,{className:`p-3 pt-0 space-y-2`,children:[(0,P.jsx)(F,{size:`sm`,className:`w-full`,onClick:()=>{St(),Dt()},children:`Add node`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{Tt(),Dt()},disabled:tt.length<2,children:`Auto-layout`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{O?.fitView({padding:.15,duration:250}),Dt()},disabled:!O,children:`Fit view`})]})]})}):null]})]})})]}),(0,P.jsxs)(`div`,{className:`space-y-6`,children:[(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{children:`Lab`})}),(0,P.jsxs)(V,{className:`space-y-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Lab name`}),(0,P.jsx)(K,{value:l,onChange:e=>u(e.target.value)})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Runtime`}),(0,P.jsxs)(q,{value:p,onValueChange:e=>m(e),disabled:!d,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:d?`Select runtime`:`No user scope available`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`clabernetes`,children:`Clabernetes (in-cluster)`}),(0,P.jsx)(Z,{value:`containerlab`,children:`Containerlab (BYOS)`})]})]})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Repo path`}),(0,P.jsxs)(`div`,{className:`grid grid-cols-2 gap-2`,children:[(0,P.jsx)(K,{value:ee,onChange:e=>te(e.target.value),placeholder:`containerlab/designer`}),(0,P.jsx)(K,{value:x,onChange:e=>S(e.target.value),placeholder:`${l||`lab`}.clab.yml`})]}),(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,P.jsx)(F,{size:`sm`,variant:`outline`,onClick:()=>{navigator.clipboard?.writeText(`${bt}/${xt}`),j.success(`Copied path`)},disabled:!d,children:`Copy path`}),(0,P.jsxs)(F,{size:`sm`,variant:`outline`,onClick:Wt,disabled:!d,children:[(0,P.jsx)(ae,{className:`mr-2 h-4 w-4`}),`Open map`]})]}),(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:[bt,`/`,xt]})]}),(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3 rounded-lg border p-3`,children:[(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Use saved config`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground truncate`,children:y?.scopeId===d?`${y.filePath} (${y.branch})`:`Auto-saves before deploy`})]}),(0,P.jsx)(nc,{checked:_,onCheckedChange:e=>v(!!e)})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Containerlab server`}),(0,P.jsxs)(q,{value:h,onValueChange:e=>g(e),disabled:!d||p!==`containerlab`,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:p===`containerlab`?d?It.isLoading?`Loading`:`Select server`:`No user scope available`:`Not required for clabernetes`})}),(0,P.jsx)(X,{children:(It.data?.servers??[]).map(e=>(0,P.jsx)(Z,{value:`user:${String(e.id)}`,children:Bl(e.apiUrl)||e.name},String(e.id)))})]}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Only required for Containerlab (BYOS). Configure in My Settings , then go to BYOL Servers.`})]}),(0,P.jsx)(`div`,{children:(0,P.jsxs)(F,{className:`w-full`,disabled:zt.isPending,onClick:()=>zt.mutate(),children:[(0,P.jsx)(st,{className:`mr-2 h-4 w-4`}),zt.isPending?`Creating`:`Create deployment + deploy`]})}),(0,P.jsxs)(`div`,{className:`flex items-center justify-between rounded-lg border px-3 py-2`,children:[(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Open deployment on create`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Keeps the Designer open in this tab.`})]}),(0,P.jsx)(nc,{checked:Ge,onCheckedChange:e=>Ke(!!e)})]})]})]}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{children:`Node`})}),(0,P.jsx)(V,{className:`space-y-4`,children:ft?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Name`}),(0,P.jsx)(K,{value:String(ft.data?.label??ft.id),onChange:e=>{let t=e.target.value;ct(),nt(e=>e.map(e=>e.id===ft.id?{...e,data:{...e.data,label:t}}:e))}})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Kind`}),(0,P.jsx)(K,{value:String(ft.data?.kind??``),onChange:e=>{let t=e.target.value;nt(e=>e.map(e=>e.id===ft.id?{...e,data:{...e.data,kind:t}}:e))},placeholder:`linux, ceos, ...`})]}),(0,P.jsx)(Nl,{value:String(ft.data?.image??``),onChange:e=>{ct(),nt(t=>t.map(t=>t.id===ft.id?{...t,data:{...t.data,image:e}}:t))}})]}):(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Click a node to edit.`})})]}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{className:`pb-3`,children:(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,P.jsx)(z,{children:`YAML`}),(0,P.jsx)(`div`,{className:`flex items-center gap-2`,children:(0,P.jsxs)(F,{size:`sm`,variant:`outline`,onClick:()=>{navigator.clipboard?.writeText(yt),j.success(`Copied YAML`)},children:[(0,P.jsx)(Oe,{className:`mr-2 h-4 w-4`}),`Copy`]})})]})}),(0,P.jsxs)(V,{className:`space-y-3`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(F,{size:`sm`,variant:fe===`generated`?`default`:`outline`,onClick:()=>pe(`generated`),children:`Generated`}),(0,P.jsx)(F,{size:`sm`,variant:fe===`custom`?`default`:`outline`,onClick:()=>{pe(`custom`),me.trim()||he(yt)},children:`Custom`})]}),vt.length||$e&&gt.length?(0,P.jsxs)(`div`,{className:`rounded-md border bg-amber-500/10 text-amber-900 dark:text-amber-200 px-3 py-2 text-xs`,children:[vt.slice(0,6).map(e=>(0,P.jsx)(`div`,{children:e},e)),$e?gt.slice(0,6).map(e=>(0,P.jsx)(`div`,{children:e},e)):null]}):null,(0,P.jsx)(Cc,{value:fe===`custom`?me:mt,onChange:e=>he(e.target.value),readOnly:fe!==`custom`,className:`font-mono text-xs h-[320px]`})]})]})]})]}),(0,P.jsx)(Zn,{open:ge,onOpenChange:e=>ve(e),children:(0,P.jsxs)(er,{children:[(0,P.jsxs)(tr,{children:[(0,P.jsx)(rr,{children:`Import template`}),(0,P.jsx)(ir,{children:`Load an existing containerlab YAML from templates/blueprints into the editor.`})]}),(0,P.jsxs)(`div`,{className:`space-y-3`,children:[(0,P.jsxs)(`div`,{className:`grid grid-cols-2 gap-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Source`}),(0,P.jsxs)(q,{value:ye,onValueChange:e=>{let t=e;be(t),Se(t===`user`?`containerlab/designer`:`containerlab`),we(``)},children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`blueprints`,children:`Blueprints`}),(0,P.jsx)(Z,{value:`user`,children:`User repo`})]})]})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Directory`}),(0,P.jsx)(K,{value:xe,onChange:e=>Se(e.target.value)})]})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Template`}),(0,P.jsxs)(q,{value:Ce,onValueChange:e=>we(e),disabled:!d,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:Lt.isLoading?`Loading`:`Select template`})}),(0,P.jsx)(X,{children:(Lt.data?.templates??[]).map(e=>(0,P.jsx)(Z,{value:e,children:e},e))})]}),Lt.isError?(0,P.jsx)(`div`,{className:`text-xs text-destructive`,children:`Failed to list templates`}):null]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Preview`}),(0,P.jsx)(Cc,{value:Rt.data?.yaml??``,readOnly:!0,placeholder:Ce?Rt.isLoading?`Loading preview`:`No preview`:`Select a template to preview`,className:`font-mono text-xs h-[220px]`})]})]}),(0,P.jsxs)(nr,{children:[(0,P.jsx)(F,{variant:`outline`,onClick:()=>ve(!1),children:`Cancel`}),(0,P.jsx)(F,{onClick:()=>Vt.mutate(),disabled:Vt.isPending||!Ce,children:`Import`})]})]})}),(0,P.jsx)(Zn,{open:Te,onOpenChange:e=>De(e),children:(0,P.jsxs)(er,{children:[(0,P.jsxs)(tr,{children:[(0,P.jsx)(rr,{children:`Quickstart: Generate CLOS`}),(0,P.jsx)(ir,{children:"Generate a simple leaf/spine fabric (inspired by `clab generate`). This populates the designer canvas; you can edit nodes and YAML afterwards."})]}),(0,P.jsxs)(`div`,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Lab name`}),(0,P.jsx)(K,{value:ke,onChange:e=>A(e.target.value)})]}),(0,P.jsxs)(`div`,{className:`grid grid-cols-3 gap-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Spines`}),(0,P.jsx)(K,{type:`number`,min:1,max:16,value:je,onChange:e=>Me(Number(e.target.value||0))})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Leaves`}),(0,P.jsx)(K,{type:`number`,min:1,max:64,value:Ne,onChange:e=>Pe(Number(e.target.value||0))})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Hosts/leaf`}),(0,P.jsx)(K,{type:`number`,min:0,max:16,value:Fe,onChange:e=>Ie(Number(e.target.value||0))})]})]}),(0,P.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-4`,children:[(0,P.jsxs)(`div`,{className:`space-y-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Switch kind`}),(0,P.jsx)(K,{value:Le,onChange:e=>Re(e.target.value),placeholder:`ceos`})]}),(0,P.jsx)(Nl,{value:ze,onChange:Be})]}),(0,P.jsxs)(`div`,{className:`space-y-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(G,{children:`Host kind`}),(0,P.jsx)(K,{value:Ve,onChange:e=>He(e.target.value),placeholder:`linux`})]}),(0,P.jsx)(Nl,{value:Ue,onChange:We})]})]})]}),(0,P.jsxs)(nr,{children:[(0,P.jsx)(F,{variant:`outline`,onClick:()=>De(!1),children:`Cancel`}),(0,P.jsx)(F,{onClick:wt,children:`Generate`})]})]})})]})}const Kl=t(`/dashboard/forward/credentials`)({component:Jl});function ql(e){let t=e.trim()||`https://fwd.app`,n=/^https?:\/\//i.test(t)?t:`https://${t}`;try{return new URL(n).host||`fwd.app`}catch{return t.replace(/^https?:\/\//i,``).split(`/`)[0]||`fwd.app`}}function Jl(){let e=c(),t=[`user`,`forward`,`credentialProfiles`],n=i({queryKey:t,queryFn:ha,staleTime:1e4,retry:!1}),a=i({queryKey:H.userForwardCollectorConfigs(),queryFn:ua,staleTime:1e4,retry:!1}),[o,s]=(0,M.useState)(``),[l,u]=(0,M.useState)(!0),[d,f]=(0,M.useState)(``),[p,m]=(0,M.useState)(``),h=a.data?.collectors??[],g=n.data?.profiles??[],_=(0,M.useMemo)(()=>{let e=new Map;for(let t of h){let n=`${String(t.username??``).trim().toLowerCase()}@${String(t.baseUrl??``).trim().toLowerCase()}`;n!==`@`&&e.set(n,(e.get(n)??0)+1)}return e},[h]),v=r({mutationFn:async()=>{let e=d.trim(),t=p.trim(),n=o.trim();if(!e||!t)throw Error(`Username and password are required`);return ga({baseUrl:n,skipTlsVerify:!l,username:e,password:t})},onSuccess:async()=>{m(``),await e.invalidateQueries({queryKey:t}),await e.invalidateQueries({queryKey:H.userForwardCollectorConfigs()}),j.success(`Forward credential set saved`)},onError:e=>j.error(`Failed to save Forward credential set`,{description:e instanceof Error?e.message:String(e)})}),y=r({mutationFn:async e=>_a(e),onSuccess:async()=>{await e.invalidateQueries({queryKey:t}),await e.invalidateQueries({queryKey:H.userForwardCollectorConfigs()}),j.success(`Forward credential set deleted`)},onError:e=>j.error(`Failed to delete Forward credential set`,{description:e instanceof Error?e.message:String(e)})});return(0,P.jsxs)(`div`,{className:`mx-auto w-full max-w-4xl space-y-6 p-6`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`h1`,{className:`text-2xl font-bold tracking-tight`,children:`Forward Credentials`}),(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Saved per-user credential sets reused by Forward collector and analytics targets.`})]}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{children:`Credential Sets`})}),(0,P.jsx)(V,{className:`space-y-6`,children:(0,P.jsxs)(`div`,{className:`space-y-3 rounded border p-4`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`These credentials are reused by collectors and other Forward integrations.`}),(0,P.jsxs)(`div`,{className:`text-xs font-mono text-muted-foreground`,children:[`Identifier:`,` `,d.trim()?`${d.trim()}@${ql(o)}`:`<username>@${ql(o)}`]}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(K,{value:o,onChange:e=>s(e.target.value),placeholder:`Host (optional, defaults to https://fwd.app)`}),(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`For Skyforge Forward Cluster use:`,` `,(0,P.jsx)(`code`,{children:`http://fwd-appserver.forward.svc.cluster.local:8080`})]})]}),(0,P.jsx)(K,{value:d,onChange:e=>f(e.target.value),placeholder:`Forward username`}),(0,P.jsx)(K,{type:`password`,value:p,onChange:e=>m(e.target.value),placeholder:`Forward password`})]}),(0,P.jsxs)(`label`,{className:`flex items-center gap-2 text-sm`,children:[(0,P.jsx)(`input`,{type:`checkbox`,checked:l,onChange:e=>u(e.target.checked)}),`Verify TLS certificate`]}),(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>v.mutate(),disabled:v.isPending,children:`Save credential set`}),n.isLoading?(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Loading credential sets...`}):null,n.isError?(0,P.jsx)(`div`,{className:`text-sm text-destructive`,children:`Failed to load credential sets.`}):null,(0,P.jsx)(`div`,{className:`space-y-2`,children:g.map(e=>{let t=`${String(e.username??``).trim().toLowerCase()}@${String(e.baseUrl??``).trim().toLowerCase()}`,n=_.get(t)??0;return(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3 rounded border p-2`,children:[(0,P.jsxs)(`div`,{className:`min-w-0 text-sm`,children:[(0,P.jsx)(`div`,{className:`font-medium truncate`,children:e.name}),(0,P.jsxs)(`div`,{className:`truncate text-muted-foreground`,children:[e.username,` @ `,e.baseUrl]}),(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Collectors using this profile: `,n]})]}),(0,P.jsx)(F,{type:`button`,size:`sm`,variant:`destructive`,onClick:()=>y.mutate(e.name),disabled:y.isPending,children:`Delete`})]},e.id)})})]})})]})]})}const Yl=t(`/dashboard/forward/collector`)({component:Xl});function Xl(){let e=c(),t=H.userForwardCollectorConfigs(),n=H.userForwardCredentialProfiles(),a=i({queryKey:t,queryFn:ua,refetchInterval:5e3,staleTime:1e4,retry:!1}),o=i({queryKey:n,queryFn:ha,staleTime:1e4,retry:!1}),s=(0,M.useMemo)(()=>a.data?.collectors??[],[a.data?.collectors]),l=o.data?.profiles??[],[u,d]=(0,M.useState)(``),f=i({queryKey:H.userForwardCollectorConfigLogs(u),queryFn:async()=>pa(u,300),enabled:!!u,refetchInterval:u?3e3:!1,retry:!1}),[p,m]=(0,M.useState)(``),[h,g]=(0,M.useState)(!1),[_,v]=(0,M.useState)(``),y=i({queryKey:H.userGitCredentials(),queryFn:$r,staleTime:6e4,retry:!1});(0,M.useEffect)(()=>{if(h||p.trim())return;let e=(y.data?.username??``).trim();e&&m(`skyforge-${e}`)},[h,p,y.data?.username]);let b=r({mutationFn:async()=>{let e=p.trim();if(!e)throw Error(`Collector name is required`);let t=_.trim();if(!t)throw Error(`Forward credential profile is required`);return da({name:e,baseUrl:``,skipTlsVerify:!1,username:``,password:``,credentialProfileName:t})},onSuccess:async()=>{j.success(`Collector created`),await e.invalidateQueries({queryKey:t})},onError:e=>j.error(`Failed to create collector`,{description:e.message})}),ee=r({mutationFn:async e=>ma(e),onSuccess:async()=>{j.success(`Collector restarted`),await e.invalidateQueries({queryKey:t})},onError:e=>j.error(`Failed to restart collector`,{description:e.message})}),te=r({mutationFn:async e=>fa(e),onSuccess:async(n,r)=>{j.success(`Collector deleted`),d(``),e.setQueryData(t,e=>{let t=e?.collectors??[];return{...e??{},collectors:t.filter(e=>String(e?.id??``)!==String(r))}}),await e.invalidateQueries({queryKey:t})},onError:e=>j.error(`Failed to delete collector`,{description:e.message})}),x=r({mutationFn:async e=>{for(let t of e)await fa(t)},onSuccess:async()=>{j.success(`Collectors deleted`),d(``),e.setQueryData(t,e=>({...e??{},collectors:[]})),await e.invalidateQueries({queryKey:t})},onError:e=>j.error(`Failed to delete collectors`,{description:e.message})});return(0,P.jsxs)(`div`,{className:`p-6 space-y-6`,children:[(0,P.jsx)(`div`,{className:`flex items-start justify-between gap-4`,children:(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`h1`,{className:`text-2xl font-bold`,children:`Collector`}),(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground mt-1`,children:`Create one or more per-user in-cluster Forward collectors. Select a collector per deployment.`})]})}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Create collector`}),(0,P.jsx)(B,{children:`Creates a Forward collector and deploys a matching in-cluster Deployment. Deleting here only deletes the in-cluster Deployment and the saved credentials; it does not delete the Forward-side collector.`})]}),(0,P.jsxs)(V,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(G,{children:`Collector name`}),(0,P.jsx)(K,{value:p,onChange:e=>{g(!0),m(e.target.value)},placeholder:`skyforge-yourname`})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(G,{children:`Forward credential profile`}),(0,P.jsxs)(q,{value:_,onValueChange:v,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:l.length?`Select credential profile`:`No credential profiles`})}),(0,P.jsx)(X,{children:l.map(e=>(0,P.jsx)(Z,{value:e.name,children:e.name},e.id))})]})]}),(0,P.jsx)(F,{onClick:()=>b.mutate(),disabled:b.isPending||!p.trim()||!_.trim(),children:b.isPending?`Creating`:`Create`})]})]}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-4`,children:[(0,P.jsx)(z,{children:`Configured collectors`}),s.length>0?(0,P.jsx)(F,{variant:`destructive`,size:`sm`,disabled:x.isPending,onClick:()=>{let e=s.map(e=>String(e.id)).filter(Boolean);e.length!==0&&confirm(`Delete ${e.length} collector(s)? This removes in-cluster Deployments and saved credentials.`)&&x.mutate(e)},children:x.isPending?`Deleting`:`Delete all`}):null]}),(0,P.jsx)(B,{children:`Each entry maps to one in-cluster Deployment and one Forward collector.`})]}),(0,P.jsxs)(V,{className:`space-y-3`,children:[a.isLoading?(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Loading`}):null,a.isError?(0,P.jsx)(`div`,{className:`text-sm text-destructive`,children:`Failed to load collectors.`}):s.length===0?(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`No collectors configured yet.`}):null,s.map(e=>{let t=!!e.runtime?.ready,n=typeof e.forwardCollector?.connected==`boolean`?e.forwardCollector.connected:void 0;return(0,P.jsxs)(`div`,{className:`rounded-md border p-3 space-y-2`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-2 min-w-0`,children:[(0,P.jsx)(`div`,{className:`font-medium truncate`,children:e.name}),e.decryptionFailed?(0,P.jsx)(W,{variant:`destructive`,children:`re-save creds`}):null]}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:e.id})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>d(t=>t===e.id?``:e.id),children:u===e.id?`Hide logs`:`Logs`}),(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>ee.mutate(e.id),disabled:ee.isPending,children:`Restart`}),(0,P.jsx)(F,{variant:`destructive`,size:`sm`,onClick:()=>{confirm(`Delete collector "${e.name}"?`)&&te.mutate(e.id)},disabled:te.isPending,children:`Delete`})]})]}),(0,P.jsxs)(`div`,{className:`text-sm`,children:[`Status:`,` `,(0,P.jsx)(`span`,{className:t?`text-emerald-600`:`text-muted-foreground`,children:t?`Running`:`Starting`})]}),(0,P.jsxs)(`div`,{className:`text-sm`,children:[`Forward:`,` `,typeof n==`boolean`?(0,P.jsx)(`span`,{className:n?`text-emerald-600`:`text-muted-foreground`,children:n?`Connected`:`Not connected`}):(0,P.jsx)(`span`,{className:`text-muted-foreground`,children:`Unknown`})]}),e.forwardCollector?.version?(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Version:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:String(e.forwardCollector.version)})]}):null,e.forwardCollector?.updateStatus?(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Update:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:String(e.forwardCollector.updateStatus)})]}):null,e.forwardCollector?.externalIp?(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`External IP:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:String(e.forwardCollector.externalIp)})]}):null,Array.isArray(e.forwardCollector?.internalIps)&&(e.forwardCollector?.internalIps??[]).length>0?(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Internal IPs:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:(e.forwardCollector?.internalIps??[]).filter(Boolean).join(`, `)})]}):null,e.runtime?.podName?(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Pod:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:String(e.runtime.podName)}),` `,`(`,String(e.runtime.podPhase??``),`)`]}):null,u===e.id?(0,P.jsx)(`pre`,{className:`bg-muted p-3 rounded-md overflow-auto font-mono text-xs whitespace-pre-wrap`,children:f.isLoading?`Loading`:(f.data?.logs??``).trim()||`No logs yet.`}):null]},e.id)})]})]})]})}const Zl=t(`/dashboard/forward/cluster`)({component:$l});var Ql=`https://skyforge-fwd.local.forwardnetworks.com`;function $l(){return(0,P.jsxs)(`div`,{className:`mx-auto w-full max-w-4xl space-y-6 p-6`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`h1`,{className:`text-2xl font-bold tracking-tight`,children:`Forward Cluster`}),(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Open the in-cluster Forward instance. Authentication is handled by Forward.`})]}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Launch`}),(0,P.jsx)(B,{children:`Skyforge routes this link directly to the Forward cluster UI.`})]}),(0,P.jsxs)(V,{className:`space-y-3`,children:[(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground font-mono break-all`,children:Ql}),(0,P.jsx)(F,{asChild:!0,children:(0,P.jsxs)(`a`,{href:Ql,target:`_blank`,rel:`noreferrer noopener`,children:[`Open Forward Cluster`,(0,P.jsx)(ae,{className:`ml-2 h-4 w-4`})]})})]})]})]})}function eu(e){let t=String(e??``).trim();t&&window.open(t,`_blank`,`noopener,noreferrer`)}function tu(e,t,n){let r=new Blob([t],{type:n}),i=URL.createObjectURL(r),a=document.createElement(`a`);a.href=i,a.download=e,document.body.append(a),a.click(),a.remove(),URL.revokeObjectURL(i)}function nu(e){let t=e.savedNetworkRef.trim(),n=e.snapshotId.trim()||void 0,[a,o]=(0,M.useState)(`summary`),[s,l]=(0,M.useState)(`exec`),[u,d]=(0,M.useState)(!1),f=c(),p=i({queryKey:H.forwardAnalyticsBriefing(t,n,s),queryFn:()=>ko({forwardNetworkRef:t||void 0,snapshotId:n,status:`open`,audience:s,limit:10}),enabled:t.length>0,retry:!1,staleTime:1e4}),m=i({queryKey:H.forwardAnalyticsExecutive(t,n,s),queryFn:()=>Oo({forwardNetworkRef:t||void 0,snapshotId:n,status:`open`,audience:s,limit:12}),enabled:t.length>0,retry:!1,staleTime:1e4}),h=i({queryKey:H.forwardAnalyticsActions(t,n,`open`,s,50),queryFn:()=>Ao({forwardNetworkRef:t||void 0,snapshotId:n,status:`open`,audience:s,limit:50}),enabled:t.length>0,retry:!1,staleTime:1e4}),g=i({queryKey:H.forwardAnalyticsCampaigns(t,n,`open`,s,50),queryFn:()=>jo({forwardNetworkRef:t||void 0,snapshotId:n,status:`open`,audience:s,limit:50}),enabled:t.length>0,retry:!1,staleTime:1e4}),v=i({queryKey:H.forwardAnalyticsPortfolio(t,n,s),queryFn:()=>Mo({forwardNetworkRef:t||void 0,snapshotId:n,audience:s}),enabled:t.length>0,retry:!1,staleTime:1e4}),y=i({queryKey:H.forwardAnalyticsValidation(t,n,s),queryFn:()=>No({forwardNetworkRef:t||void 0,snapshotId:n,audience:s}),enabled:t.length>0,retry:!1,staleTime:1e4}),b=i({queryKey:H.forwardAnalyticsTrends(t,n,s),queryFn:()=>Po({forwardNetworkRef:t||void 0,snapshotId:n,audience:s}),enabled:t.length>0,retry:!1,staleTime:1e4}),ee=i({queryKey:H.forwardAnalyticsRunHistory(t,``,``,25),queryFn:()=>Lo({forwardNetworkRef:t||void 0,limit:25}),enabled:t.length>0,retry:!1,staleTime:1e4}),te=r({mutationFn:()=>Io({forwardNetworkRef:t||void 0,snapshotId:n}),onSuccess:async()=>{await Promise.all([f.invalidateQueries({queryKey:H.forwardAnalyticsExecutive(t,n,s)}),f.invalidateQueries({queryKey:H.forwardAnalyticsBriefing(t,n,s)}),f.invalidateQueries({queryKey:H.forwardAnalyticsActions(t,n,`open`,s,50)}),f.invalidateQueries({queryKey:H.forwardAnalyticsCampaigns(t,n,`open`,s,50)}),f.invalidateQueries({queryKey:H.forwardAnalyticsRunHistory(t,``,``,25)})])}});(0,M.useMemo)(()=>m.data?.topActions??[],[m.data?.topActions]);let x=(0,M.useMemo)(()=>p.data?.topActions??[],[p.data?.topActions]),S=(0,M.useMemo)(()=>g.data?.items??[],[g.data?.items]);async function C(){if(!(!t||u)){d(!0);try{let e=await Fo({forwardNetworkRef:t,snapshotId:n,status:`open`,audience:s,limit:50});tu(`${e.fileBase}-briefing.md`,e.markdown,`text/markdown;charset=utf-8`),tu(`${e.fileBase}-appendix.json`,e.json,`application/json;charset=utf-8`)}finally{d(!1)}}}return(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Executive Analytics`}),(0,P.jsx)(B,{children:`Cross-module readiness, trend context, and ranked next actions for this network.`})]}),(0,P.jsxs)(V,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(F,{variant:`outline`,disabled:!t,onClick:()=>{m.refetch(),p.refetch(),h.refetch(),g.refetch(),v.refetch(),y.refetch(),b.refetch(),ee.refetch()},children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Refresh`]}),(0,P.jsxs)(F,{variant:`outline`,disabled:!t||te.isPending,onClick:()=>te.mutate(),children:[(0,P.jsx)(vn,{className:`mr-2 h-4 w-4`}),te.isPending?`Running...`:`Run All Modules`]}),m.data?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(W,{variant:m.data.gatePassed?`secondary`:`destructive`,children:m.data.gatePassed?`Ready for executive reporting`:`Not ready for executive reporting`}),(0,P.jsxs)(W,{variant:`outline`,children:[`Score: `,m.data.overallCompetitiveScore]}),(0,P.jsxs)(W,{variant:`outline`,children:[`Findings: `,m.data.totalFindings]}),(0,P.jsxs)(W,{variant:`outline`,children:[`Priorities: `,m.data.priorityCount]}),(0,P.jsxs)(W,{variant:m.data.staleModules>0?`destructive`:`secondary`,children:[`Stale modules: `,m.data.staleModules,`/`,m.data.totalModules]})]}):null,e.networkId?(0,P.jsxs)(W,{variant:`secondary`,children:[`Network ID: `,e.networkId]}):null,(0,P.jsxs)(q,{value:s,onValueChange:e=>l(e===`engineering`?`engineering`:`exec`),children:[(0,P.jsx)(Y,{className:`h-8 w-[180px]`,children:(0,P.jsx)(J,{placeholder:`Audience`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`exec`,children:`Executive audience`}),(0,P.jsx)(Z,{value:`engineering`,children:`Engineering audience`})]})]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>eu(m.data?.forwardSearchUrl??p.data?.forwardSearchUrl),disabled:!String(m.data?.forwardSearchUrl??p.data?.forwardSearchUrl??``).trim(),children:[(0,P.jsx)(ae,{className:`mr-2 h-4 w-4`}),`Open in Forward`]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:C,disabled:!p.data||u,children:[(0,P.jsx)(Ae,{className:`mr-2 h-4 w-4`}),u?`Exporting...`:`Export Bundle`]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>window.print(),children:[(0,P.jsx)(_,{className:`mr-2 h-4 w-4`}),`Print`]})]}),t?null:(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Select a saved network target first.`}),m.error?(0,P.jsxs)(`p`,{className:`text-sm text-destructive`,children:[`Failed to load executive analytics: `,String(m.error)]}):null,p.error?(0,P.jsxs)(`p`,{className:`text-sm text-destructive`,children:[`Failed to load briefing: `,String(p.error)]}):null,ee.error?(0,P.jsxs)(`p`,{className:`text-sm text-destructive`,children:[`Failed to load run history: `,String(ee.error)]}):null,(0,P.jsxs)(lc,{value:a,onValueChange:e=>o(e),children:[(0,P.jsxs)(uc,{className:`grid w-full grid-cols-7`,children:[(0,P.jsx)(dc,{value:`briefing`,children:`Briefing`}),(0,P.jsx)(dc,{value:`summary`,children:`Summary`}),(0,P.jsx)(dc,{value:`actions`,children:`Campaigns`}),(0,P.jsx)(dc,{value:`readiness`,children:`Readiness`}),(0,P.jsx)(dc,{value:`trends`,children:`Trends`}),(0,P.jsx)(dc,{value:`portfolio`,children:`Portfolio`}),(0,P.jsx)(dc,{value:`operations`,children:`Operations`})]}),(0,P.jsxs)(fc,{value:`briefing`,className:`space-y-3`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border px-3 py-2 text-sm`,children:[(0,P.jsx)(`div`,{className:`text-base font-semibold`,children:p.data?.storyline?.headline||`Briefing not available`}),(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4 text-xs text-muted-foreground`,children:(p.data?.storyline?.bullets??[]).map((e,t)=>(0,P.jsx)(`li`,{children:e},`story-${t}`))})]}),(0,P.jsxs)(wc,{children:[(0,P.jsx)(Tc,{children:(0,P.jsxs)(Oc,{children:[(0,P.jsx)(Q,{children:`#`}),(0,P.jsx)(Q,{children:`Action`}),(0,P.jsx)(Q,{children:`Status`}),(0,P.jsx)(Q,{children:`Owner`}),(0,P.jsx)(Q,{children:`Timebox`}),(0,P.jsx)(Q,{children:`Effort`})]})}),(0,P.jsx)(Ec,{children:x.map(e=>(0,P.jsxs)(Oc,{children:[(0,P.jsx)($,{children:e.rank}),(0,P.jsx)($,{children:e.title||e.findingKey}),(0,P.jsxs)($,{children:[e.checkStatus||`ok`,e.fallbackUsed?` (fallback)`:``]}),(0,P.jsx)($,{children:e.ownerRole||`-`}),(0,P.jsx)($,{children:e.timebox||`-`}),(0,P.jsx)($,{children:e.effortBand||`-`})]},`${e.module}:${e.findingKey||e.title}`))})]})]}),(0,P.jsx)(fc,{value:`summary`,className:`space-y-3`,children:(0,P.jsx)(`div`,{className:`grid gap-2 md:grid-cols-4`,children:(m.data?.modules??[]).map(e=>(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{className:`pb-2`,children:(0,P.jsx)(z,{className:`text-sm`,children:e.title})}),(0,P.jsxs)(V,{className:`space-y-1 text-xs`,children:[(0,P.jsxs)(`div`,{children:[`Score: `,e.competitiveScoreOverall]}),(0,P.jsxs)(`div`,{children:[`Findings: `,e.totalFindings]}),(0,P.jsxs)(`div`,{children:[`High risk: `,e.highRiskFindings]}),(0,P.jsxs)(`div`,{children:[`Drift delta: `,e.driftDelta]}),(0,P.jsxs)(`div`,{children:[`Freshness: `,e.freshnessState||`unknown`,typeof e.freshnessMinutes==`number`?` (${e.freshnessMinutes}m)`:``]})]})]},e.module))})}),(0,P.jsx)(fc,{value:`actions`,children:(0,P.jsxs)(wc,{children:[(0,P.jsx)(Tc,{children:(0,P.jsxs)(Oc,{children:[(0,P.jsx)(Q,{children:`#`}),(0,P.jsx)(Q,{children:`Module`}),(0,P.jsx)(Q,{children:`Campaign`}),(0,P.jsx)(Q,{children:`Findings`}),(0,P.jsx)(Q,{children:`Priority`}),(0,P.jsx)(Q,{children:`Sequence`}),(0,P.jsx)(Q,{children:`Impact`})]})}),(0,P.jsx)(Ec,{children:S.map(e=>(0,P.jsxs)(Oc,{children:[(0,P.jsx)($,{children:e.rank}),(0,P.jsx)($,{children:e.moduleTitle||e.module}),(0,P.jsxs)($,{children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.groupKey}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:e.summary||`No summary`})]}),(0,P.jsxs)($,{children:[e.findingsCount,` (`,e.highRiskCount,` high-risk)`]}),(0,P.jsx)($,{children:e.priorityScore}),(0,P.jsx)($,{children:e.sequenceScore}),(0,P.jsxs)($,{children:[e.expectedRiskReduction||`n/a`,` /`,` `,e.confidence||`unknown`]})]},e.groupKey))})]})}),(0,P.jsx)(fc,{value:`readiness`,className:`space-y-2`,children:(y.data?.modules??[]).map(e=>(0,P.jsxs)(`div`,{className:`rounded-md border px-3 py-2 text-sm`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsx)(`span`,{className:`font-medium`,children:e.title}),(0,P.jsx)(W,{variant:e.validationPassed?`secondary`:`destructive`,children:e.validationPassed?`Ready`:`Needs improvement`})]}),(0,P.jsxs)(`div`,{className:`mt-1 text-xs text-muted-foreground`,children:[`Supporting details `,e.evidenceCoveragePct,`% | Recommendations `,e.recommendationCoveragePct,`% | Forward links `,e.forwardDeepLinkCoveragePct,`% | High confidence`,` `,e.highConfidenceCoveragePct,`%`]})]},e.module))}),(0,P.jsx)(fc,{value:`trends`,className:`space-y-2`,children:(b.data?.modules??[]).map(e=>(0,P.jsxs)(`div`,{className:`rounded-md border px-3 py-2 text-sm`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsx)(`span`,{className:`font-medium`,children:e.title}),(0,P.jsxs)(W,{variant:`outline`,children:[e.direction,` (`,e.severity,`)`]})]}),(0,P.jsxs)(`div`,{className:`mt-1 text-xs text-muted-foreground`,children:[`Drift delta: `,e.driftDelta,`. `,e.message]})]},e.module))}),(0,P.jsx)(fc,{value:`portfolio`,className:`space-y-2`,children:v.data?(0,P.jsxs)(`div`,{className:`rounded-md border px-3 py-2 text-sm`,children:[(0,P.jsxs)(`div`,{className:`font-medium`,children:[`Overall score `,v.data.overallCompetitiveScore,` (`,v.data.overallCompetitiveTier,`)`]}),(0,P.jsxs)(`div`,{className:`mt-1 text-xs text-muted-foreground`,children:[`Gate passed modules: `,v.data.gatePassedModules,`/`,v.data.totalModules]})]}):null}),(0,P.jsx)(fc,{value:`operations`,className:`space-y-2`,children:(0,P.jsxs)(wc,{children:[(0,P.jsx)(Tc,{children:(0,P.jsxs)(Oc,{children:[(0,P.jsx)(Q,{children:`Start`}),(0,P.jsx)(Q,{children:`Module`}),(0,P.jsx)(Q,{children:`Status`}),(0,P.jsx)(Q,{children:`Duration`}),(0,P.jsx)(Q,{children:`Warnings`}),(0,P.jsx)(Q,{children:`Error`})]})}),(0,P.jsxs)(Ec,{children:[(ee.data?.items??[]).map(e=>(0,P.jsxs)(Oc,{children:[(0,P.jsx)($,{children:e.startedAt}),(0,P.jsx)($,{children:e.module}),(0,P.jsx)($,{children:e.status}),(0,P.jsxs)($,{children:[e.durationMs,` ms`]}),(0,P.jsx)($,{children:e.warningCount}),(0,P.jsx)($,{className:`max-w-[420px] truncate`,children:e.error||`-`})]},e.runId)),(ee.data?.items??[]).length===0?(0,P.jsx)(Oc,{children:(0,P.jsx)($,{colSpan:6,className:`text-center text-sm text-muted-foreground`,children:`No recent analytics runs.`})}):null]})]})})]})]})]})}var ru=[{key:`coverage`,label:`Coverage`},{key:`explainability`,label:`Explainability`},{key:`actionability`,label:`Actionability`},{key:`evidenceDepth`,label:`Evidence Depth`},{key:`freshnessDrift`,label:`Freshness/Drift`}];function iu(e){return e>=90?`destructive`:e>=80?`default`:e>=65?`secondary`:`outline`}function au(e){return e>=5?`bg-emerald-600`:e>=4?`bg-emerald-500`:e>=3?`bg-amber-500`:e>=2?`bg-orange-500`:`bg-rose-600`}function ou(e){let t=Number.isFinite(e.overall)?Number(e.overall):0,n=e.score,r=(e.tier||`needs-work`).trim().toLowerCase(),i=e.gatePassed===!0,a=(e.gateReasons??[]).filter(e=>e.trim()!==``),o=(e.gateChecks??[]).filter(e=>!e.passed),s=(e.strengths??[]).slice(0,3),c=(e.gaps??[]).slice(0,3);return(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Competitive Score`}),(0,P.jsxs)(W,{variant:iu(t),children:[t,`/100`]})]}),(0,P.jsxs)(`div`,{className:`mt-2 flex flex-wrap items-center gap-2`,children:[(0,P.jsx)(W,{variant:i?`default`:`destructive`,children:i?`Ready for executive reporting`:`Not ready for executive reporting`}),(0,P.jsx)(W,{variant:`outline`,children:r===`leader`?`Leader`:r===`strong`?`Strong`:`Needs Work`})]}),o.length>0?(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4 text-xs text-muted-foreground`,children:o.slice(0,3).map(e=>(0,P.jsxs)(`li`,{children:[e.message,e.remediation?` ${e.remediation}`:``]},`${e.id}-${e.message}`))}):a.length>0?(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4 text-xs text-muted-foreground`,children:a.slice(0,3).map((e,t)=>(0,P.jsx)(`li`,{children:e},`${e}-${t}`))}):null,(0,P.jsx)(`div`,{className:`mt-3 space-y-2`,children:ru.map(e=>{let t=n?Number(n[e.key]??0):0,r=Math.max(0,Math.min(5,t)),i=`${r/5*100}%`;return(0,P.jsxs)(`div`,{children:[(0,P.jsxs)(`div`,{className:`mb-1 flex items-center justify-between text-xs`,children:[(0,P.jsx)(`span`,{children:e.label}),(0,P.jsxs)(`span`,{className:`font-mono`,children:[r,`/5`]})]}),(0,P.jsx)(`div`,{className:`h-1.5 rounded bg-muted`,children:(0,P.jsx)(`div`,{className:`h-full rounded ${au(r)}`,style:{width:i}})})]},e.key)})}),(0,P.jsxs)(`div`,{className:`mt-3 grid gap-2 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`div`,{className:`text-xs font-medium text-muted-foreground`,children:`Strengths`}),s.length===0?(0,P.jsx)(`div`,{className:`mt-1 text-xs text-muted-foreground`,children:`No strengths available yet.`}):(0,P.jsx)(`ul`,{className:`mt-1 list-disc space-y-1 pl-4 text-xs`,children:s.map((e,t)=>(0,P.jsx)(`li`,{children:e},`${e}-${t}`))})]}),(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`div`,{className:`text-xs font-medium text-muted-foreground`,children:`Gaps`}),c.length===0?(0,P.jsx)(`div`,{className:`mt-1 text-xs text-muted-foreground`,children:`No gaps available yet.`}):(0,P.jsx)(`ul`,{className:`mt-1 list-disc space-y-1 pl-4 text-xs`,children:c.map((e,t)=>(0,P.jsx)(`li`,{children:e},`${e}-${t}`))})]})]})]})}var su=`__all__`,cu=50;function lu(e){let t=String(e??``).trim().toLowerCase();return t===`critical`||t===`high`?`destructive`:t===`medium`?`default`:`secondary`}function uu(e){return e>=80?`destructive`:e>=60?`default`:e>=40?`secondary`:`outline`}function du(e){let t=[],n=new Set;for(let r of e){let e=String(r.findingKey??``).trim();!e||n.has(e)||(n.add(e),t.push(r))}return t}async function fu(e,t){let n=String(e??``);if(!n.trim()){j.error(`No ${t} available to copy`);return}try{await navigator.clipboard.writeText(n),j.success(`${t} copied`)}catch(e){j.error(`Failed to copy ${t}`,{description:e instanceof Error?e.message:String(e)})}}function pu(e){try{return JSON.stringify(e,null,2)}catch{return String(e)}}function mu(e){let t=c(),n=e.savedNetworkRef.trim(),a=e.snapshotId.trim()||void 0,[o,s]=(0,M.useState)(`overview`),[l,u]=(0,M.useState)(su),[d,f]=(0,M.useState)(su),[p,m]=(0,M.useState)(`open`),[h,g]=(0,M.useState)(``),[_,v]=(0,M.useState)([]),[y,b]=(0,M.useState)(``),[ee,te]=(0,M.useState)(!1),[x,S]=(0,M.useState)(``),[C,w]=(0,M.useState)(``),ne=i({queryKey:H.forwardCapacitySummary(n),queryFn:()=>xo({forwardNetworkRef:n||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4}),T=i({queryKey:H.forwardCapacityPriorities(n,a,l,d,p,h),queryFn:()=>So({forwardNetworkRef:n||void 0,snapshotId:a,category:l===su?void 0:l,severity:d===su?void 0:d,status:p===su?`all`:p,limit:cu,cursor:h||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4}),re=i({queryKey:H.forwardCapacityFindingEvidence(n,y),queryFn:()=>Co(y,{forwardNetworkRef:n||void 0}),enabled:n.length>0&&y.trim().length>0,retry:!1,staleTime:5e3}),ie=i({queryKey:H.forwardCapacityQueries(n,a),queryFn:()=>wo({forwardNetworkRef:n||void 0,snapshotId:a}),enabled:n.length>0,retry:!1,staleTime:1e4}),ae=i({queryKey:H.forwardCapacitySources(n),queryFn:()=>To({forwardNetworkRef:n||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4}),E=i({queryKey:H.forwardCapacityDrift(n),queryFn:()=>Eo({forwardNetworkRef:n||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4});(0,M.useEffect)(()=>{let e=du(T.data?.priorities??[]);if(!h){v(e);return}v(t=>du([...t,...e]))},[T.data?.priorities,h]),(0,M.useEffect)(()=>{if(_.length===0){b(``);return}_.some(e=>String(e.findingKey??``).trim()===y)||b(String(_[0].findingKey??``).trim())},[_,y]),(0,M.useEffect)(()=>{g(``),v([])},[n,a,l,d,p]);let D=r({mutationFn:async()=>bo({forwardNetworkRef:n||void 0,snapshotId:a}),onSuccess:async()=>{g(``),v([]),s(`overview`),await Promise.all([t.invalidateQueries({queryKey:H.forwardCapacitySummary(n)}),t.invalidateQueries({queryKey:H.forwardCapacityPriorities(n)}),t.invalidateQueries({queryKey:H.forwardCapacityQueries(n)}),t.invalidateQueries({queryKey:H.forwardCapacitySources(n)}),t.invalidateQueries({queryKey:H.forwardCapacityDrift(n)})]),j.success(`Capacity analytics completed`)},onError:e=>j.error(`Capacity analytics failed`,{description:e.message})}),O=ne.data?.summary,oe=T.data?.nextCursor||``,se=ie.data?.items??[],ce=O?.topRiskDrivers??[],k=(0,M.useMemo)(()=>_.find(e=>String(e.findingKey)===y),[_,y]),le=re.data?.finding,ue=(0,M.useMemo)(()=>{let e=new Set;for(let t of _){let n=String(t.category??``).trim().toLowerCase();n&&e.add(n)}return Array.from(e).sort((e,t)=>e.localeCompare(t))},[_]),de=(0,M.useMemo)(()=>_.slice(0,5),[_]);return(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Capacity Planning Analytics`}),(0,P.jsx)(B,{children:`Prioritized capacity planning insights powered by Forward signals.`})]}),(0,P.jsxs)(V,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(F,{onClick:()=>D.mutate(),disabled:!n||D.isPending,children:[(0,P.jsx)(vn,{className:`mr-2 h-4 w-4`}),`Run capacity analytics`]}),(0,P.jsxs)(F,{variant:`outline`,onClick:()=>{ne.refetch(),T.refetch(),ie.refetch(),ae.refetch(),E.refetch(),y&&re.refetch()},disabled:!n,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Refresh`]}),(0,P.jsx)(W,{variant:`secondary`,children:O?.snapshotId?`Snapshot: ${O.snapshotId}`:`Snapshot: Latest Processed`}),e.networkId?(0,P.jsxs)(W,{variant:`outline`,children:[`Network ID: `,e.networkId]}):null,O?.forwardSearchUrl?(0,P.jsx)(F,{variant:`outline`,onClick:()=>window.open(O.forwardSearchUrl,`_blank`,`noopener,noreferrer`),children:`Open in Forward`}):null]}),n?null:(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Select a saved network target first.`}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-6`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Graph risk score`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.graphRiskScore??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Priority queue`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.priorityCount??_.length})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Hot interfaces`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.hotInterfaceCount??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Upgrade candidates`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.upgradeCandidateCount??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Urgent candidates`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.urgentCandidates??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Unhealthy devices`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.unhealthyDeviceCount??0})]})]}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-4`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Coverage`}),(0,P.jsxs)(`div`,{className:`text-xl font-semibold`,children:[(O?.coveragePercent??0).toFixed(1),`%`]})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Max observed utilization`}),(0,P.jsxs)(`div`,{className:`text-xl font-semibold`,children:[(O?.maxObservedUtil??0).toFixed(1),`%`]})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Forecast crossings (30d)`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.forecastCrossingSoonCount??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Soonest forecast crossing`}),(0,P.jsx)(`div`,{className:`text-sm font-semibold`,children:O?.soonestForecastCrossing||`n/a`})]})]}),O?.warnings&&O.warnings.length>0?(0,P.jsxs)(`div`,{className:`rounded-md border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900`,children:[(0,P.jsx)(`div`,{className:`font-medium`,children:`Warnings`}),(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4`,children:O.warnings.map(e=>(0,P.jsx)(`li`,{children:e},e))})]}):null,(0,P.jsxs)(lc,{value:o,onValueChange:e=>s(e),className:`space-y-4`,children:[(0,P.jsxs)(uc,{children:[(0,P.jsx)(dc,{value:`overview`,children:`Overview`}),(0,P.jsx)(dc,{value:`priorities`,children:`Priorities`}),(0,P.jsx)(dc,{value:`evidence`,children:`Evidence`}),(0,P.jsx)(dc,{value:`queries`,children:`Method and data`})]}),(0,P.jsxs)(fc,{value:`overview`,className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`grid gap-3 lg:grid-cols-3`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Main risk themes`}),ce.length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`Run capacity analytics to populate drivers.`}):(0,P.jsx)(`ul`,{className:`mt-2 space-y-2 text-sm`,children:ce.map(e=>(0,P.jsxs)(`li`,{className:`flex items-center justify-between gap-3`,children:[(0,P.jsxs)(`div`,{className:`truncate`,children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.controlId||`control`}),(0,P.jsx)(`div`,{className:`font-mono text-xs text-muted-foreground`,children:e.controlId||`n/a`})]}),(0,P.jsx)(W,{variant:`outline`,children:e.count})]},`${e.controlId}-${e.title}`))})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Snapshot drift context`}),(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:E.data?.message||`No delta metadata yet.`}),(0,P.jsxs)(`div`,{className:`mt-2 flex flex-wrap items-center gap-2`,children:[(0,P.jsx)(W,{variant:E.data?.available?`default`:`secondary`,children:E.data?.available?`Available`:`Unavailable`}),E.data?.baselineSnapshotId?(0,P.jsxs)(W,{variant:`outline`,children:[`Baseline: `,E.data.baselineSnapshotId]}):null,E.data?.compareSnapshotId?(0,P.jsxs)(W,{variant:`outline`,children:[`Compare: `,E.data.compareSnapshotId]}):null]})]}),(0,P.jsx)(ou,{overall:O?.competitiveScoreOverall,score:O?.competitiveScore,tier:O?.competitiveTier,gatePassed:O?.competitiveGatePassed,gateReasons:O?.competitiveGateReasons,gateChecks:O?.competitiveGateChecks,strengths:O?.competitiveStrengths,gaps:O?.competitiveGaps})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Fix-first actions`}),de.length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`No priorities yet. Run capacity analytics to build the queue.`}):(0,P.jsx)(`ul`,{className:`mt-2 space-y-2`,children:de.map(e=>(0,P.jsxs)(`li`,{className:`flex flex-wrap items-center justify-between gap-2 rounded border p-2`,children:[(0,P.jsxs)(`div`,{className:`min-w-0 flex-1`,children:[(0,P.jsx)(`div`,{className:`truncate text-sm font-medium`,children:e.title||e.findingKey}),(0,P.jsx)(`div`,{className:`truncate text-xs text-muted-foreground`,children:e.summary||`No summary`})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(W,{variant:uu(e.priorityScore),children:[`P`,e.priorityScore]}),(0,P.jsxs)(W,{variant:`outline`,children:[e.remediationEffort||`medium`,` effort`]})]})]},e.findingKey))})]})]}),(0,P.jsxs)(fc,{value:`priorities`,className:`space-y-4`,children:[(0,P.jsxs)(`details`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`summary`,{className:`cursor-pointer text-sm font-medium`,children:`Advanced filters`}),(0,P.jsxs)(`div`,{className:`mt-3 flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(q,{value:l,onValueChange:u,children:[(0,P.jsx)(Y,{className:`w-[180px]`,children:(0,P.jsx)(J,{placeholder:`Category`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:su,children:`All categories`}),ue.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))]})]}),(0,P.jsxs)(q,{value:d,onValueChange:f,children:[(0,P.jsx)(Y,{className:`w-[150px]`,children:(0,P.jsx)(J,{placeholder:`Severity`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:su,children:`All severities`}),(0,P.jsx)(Z,{value:`critical`,children:`Critical`}),(0,P.jsx)(Z,{value:`high`,children:`High`}),(0,P.jsx)(Z,{value:`medium`,children:`Medium`}),(0,P.jsx)(Z,{value:`low`,children:`Low`})]})]}),(0,P.jsxs)(q,{value:p,onValueChange:m,children:[(0,P.jsx)(Y,{className:`w-[130px]`,children:(0,P.jsx)(J,{placeholder:`Status`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`open`,children:`Open`}),(0,P.jsx)(Z,{value:su,children:`All`})]})]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>{g(``),v([]),T.refetch()},disabled:T.isFetching,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Apply`]})]})]}),T.isError?(0,P.jsxs)(`p`,{className:`text-xs text-destructive`,children:[`Failed to load priorities: `,T.error.message]}):null,(0,P.jsxs)(wc,{children:[(0,P.jsx)(Tc,{children:(0,P.jsxs)(Oc,{children:[(0,P.jsx)(Q,{className:`w-[72px]`,children:`Rank`}),(0,P.jsx)(Q,{children:`Issue`}),(0,P.jsx)(Q,{className:`text-right`,children:`Scores`}),(0,P.jsx)(Q,{children:`Effort`}),(0,P.jsx)(Q,{className:`text-right`,children:`Actions`})]})}),(0,P.jsxs)(Ec,{children:[_.map(e=>(0,P.jsxs)(Oc,{children:[(0,P.jsx)($,{children:(0,P.jsxs)(W,{variant:`outline`,children:[`#`,e.rank]})}),(0,P.jsxs)($,{children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.findingKey}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:e.summary||`No summary`}),(0,P.jsxs)(`div`,{className:`mt-1 flex flex-wrap items-center gap-1`,children:[(0,P.jsx)(W,{variant:lu(e.severity),children:e.severity||`unknown`}),(0,P.jsx)(W,{variant:`outline`,children:e.category||`uncategorized`})]})]}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsxs)(`div`,{className:`flex flex-col items-end gap-1 text-xs`,children:[(0,P.jsxs)(W,{variant:uu(e.priorityScore),children:[`Priority `,e.priorityScore]}),(0,P.jsxs)(`span`,{children:[`Graph `,e.graphRiskScore]}),(0,P.jsxs)(`span`,{children:[`Potential spread `,e.blastRadiusScore]}),(0,P.jsxs)(`span`,{children:[`Scope `,e.impactedObjects]})]})}),(0,P.jsx)($,{children:(0,P.jsxs)(`div`,{className:`flex flex-col gap-1 text-xs`,children:[(0,P.jsx)(W,{variant:`outline`,children:e.remediationEffort||`medium`}),(0,P.jsxs)(`span`,{className:`text-muted-foreground`,children:[`Confidence: `,e.confidence||`n/a`]})]})}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>{b(e.findingKey),s(`evidence`)},children:`View`})})]},e.findingKey)),_.length===0?(0,P.jsx)(Oc,{children:(0,P.jsx)($,{colSpan:5,className:`text-center text-sm text-muted-foreground`,children:`No priority findings yet.`})}):null]})]}),oe?(0,P.jsx)(`div`,{className:`flex justify-end`,children:(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>g(oe),disabled:T.isFetching,children:`Load more`})}):null]}),(0,P.jsx)(fc,{value:`evidence`,className:`space-y-4`,children:y?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(`div`,{className:`rounded-md border p-3`,children:(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center justify-between gap-2`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:k?.title||y}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:k?.summary||`No summary`})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(W,{variant:uu(k?.priorityScore??0),children:[`Priority `,k?.priorityScore??0]}),(0,P.jsx)(W,{variant:lu(k?.severity),children:k?.severity||`unknown`})]})]})}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Why this matters`}),(k?.rationale??[]).length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`No rationale available.`}):(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4 text-xs`,children:k?.rationale?.map((e,t)=>(0,P.jsx)(`li`,{children:e},`${e}-${t}`))})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Recommendations`}),(k?.recommendations??[]).length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`No remediation hints available.`}):(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4 text-xs`,children:k?.recommendations?.map((e,t)=>(0,P.jsx)(`li`,{children:e},`${e}-${t}`))})]})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Supporting details`}),re.isError?(0,P.jsxs)(`p`,{className:`text-xs text-destructive`,children:[`Failed to load evidence:`,` `,re.error.message]}):null,(0,P.jsx)(`pre`,{className:`max-h-[28rem] overflow-auto rounded-md border bg-muted/20 p-3 text-xs`,children:pu(le?.evidence??k?.evidence??{})})]})]}):(0,P.jsx)(`div`,{className:`rounded-md border p-3 text-sm text-muted-foreground`,children:`Select a priority to inspect evidence.`})}),(0,P.jsxs)(fc,{value:`queries`,className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Capacity source checks and payloads used by this overlay.`}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>{ie.refetch(),ae.refetch(),E.refetch()},disabled:ie.isFetching||ae.isFetching,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Refresh`]})]}),(0,P.jsxs)(wc,{children:[(0,P.jsx)(Tc,{children:(0,P.jsxs)(Oc,{children:[(0,P.jsx)(Q,{children:`Check`}),(0,P.jsx)(Q,{children:`Severity`}),(0,P.jsx)(Q,{className:`text-right`,children:`Findings`}),(0,P.jsx)(Q,{className:`text-right`,children:`Actions`})]})}),(0,P.jsxs)(Ec,{children:[se.map(e=>(0,P.jsxs)(Oc,{children:[(0,P.jsxs)($,{children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.checkId}),(0,P.jsx)(`div`,{className:`font-mono text-xs text-muted-foreground`,children:e.checkId})]}),(0,P.jsx)($,{children:(0,P.jsx)(W,{variant:lu(e.severity),children:e.severity||`unknown`})}),(0,P.jsx)($,{className:`text-right`,children:e.totalFindings}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsxs)(`div`,{className:`flex items-center justify-end gap-2`,children:[(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>{S(e.title||e.checkId),w(e.queryText||``),te(!0)},children:`View Query`}),(0,P.jsx)(F,{variant:`outline`,size:`icon`,onClick:()=>void fu(e.queryText,`${e.checkId} query`),children:(0,P.jsx)(Oe,{className:`h-4 w-4`})})]})})]},e.checkId)),se.length===0?(0,P.jsx)(Oc,{children:(0,P.jsx)($,{colSpan:4,className:`text-center text-sm text-muted-foreground`,children:`No capacity queries available yet.`})}):null]})]}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Drift metadata`}),(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:E.data?.message||`No drift metadata yet.`})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Source payloads`}),(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`Collected from Forward APIs during capacity analytics runs.`})]})]}),(0,P.jsx)(`pre`,{className:`max-h-[24rem] overflow-auto rounded-md border bg-muted/20 p-3 text-xs`,children:pu(ae.data?.sources??{})})]})]}),(0,P.jsx)(Zn,{open:ee,onOpenChange:te,children:(0,P.jsxs)(er,{className:`max-h-[85vh] max-w-4xl overflow-hidden`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{children:x||`Capacity Query`})}),(0,P.jsx)(`pre`,{className:`max-h-[65vh] overflow-auto rounded-md border bg-muted/20 p-3 text-xs`,children:C||`No query text available.`})]})})]})]})}var hu=`__all__`,gu=50;function _u(e){let t=String(e??``).trim().toLowerCase();return t===`critical`||t===`high`?`destructive`:t===`medium`?`default`:`secondary`}function vu(e){return e>=80?`destructive`:e>=60?`default`:e>=40?`secondary`:`outline`}function yu(e){let t=[],n=new Set;for(let r of e){let e=String(r.findingKey??``).trim();!e||n.has(e)||(n.add(e),t.push(r))}return t}async function bu(e,t){let n=String(e??``);if(!n.trim()){j.error(`No ${t} available to copy`);return}try{await navigator.clipboard.writeText(n),j.success(`${t} copied`)}catch(e){j.error(`Failed to copy ${t}`,{description:e instanceof Error?e.message:String(e)})}}function xu(e){try{return JSON.stringify(e,null,2)}catch{return String(e)}}function Su(e){let t=c(),n=e.savedNetworkRef.trim(),a=e.snapshotId.trim()||void 0,[o,s]=(0,M.useState)(`overview`),[l,u]=(0,M.useState)(hu),[d,f]=(0,M.useState)(hu),[p,m]=(0,M.useState)(`open`),[h,g]=(0,M.useState)(``),[_,v]=(0,M.useState)([]),[y,b]=(0,M.useState)(``),[ee,te]=(0,M.useState)(!1),[x,S]=(0,M.useState)(``),[C,w]=(0,M.useState)(``),ne=i({queryKey:H.forwardCloudSummary(n),queryFn:()=>$a({forwardNetworkRef:n||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4}),T=i({queryKey:H.forwardCloudPriorities(n,a,l,d,p,h),queryFn:()=>eo({forwardNetworkRef:n||void 0,snapshotId:a,category:l===hu?void 0:l,severity:d===hu?void 0:d,status:p===hu?`all`:p,limit:gu,cursor:h||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4}),re=i({queryKey:H.forwardCloudFindingEvidence(n,y),queryFn:()=>to(y,{forwardNetworkRef:n||void 0}),enabled:n.length>0&&y.trim().length>0,retry:!1,staleTime:5e3}),ie=i({queryKey:H.forwardCloudQueries(n,a),queryFn:()=>no({forwardNetworkRef:n||void 0,snapshotId:a}),enabled:n.length>0,retry:!1,staleTime:1e4}),ae=i({queryKey:H.forwardCloudSources(n),queryFn:()=>ro({forwardNetworkRef:n||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4}),E=i({queryKey:H.forwardCloudDrift(n),queryFn:()=>io({forwardNetworkRef:n||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4});(0,M.useEffect)(()=>{let e=yu(T.data?.priorities??[]);if(!h){v(e);return}v(t=>yu([...t,...e]))},[T.data?.priorities,h]),(0,M.useEffect)(()=>{if(_.length===0){b(``);return}_.some(e=>String(e.findingKey??``).trim()===y)||b(String(_[0].findingKey??``).trim())},[_,y]),(0,M.useEffect)(()=>{g(``),v([])},[n,a,l,d,p]);let D=r({mutationFn:async()=>Qa({forwardNetworkRef:n||void 0,snapshotId:a}),onSuccess:async()=>{g(``),v([]),s(`overview`),await Promise.all([t.invalidateQueries({queryKey:H.forwardCloudSummary(n)}),t.invalidateQueries({queryKey:H.forwardCloudPriorities(n)}),t.invalidateQueries({queryKey:H.forwardCloudQueries(n)}),t.invalidateQueries({queryKey:H.forwardCloudSources(n)}),t.invalidateQueries({queryKey:H.forwardCloudDrift(n)})]),j.success(`Cloud analytics completed`)},onError:e=>j.error(`Cloud analytics failed`,{description:e.message})}),O=ne.data?.summary,oe=T.data?.nextCursor||``,se=ie.data?.items??[],ce=O?.topRiskDrivers??[],k=(0,M.useMemo)(()=>_.find(e=>String(e.findingKey)===y),[_,y]),le=re.data?.finding,ue=(0,M.useMemo)(()=>{let e=new Set;for(let t of _){let n=String(t.category??``).trim().toLowerCase();n&&e.add(n)}return Array.from(e).sort((e,t)=>e.localeCompare(t))},[_]),de=(0,M.useMemo)(()=>_.slice(0,5),[_]);return(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Cloud Security Analytics`}),(0,P.jsx)(B,{children:`Prioritized cloud risk overlay powered by Forward signals.`})]}),(0,P.jsxs)(V,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(F,{onClick:()=>D.mutate(),disabled:!n||D.isPending,children:[(0,P.jsx)(vn,{className:`mr-2 h-4 w-4`}),`Run cloud analytics`]}),(0,P.jsxs)(F,{variant:`outline`,onClick:()=>{ne.refetch(),T.refetch(),ie.refetch(),ae.refetch(),E.refetch(),y&&re.refetch()},disabled:!n,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Refresh`]}),(0,P.jsx)(W,{variant:`secondary`,children:O?.snapshotId?`Snapshot: ${O.snapshotId}`:`Snapshot: Latest Processed`}),e.networkId?(0,P.jsxs)(W,{variant:`outline`,children:[`Network ID: `,e.networkId]}):null]}),n?null:(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Select a saved network target first.`}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-5`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Exposure impact score`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.graphRiskScore??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Priority queue`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.priorityCount??_.length})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`High confidence`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.highConfidenceCount??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Exposed interfaces`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.exposedInterfaceCount??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Exploited vulns`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.exploitedVulnerabilityCount??0})]})]}),O?.warnings&&O.warnings.length>0?(0,P.jsxs)(`div`,{className:`rounded-md border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900`,children:[(0,P.jsx)(`div`,{className:`font-medium`,children:`Warnings`}),(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4`,children:O.warnings.map(e=>(0,P.jsx)(`li`,{children:e},e))})]}):null,(0,P.jsxs)(lc,{value:o,onValueChange:e=>s(e),className:`space-y-4`,children:[(0,P.jsxs)(uc,{children:[(0,P.jsx)(dc,{value:`overview`,children:`Overview`}),(0,P.jsx)(dc,{value:`priorities`,children:`Priorities`}),(0,P.jsx)(dc,{value:`evidence`,children:`Evidence`}),(0,P.jsx)(dc,{value:`queries`,children:`Method and data`})]}),(0,P.jsxs)(fc,{value:`overview`,className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`grid gap-3 lg:grid-cols-3`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Main risk themes`}),ce.length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`Run cloud analytics to populate drivers.`}):(0,P.jsx)(`ul`,{className:`mt-2 space-y-2 text-sm`,children:ce.map(e=>(0,P.jsxs)(`li`,{className:`flex items-center justify-between gap-3`,children:[(0,P.jsxs)(`div`,{className:`truncate`,children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.controlId||`control`}),(0,P.jsx)(`div`,{className:`font-mono text-xs text-muted-foreground`,children:e.controlId||`n/a`})]}),(0,P.jsx)(W,{variant:`outline`,children:e.count})]},`${e.controlId}-${e.title}`))})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Snapshot drift context`}),(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:E.data?.message||`No drift metadata yet.`}),(0,P.jsxs)(`div`,{className:`mt-2 flex flex-wrap items-center gap-2`,children:[(0,P.jsx)(W,{variant:E.data?.available?`default`:`secondary`,children:E.data?.available?`Available`:`Unavailable`}),E.data?.baselineSnapshotId?(0,P.jsxs)(W,{variant:`outline`,children:[`Baseline: `,E.data.baselineSnapshotId]}):null,E.data?.compareSnapshotId?(0,P.jsxs)(W,{variant:`outline`,children:[`Compare: `,E.data.compareSnapshotId]}):null]})]}),(0,P.jsx)(ou,{overall:O?.competitiveScoreOverall,score:O?.competitiveScore,tier:O?.competitiveTier,gatePassed:O?.competitiveGatePassed,gateReasons:O?.competitiveGateReasons,gateChecks:O?.competitiveGateChecks,strengths:O?.competitiveStrengths,gaps:O?.competitiveGaps})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Fix-first actions`}),de.length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`No priorities yet. Run cloud analytics to build the queue.`}):(0,P.jsx)(`ul`,{className:`mt-2 space-y-2`,children:de.map(e=>(0,P.jsxs)(`li`,{className:`flex flex-wrap items-center justify-between gap-2 rounded border p-2`,children:[(0,P.jsxs)(`div`,{className:`min-w-0 flex-1`,children:[(0,P.jsx)(`div`,{className:`truncate text-sm font-medium`,children:e.title||e.findingKey}),(0,P.jsx)(`div`,{className:`truncate text-xs text-muted-foreground`,children:e.summary||`No summary`})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(W,{variant:vu(e.priorityScore),children:[`P`,e.priorityScore]}),(0,P.jsx)(W,{variant:`outline`,children:e.remediationEffort||`medium`})]})]},e.findingKey))})]})]}),(0,P.jsxs)(fc,{value:`priorities`,className:`space-y-4`,children:[(0,P.jsxs)(`details`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`summary`,{className:`cursor-pointer text-sm font-medium`,children:`Advanced filters`}),(0,P.jsxs)(`div`,{className:`mt-3 flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(q,{value:l,onValueChange:u,children:[(0,P.jsx)(Y,{className:`w-[180px]`,children:(0,P.jsx)(J,{placeholder:`Category`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:hu,children:`All categories`}),ue.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))]})]}),(0,P.jsxs)(q,{value:d,onValueChange:f,children:[(0,P.jsx)(Y,{className:`w-[150px]`,children:(0,P.jsx)(J,{placeholder:`Severity`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:hu,children:`All severities`}),(0,P.jsx)(Z,{value:`critical`,children:`Critical`}),(0,P.jsx)(Z,{value:`high`,children:`High`}),(0,P.jsx)(Z,{value:`medium`,children:`Medium`}),(0,P.jsx)(Z,{value:`low`,children:`Low`})]})]}),(0,P.jsxs)(q,{value:p,onValueChange:m,children:[(0,P.jsx)(Y,{className:`w-[130px]`,children:(0,P.jsx)(J,{placeholder:`Status`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`open`,children:`Open`}),(0,P.jsx)(Z,{value:hu,children:`All`})]})]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>{g(``),v([]),T.refetch()},disabled:T.isFetching,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Apply`]})]})]}),T.isError?(0,P.jsxs)(`p`,{className:`text-xs text-destructive`,children:[`Failed to load priorities: `,T.error.message]}):null,(0,P.jsxs)(wc,{children:[(0,P.jsx)(Tc,{children:(0,P.jsxs)(Oc,{children:[(0,P.jsx)(Q,{className:`w-[72px]`,children:`Rank`}),(0,P.jsx)(Q,{children:`Issue`}),(0,P.jsx)(Q,{className:`text-right`,children:`Scores`}),(0,P.jsx)(Q,{children:`Effort`}),(0,P.jsx)(Q,{className:`text-right`,children:`Actions`})]})}),(0,P.jsxs)(Ec,{children:[_.map(e=>(0,P.jsxs)(Oc,{children:[(0,P.jsx)($,{children:(0,P.jsxs)(W,{variant:`outline`,children:[`#`,e.rank]})}),(0,P.jsxs)($,{children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.findingKey}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:e.summary||`No summary`}),(0,P.jsxs)(`div`,{className:`mt-1 flex flex-wrap items-center gap-1`,children:[(0,P.jsx)(W,{variant:_u(e.severity),children:e.severity||`unknown`}),(0,P.jsx)(W,{variant:`outline`,children:e.category||`uncategorized`})]})]}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsxs)(`div`,{className:`flex flex-col items-end gap-1 text-xs`,children:[(0,P.jsxs)(W,{variant:vu(e.priorityScore),children:[`Priority `,e.priorityScore]}),(0,P.jsxs)(`span`,{children:[`Graph `,e.graphRiskScore]}),(0,P.jsxs)(`span`,{children:[`Potential spread `,e.blastRadiusScore]})]})}),(0,P.jsx)($,{children:(0,P.jsxs)(`div`,{className:`flex flex-col gap-1 text-xs`,children:[(0,P.jsx)(W,{variant:`outline`,children:e.remediationEffort||`medium`}),(0,P.jsxs)(`span`,{className:`text-muted-foreground`,children:[`Confidence: `,e.confidence||`n/a`]})]})}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsx)(`div`,{className:`flex items-center justify-end`,children:(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>{b(e.findingKey),s(`evidence`)},children:`View`})})})]},e.findingKey)),_.length===0?(0,P.jsx)(Oc,{children:(0,P.jsx)($,{colSpan:5,className:`text-center text-sm text-muted-foreground`,children:`No priority findings yet.`})}):null]})]}),oe?(0,P.jsx)(`div`,{className:`flex justify-end`,children:(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>g(oe),disabled:T.isFetching,children:`Load more`})}):null]}),(0,P.jsx)(fc,{value:`evidence`,className:`space-y-4`,children:y?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(`div`,{className:`rounded-md border p-3`,children:(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center justify-between gap-2`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:k?.title||y}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:k?.summary||`No summary`})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(W,{variant:vu(k?.priorityScore??0),children:[`Priority `,k?.priorityScore??0]}),(0,P.jsx)(W,{variant:_u(k?.severity),children:k?.severity||`unknown`})]})]})}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Why this matters`}),(k?.rationale??[]).length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`No rationale available.`}):(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4 text-xs`,children:k?.rationale?.map((e,t)=>(0,P.jsx)(`li`,{children:e},`${e}-${t}`))})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Recommendations`}),(k?.recommendations??[]).length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`No remediation hints available.`}):(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4 text-xs`,children:k?.recommendations?.map((e,t)=>(0,P.jsx)(`li`,{children:e},`${e}-${t}`))})]})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Supporting details`}),re.isError?(0,P.jsxs)(`p`,{className:`text-xs text-destructive`,children:[`Failed to load evidence:`,` `,re.error.message]}):null,(0,P.jsx)(`pre`,{className:`max-h-[28rem] overflow-auto rounded-md border bg-muted/20 p-3 text-xs`,children:xu(le?.evidence??k?.evidence??{})})]})]}):(0,P.jsx)(`div`,{className:`rounded-md border p-3 text-sm text-muted-foreground`,children:`Select a priority to inspect evidence.`})}),(0,P.jsxs)(fc,{value:`queries`,className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Cloud NQE checks and source payloads used by this overlay.`}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>{ie.refetch(),ae.refetch(),E.refetch()},disabled:ie.isFetching||ae.isFetching,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Refresh`]})]}),(0,P.jsxs)(wc,{children:[(0,P.jsx)(Tc,{children:(0,P.jsxs)(Oc,{children:[(0,P.jsx)(Q,{children:`Check`}),(0,P.jsx)(Q,{children:`Severity`}),(0,P.jsx)(Q,{className:`text-right`,children:`Findings`}),(0,P.jsx)(Q,{className:`text-right`,children:`Actions`})]})}),(0,P.jsxs)(Ec,{children:[se.map(e=>(0,P.jsxs)(Oc,{children:[(0,P.jsxs)($,{children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.checkId}),(0,P.jsx)(`div`,{className:`font-mono text-xs text-muted-foreground`,children:e.checkId})]}),(0,P.jsx)($,{children:(0,P.jsx)(W,{variant:_u(e.severity),children:e.severity||`unknown`})}),(0,P.jsx)($,{className:`text-right`,children:e.totalFindings}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsxs)(`div`,{className:`flex items-center justify-end gap-2`,children:[(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>{S(e.title||e.checkId),w(e.queryText||``),te(!0)},children:`View Query`}),(0,P.jsx)(F,{variant:`outline`,size:`icon`,onClick:()=>void bu(e.queryText,`${e.checkId} query`),children:(0,P.jsx)(Oe,{className:`h-4 w-4`})})]})})]},e.checkId)),se.length===0?(0,P.jsx)(Oc,{children:(0,P.jsx)($,{colSpan:4,className:`text-center text-sm text-muted-foreground`,children:`No cloud queries available yet.`})}):null]})]}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Drift metadata`}),(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:E.data?.message||`No drift metadata yet.`})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Source payloads`}),(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`Collected from Forward APIs during cloud analytics runs.`})]})]}),(0,P.jsx)(`pre`,{className:`max-h-[24rem] overflow-auto rounded-md border bg-muted/20 p-3 text-xs`,children:xu(ae.data?.sources??{})})]})]}),(0,P.jsx)(Zn,{open:ee,onOpenChange:te,children:(0,P.jsxs)(er,{className:`max-h-[85vh] max-w-4xl overflow-hidden`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{children:x||`Cloud Query`})}),(0,P.jsx)(`pre`,{className:`max-h-[65vh] overflow-auto rounded-md border bg-muted/20 p-3 text-xs`,children:C||`No query text available.`})]})})]})]})}var Cu=`__all__`,wu=50;function Tu(e){let t=String(e??``).trim().toLowerCase();return t===`critical`||t===`high`?`destructive`:t===`medium`?`default`:`secondary`}function Eu(e){return e>=80?`destructive`:e>=60?`default`:e>=40?`secondary`:`outline`}function Du(e){let t=[],n=new Set;for(let r of e){let e=String(r.findingKey??``).trim();!e||n.has(e)||(n.add(e),t.push(r))}return t}async function Ou(e,t){let n=String(e??``);if(!n.trim()){j.error(`No ${t} available to copy`);return}try{await navigator.clipboard.writeText(n),j.success(`${t} copied`)}catch(e){j.error(`Failed to copy ${t}`,{description:e instanceof Error?e.message:String(e)})}}function ku(e){try{return JSON.stringify(e,null,2)}catch{return String(e)}}function Au(e){let t=c(),n=e.savedNetworkRef.trim(),a=e.snapshotId.trim()||void 0,[o,s]=(0,M.useState)(`overview`),[l,u]=(0,M.useState)(Cu),[d,f]=(0,M.useState)(Cu),[p,m]=(0,M.useState)(`open`),[h,g]=(0,M.useState)(``),[_,v]=(0,M.useState)([]),[y,b]=(0,M.useState)(``),[ee,te]=(0,M.useState)(!1),[x,S]=(0,M.useState)(``),[C,w]=(0,M.useState)(``),ne=i({queryKey:H.forwardRoutingSummary(n),queryFn:()=>mo({forwardNetworkRef:n||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4}),T=i({queryKey:H.forwardRoutingPriorities(n,a,l,d,p,h),queryFn:()=>ho({forwardNetworkRef:n||void 0,snapshotId:a,category:l===Cu?void 0:l,severity:d===Cu?void 0:d,status:p===Cu?`all`:p,limit:wu,cursor:h||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4}),re=i({queryKey:H.forwardRoutingFindingEvidence(n,y),queryFn:()=>go(y,{forwardNetworkRef:n||void 0}),enabled:n.length>0&&y.trim().length>0,retry:!1,staleTime:5e3}),ie=i({queryKey:H.forwardRoutingQueries(n,a),queryFn:()=>_o({forwardNetworkRef:n||void 0,snapshotId:a}),enabled:n.length>0,retry:!1,staleTime:1e4}),ae=i({queryKey:H.forwardRoutingSources(n),queryFn:()=>vo({forwardNetworkRef:n||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4}),E=i({queryKey:H.forwardRoutingDrift(n),queryFn:()=>yo({forwardNetworkRef:n||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4});(0,M.useEffect)(()=>{let e=Du(T.data?.priorities??[]);if(!h){v(e);return}v(t=>Du([...t,...e]))},[T.data?.priorities,h]),(0,M.useEffect)(()=>{if(_.length===0){b(``);return}_.some(e=>String(e.findingKey??``).trim()===y)||b(String(_[0].findingKey??``).trim())},[_,y]),(0,M.useEffect)(()=>{g(``),v([])},[n,a,l,d,p]);let D=r({mutationFn:async()=>po({forwardNetworkRef:n||void 0,snapshotId:a}),onSuccess:async()=>{g(``),v([]),s(`overview`),await Promise.all([t.invalidateQueries({queryKey:H.forwardRoutingSummary(n)}),t.invalidateQueries({queryKey:H.forwardRoutingPriorities(n)}),t.invalidateQueries({queryKey:H.forwardRoutingQueries(n)}),t.invalidateQueries({queryKey:H.forwardRoutingSources(n)}),t.invalidateQueries({queryKey:H.forwardRoutingDrift(n)})]),j.success(`Routing analytics completed`)},onError:e=>j.error(`Routing analytics failed`,{description:e.message})}),O=ne.data?.summary,oe=T.data?.nextCursor||``,se=ie.data?.items??[],ce=O?.topRiskDrivers??[],k=(0,M.useMemo)(()=>_.find(e=>String(e.findingKey)===y),[_,y]),le=re.data?.finding,ue=(0,M.useMemo)(()=>{let e=new Set;for(let t of _){let n=String(t.category??``).trim().toLowerCase();n&&e.add(n)}return Array.from(e).sort((e,t)=>e.localeCompare(t))},[_]),de=(0,M.useMemo)(()=>_.slice(0,5),[_]);return(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Routing Analytics`}),(0,P.jsx)(B,{children:`Prioritized routing risk overlay powered by Forward signals.`})]}),(0,P.jsxs)(V,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(F,{onClick:()=>D.mutate(),disabled:!n||D.isPending,children:[(0,P.jsx)(vn,{className:`mr-2 h-4 w-4`}),`Run routing analytics`]}),(0,P.jsxs)(F,{variant:`outline`,onClick:()=>{ne.refetch(),T.refetch(),ie.refetch(),ae.refetch(),E.refetch(),y&&re.refetch()},disabled:!n,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Refresh`]}),(0,P.jsx)(W,{variant:`secondary`,children:O?.snapshotId?`Snapshot: ${O.snapshotId}`:`Snapshot: Latest Processed`}),e.networkId?(0,P.jsxs)(W,{variant:`outline`,children:[`Network ID: `,e.networkId]}):null]}),n?null:(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Select a saved network target first.`}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-5`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Exposure impact score`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.graphRiskScore??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Priority queue`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.priorityCount??_.length})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`High confidence`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.highConfidenceCount??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Route entries`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.routeEntryTotal??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`BGP down peers`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.bgpDownNeighbors??0})]})]}),O?.warnings&&O.warnings.length>0?(0,P.jsxs)(`div`,{className:`rounded-md border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900`,children:[(0,P.jsx)(`div`,{className:`font-medium`,children:`Warnings`}),(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4`,children:O.warnings.map(e=>(0,P.jsx)(`li`,{children:e},e))})]}):null,(0,P.jsxs)(lc,{value:o,onValueChange:e=>s(e),className:`space-y-4`,children:[(0,P.jsxs)(uc,{children:[(0,P.jsx)(dc,{value:`overview`,children:`Overview`}),(0,P.jsx)(dc,{value:`priorities`,children:`Priorities`}),(0,P.jsx)(dc,{value:`evidence`,children:`Evidence`}),(0,P.jsx)(dc,{value:`queries`,children:`Method and data`})]}),(0,P.jsxs)(fc,{value:`overview`,className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`grid gap-3 lg:grid-cols-3`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Main risk themes`}),ce.length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`Run routing analytics to populate drivers.`}):(0,P.jsx)(`ul`,{className:`mt-2 space-y-2 text-sm`,children:ce.map(e=>(0,P.jsxs)(`li`,{className:`flex items-center justify-between gap-3`,children:[(0,P.jsxs)(`div`,{className:`truncate`,children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.controlId||`control`}),(0,P.jsx)(`div`,{className:`font-mono text-xs text-muted-foreground`,children:e.controlId||`n/a`})]}),(0,P.jsx)(W,{variant:`outline`,children:e.count})]},`${e.controlId}-${e.title}`))})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Snapshot drift context`}),(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:E.data?.message||`No drift metadata yet.`}),(0,P.jsxs)(`div`,{className:`mt-2 flex flex-wrap items-center gap-2`,children:[(0,P.jsx)(W,{variant:E.data?.available?`default`:`secondary`,children:E.data?.available?`Available`:`Unavailable`}),E.data?.baselineSnapshotId?(0,P.jsxs)(W,{variant:`outline`,children:[`Baseline: `,E.data.baselineSnapshotId]}):null,E.data?.compareSnapshotId?(0,P.jsxs)(W,{variant:`outline`,children:[`Compare: `,E.data.compareSnapshotId]}):null]})]}),(0,P.jsx)(ou,{overall:O?.competitiveScoreOverall,score:O?.competitiveScore,tier:O?.competitiveTier,gatePassed:O?.competitiveGatePassed,gateReasons:O?.competitiveGateReasons,gateChecks:O?.competitiveGateChecks,strengths:O?.competitiveStrengths,gaps:O?.competitiveGaps})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Fix-first actions`}),de.length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`No priorities yet. Run routing analytics to build the queue.`}):(0,P.jsx)(`ul`,{className:`mt-2 space-y-2`,children:de.map(e=>(0,P.jsxs)(`li`,{className:`flex flex-wrap items-center justify-between gap-2 rounded border p-2`,children:[(0,P.jsxs)(`div`,{className:`min-w-0 flex-1`,children:[(0,P.jsx)(`div`,{className:`truncate text-sm font-medium`,children:e.title||e.findingKey}),(0,P.jsx)(`div`,{className:`truncate text-xs text-muted-foreground`,children:e.summary||`No summary`})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(W,{variant:Eu(e.priorityScore),children:[`P`,e.priorityScore]}),(0,P.jsx)(W,{variant:`outline`,children:e.remediationEffort||`medium`})]})]},e.findingKey))})]})]}),(0,P.jsxs)(fc,{value:`priorities`,className:`space-y-4`,children:[(0,P.jsxs)(`details`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`summary`,{className:`cursor-pointer text-sm font-medium`,children:`Advanced filters`}),(0,P.jsxs)(`div`,{className:`mt-3 flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(q,{value:l,onValueChange:u,children:[(0,P.jsx)(Y,{className:`w-[180px]`,children:(0,P.jsx)(J,{placeholder:`Category`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:Cu,children:`All categories`}),ue.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))]})]}),(0,P.jsxs)(q,{value:d,onValueChange:f,children:[(0,P.jsx)(Y,{className:`w-[150px]`,children:(0,P.jsx)(J,{placeholder:`Severity`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:Cu,children:`All severities`}),(0,P.jsx)(Z,{value:`critical`,children:`Critical`}),(0,P.jsx)(Z,{value:`high`,children:`High`}),(0,P.jsx)(Z,{value:`medium`,children:`Medium`}),(0,P.jsx)(Z,{value:`low`,children:`Low`})]})]}),(0,P.jsxs)(q,{value:p,onValueChange:m,children:[(0,P.jsx)(Y,{className:`w-[130px]`,children:(0,P.jsx)(J,{placeholder:`Status`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`open`,children:`Open`}),(0,P.jsx)(Z,{value:Cu,children:`All`})]})]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>{g(``),v([]),T.refetch()},disabled:T.isFetching,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Apply`]})]})]}),T.isError?(0,P.jsxs)(`p`,{className:`text-xs text-destructive`,children:[`Failed to load priorities: `,T.error.message]}):null,(0,P.jsxs)(wc,{children:[(0,P.jsx)(Tc,{children:(0,P.jsxs)(Oc,{children:[(0,P.jsx)(Q,{className:`w-[72px]`,children:`Rank`}),(0,P.jsx)(Q,{children:`Issue`}),(0,P.jsx)(Q,{className:`text-right`,children:`Scores`}),(0,P.jsx)(Q,{children:`Effort`}),(0,P.jsx)(Q,{className:`text-right`,children:`Actions`})]})}),(0,P.jsxs)(Ec,{children:[_.map(e=>(0,P.jsxs)(Oc,{children:[(0,P.jsx)($,{children:(0,P.jsxs)(W,{variant:`outline`,children:[`#`,e.rank]})}),(0,P.jsxs)($,{children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.findingKey}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:e.summary||`No summary`}),(0,P.jsxs)(`div`,{className:`mt-1 flex flex-wrap items-center gap-1`,children:[(0,P.jsx)(W,{variant:Tu(e.severity),children:e.severity||`unknown`}),(0,P.jsx)(W,{variant:`outline`,children:e.category||`uncategorized`})]})]}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsxs)(`div`,{className:`flex flex-col items-end gap-1 text-xs`,children:[(0,P.jsxs)(W,{variant:Eu(e.priorityScore),children:[`Priority `,e.priorityScore]}),(0,P.jsxs)(`span`,{children:[`Graph `,e.graphRiskScore]}),(0,P.jsxs)(`span`,{children:[`Potential spread `,e.blastRadiusScore]})]})}),(0,P.jsx)($,{children:(0,P.jsxs)(`div`,{className:`flex flex-col gap-1 text-xs`,children:[(0,P.jsx)(W,{variant:`outline`,children:e.remediationEffort||`medium`}),(0,P.jsxs)(`span`,{className:`text-muted-foreground`,children:[`Confidence: `,e.confidence||`n/a`]})]})}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsx)(`div`,{className:`flex items-center justify-end`,children:(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>{b(e.findingKey),s(`evidence`)},children:`View`})})})]},e.findingKey)),_.length===0?(0,P.jsx)(Oc,{children:(0,P.jsx)($,{colSpan:5,className:`text-center text-sm text-muted-foreground`,children:`No priority findings yet.`})}):null]})]}),oe?(0,P.jsx)(`div`,{className:`flex justify-end`,children:(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>g(oe),disabled:T.isFetching,children:`Load more`})}):null]}),(0,P.jsx)(fc,{value:`evidence`,className:`space-y-4`,children:y?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(`div`,{className:`rounded-md border p-3`,children:(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center justify-between gap-2`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:k?.title||y}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:k?.summary||`No summary`})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(W,{variant:Eu(k?.priorityScore??0),children:[`Priority `,k?.priorityScore??0]}),(0,P.jsx)(W,{variant:Tu(k?.severity),children:k?.severity||`unknown`})]})]})}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Why this matters`}),(k?.rationale??[]).length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`No rationale available.`}):(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4 text-xs`,children:k?.rationale?.map((e,t)=>(0,P.jsx)(`li`,{children:e},`${e}-${t}`))})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Recommendations`}),(k?.recommendations??[]).length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`No remediation hints available.`}):(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4 text-xs`,children:k?.recommendations?.map((e,t)=>(0,P.jsx)(`li`,{children:e},`${e}-${t}`))})]})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Supporting details`}),re.isError?(0,P.jsxs)(`p`,{className:`text-xs text-destructive`,children:[`Failed to load evidence:`,` `,re.error.message]}):null,(0,P.jsx)(`pre`,{className:`max-h-[28rem] overflow-auto rounded-md border bg-muted/20 p-3 text-xs`,children:ku(le?.evidence??k?.evidence??{})})]})]}):(0,P.jsx)(`div`,{className:`rounded-md border p-3 text-sm text-muted-foreground`,children:`Select a priority to inspect evidence.`})}),(0,P.jsxs)(fc,{value:`queries`,className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Routing NQE checks and source payloads used by this overlay.`}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>{ie.refetch(),ae.refetch(),E.refetch()},disabled:ie.isFetching||ae.isFetching,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Refresh`]})]}),(0,P.jsxs)(wc,{children:[(0,P.jsx)(Tc,{children:(0,P.jsxs)(Oc,{children:[(0,P.jsx)(Q,{children:`Check`}),(0,P.jsx)(Q,{children:`Severity`}),(0,P.jsx)(Q,{className:`text-right`,children:`Findings`}),(0,P.jsx)(Q,{className:`text-right`,children:`Actions`})]})}),(0,P.jsxs)(Ec,{children:[se.map(e=>(0,P.jsxs)(Oc,{children:[(0,P.jsxs)($,{children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.checkId}),(0,P.jsx)(`div`,{className:`font-mono text-xs text-muted-foreground`,children:e.checkId})]}),(0,P.jsx)($,{children:(0,P.jsx)(W,{variant:Tu(e.severity),children:e.severity||`unknown`})}),(0,P.jsx)($,{className:`text-right`,children:e.totalFindings}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsxs)(`div`,{className:`flex items-center justify-end gap-2`,children:[(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>{S(e.title||e.checkId),w(e.queryText||``),te(!0)},children:`View Query`}),(0,P.jsx)(F,{variant:`outline`,size:`icon`,onClick:()=>void Ou(e.queryText,`${e.checkId} query`),children:(0,P.jsx)(Oe,{className:`h-4 w-4`})})]})})]},e.checkId)),se.length===0?(0,P.jsx)(Oc,{children:(0,P.jsx)($,{colSpan:4,className:`text-center text-sm text-muted-foreground`,children:`No routing queries available yet.`})}):null]})]}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Drift metadata`}),(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:E.data?.message||`No drift metadata yet.`})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Source payloads`}),(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`Collected from Forward APIs during routing analytics runs.`})]})]}),(0,P.jsx)(`pre`,{className:`max-h-[24rem] overflow-auto rounded-md border bg-muted/20 p-3 text-xs`,children:ku(ae.data?.sources??{})})]})]}),(0,P.jsx)(Zn,{open:ee,onOpenChange:te,children:(0,P.jsxs)(er,{className:`max-h-[85vh] max-w-4xl overflow-hidden`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{children:x||`Routing Query`})}),(0,P.jsx)(`pre`,{className:`max-h-[65vh] overflow-auto rounded-md border bg-muted/20 p-3 text-xs`,children:C||`No query text available.`})]})})]})]})}var ju=`__all__`,Mu=50;function Nu(e){let t=String(e??``).trim().toLowerCase();return t===`critical`||t===`high`?`destructive`:t===`medium`?`default`:`secondary`}function Pu(e){return e>=80?`destructive`:e>=60?`default`:e>=40?`secondary`:`outline`}function Fu(e){let t=[],n=new Set;for(let r of e){let e=String(r.findingKey??``).trim();!e||n.has(e)||(n.add(e),t.push(r))}return t}async function Iu(e,t){let n=String(e??``);if(!n.trim()){j.error(`No ${t} available to copy`);return}try{await navigator.clipboard.writeText(n),j.success(`${t} copied`)}catch(e){j.error(`Failed to copy ${t}`,{description:e instanceof Error?e.message:String(e)})}}function Lu(e){try{return JSON.stringify(e,null,2)}catch{return String(e)}}function Ru(e){let t=c(),n=e.savedNetworkRef.trim(),a=e.snapshotId.trim()||void 0,[o,s]=(0,M.useState)(`overview`),[l,u]=(0,M.useState)(ju),[d,f]=(0,M.useState)(ju),[p,m]=(0,M.useState)(`open`),[h,g]=(0,M.useState)(``),[_,v]=(0,M.useState)([]),[y,b]=(0,M.useState)(``),[ee,te]=(0,M.useState)(!1),[x,S]=(0,M.useState)(``),[C,w]=(0,M.useState)(``),ne=i({queryKey:H.forwardSecuritySummary(n),queryFn:()=>oo({forwardNetworkRef:n||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4}),T=i({queryKey:H.forwardSecurityPriorities(n,a,l,d,p,h),queryFn:()=>so({forwardNetworkRef:n||void 0,snapshotId:a,category:l===ju?void 0:l,severity:d===ju?void 0:d,status:p===ju?`all`:p,limit:Mu,cursor:h||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4}),re=i({queryKey:H.forwardSecurityFindingEvidence(n,y),queryFn:()=>co(y,{forwardNetworkRef:n||void 0}),enabled:n.length>0&&y.trim().length>0,retry:!1,staleTime:5e3}),ie=i({queryKey:H.forwardSecurityQueries(n,a),queryFn:()=>lo({forwardNetworkRef:n||void 0,snapshotId:a}),enabled:n.length>0,retry:!1,staleTime:1e4}),ae=i({queryKey:H.forwardSecuritySources(n),queryFn:()=>uo({forwardNetworkRef:n||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4}),E=i({queryKey:H.forwardSecurityDrift(n),queryFn:()=>fo({forwardNetworkRef:n||void 0}),enabled:n.length>0,retry:!1,staleTime:1e4});(0,M.useEffect)(()=>{let e=Fu(T.data?.priorities??[]);if(!h){v(e);return}v(t=>Fu([...t,...e]))},[T.data?.priorities,h]),(0,M.useEffect)(()=>{if(_.length===0){b(``);return}_.some(e=>String(e.findingKey??``).trim()===y)||b(String(_[0].findingKey??``).trim())},[_,y]),(0,M.useEffect)(()=>{g(``),v([])},[n,a,l,d,p]);let D=r({mutationFn:async()=>ao({forwardNetworkRef:n||void 0,snapshotId:a}),onSuccess:async()=>{g(``),v([]),s(`overview`),await Promise.all([t.invalidateQueries({queryKey:H.forwardSecuritySummary(n)}),t.invalidateQueries({queryKey:H.forwardSecurityPriorities(n)}),t.invalidateQueries({queryKey:H.forwardSecurityQueries(n)}),t.invalidateQueries({queryKey:H.forwardSecuritySources(n)}),t.invalidateQueries({queryKey:H.forwardSecurityDrift(n)})]),j.success(`Security analytics completed`)},onError:e=>j.error(`Security analytics failed`,{description:e.message})}),O=ne.data?.summary,oe=T.data?.nextCursor||``,se=ie.data?.items??[],ce=O?.topRiskDrivers??[],k=(0,M.useMemo)(()=>_.find(e=>String(e.findingKey)===y),[_,y]),le=re.data?.finding,ue=(0,M.useMemo)(()=>{let e=new Set;for(let t of _){let n=String(t.category??``).trim().toLowerCase();n&&e.add(n)}return Array.from(e).sort((e,t)=>e.localeCompare(t))},[_]),de=(0,M.useMemo)(()=>_.slice(0,5),[_]),fe=(0,M.useMemo)(()=>{let e=(O?.driftAclChanges??0)+(O?.driftObjectChanges??0);return e>=30?{label:`Trend: Increasing`,variant:`destructive`}:e<=0?{label:`Trend: Stable`,variant:`secondary`}:{label:`Trend: Watch`,variant:`default`}},[O?.driftAclChanges,O?.driftObjectChanges]);return(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Security Analytics`}),(0,P.jsx)(B,{children:`Prioritized security risk overlay powered by Forward signals.`})]}),(0,P.jsxs)(V,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(F,{onClick:()=>D.mutate(),disabled:!n||D.isPending,children:[(0,P.jsx)(vn,{className:`mr-2 h-4 w-4`}),`Run security analytics`]}),(0,P.jsxs)(F,{variant:`outline`,onClick:()=>{ne.refetch(),T.refetch(),ie.refetch(),ae.refetch(),E.refetch(),y&&re.refetch()},disabled:!n,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Refresh`]}),(0,P.jsx)(W,{variant:`secondary`,children:O?.snapshotId?`Snapshot: ${O.snapshotId}`:`Snapshot: Latest Processed`}),e.networkId?(0,P.jsxs)(W,{variant:`outline`,children:[`Network ID: `,e.networkId]}):null]}),n?null:(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Select a saved network target first.`}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-5`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Exposure impact score`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.graphRiskScore??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Priority queue`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.priorityCount??_.length})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`High confidence`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.highConfidenceCount??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Exposed interfaces`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.exposedInterfaceCount??0})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Exploited vulns`}),(0,P.jsx)(`div`,{className:`text-xl font-semibold`,children:O?.exploitedVulnerabilityCount??0})]})]}),O?.warnings&&O.warnings.length>0?(0,P.jsxs)(`div`,{className:`rounded-md border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900`,children:[(0,P.jsx)(`div`,{className:`font-medium`,children:`Warnings`}),(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4`,children:O.warnings.map(e=>(0,P.jsx)(`li`,{children:e},e))})]}):null,(0,P.jsxs)(lc,{value:o,onValueChange:e=>s(e),className:`space-y-4`,children:[(0,P.jsxs)(uc,{children:[(0,P.jsx)(dc,{value:`overview`,children:`Overview`}),(0,P.jsx)(dc,{value:`priorities`,children:`Priorities`}),(0,P.jsx)(dc,{value:`evidence`,children:`Evidence`}),(0,P.jsx)(dc,{value:`queries`,children:`Method and data`})]}),(0,P.jsxs)(fc,{value:`overview`,className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`grid gap-3 lg:grid-cols-3`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Main risk themes`}),ce.length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`Run security analytics to populate drivers.`}):(0,P.jsx)(`ul`,{className:`mt-2 space-y-2 text-sm`,children:ce.map(e=>(0,P.jsxs)(`li`,{className:`flex items-center justify-between gap-3`,children:[(0,P.jsxs)(`div`,{className:`truncate`,children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.controlId||`control`}),(0,P.jsx)(`div`,{className:`font-mono text-xs text-muted-foreground`,children:e.controlId||`n/a`})]}),(0,P.jsx)(W,{variant:`outline`,children:e.count})]},`${e.controlId}-${e.title}`))})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Snapshot drift context`}),(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:E.data?.message||`No drift metadata yet.`}),(0,P.jsxs)(`div`,{className:`mt-2 flex flex-wrap items-center gap-2`,children:[(0,P.jsx)(W,{variant:E.data?.available?`default`:`secondary`,children:E.data?.available?`Available`:`Unavailable`}),E.data?.baselineSnapshotId?(0,P.jsxs)(W,{variant:`outline`,children:[`Baseline: `,E.data.baselineSnapshotId]}):null,E.data?.compareSnapshotId?(0,P.jsxs)(W,{variant:`outline`,children:[`Compare: `,E.data.compareSnapshotId]}):null]})]}),(0,P.jsx)(ou,{overall:O?.competitiveScoreOverall,score:O?.competitiveScore,tier:O?.competitiveTier,gatePassed:O?.competitiveGatePassed,gateReasons:O?.competitiveGateReasons,gateChecks:O?.competitiveGateChecks,strengths:O?.competitiveStrengths,gaps:O?.competitiveGaps})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Fix-first actions`}),de.length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`No priorities yet. Run security analytics to build the queue.`}):(0,P.jsx)(`ul`,{className:`mt-2 space-y-2`,children:de.map(e=>(0,P.jsxs)(`li`,{className:`flex flex-wrap items-center justify-between gap-2 rounded border p-2`,children:[(0,P.jsxs)(`div`,{className:`min-w-0 flex-1`,children:[(0,P.jsx)(`div`,{className:`truncate text-sm font-medium`,children:e.title||e.findingKey}),(0,P.jsx)(`div`,{className:`truncate text-xs text-muted-foreground`,children:e.summary||`No summary`})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(W,{variant:Pu(e.priorityScore),children:[`P`,e.priorityScore]}),(0,P.jsx)(W,{variant:`outline`,children:e.remediationEffort||`medium`})]})]},e.findingKey))})]})]}),(0,P.jsxs)(fc,{value:`priorities`,className:`space-y-4`,children:[(0,P.jsxs)(`details`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`summary`,{className:`cursor-pointer text-sm font-medium`,children:`Advanced filters`}),(0,P.jsxs)(`div`,{className:`mt-3 flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(q,{value:l,onValueChange:u,children:[(0,P.jsx)(Y,{className:`w-[180px]`,children:(0,P.jsx)(J,{placeholder:`Category`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:ju,children:`All categories`}),ue.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))]})]}),(0,P.jsxs)(q,{value:d,onValueChange:f,children:[(0,P.jsx)(Y,{className:`w-[150px]`,children:(0,P.jsx)(J,{placeholder:`Severity`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:ju,children:`All severities`}),(0,P.jsx)(Z,{value:`critical`,children:`Critical`}),(0,P.jsx)(Z,{value:`high`,children:`High`}),(0,P.jsx)(Z,{value:`medium`,children:`Medium`}),(0,P.jsx)(Z,{value:`low`,children:`Low`})]})]}),(0,P.jsxs)(q,{value:p,onValueChange:m,children:[(0,P.jsx)(Y,{className:`w-[130px]`,children:(0,P.jsx)(J,{placeholder:`Status`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`open`,children:`Open`}),(0,P.jsx)(Z,{value:ju,children:`All`})]})]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>{g(``),v([]),T.refetch()},disabled:T.isFetching,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Apply`]})]})]}),T.isError?(0,P.jsxs)(`p`,{className:`text-xs text-destructive`,children:[`Failed to load priorities: `,T.error.message]}):null,(0,P.jsxs)(wc,{children:[(0,P.jsx)(Tc,{children:(0,P.jsxs)(Oc,{children:[(0,P.jsx)(Q,{className:`w-[72px]`,children:`Rank`}),(0,P.jsx)(Q,{children:`Issue`}),(0,P.jsx)(Q,{className:`text-right`,children:`Scores`}),(0,P.jsx)(Q,{children:`Effort`}),(0,P.jsx)(Q,{className:`text-right`,children:`Actions`})]})}),(0,P.jsxs)(Ec,{children:[_.map(e=>(0,P.jsxs)(Oc,{children:[(0,P.jsx)($,{children:(0,P.jsxs)(W,{variant:`outline`,children:[`#`,e.rank]})}),(0,P.jsxs)($,{children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.findingKey}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:e.summary||`No summary`}),(0,P.jsxs)(`div`,{className:`mt-1 flex flex-wrap items-center gap-1`,children:[(0,P.jsx)(W,{variant:Nu(e.severity),children:e.severity||`unknown`}),(0,P.jsx)(W,{variant:`outline`,children:e.category||`uncategorized`}),(0,P.jsx)(W,{variant:fe.variant,children:fe.label})]})]}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsxs)(`div`,{className:`flex flex-col items-end gap-1 text-xs`,children:[(0,P.jsxs)(W,{variant:Pu(e.priorityScore),children:[`Priority `,e.priorityScore]}),(0,P.jsxs)(`span`,{children:[`Graph `,e.graphRiskScore]}),(0,P.jsxs)(`span`,{children:[`Potential spread `,e.blastRadiusScore]})]})}),(0,P.jsx)($,{children:(0,P.jsxs)(`div`,{className:`flex flex-col gap-1 text-xs`,children:[(0,P.jsx)(W,{variant:`outline`,children:e.remediationEffort||`medium`}),(0,P.jsxs)(`span`,{className:`text-muted-foreground`,children:[`Confidence: `,e.confidence||`n/a`]})]})}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsx)(`div`,{className:`flex items-center justify-end`,children:(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>{b(e.findingKey),s(`evidence`)},children:`View`})})})]},e.findingKey)),_.length===0?(0,P.jsx)(Oc,{children:(0,P.jsx)($,{colSpan:5,className:`text-center text-sm text-muted-foreground`,children:`No priority findings yet.`})}):null]})]}),oe?(0,P.jsx)(`div`,{className:`flex justify-end`,children:(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>g(oe),disabled:T.isFetching,children:`Load more`})}):null]}),(0,P.jsx)(fc,{value:`evidence`,className:`space-y-4`,children:y?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(`div`,{className:`rounded-md border p-3`,children:(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center justify-between gap-2`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:k?.title||y}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:k?.summary||`No summary`})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(W,{variant:Pu(k?.priorityScore??0),children:[`Priority `,k?.priorityScore??0]}),(0,P.jsx)(W,{variant:Nu(k?.severity),children:k?.severity||`unknown`})]})]})}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Why this matters`}),(k?.rationale??[]).length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`No rationale available.`}):(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4 text-xs`,children:k?.rationale?.map((e,t)=>(0,P.jsx)(`li`,{children:e},`${e}-${t}`))})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Recommendations`}),(k?.recommendations??[]).length===0?(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`No remediation hints available.`}):(0,P.jsx)(`ul`,{className:`mt-2 list-disc space-y-1 pl-4 text-xs`,children:k?.recommendations?.map((e,t)=>(0,P.jsx)(`li`,{children:e},`${e}-${t}`))})]})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Supporting details`}),re.isError?(0,P.jsxs)(`p`,{className:`text-xs text-destructive`,children:[`Failed to load evidence:`,` `,re.error.message]}):null,(0,P.jsx)(`pre`,{className:`max-h-[28rem] overflow-auto rounded-md border bg-muted/20 p-3 text-xs`,children:Lu(le?.evidence??k?.evidence??{})})]})]}):(0,P.jsx)(`div`,{className:`rounded-md border p-3 text-sm text-muted-foreground`,children:`Select a priority to inspect evidence.`})}),(0,P.jsxs)(fc,{value:`queries`,className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,P.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Security NQE checks and source payloads used by this overlay.`}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>{ie.refetch(),ae.refetch(),E.refetch()},disabled:ie.isFetching||ae.isFetching,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),`Refresh`]})]}),(0,P.jsxs)(wc,{children:[(0,P.jsx)(Tc,{children:(0,P.jsxs)(Oc,{children:[(0,P.jsx)(Q,{children:`Check`}),(0,P.jsx)(Q,{children:`Severity`}),(0,P.jsx)(Q,{className:`text-right`,children:`Findings`}),(0,P.jsx)(Q,{className:`text-right`,children:`Actions`})]})}),(0,P.jsxs)(Ec,{children:[se.map(e=>(0,P.jsxs)(Oc,{children:[(0,P.jsxs)($,{children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.title||e.checkId}),(0,P.jsx)(`div`,{className:`font-mono text-xs text-muted-foreground`,children:e.checkId})]}),(0,P.jsx)($,{children:(0,P.jsx)(W,{variant:Nu(e.severity),children:e.severity||`unknown`})}),(0,P.jsx)($,{className:`text-right`,children:e.totalFindings}),(0,P.jsx)($,{className:`text-right`,children:(0,P.jsxs)(`div`,{className:`flex items-center justify-end gap-2`,children:[(0,P.jsx)(F,{variant:`outline`,size:`sm`,onClick:()=>{S(e.title||e.checkId),w(e.queryText||``),te(!0)},children:`View Query`}),(0,P.jsx)(F,{variant:`outline`,size:`icon`,onClick:()=>void Iu(e.queryText,`${e.checkId} query`),children:(0,P.jsx)(Oe,{className:`h-4 w-4`})})]})})]},e.checkId)),se.length===0?(0,P.jsx)(Oc,{children:(0,P.jsx)($,{colSpan:4,className:`text-center text-sm text-muted-foreground`,children:`No security queries available yet.`})}):null]})]}),(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Drift metadata`}),(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:E.data?.message||`No drift metadata yet.`})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Source payloads`}),(0,P.jsx)(`div`,{className:`mt-2 text-xs text-muted-foreground`,children:`Collected from Forward APIs during security analytics runs.`})]})]}),(0,P.jsx)(`pre`,{className:`max-h-[24rem] overflow-auto rounded-md border bg-muted/20 p-3 text-xs`,children:Lu(ae.data?.sources??{})})]})]}),(0,P.jsx)(Zn,{open:ee,onOpenChange:te,children:(0,P.jsxs)(er,{className:`max-h-[85vh] max-w-4xl overflow-hidden`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{children:x||`Security Query`})}),(0,P.jsx)(`pre`,{className:`max-h-[65vh] overflow-auto rounded-md border bg-muted/20 p-3 text-xs`,children:C||`No query text available.`})]})})]})]})}const zu=t(`/dashboard/forward/analytics`)({component:Uu});var Bu=`__latest__`;function Vu(e){if(!e||typeof e!=`object`)return[];let t=(Array.isArray(e.snapshots)?e.snapshots:Array.isArray(e.items)?e.items:[])??[],n=[],r=new Set;for(let e of t){if(!e||typeof e!=`object`)continue;let t=String(e.id??e.snapshotId??``).trim();!t||r.has(t)||(r.add(t),n.push(t))}return n}function Hu(e){let t=String(e.name??``).trim(),n=String(e.forwardNetworkId??``).trim();return t&&n?`${t} (${n})`:t||n||String(e.id??``).trim()}function Uu(){let e=c(),[t,n]=(0,M.useState)(``),[a,o]=(0,M.useState)(``),[s,l]=(0,M.useState)(``),[u,d]=(0,M.useState)(``),f=i({queryKey:H.userForwardNetworks(),queryFn:()=>zo(),retry:!1,staleTime:1e4}),p=i({queryKey:H.userForwardCredentialProfiles(),queryFn:ha,retry:!1,staleTime:1e4}),m=i({queryKey:H.userForwardSourceNetworks(s,``,200),queryFn:()=>ti({forwardCredentialProfileId:s,limit:200}),enabled:s.trim().length>0,retry:!1,staleTime:1e4}),h=(0,M.useMemo)(()=>(f.data?.networks??[]).find(e=>String(e.id)===t)??null,[t,f.data?.networks]),g=String(h?.forwardNetworkId??``).trim(),_=i({queryKey:H.policyReportsSnapshots(g),queryFn:()=>Za(g,50),enabled:g.length>0,retry:!1,staleTime:1e4}),v=(0,M.useMemo)(()=>Vu(_.data?.body),[_.data?.body]),y=r({mutationFn:async()=>{let e=s.trim(),t=u.trim();if(!e)throw Error(`Forward credential profile is required`);if(!t)throw Error(`Forward network is required`);let n=(m.data?.networks??[]).find(e=>String(e.id).trim()===t);return Ro({forwardCredentialProfileId:e,forwardNetworkId:t,name:String(n?.name??``).trim()||t,description:``})},onSuccess:async t=>{j.success(`Saved network target`),await e.invalidateQueries({queryKey:H.userForwardNetworks()}),t?.id&&n(String(t.id))},onError:e=>j.error(`Failed to save network target`,{description:e instanceof Error?e.message:String(e)})});return(0,M.useEffect)(()=>{if(t)return;let e=f.data?.networks?.[0];e?.id&&n(String(e.id))},[t,f.data?.networks]),(0,M.useEffect)(()=>{if(s)return;let e=p.data?.profiles?.[0];e?.id&&l(String(e.id))},[s,p.data?.profiles]),(0,M.useEffect)(()=>{d(``)},[s]),(0,M.useEffect)(()=>{if(u)return;let e=m.data?.networks?.[0];e?.id&&d(String(e.id))},[u,m.data?.networks]),(0,M.useEffect)(()=>{o(``)},[t]),(0,P.jsxs)(`div`,{className:`space-y-6`,children:[(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Network Analytics`}),(0,P.jsx)(B,{children:`Capacity, cloud, routing, and security analytics over a saved Forward network target.`})]}),(0,P.jsxs)(V,{className:`space-y-3`,children:[(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Forward credential profile`}),(0,P.jsxs)(q,{value:s,onValueChange:l,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select credential profile`})}),(0,P.jsx)(X,{children:(p.data?.profiles??[]).map(e=>(0,P.jsxs)(Z,{value:e.id,children:[e.username,`@`,e.baseUrl]},e.id))})]})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Forward network`}),(0,P.jsxs)(q,{value:u,onValueChange:d,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select network from profile`})}),(0,P.jsx)(X,{children:(m.data?.networks??[]).map(e=>(0,P.jsx)(Z,{value:e.id,children:e.name?`${e.name} (${e.id})`:e.id},e.id))})]})]}),(0,P.jsx)(`div`,{className:`flex items-end`,children:(0,P.jsx)(F,{onClick:()=>y.mutate(),disabled:y.isPending||!s.trim()||!u.trim(),children:`Save Network Target`})})]}),m.isError?(0,P.jsxs)(`p`,{className:`text-xs text-destructive`,children:[`Failed to load networks from this profile:`,` `,m.error.message]}):null,(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Saved network target`}),(0,P.jsxs)(q,{value:t,onValueChange:n,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select saved target`})}),(0,P.jsx)(X,{children:(f.data?.networks??[]).map(e=>(0,P.jsx)(Z,{value:e.id,children:Hu(e)},e.id))})]})]}),(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Snapshot`}),(0,P.jsxs)(q,{value:a||Bu,onValueChange:e=>o(e===Bu?``:e),children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Latest Processed`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:Bu,children:`Latest Processed`}),v.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))]})]})]}),(0,P.jsx)(`div`,{className:`flex items-end`,children:(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[g?(0,P.jsxs)(W,{variant:`outline`,children:[`Network ID: `,g]}):null,a?(0,P.jsxs)(W,{variant:`secondary`,children:[`Snapshot: `,a]}):(0,P.jsx)(W,{variant:`secondary`,children:`Snapshot: Latest Processed`})]})})]})]})]}),(0,P.jsx)(nu,{savedNetworkRef:t,networkId:g,snapshotId:a}),(0,P.jsx)(Su,{savedNetworkRef:t,networkId:g,snapshotId:a}),(0,P.jsx)(Ru,{savedNetworkRef:t,networkId:g,snapshotId:a}),(0,P.jsx)(Au,{savedNetworkRef:t,networkId:g,snapshotId:a}),(0,P.jsx)(mu,{savedNetworkRef:t,networkId:g,snapshotId:a})]})}var Wu=[{slug:`getting-started`,title:`Getting started`,content:(0,P.jsxs)(`div`,{className:`space-y-4 text-sm`,children:[(0,P.jsx)(`p`,{children:`Skyforge is optimized for a happy path workflow. You can still run tools manually, but the goal is to make repeatable automation the default.`}),(0,P.jsxs)(`ol`,{className:`list-decimal pl-5 space-y-2`,children:[(0,P.jsxs)(`li`,{children:[`Go to`,` `,(0,P.jsx)(p,{className:`underline`,to:`/dashboard/settings`,children:`My Settings`}),` `,`and configure:`,(0,P.jsxs)(`ul`,{className:`list-disc pl-5 mt-2 space-y-1`,children:[(0,P.jsx)(`li`,{children:`External template repos (optional)`}),(0,P.jsx)(`li`,{children:`BYOL servers (optional)`}),(0,P.jsx)(`li`,{children:`Collector + integrations (optional)`})]})]}),(0,P.jsxs)(`li`,{children:[`Create a deployment from`,` `,(0,P.jsx)(p,{className:`underline`,to:`/dashboard/deployments/new`,children:`Create deployment`}),`.`]}),(0,P.jsxs)(`li`,{children:[`Use `,(0,P.jsx)(`span`,{className:`font-mono`,children:`Validate`}),` before starting, especially when overriding env vars.`]})]})]})},{slug:`my-settings`,title:`My Settings`,content:(0,P.jsxs)(`div`,{className:`space-y-4 text-sm`,children:[(0,P.jsxs)(`p`,{children:[`The current model is`,` `,(0,P.jsx)(`strong`,{children:`per-user settings applied to deployments`}),`. The portal operates in user-only scope and does not require legacy namespace scoping.`]}),(0,P.jsxs)(`ul`,{className:`list-disc pl-5 space-y-2`,children:[(0,P.jsxs)(`li`,{children:[(0,P.jsx)(`strong`,{children:`Defaults`}),`: environment variables applied to new deployments.`]}),(0,P.jsxs)(`li`,{children:[(0,P.jsx)(`strong`,{children:`External Template Repos`}),`: add Git repos once and reuse them across deployments.`]}),(0,P.jsxs)(`li`,{children:[(0,P.jsx)(`strong`,{children:`BYOL Servers`}),`: register Netlab / Containerlab / EVE-NG servers (using `,(0,P.jsx)(`span`,{className:`font-mono`,children:`user:`}),` `,`refs).`]}),(0,P.jsxs)(`li`,{children:[(0,P.jsx)(`strong`,{children:`Cloud credentials`}),`: stored per-user; UI only shows configured status.`]})]})]})},{slug:`deployments`,title:`Deployments`,content:(0,P.jsxs)(`div`,{className:`space-y-4 text-sm`,children:[(0,P.jsx)(`p`,{children:`Deployments are created from templates and then executed as runs. Template validation should use the same env overrides youll apply at runtime.`}),(0,P.jsxs)(`ul`,{className:`list-disc pl-5 space-y-2`,children:[(0,P.jsxs)(`li`,{children:[`Use the `,(0,P.jsx)(`span`,{className:`font-mono`,children:`View`}),` button to inspect a selected template.`]}),(0,P.jsxs)(`li`,{children:[`Use `,(0,P.jsx)(`span`,{className:`font-mono`,children:`Validate`}),` to catch obvious netlab errors early.`]})]})]})},{slug:`servicenow`,title:`ServiceNow demo workflow`,content:(0,P.jsxs)(`div`,{className:`space-y-4 text-sm`,children:[(0,P.jsx)(`p`,{children:`This workflow installs a demo app into a ServiceNow PDI. The demo app calls Forward SaaS directly; Skyforge only installs/configures ServiceNow resources.`}),(0,P.jsxs)(`ol`,{className:`list-decimal pl-5 space-y-2`,children:[(0,P.jsx)(`li`,{children:`Create (and wake) a PDI from ServiceNow developer portal.`}),(0,P.jsxs)(`li`,{children:[`In Skyforge, open`,` `,(0,P.jsx)(p,{className:`underline`,to:`/dashboard/servicenow`,children:`ServiceNow`}),` `,`and save your instance URL + admin credentials.`]}),(0,P.jsxs)(`li`,{children:[`Click `,(0,P.jsx)(`strong`,{children:`Install demo app`}),`.`]}),(0,P.jsx)(`li`,{children:`If schema setup is required, create the required tables in ServiceNow Studio (first time per PDI), then re-run install.`})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3 text-xs text-muted-foreground`,children:[(0,P.jsx)(`div`,{className:`font-medium text-foreground`,children:`Where to find the demo`}),(0,P.jsxs)(`ul`,{className:`mt-2 list-disc space-y-1 pl-5`,children:[(0,P.jsxs)(`li`,{children:[`In ServiceNow App Navigator, search for`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:`Forward Connectivity Ticket`}),`.`]}),(0,P.jsxs)(`li`,{children:[`Portal page:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:`/sp?id=connectivity_ticket`})]}),(0,P.jsxs)(`li`,{children:[`Widget name:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:`Connectivity Ticket Analyzer`})]})]})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-3 text-xs text-muted-foreground`,children:[(0,P.jsx)(`div`,{className:`font-medium text-foreground`,children:`Schema (tables)`}),(0,P.jsx)(`p`,{className:`mt-2`,children:`Skyforge prefers the simplest global table names. Create these two tables (once per PDI) and then re-run install:`}),(0,P.jsxs)(`ul`,{className:`mt-2 list-disc space-y-1 pl-5`,children:[(0,P.jsx)(`li`,{children:(0,P.jsx)(`span`,{className:`font-mono`,children:`u_forward_connectivity_ticket`})}),(0,P.jsx)(`li`,{children:(0,P.jsx)(`span`,{className:`font-mono`,children:`u_forward_connectivity_hop`})})]}),(0,P.jsx)(`p`,{className:`mt-2`,children:`To create the tables in ServiceNow:`}),(0,P.jsxs)(`ol`,{className:`mt-2 list-decimal space-y-1 pl-5`,children:[(0,P.jsxs)(`li`,{children:[`Open `,(0,P.jsx)(`span`,{className:`font-medium`,children:`App Navigator`}),` and search for `,(0,P.jsx)(`span`,{className:`font-mono`,children:`Tables`}),` (System Definition).`]}),(0,P.jsxs)(`li`,{children:[`Click `,(0,P.jsx)(`span`,{className:`font-medium`,children:`New`}),`.`]}),(0,P.jsxs)(`li`,{children:[`For the ticket table, set the`,` `,(0,P.jsx)(`span`,{className:`font-medium`,children:`Label`}),` to`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:`Forward Connectivity Ticket`}),` `,`(leave the `,(0,P.jsx)(`span`,{className:`font-medium`,children:`Name`}),` blank so ServiceNow derives`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:`u_forward_connectivity_ticket`}),`). Set `,(0,P.jsx)(`span`,{className:`font-medium`,children:`Extends table`}),` to`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:`task`}),`.`]}),(0,P.jsxs)(`li`,{children:[`For the hop table, set the`,` `,(0,P.jsx)(`span`,{className:`font-medium`,children:`Label`}),` to`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:`Forward Connectivity Hop`}),` (leave Name blank so it becomes`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:`u_forward_connectivity_hop`}),`).`]})]}),(0,P.jsx)(`p`,{className:`mt-2`,children:`After the tables exist, Skyforge auto-creates required fields and choice lists via Table API.`})]})]})}];const Gu=t(`/dashboard/docs/$slug`)({component:Ku});function Ku(){let{slug:e}=Gu.useParams(),t=Wu.find(t=>t.slug===e);return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsx)(`div`,{className:`flex items-center gap-3`,children:(0,P.jsxs)(p,{to:`/dashboard/docs`,className:`inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground`,children:[(0,P.jsx)(ot,{className:`h-4 w-4`}),`Back to Docs`]})}),(0,P.jsxs)(L,{variant:`glass`,children:[(0,P.jsx)(R,{children:(0,P.jsxs)(z,{className:`flex items-center gap-2`,children:[(0,P.jsx)(ln,{className:`h-5 w-5`}),t?.title??`Page not found`]})}),(0,P.jsx)(V,{children:t?t.content:(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`This doc page doesnt exist.`})})]})]})}var qu=mn,Ju=M.createContext({}),Yu=({...e})=>(0,P.jsx)(Ju.Provider,{value:{name:e.name},children:(0,P.jsx)(tn,{...e})}),Xu=()=>{let e=M.useContext(Ju),t=M.useContext(Zu),{getFieldState:n,formState:r}=xn(),i=n(e.name,r);if(!e)throw Error(`useFormField should be used within <FormField>`);let{id:a}=t;return{id:a,name:e.name,formItemId:`${a}-form-item`,formDescriptionId:`${a}-form-item-description`,formMessageId:`${a}-form-item-message`,...i}},Zu=M.createContext({}),Qu=M.forwardRef(({className:e,...t},n)=>{let r=M.useId();return(0,P.jsx)(Zu.Provider,{value:{id:r},children:(0,P.jsx)(`div`,{ref:n,className:N(`space-y-2`,e),...t})})});Qu.displayName=`FormItem`;var $u=M.forwardRef(({className:e,...t},n)=>{let{error:r,formItemId:i}=Xu();return(0,P.jsx)(G,{ref:n,className:N(r&&`text-destructive`,e),htmlFor:i,...t})});$u.displayName=`FormLabel`;var ed=M.forwardRef(({...e},t)=>{let{error:n,formItemId:r,formDescriptionId:i,formMessageId:a}=Xu();return(0,P.jsx)(Fn,{ref:t,id:r,"aria-describedby":n?`${i} ${a}`:`${i}`,"aria-invalid":!!n,...e})});ed.displayName=`FormControl`;var td=M.forwardRef(({className:e,...t},n)=>{let{formDescriptionId:r}=Xu();return(0,P.jsx)(`p`,{ref:n,id:r,className:N(`text-sm text-muted-foreground`,e),...t})});td.displayName=`FormDescription`;var nd=M.forwardRef(({className:e,children:t,...n},r)=>{let{error:i,formMessageId:a}=Xu(),o=i?String(i?.message):t;return o?(0,P.jsx)(`p`,{ref:r,id:a,className:N(`text-sm font-medium text-destructive`,e),...n,children:o}):null});nd.displayName=`FormMessage`;var rd=Qt,id=dn,ad=Lt,od=M.forwardRef(({className:e,sideOffset:t=4,...n},r)=>(0,P.jsx)(_n,{ref:r,sideOffset:t,className:N(`z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2`,e),...n}));od.displayName=_n.displayName;const sd=[{label:"Device (`NETLAB_DEVICE`)",key:`NETLAB_DEVICE`},{label:"BGP AS (`NETLAB_BGP_AS`)",key:`NETLAB_BGP_AS`},{label:"P2P IPv4 pool (`NETLAB_ADDRESSING_P2P_IPV4`)",key:`NETLAB_ADDRESSING_P2P_IPV4`},{label:"P2P IPv6 mode (`NETLAB_ADDRESSING_P2P_IPV6`)",key:`NETLAB_ADDRESSING_P2P_IPV6`},{label:"Loopback IPv4 pool (`NETLAB_ADDRESSING_LOOPBACK_IPV4`)",key:`NETLAB_ADDRESSING_LOOPBACK_IPV4`},{label:"LAN IPv4 pool (`NETLAB_ADDRESSING_LAN_IPV4`)",key:`NETLAB_ADDRESSING_LAN_IPV4`},{label:"Netlab `--set` overrides (`SKYFORGE_NETLAB_SET_OVERRIDES`)",key:`SKYFORGE_NETLAB_SET_OVERRIDES`}],cd=[{label:`Arista EOS (eos)`,value:`eos`},{label:`Cisco IOL (iol)`,value:`iol`},{label:`Cisco IOSv (iosv)`,value:`iosv`},{label:`Cisco IOSvL2 (iosvl2)`,value:`iosvl2`},{label:`Cisco CSR1000v (csr)`,value:`csr`},{label:`Cisco IOS XRd (iosxr)`,value:`iosxr`},{label:`Cisco ASA (asav)`,value:`asav`},{label:`Cisco NX-OSv9k (nxos)`,value:`nxos`},{label:`NVIDIA Cumulus VX (cumulus)`,value:`cumulus`},{label:`Juniper vMX (vmx)`,value:`vmx`},{label:`Juniper vJunos Router (vjunos-router)`,value:`vjunos-router`},{label:`Juniper vJunos Switch (vjunos-switch)`,value:`vjunos-switch`},{label:`Nokia SR OS (sros)`,value:`sros`},{label:`Linux (linux)`,value:`linux`}];function ld(e){return String(e??``).trim().toUpperCase()===`SKYFORGE_NETLAB_SET_OVERRIDES`}function ud(e){switch(String(e??``).trim().toUpperCase()){case`NETLAB_DEVICE`:return cd;case`NETLAB_BGP_AS`:return[{label:`65000`,value:`65000`},{label:`65100`,value:`65100`},{label:`65200`,value:`65200`},{label:`65500`,value:`65500`}];case`NETLAB_ADDRESSING_P2P_IPV4`:return[{label:`198.18.0.0/16 (benchmark range)`,value:`198.18.0.0/16`},{label:`172.16.0.0/12`,value:`172.16.0.0/12`},{label:`100.64.0.0/10`,value:`100.64.0.0/10`}];case`NETLAB_ADDRESSING_P2P_IPV6`:return[{label:`false (disable / avoid LLA-only)`,value:`false`},{label:`true`,value:`true`}];case`NETLAB_ADDRESSING_LOOPBACK_IPV4`:return[{label:`10.0.0.0/24`,value:`10.0.0.0/24`},{label:`198.18.1.0/24`,value:`198.18.1.0/24`},{label:`172.16.0.0/24`,value:`172.16.0.0/24`}];case`NETLAB_ADDRESSING_LAN_IPV4`:return[{label:`172.18.0.0/16`,value:`172.18.0.0/16`},{label:`198.18.128.0/17`,value:`198.18.128.0/17`}];default:return null}}const dd=t(`/dashboard/deployments/new`)({component:md});var fd=Jn({scopeId:Un().optional(),name:Un().min(1,`Deployment name is required`).max(100),kind:Kn([`netlab-c9s`,`netlab`,`containerlab`,`clabernetes`,`terraform`,`eve_ng`]),source:Kn([`user`,`blueprints`,`external`,`custom`]),templateRepoId:Un().optional(),templateRepo:Un().optional(),template:Un().min(1,`Template is required`),netlabServer:Un().optional(),eveServer:Un().optional(),forwardCollectorId:Un().optional(),variableGroupId:Un().optional(),env:Hn(Jn({key:Un(),value:Un()})).optional()});function pd(e){let t=String(e??``).trim();if(!t)return``;try{return new URL(t).hostname||t}catch{return t.replace(/^https?:\/\//,``).split(`/`)[0]??t}}function md(){let e=n(),t=c(),[a,o]=(0,M.useState)(!1),[s,l]=(0,M.useState)(!1),[u,d]=(0,M.useState)(`all`),[f,p]=(0,M.useState)(!1),[m,h]=(0,M.useState)(``),[g,_]=(0,M.useState)(``),[v,y]=(0,M.useState)(``),[b,ee]=(0,M.useState)(!1),[te,x]=(0,M.useState)(``);qc(!0);let S=i({queryKey:H.dashboardSnapshot(),queryFn:Rr,initialData:()=>t.getQueryData(H.dashboardSnapshot())??null,retry:!1,staleTime:1/0}),C=i({queryKey:H.userSettings(),queryFn:ei,staleTime:3e4,retry:!1}),w=Kt({resolver:mt(fd),defaultValues:{scopeId:`self`,name:``,kind:`netlab-c9s`,source:`user`,templateRepoId:``,templateRepo:``,template:``,netlabServer:``,eveServer:``,forwardCollectorId:`none`,variableGroupId:`none`,env:[]}}),{watch:ne,setValue:T,control:re}=w,{fields:ie,append:ae,remove:E}=bt({control:re,name:`env`});(0,M.useEffect)(()=>{let e=C.data?.defaultEnv??[];e.length&&((w.getValues(`env`)??[]).length||T(`env`,e,{shouldDirty:!1,shouldTouch:!1,shouldValidate:!0}))},[C.data?.defaultEnv,w,T]);let D=String(ne(`scopeId`)??``),O=ne(`kind`),oe=ne(`source`),se=ne(`templateRepoId`),ce=ne(`templateRepo`),k=ne(`template`);ne(`name`);let le=ne(`forwardCollectorId`);ne(`env`);let ue=S.data?.templatesIndexUpdatedAt??``;(0,M.useEffect)(()=>{T(`name`,`${(k||O).split(`/`).pop()||O}-${new Date().toISOString().replace(/[-:]/g,``).replace(/\..+/,``).slice(0,15)}`)},[k,O,T]);let de=i({queryKey:H.userNetlabServers(),queryFn:Si,staleTime:3e4,retry:!1}),fe=i({queryKey:H.userContainerlabServers(),queryFn:Oi,staleTime:3e4,retry:!1}),pe=i({queryKey:H.userEveServers(),queryFn:Ti,staleTime:3e4,retry:!1}),me=i({queryKey:H.userEveLabs(m,``,!0),queryFn:()=>Ur({server:m,recursive:!0}),enabled:!!(f&&D&&m),staleTime:3e4,retry:!1}),he=i({queryKey:H.userVariableGroups(),queryFn:qa,staleTime:3e4}),ge=i({queryKey:H.userForwardCollectorConfigs(),queryFn:ua,enabled:[`netlab-c9s`,`clabernetes`,`terraform`].includes(O),staleTime:3e4,retry:!1}),_e=(0,M.useMemo)(()=>(ge.data?.collectors??[]).filter(e=>e&&typeof e.id==`string`&&typeof e.name==`string`).filter(e=>!e.decryptionFailed),[ge.data?.collectors]);(0,M.useEffect)(()=>{if(![`netlab-c9s`,`clabernetes`,`terraform`].includes(O)){(le??`none`)!==`none`&&T(`forwardCollectorId`,`none`);return}},[O,T]);let ve=(0,M.useMemo)(()=>O===`netlab`||O===`netlab-c9s`?oe===`user`||oe===`blueprints`||oe===`external`||oe===`custom`?oe:`user`:O===`eve_ng`?`blueprints`:O===`containerlab`||O===`clabernetes`||O===`terraform`?oe:`user`,[O,oe]),ye=(0,M.useMemo)(()=>{if(ve===`external`)return String(se??``).trim()||void 0;if(ve===`custom`)return String(ce??``).trim()||void 0},[ve,ce,se]),be=i({queryKey:H.userTemplates(O,ve,ye,void 0),enabled:!!D,queryFn:async()=>{let e={source:ve};switch(ye&&(e.repo=ye),O){case`netlab`:case`netlab-c9s`:return Xi(e);case`eve_ng`:return na(e);case`containerlab`:case`clabernetes`:return $i(e);case`terraform`:return ea(e);default:return Xi(e)}},staleTime:5*6e4,refetchOnWindowFocus:!1});(0,M.useEffect)(()=>{ue&&t.invalidateQueries({queryKey:[`userTemplates`]})},[ue,t]);let xe=(0,M.useMemo)(()=>{let e=be.data?.templates??[];if(O!==`terraform`)return e;let t=String(u??`all`).trim().toLowerCase();return!t||t===`all`?e:e.filter(e=>String(e).toLowerCase().startsWith(`${t}/`)||String(e).toLowerCase()===t)},[be.data?.templates,u,O]),Se=(0,M.useMemo)(()=>{if(O!==`terraform`)return[];let e=be.data?.templates??[],t=new Set;for(let n of e){let e=String(n??``).split(`/`)[0]?.trim();e&&t.add(e)}return Array.from(t).sort((e,t)=>e.localeCompare(t))},[be.data?.templates,O]);(0,M.useEffect)(()=>{if(O!==`terraform`){d(`all`);return}u!==`all`&&!Se.includes(u)&&d(`all`)},[u,Se,O]);let Ce=i({queryKey:[`userTemplate`,O,D,ve,ye,be.data?.dir,k],queryFn:async()=>{if(!D)throw Error(`user scope is required`);if(!k)throw Error(`template is required`);let e={source:ve};return ye&&(e.repo=ye),be.data?.dir&&(e.dir=be.data.dir),O===`containerlab`||O===`clabernetes`?ta({...e,file:k}):Zi({...e,template:k})},enabled:a&&!!D&&!!k&&(ve!==`custom`||!!ye)&&(O===`netlab`||O===`netlab-c9s`||O===`containerlab`||O===`clabernetes`),retry:!1,staleTime:3e4}),we=(C.data?.externalTemplateRepos??[]).filter(e=>!!e&&typeof e.id==`string`&&typeof e.repo==`string`),Te=we.length>0,Ee=r({mutationFn:async e=>{let t={template:e.template};if(e.variableGroupId&&e.variableGroupId!==`none`&&(t.envGroupIds=[Number.parseInt(e.variableGroupId,10)],t.envGroupScope=`user`),e.env&&e.env.length>0){let n={};for(let t of e.env)t.key.trim()&&(n[t.key.trim()]=t.value);Object.keys(n).length>0&&(t.environment=n)}if([`netlab-c9s`,`clabernetes`,`terraform`].includes(e.kind)){let n=String(e.forwardCollectorId??`none`).trim();n&&n!==`none`&&(t.forwardEnabled=!0,t.forwardCollectorId=n)}if(e.kind===`netlab`||e.kind===`containerlab`){let n=(e.netlabServer||``).trim();if(!n)throw Error(`BYOS server is required`);t.netlabServer=n,t.templateSource=ve,ve===`external`&&e.templateRepoId&&(t.templateRepo=e.templateRepoId),ve===`custom`&&e.templateRepo&&(t.templateRepo=e.templateRepo),be.data?.dir&&(t.templatesDir=be.data.dir)}if(e.kind===`netlab-c9s`&&(t.templateSource=ve,ve===`external`&&e.templateRepoId&&(t.templateRepo=e.templateRepoId),ve===`custom`&&e.templateRepo&&(t.templateRepo=e.templateRepo),be.data?.dir&&(t.templatesDir=be.data.dir)),e.kind===`clabernetes`&&(t.templateSource=ve,ve===`external`&&e.templateRepoId&&(t.templateRepo=e.templateRepoId),ve===`custom`&&e.templateRepo&&(t.templateRepo=e.templateRepo),be.data?.dir&&(t.templatesDir=be.data.dir)),e.kind===`terraform`&&(t.templateSource=ve,ve===`external`&&e.templateRepoId&&(t.templateRepo=e.templateRepoId),ve===`custom`&&e.templateRepo&&(t.templateRepo=e.templateRepo),be.data?.dir&&(t.templatesDir=be.data.dir)),e.kind===`eve_ng`){t.templateSource=`blueprints`,be.data?.dir&&(t.templatesDir=be.data.dir);let n=(e.eveServer||``).trim();if(!n)throw Error(`EVE-NG server is required`);t.eveServer=n}return ra({name:e.name,type:e.kind,config:t})},onSuccess:async(n,r)=>{j.success(`Deployment created successfully`,{description:`${r.name} is now queued for provisioning.`}),await t.invalidateQueries({queryKey:H.dashboardSnapshot()}),await e({to:`/dashboard/deployments`})},onError:e=>{j.error(`Failed to create deployment`,{description:e.message})}}),De=r({mutationFn:async()=>{if(!D)throw Error(`No user scope available.`);let e=m.trim();if(!e)throw Error(`Select an EVE-NG server.`);let t=g.trim();if(!t)throw Error(`Select an EVE-NG lab.`);return Wr({server:e,labPath:t,deploymentName:v.trim()||void 0})},onSuccess:async n=>{j.success(`EVE-NG lab imported`,{description:n?.name??`Deployment created.`}),await t.invalidateQueries({queryKey:H.dashboardSnapshot()}),p(!1),await e({to:`/dashboard/deployments`})},onError:e=>{j.error(`Failed to import EVE-NG lab`,{description:e.message})}}),Oe=r({mutationFn:async()=>{if(!D)throw Error(`No user scope available.`);let e=m.trim();if(!e)throw Error(`Select an EVE-NG server.`);let t=g.trim();if(!t)throw Error(`Select an EVE-NG lab.`);let n=b,r=te.trim();if(n&&!r)throw Error(`Select a Containerlab server.`);return Gr({server:e,labPath:t,createDeployment:n,containerlabServer:n?r:void 0})},onSuccess:async n=>{let r=n?.warnings??[];j.success(`Containerlab template created`,{description:n?.path??`Template saved.`}),r.length>0&&j.message(`Conversion warnings`,{description:r.slice(0,3).join(` | `)}),await t.invalidateQueries({queryKey:H.dashboardSnapshot()}),p(!1),n?.deployment&&await e({to:`/dashboard/deployments`})},onError:e=>{j.error(`Failed to convert EVE-NG lab`,{description:e.message})}}),ke=r({mutationFn:async()=>{if(!D)throw Error(`No user scope available.`);if(!k)throw Error(`Select a template first.`);let e=new Map;for(let t of w.getValues(`env`)||[]){let n=(t?.key??``).trim();n&&e.set(n,String(t?.value??``))}let t=String(w.getValues(`variableGroupId`)??`none`),n=t===`none`?null:Number(t),r={...(n?Pe.find(e=>e.id===n)?.variables:void 0)??{}};for(let[t,n]of e.entries())r[t]=n;let i={source:ve,template:k,environment:r};return ye&&(i.repo=ye),be.data?.dir&&(i.dir=be.data.dir),Qi(i)},onSuccess:async t=>{let n=String(t?.task?.id??t?.task?.task_id??``).trim();j.success(`Validation queued`,{description:n?`Run ${n} started.`:`Validation run started.`}),n&&e({to:`/dashboard/runs/$runId`,params:{runId:n}})},onError:e=>{j.error(`Validation failed`,{description:String(e?.message??e)})}});function A(e){Ee.mutate(e)}let je=de.data?.servers??[],Me=fe.data?.servers??[],Ne=pe.data?.servers??[],Pe=he.data?.groups??[],Fe=je.length>0,Ie=Me.length>0,Le=Ne.length>0;(0,M.useEffect)(()=>{f&&!m&&Ne.length>0&&h(`user:${Ne[0].id}`)},[f,m,Ne]),(0,M.useEffect)(()=>{f&&_(``)},[f,m]),(0,M.useEffect)(()=>{!f||!b||!te&&Me.length>0&&x(`user:${Me[0].id}`)},[f,b,te,Me]);let Re=(0,M.useMemo)(()=>je.filter(e=>!!e?.id).map(e=>({value:`user:${e.id}`,label:pd(e.apiUrl)||e.name})),[je]),ze=(0,M.useMemo)(()=>Me.filter(e=>!!e?.id).map(e=>({value:`user:${e.id}`,label:pd(e.apiUrl)||e.name})),[Me]),Be=(0,M.useMemo)(()=>(me.data?.labs??[]).map(e=>({value:e.path,label:e.folder?`${e.folder}/${e.name}`:e.name})).sort((e,t)=>e.label.localeCompare(t.label)),[me.data?.labs]),Ve=O===`netlab`?Re:O===`containerlab`?ze:[];return(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsx)(L,{variant:`glass`,children:(0,P.jsx)(R,{children:(0,P.jsxs)(`div`,{className:`flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(z,{children:`Create deployment`}),(0,P.jsx)(B,{children:`Configure and launch a new infrastructure deployment.`})]}),(0,P.jsx)(F,{variant:`outline`,onClick:()=>e({to:`/dashboard/deployments`}),children:`Cancel`})]})})}),Le&&O===`eve_ng`&&(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Import from EVE-NG`}),(0,P.jsx)(B,{children:`Register an existing EVE-NG lab as a deployment or convert it into a Containerlab template.`})]}),(0,P.jsxs)(V,{className:`flex flex-wrap items-center justify-between gap-3`,children:[(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Select an EVE-NG lab and import it into Skyforge without rebuilding the topology.`}),(0,P.jsxs)(F,{type:`button`,variant:`outline`,onClick:()=>p(!0),children:[(0,P.jsx)(Ae,{className:`mr-2 h-4 w-4`}),`Import EVE-NG lab`]})]})]}),(0,P.jsx)(L,{children:(0,P.jsx)(V,{className:`pt-6`,children:(0,P.jsx)(qu,{...w,children:(0,P.jsxs)(`form`,{onSubmit:w.handleSubmit(A),className:`space-y-8`,children:[(0,P.jsxs)(`div`,{className:`grid gap-6 md:grid-cols-2`,children:[(0,P.jsx)(Yu,{control:w.control,name:`kind`,render:({field:e})=>(0,P.jsxs)(Qu,{children:[(0,P.jsx)($u,{children:`Provider`}),(0,P.jsxs)(q,{onValueChange:t=>{e.onChange(t),w.setValue(`template`,``)},defaultValue:e.value,children:[(0,P.jsx)(ed,{children:(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select provider`})})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`netlab-c9s`,children:`Netlab`}),Fe&&(0,P.jsx)(Z,{value:`netlab`,children:`Netlab (BYOS)`}),Le&&(0,P.jsx)(Z,{value:`eve_ng`,children:`EVE-NG`}),Ie&&(0,P.jsx)(Z,{value:`containerlab`,children:`Containerlab (BYOS)`}),(0,P.jsx)(Z,{value:`clabernetes`,children:`Containerlab`}),(0,P.jsx)(Z,{value:`terraform`,children:`Terraform`})]})]}),(0,P.jsx)(nd,{})]})}),[`netlab-c9s`,`clabernetes`,`terraform`].includes(O)&&(0,P.jsx)(Yu,{control:w.control,name:`forwardCollectorId`,render:({field:e})=>(0,P.jsxs)(Qu,{className:`rounded-md border p-3 md:col-span-2 space-y-2`,children:[(0,P.jsx)($u,{children:`Forward collector`}),(0,P.jsxs)(td,{children:[`Optional. Select a per-user in-cluster Collector. Configure collectors under`,` `,(0,P.jsx)(`code`,{className:`font-mono`,children:`Dashboard  Forward`}),`.`]}),ge.isError?(0,P.jsx)(`div`,{className:`text-xs text-destructive`,children:`Failed to load collectors.`}):null,ge.data&&_e.length===0?(0,P.jsx)(`div`,{className:`text-xs text-destructive`,children:`No collectors configured yet.`}):null,(0,P.jsxs)(q,{value:String(e.value??`none`),onValueChange:t=>e.onChange(t),disabled:ge.isLoading,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select a collector (or None)`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`none`,children:`None`}),_e.map(e=>(0,P.jsx)(Z,{value:String(e.id),children:String(e.name)},String(e.id)))]})]})]})}),(0,P.jsx)(Yu,{control:w.control,name:`source`,render:({field:e})=>(0,P.jsxs)(Qu,{children:[(0,P.jsxs)($u,{className:`flex items-center gap-2`,children:[`Template source`,(0,P.jsx)(rd,{children:(0,P.jsxs)(id,{children:[(0,P.jsx)(ad,{asChild:!0,children:(0,P.jsx)(Xt,{className:`h-4 w-4 text-muted-foreground`})}),(0,P.jsx)(od,{children:(0,P.jsx)(`p`,{children:`Git repository or URL containing deployment templates`})})]})})]}),(0,P.jsxs)(q,{onValueChange:t=>{e.onChange(t),w.setValue(`templateRepoId`,``),w.setValue(`templateRepo`,``),w.setValue(`template`,``)},defaultValue:e.value,children:[(0,P.jsx)(ed,{children:(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select source`})})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`user`,children:`User repo`}),(0,P.jsx)(Z,{value:`blueprints`,children:`Blueprints`}),(0,P.jsx)(Z,{value:`external`,disabled:!Te||O===`eve_ng`,children:`External repo (saved)`}),(0,P.jsx)(Z,{value:`custom`,disabled:O===`eve_ng`,children:`External repo (one-shot)`})]})]}),!Te&&O!==`eve_ng`&&(0,P.jsx)(td,{children:`No external repos configured in My Settings.`}),(0,P.jsx)(nd,{})]})}),ve===`external`&&(0,P.jsx)(Yu,{control:w.control,name:`templateRepoId`,render:({field:e})=>(0,P.jsxs)(Qu,{children:[(0,P.jsx)($u,{children:`External repo`}),(0,P.jsxs)(q,{onValueChange:t=>{e.onChange(t),w.setValue(`template`,``)},defaultValue:e.value,children:[(0,P.jsx)(ed,{children:(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select repo`})})}),(0,P.jsx)(X,{children:we.map(e=>(0,P.jsxs)(Z,{value:e.id,children:[e.name,` (`,e.repo,`)`]},e.id))})]}),(0,P.jsx)(nd,{})]})}),ve===`custom`&&(0,P.jsx)(Yu,{control:w.control,name:`templateRepo`,render:({field:e})=>(0,P.jsxs)(Qu,{children:[(0,P.jsx)($u,{children:`External repo (one-shot)`}),(0,P.jsx)(ed,{children:(0,P.jsx)(K,{placeholder:`owner/repo or https://gitea.example.com/owner/repo`,...e,onChange:t=>{e.onChange(t),w.setValue(`template`,``)}})}),(0,P.jsx)(td,{children:`Used only for this deployment action.`}),(0,P.jsx)(nd,{})]})}),(O===`netlab`||O===`containerlab`)&&(0,P.jsx)(Yu,{control:w.control,name:`netlabServer`,render:({field:e})=>(0,P.jsxs)(Qu,{children:[(0,P.jsx)($u,{children:`BYOS server`}),(0,P.jsxs)(q,{onValueChange:e.onChange,defaultValue:e.value||``,value:e.value||``,children:[(0,P.jsx)(ed,{children:(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select server`})})}),(0,P.jsx)(X,{children:Ve.map(e=>(0,P.jsx)(Z,{value:e.value,children:e.label},e.value))})]}),(de.isLoading||fe.isLoading)&&(0,P.jsx)(td,{children:`Loading servers`}),(0,P.jsxs)(td,{children:[`Configure servers under`,` `,(0,P.jsx)(`code`,{className:`font-mono`,children:`Dashboard  Settings`}),`.`]}),(0,P.jsx)(nd,{})]})}),O===`eve_ng`&&(0,P.jsx)(Yu,{control:w.control,name:`eveServer`,render:({field:e})=>(0,P.jsxs)(Qu,{children:[(0,P.jsx)($u,{children:`EVE-NG server`}),(0,P.jsxs)(q,{onValueChange:e.onChange,defaultValue:e.value||``,value:e.value||``,children:[(0,P.jsx)(ed,{children:(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select server`})})}),(0,P.jsx)(X,{children:Ne.map(e=>(0,P.jsx)(Z,{value:`user:${e.id}`,children:pd(e.apiUrl)||e.name},e.id))})]}),pe.isLoading&&(0,P.jsx)(td,{children:`Loading servers`}),(0,P.jsxs)(td,{children:[`Configure servers under`,` `,(0,P.jsx)(`code`,{className:`font-mono`,children:`Dashboard  Settings`}),`.`]}),(0,P.jsx)(nd,{})]})}),(0,P.jsx)(Yu,{control:w.control,name:`template`,render:({field:e})=>(0,P.jsxs)(Qu,{children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,P.jsx)($u,{children:`Template`}),(O===`netlab`||O===`netlab-c9s`||O===`containerlab`||O===`clabernetes`)&&(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(F,{type:`button`,variant:`outline`,size:`sm`,disabled:!k,onClick:()=>o(!0),children:`View`}),O===`netlab`||O===`netlab-c9s`?(0,P.jsx)(F,{type:`button`,variant:`outline`,size:`sm`,disabled:!k||ke.isPending,onClick:()=>ke.mutate(),children:ke.isPending?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(xt,{className:`mr-2 h-3 w-3 animate-spin`}),` `,`Validating`]}):`Validate`}):null]})]}),O===`terraform`?(0,P.jsxs)(`div`,{className:`grid gap-2 rounded-md border p-3`,children:[(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Terraform templates are grouped by provider (folder name). Select a provider to filter the template list.`}),(0,P.jsxs)(q,{value:u,onValueChange:e=>d(e),disabled:be.isLoading||Se.length===0&&xe.length===0,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Provider filter`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`all`,children:`All providers`}),Se.map(e=>(0,P.jsx)(Z,{value:e,children:e},e)),(0,P.jsx)(Z,{value:`ibm`,disabled:!0,children:`ibm (coming soon)`})]})]})]}):null,(0,P.jsxs)(q,{onValueChange:e.onChange,defaultValue:e.value,disabled:be.isLoading||xe.length===0,children:[(0,P.jsx)(ed,{children:(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:be.isLoading?`Loading`:xe.length?`Select template`:`No templates`})})}),(0,P.jsx)(X,{children:xe.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))})]}),be.isError&&(0,P.jsx)(`div`,{className:`text-xs text-destructive`,children:`Failed to load templates.`}),(0,P.jsx)(nd,{})]})}),(0,P.jsx)(Yu,{control:w.control,name:`name`,render:({field:e})=>(0,P.jsxs)(Qu,{children:[(0,P.jsx)($u,{children:`Deployment name`}),(0,P.jsx)(ed,{children:(0,P.jsx)(K,{placeholder:`My Deployment`,...e})}),(0,P.jsx)(td,{children:`Custom name for this specific deployment instance.`}),(0,P.jsx)(nd,{})]})})]}),(0,P.jsxs)(`div`,{className:`rounded-md border p-4 space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsx)($u,{children:`Environment Variables`}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(O===`netlab-c9s`||O===`netlab`)&&(0,P.jsx)(F,{type:`button`,variant:`outline`,size:`sm`,onClick:()=>l(!0),children:`Supported NETLAB_ vars`}),(0,P.jsxs)(F,{type:`button`,variant:`outline`,size:`sm`,onClick:()=>ae({key:``,value:``}),children:[(0,P.jsx)(Et,{className:`mr-2 h-3 w-3`}),` Add Variable`]})]})]}),(0,P.jsx)(`div`,{className:`grid gap-6 md:grid-cols-2`,children:(0,P.jsx)(Yu,{control:w.control,name:`variableGroupId`,render:({field:e})=>(0,P.jsxs)(Qu,{children:[(0,P.jsx)($u,{className:`text-xs text-muted-foreground`,children:`Variable Group`}),(0,P.jsxs)(q,{onValueChange:e.onChange,defaultValue:e.value||`none`,value:e.value||`none`,children:[(0,P.jsx)(ed,{children:(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`None`})})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`none`,children:`None`}),Pe.map(e=>(0,P.jsx)(Z,{value:String(e.id),children:e.name},e.id))]})]})]})})}),ie.length>0&&(0,P.jsx)(`div`,{className:`space-y-2`,children:ie.map((e,t)=>(0,P.jsxs)(`div`,{className:`flex gap-2 items-start`,children:[O===`netlab-c9s`||O===`netlab`?(0,P.jsx)(Yu,{control:w.control,name:`env.${t}.key`,render:({field:e})=>{let t=String(e.value??``).trim(),n=sd.some(e=>e.key===t)?t:`__custom__`;return(0,P.jsxs)(Qu,{className:`flex-1 space-y-2`,children:[(0,P.jsx)(ed,{children:(0,P.jsxs)(q,{value:n,onValueChange:t=>{t===`__custom__`?e.onChange(``):e.onChange(t)},children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select env var`})}),(0,P.jsxs)(X,{children:[sd.map(e=>(0,P.jsx)(Z,{value:e.key,children:e.label},e.key)),(0,P.jsx)(Z,{value:`__custom__`,children:`Custom`})]})]})}),n===`__custom__`&&(0,P.jsx)(ed,{children:(0,P.jsx)(K,{...e,placeholder:`KEY`,className:`font-mono text-xs`})}),(0,P.jsx)(nd,{})]})}}):(0,P.jsx)(Yu,{control:w.control,name:`env.${t}.key`,render:({field:e})=>(0,P.jsxs)(Qu,{className:`flex-1`,children:[(0,P.jsx)(ed,{children:(0,P.jsx)(K,{...e,placeholder:`KEY`,className:`font-mono text-xs`})}),(0,P.jsx)(nd,{})]})}),(0,P.jsx)(Yu,{control:w.control,name:`env.${t}.value`,render:({field:e})=>(0,P.jsxs)(Qu,{className:`flex-1`,children:[(0,P.jsx)(ed,{children:(()=>{let n=String(w.getValues(`env.${t}.key`)??``).trim();if(ld(n))return(0,P.jsx)(Cc,{...e,placeholder:`One \`key=value\` per line.
Example:
addressing.p2p.ipv4=198.18.0.0/16`,className:`font-mono text-xs min-h-[120px]`});let r=ud(n);if(!r)return(0,P.jsx)(K,{...e,placeholder:`VALUE`,className:`font-mono text-xs`});let i=String(e.value??``).trim(),a=r.some(e=>e.value===i),o=i?a?i:`__custom__`:`none`;return(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsxs)(q,{value:o,onValueChange:t=>{t===`none`?e.onChange(``):t===`__custom__`?e.onChange(i&&!a?i:``):e.onChange(t)},children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select value`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`none`,children:`None`}),r.map(e=>(0,P.jsx)(Z,{value:e.value,children:e.label},e.value)),(0,P.jsx)(Z,{value:`__custom__`,children:`Custom`})]})]}),o===`__custom__`&&(0,P.jsx)(K,{...e,placeholder:`VALUE`,className:`font-mono text-xs`})]})})()}),(0,P.jsx)(nd,{})]})}),(0,P.jsx)(F,{type:`button`,variant:`ghost`,size:`icon`,onClick:()=>E(t),className:`shrink-0`,children:(0,P.jsx)(Rn,{className:`h-4 w-4 text-muted-foreground`})})]},e.id))})]}),(0,P.jsx)(Zn,{open:s,onOpenChange:l,children:(0,P.jsxs)(er,{className:`max-w-2xl`,children:[(0,P.jsxs)(tr,{children:[(0,P.jsx)(rr,{children:`Supported Netlab overrides`}),(0,P.jsxs)(ir,{children:[`These variables are passed into the Netlab generator. Use`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:`NETLAB_*`}),` for native Netlab defaults, and`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:`SKYFORGE_NETLAB_SET_OVERRIDES`}),` `,`for generator-only`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:`netlab --set`}),` overrides.`]})]}),(0,P.jsx)(`div`,{className:`space-y-2 text-sm`,children:sd.map(e=>(0,P.jsx)(`div`,{className:`flex items-start justify-between gap-3 rounded-md border p-3`,children:(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsx)(`div`,{className:`font-medium`,children:e.label}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono break-all`,children:e.key})]})},e.key))})]})}),Ee.isError&&(0,P.jsx)(`div`,{className:`rounded-md bg-destructive/15 p-3 text-sm text-destructive border border-destructive/20`,children:Ee.error?.message||`Create failed.`}),(0,P.jsxs)(`div`,{className:`flex gap-3`,children:[(0,P.jsxs)(F,{type:`submit`,disabled:Ee.isPending,children:[Ee.isPending&&(0,P.jsx)(xt,{className:`mr-2 h-4 w-4 animate-spin`}),Ee.isPending?`Creating`:`Create Deployment`]}),(0,P.jsx)(F,{type:`button`,variant:`secondary`,onClick:()=>e({to:`/dashboard/deployments`}),disabled:Ee.isPending,children:`Back`})]})]})})})}),(0,P.jsx)(Zn,{open:f,onOpenChange:p,children:(0,P.jsxs)(er,{className:`max-w-2xl`,children:[(0,P.jsxs)(tr,{children:[(0,P.jsx)(rr,{children:`Import EVE-NG lab`}),(0,P.jsx)(ir,{children:`Pull an existing EVE-NG lab into Skyforge or convert it into a Containerlab template.`})]}),(0,P.jsxs)(`div`,{className:`grid gap-4`,children:[(0,P.jsxs)(`div`,{className:`grid gap-2`,children:[(0,P.jsx)($u,{children:`EVE-NG server`}),(0,P.jsxs)(q,{value:m,onValueChange:h,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select EVE-NG server`})}),(0,P.jsx)(X,{children:Ne.map(e=>(0,P.jsx)(Z,{value:`user:${e.id}`,children:pd(e.apiUrl)||e.name},e.id))})]}),(0,P.jsx)(td,{children:`Configure EVE-NG servers in Settings if none appear.`})]}),(0,P.jsxs)(`div`,{className:`grid gap-2`,children:[(0,P.jsx)($u,{children:`EVE-NG lab`}),(0,P.jsxs)(q,{value:g,onValueChange:_,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select lab`})}),(0,P.jsxs)(X,{children:[me.isLoading&&(0,P.jsx)(`div`,{className:`px-3 py-2 text-xs text-muted-foreground`,children:`Loading labs`}),!me.isLoading&&Be.length===0&&(0,P.jsx)(`div`,{className:`px-3 py-2 text-xs text-muted-foreground`,children:`No labs found.`}),Be.map(e=>(0,P.jsx)(Z,{value:e.value,children:e.label},e.value))]})]}),me.isError&&(0,P.jsx)(`div`,{className:`text-xs text-destructive`,children:`Failed to load labs.`})]}),(0,P.jsxs)(`div`,{className:`grid gap-2`,children:[(0,P.jsx)($u,{children:`Deployment name`}),(0,P.jsx)(K,{value:v,onChange:e=>y(e.target.value),placeholder:`Optional override`}),(0,P.jsx)(td,{children:`Defaults to the EVE-NG lab name if left empty.`})]}),(0,P.jsxs)(`div`,{className:`flex items-start justify-between gap-3 rounded-md border p-3`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)($u,{className:`text-sm`,children:`Create Containerlab deployment`}),(0,P.jsx)(td,{children:`Generate a Containerlab template and optionally create a deployment.`})]}),(0,P.jsx)(nc,{checked:b,onCheckedChange:ee})]}),b&&(0,P.jsxs)(`div`,{className:`grid gap-2`,children:[(0,P.jsx)($u,{children:`Containerlab server`}),(0,P.jsxs)(q,{value:te,onValueChange:x,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:`Select Containerlab server`})}),(0,P.jsx)(X,{children:ze.map(e=>(0,P.jsx)(Z,{value:e.value,children:e.label},e.value))})]}),(0,P.jsx)(td,{children:`Required to create a Containerlab deployment.`})]})]}),(0,P.jsxs)(`div`,{className:`flex flex-wrap justify-end gap-2 pt-2`,children:[(0,P.jsx)(F,{type:`button`,variant:`outline`,onClick:()=>p(!1),children:`Cancel`}),(0,P.jsxs)(F,{type:`button`,variant:`secondary`,onClick:()=>De.mutate(),disabled:De.isPending||Oe.isPending,children:[De.isPending&&(0,P.jsx)(xt,{className:`mr-2 h-4 w-4 animate-spin`}),`Import EVE-NG`]}),(0,P.jsxs)(F,{type:`button`,onClick:()=>Oe.mutate(),disabled:De.isPending||Oe.isPending,children:[Oe.isPending&&(0,P.jsx)(xt,{className:`mr-2 h-4 w-4 animate-spin`}),`Convert to Containerlab`]})]})]})}),(0,P.jsx)(Zn,{open:a,onOpenChange:o,children:(0,P.jsxs)(er,{className:`max-w-4xl`,children:[(0,P.jsxs)(tr,{children:[(0,P.jsx)(rr,{children:`Template`}),(0,P.jsx)(ir,{className:`font-mono text-xs truncate`,children:String(Ce.data?.path??k)})]}),(0,P.jsxs)(`div`,{className:`space-y-2`,children:[Ce.isError&&(0,P.jsx)(`div`,{className:`text-sm text-destructive`,children:`Failed to load template.`}),(0,P.jsx)(Cc,{readOnly:!0,value:String(Ce.data?.yaml??``),className:`h-[60vh] font-mono text-xs`,placeholder:Ce.isLoading?`Loading`:`No template loaded.`})]})]})})]})}const hd=t(`/dashboard/deployments/$deploymentId/`)({component:gd,validateSearch:e=>{let t={};return typeof e.action==`string`&&e.action.trim()&&(t.action=e.action.trim()),typeof e.node==`string`&&e.node.trim()&&(t.node=e.node.trim()),t}});function gd(){let{deploymentId:e}=hd.useParams(),{action:t,node:a}=hd.useSearch(),o=n(),s=c();qc(!0);let[l,u]=(0,M.useState)(!1),[d,f]=(0,M.useState)(!1),[m,h]=(0,M.useState)(``),g=i({queryKey:H.dashboardSnapshot(),queryFn:async()=>null,initialData:null,retry:!1,staleTime:1/0}),_=(0,M.useMemo)(()=>(g.data?.deployments??[]).find(t=>t.id===e),[g.data?.deployments,e]),v=String(_?.type??``);(0,M.useEffect)(()=>{let e=!!(_?.config??{}).forwardEnabled,t=String((_?.config??{}).forwardCollectorId??``).trim();f(e),h(t)},[_?.id,_?.config]);let y=String(_?.activeTaskId??``);al(y,!!y);let b=i({queryKey:H.runLogs(y),queryFn:async()=>({cursor:0,entries:[]}),retry:!1,staleTime:1/0,enabled:!!y}),ee=async()=>{try{if(!_)throw Error(`deployment not found`);await Va(_.id),j.success(`Deployment starting`,{description:`${_.name} is queued to start.`})}catch(e){j.error(`Failed to start`,{description:e.message})}},te=async()=>{try{if(!_)throw Error(`deployment not found`);await Ha(_.id),j.success(`Deployment stopping`,{description:`${_.name} is queued to stop.`})}catch(e){j.error(`Failed to stop`,{description:e.message})}},S=async()=>{try{if(!_)throw Error(`deployment not found`);await Ua(_.id),j.success(`Deployment deleted`),await s.invalidateQueries({queryKey:H.dashboardSnapshot()}),o({to:`/dashboard/deployments`})}catch(e){j.error(`Failed to delete`,{description:e.message})}},C=_?.activeTaskStatus??_?.lastStatus??`unknown`,w=!!_?.activeTaskId,ne=(0,M.useMemo)(()=>_?(g.data?.runs??[]).filter(e=>String(e.deploymentId??``)===_.id):[],[_,g.data?.runs]),T=i({queryKey:H.deploymentTopology(e),queryFn:async()=>{if(!_)throw Error(`deployment not found`);return sa(_.id)},enabled:!!_&&[`containerlab`,`netlab-c9s`,`clabernetes`].includes(v),retry:!1,staleTime:1e4}),re=r({mutationFn:async e=>{if(!_)throw Error(`deployment not found`);return Ji(_.id,e)},onSuccess:(e,t)=>{if(e?.skipped){j.message(`Save config skipped`,{description:e.message||`Node ${t}`});return}j.success(`Save config queued/applied`,{description:e.stdout||`Node ${t}`})},onError:e=>j.error(`Save config failed`,{description:e.message})}),ie=async()=>{if(!_)return;let e=T.data?.nodes??[];if(!e.length){j.message(`No nodes to save`);return}if(re.isPending)return;j.message(`Saving configs`,{description:`Nodes: ${e.length}`});let t=e.map(e=>String(e.id)),n=0,r=0,i=0,a=0;if(await Promise.all(Array.from({length:Math.min(3,t.length)},async()=>{for(;n<t.length;){let e=t[n++];try{(await Ji(_.id,e))?.skipped?i++:r++}catch{a++}}})),a){j.error(`Save configs finished with errors`,{description:`ok=${r} skipped=${i} failed=${a}`});return}j.success(`Save configs finished`,{description:`ok=${r} skipped=${i}`})},E=()=>{try{if(!_){j.error(`Cannot download config`,{description:`Deployment not found.`});return}let e=new Blob([JSON.stringify(_.config??{},null,2)],{type:`application/json`}),t=document.createElement(`a`),n=String(_.name??`deployment`).replace(/[^a-zA-Z0-9._-]+/g,`_`);t.href=URL.createObjectURL(e),t.download=`${n}.config.json`,document.body.appendChild(t),t.click(),t.remove(),setTimeout(()=>URL.revokeObjectURL(t.href),5e3),j.success(`Downloaded config`)}catch(e){j.error(`Failed to download config`,{description:e.message})}},D=i({queryKey:H.userForwardCollectorConfigs(),queryFn:ua,enabled:d,retry:!1,staleTime:3e4}),O=D.data?.collectors??[],oe=r({mutationFn:async e=>{if(!_)throw Error(`deployment not found`);return ji(_.id,e)},onSuccess:async()=>{j.success(`Forward settings updated`),await s.invalidateQueries({queryKey:H.dashboardSnapshot()})},onError:e=>j.error(`Failed to update Forward settings`,{description:e.message})}),se=r({mutationFn:async()=>{if(!_)throw Error(`deployment not found`);return Mi(_.id)},onSuccess:async e=>{j.success(`Forward sync queued`,{description:`Run ${String(e.run?.id??``)}`}),await s.invalidateQueries({queryKey:H.dashboardSnapshot()})},onError:e=>j.error(`Failed to sync to Forward`,{description:e.message})});if(t&&a&&_){if(t===`terminal`)return(0,P.jsx)(`div`,{className:`h-screen w-screen bg-zinc-950 flex flex-col`,children:(0,P.jsx)(gl,{deploymentId:e,nodeId:a,className:`flex-1`})});if(t===`logs`)return(0,P.jsx)(`div`,{className:`h-screen w-screen bg-background flex flex-col`,children:(0,P.jsx)(fl,{deploymentId:e,nodeId:a,className:`flex-1`})});if(t===`describe`)return(0,P.jsx)(`div`,{className:`h-screen w-screen bg-background flex flex-col`,children:(0,P.jsx)(ul,{deploymentId:e,nodeId:a,className:`flex-1`})})}return _?(0,P.jsxs)(`div`,{className:`space-y-6 p-6 pb-20`,children:[(0,P.jsxs)(`div`,{className:`flex flex-col gap-4 md:flex-row md:items-center md:justify-between`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,P.jsx)(p,{to:`/dashboard/deployments`,className:yr({variant:`outline`,size:`icon`,className:`h-9 w-9`}),children:(0,P.jsx)(ot,{className:`h-4 w-4`})}),(0,P.jsxs)(`div`,{children:[(0,P.jsxs)(`h1`,{className:`text-2xl font-bold tracking-tight flex items-center gap-3`,children:[_.name,(0,P.jsx)(_d,{status:C})]}),(0,P.jsxs)(`p`,{className:`text-sm text-muted-foreground flex items-center gap-2 mt-1`,children:[(0,P.jsx)(`span`,{className:`font-mono text-xs bg-muted px-1.5 py-0.5 rounded`,children:_.id}),(0,P.jsx)(`span`,{children:``}),(0,P.jsx)(`span`,{className:`capitalize`,children:_.type})]})]})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(p,{to:`/dashboard/deployments/$deploymentId/capacity`,params:{deploymentId:e},className:yr({variant:`outline`,size:`sm`}),title:`Capacity rollups and forecasting`,children:[(0,P.jsx)(Ce,{className:`mr-2 h-4 w-4`}),` Capacity`]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:ee,disabled:w,children:[(0,P.jsx)(vn,{className:`mr-2 h-4 w-4`}),` Start`]}),(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:te,disabled:w,children:[(0,P.jsx)(Se,{className:`mr-2 h-4 w-4`}),` Stop`]}),(0,P.jsxs)(F,{variant:`destructive`,size:`sm`,onClick:()=>u(!0),disabled:w,children:[(0,P.jsx)(Rn,{className:`mr-2 h-4 w-4`}),` Delete`]})]})]}),(0,P.jsxs)(lc,{defaultValue:`topology`,className:`space-y-6`,children:[(0,P.jsxs)(uc,{children:[(0,P.jsxs)(dc,{value:`topology`,className:`gap-2`,children:[(0,P.jsx)(Rt,{className:`h-4 w-4`}),` Topology`]}),(0,P.jsxs)(dc,{value:`logs`,className:`gap-2`,children:[(0,P.jsx)(x,{className:`h-4 w-4`}),` Logs & Events`]}),(0,P.jsxs)(dc,{value:`config`,className:`gap-2`,children:[(0,P.jsx)(On,{className:`h-4 w-4`}),` Configuration`]})]}),(0,P.jsxs)(fc,{value:`topology`,className:`space-y-6 animate-in fade-in-50`,children:[(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{className:`pb-3`,children:(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(z,{children:`Network Topology`}),(0,P.jsx)(B,{children:_.type===`containerlab`?`Derived from containerlab after deploy (includes resolved mgmt IPs).`:_.type===`netlab-c9s`||_.type===`clabernetes`?`Derived from clabernetes after deploy (includes resolved mgmt IPs).`:`Topology is provider-dependent; not yet implemented for this deployment type.`})]}),(0,P.jsx)(`div`,{className:`flex items-center gap-2`,children:(0,P.jsxs)(F,{variant:`outline`,size:`sm`,onClick:()=>{let e=window.location.pathname,t=e.endsWith(`/`)?e.slice(0,-1):e;window.open(`${t}/map`,`_blank`,`noopener,noreferrer`)},title:`Open the full-screen map view in a new tab`,children:[(0,P.jsx)(ae,{className:`mr-2 h-4 w-4`}),`Open map`]})})]})}),(0,P.jsx)(V,{children:(0,P.jsx)(xl,{topology:T.data,deploymentId:_.id,enableTerminal:[`netlab-c9s`,`clabernetes`].includes(_.type)})})]}),T.data?.nodes?.length?(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{className:`pb-3`,children:(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(z,{children:`Nodes`}),(0,P.jsx)(B,{children:`Quick actions (opens in a new tab where applicable).`})]}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,disabled:re.isPending,onClick:ie,children:re.isPending?`Saving`:`Save all configs`})]})}),(0,P.jsx)(V,{children:(0,P.jsx)(`div`,{className:`space-y-2`,children:T.data.nodes.map(e=>{let t=String(e.id),n=String(e.kind??``),r=String(e.mgmtIp??``),i=String(e.status??``),a=`${window.location.pathname}?node=${encodeURIComponent(t)}`;return(0,P.jsxs)(`div`,{className:`flex flex-col gap-2 rounded-md border p-3 md:flex-row md:items-center md:justify-between`,children:[(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:t}),i?(0,P.jsx)(W,{variant:`secondary`,className:`capitalize`,children:i}):null,n?(0,P.jsx)(`span`,{className:`text-xs text-muted-foreground truncate`,children:n}):null]}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate mt-1`,children:r||``})]}),(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,P.jsx)(F,{size:`sm`,variant:`outline`,disabled:![`netlab-c9s`,`clabernetes`].includes(_.type),onClick:()=>window.open(`${a}&action=terminal`,`_blank`,`noopener,noreferrer`),children:`Terminal`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,onClick:()=>window.open(`${a}&action=logs`,`_blank`,`noopener,noreferrer`),children:`Logs`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,onClick:()=>window.open(`${a}&action=describe`,`_blank`,`noopener,noreferrer`),children:`Describe`}),(0,P.jsx)(F,{size:`sm`,variant:`outline`,disabled:re.isPending,onClick:()=>re.mutate(t),children:re.isPending?`Saving`:`Save config`}),(0,P.jsx)(F,{size:`sm`,variant:`ghost`,onClick:()=>{if(!r.trim()){j.error(`No management IP available`);return}navigator.clipboard?.writeText(r),j.success(`Copied management IP`)},children:`Copy IP`})]})]},t)})})})]}):null]}),(0,P.jsx)(fc,{value:`logs`,className:`space-y-6 animate-in fade-in-50`,children:(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Logs & Events`}),(0,P.jsx)(B,{children:`Live task output.`})]}),(0,P.jsxs)(V,{children:[_.activeTaskId?(0,P.jsxs)(`div`,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsxs)(`div`,{className:`text-sm font-medium`,children:[`Active run: `,String(_.activeTaskId)]}),(0,P.jsx)(p,{to:`/dashboard/runs/$runId`,params:{runId:String(_.activeTaskId)},className:yr({variant:`outline`,size:`sm`}),children:`Open run details`})]}),(0,P.jsx)(`div`,{className:`rounded-md border bg-zinc-950 p-4 font-mono text-xs text-zinc-100`,children:(0,P.jsx)(vd,{entries:b.data?.entries??[]})})]}):(0,P.jsxs)(`div`,{className:`flex flex-col items-center justify-center py-10 text-center text-muted-foreground border-2 border-dashed rounded-lg`,children:[(0,P.jsx)(x,{className:`h-10 w-10 mb-3 opacity-20`}),(0,P.jsx)(`p`,{children:`No active run.`}),(0,P.jsx)(`p`,{className:`text-xs mt-1`,children:`Start/stop/destroy will queue runs that appear here.`})]}),(0,P.jsxs)(`div`,{className:`mt-8 space-y-3`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Recent runs`}),(0,P.jsx)(`div`,{className:`space-y-2`,children:ne.length===0?(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`No runs yet.`}):ne.slice(0,10).map(e=>{let t=String(e.id??``);return(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3 rounded-md border p-3`,children:[(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:t}),(0,P.jsx)(W,{variant:`secondary`,className:`capitalize`,children:String(e.status??``)}),(0,P.jsx)(`span`,{className:`text-xs text-muted-foreground truncate`,children:String(e.tpl_alias??e.type??``)})]}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground truncate mt-1`,children:String(e.status_text??e.message??``)})]}),(0,P.jsx)(p,{to:`/dashboard/runs/$runId`,params:{runId:t},className:yr({variant:`outline`,size:`sm`}),children:`View`})]},t)})})]})]})]})}),(0,P.jsxs)(fc,{value:`config`,className:`space-y-6 animate-in fade-in-50`,children:[(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{children:[(0,P.jsx)(z,{children:`Forward Networks`}),(0,P.jsx)(B,{children:`Optional: sync device IPs into Forward for collection.`})]}),(0,P.jsxs)(V,{className:`space-y-4`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Enable Forward collection`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Requires configuring your Collector first.`})]}),(0,P.jsx)(nc,{checked:d,disabled:oe.isPending,onCheckedChange:e=>{f(e);let t=e?m.trim():``;oe.mutate({enabled:e,collectorConfigId:t||void 0})}})]}),d?(0,P.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(`div`,{className:`text-sm font-medium`,children:`Collector`}),(0,P.jsxs)(q,{value:m,onValueChange:e=>{h(e),oe.mutate({enabled:!0,collectorConfigId:e})},disabled:D.isLoading||D.isError||oe.isPending,children:[(0,P.jsx)(Y,{children:(0,P.jsx)(J,{placeholder:D.isLoading?`Loading`:D.isError?`Configure Collector first`:`Select collector`})}),(0,P.jsx)(X,{children:O.map(e=>(0,P.jsx)(Z,{value:e.id,children:e.name},e.id))})]})]}),(0,P.jsx)(`div`,{className:`flex items-end gap-2`,children:(0,P.jsx)(F,{variant:`outline`,onClick:()=>se.mutate(),disabled:!m.trim()||se.isPending||oe.isPending,children:se.isPending?`Queueing`:`Sync now`})})]}):null]})]}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,P.jsxs)(`div`,{children:[(0,P.jsx)(z,{children:`Configuration`}),(0,P.jsx)(B,{children:`Read-only view of the deployment parameters.`})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(F,{size:`sm`,variant:`outline`,onClick:()=>{navigator.clipboard?.writeText(JSON.stringify(_.config??{},null,2)),j.success(`Copied config JSON`)},children:[(0,P.jsx)(Oe,{className:`mr-2 h-4 w-4`}),`Copy`]}),(0,P.jsxs)(F,{size:`sm`,variant:`outline`,onClick:E,children:[(0,P.jsx)(Ae,{className:`mr-2 h-4 w-4`}),`Download`]})]})]})}),(0,P.jsx)(V,{children:(0,P.jsx)(`pre`,{className:`bg-muted p-4 rounded-lg overflow-auto font-mono text-xs max-h-[500px]`,children:JSON.stringify(_.config,null,2)})})]})]})]}),(0,P.jsx)(Ws,{open:l,onOpenChange:u,children:(0,P.jsxs)(qs,{children:[(0,P.jsxs)(Js,{children:[(0,P.jsx)(Xs,{children:`Delete deployment?`}),(0,P.jsxs)(Zs,{children:[`This will remove `,(0,P.jsx)(`strong`,{children:_.name}),` from Skyforge and trigger provider cleanup. This action cannot be undone.`]})]}),(0,P.jsxs)(Ys,{children:[(0,P.jsx)($s,{children:`Cancel`}),(0,P.jsx)(Qs,{onClick:S,className:yr({variant:`destructive`}),children:`Delete Deployment`})]})]})})]}):g.isLoading||g.isFetching?(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,P.jsx)(U,{className:`h-10 w-32`}),(0,P.jsx)(U,{className:`h-10 w-48`})]}),(0,P.jsx)(U,{className:`h-[400px] w-full`})]}):(0,P.jsx)(`div`,{className:`p-6`,children:(0,P.jsx)(Cs,{icon:ye,title:`Deployment not found`,description:`This deployment may have been deleted or you don't have access.`,action:{label:`Back to Deployments`,onClick:()=>o({to:`/dashboard/deployments`})}})})}function _d({status:e}){let t=`secondary`,n=e.toLowerCase();return[`running`,`active`,`healthy`,`succeeded`,`success`].includes(n)&&(t=`default`),[`failed`,`error`,`stopped`,`crashloopbackoff`].includes(n)&&(t=`destructive`),(0,P.jsx)(W,{variant:t,className:`capitalize`,children:e})}function vd(e){let t=(0,M.useRef)(null);return(0,M.useEffect)(()=>{let e=t.current;e&&(e.scrollTop=e.scrollHeight)},[e.entries.length]),e.entries.length===0?(0,P.jsx)(`div`,{className:`text-zinc-500`,children:`Waiting for output`}):(0,P.jsx)(`div`,{ref:t,className:`max-h-[65vh] overflow-auto whitespace-pre-wrap`,children:e.entries.map((e,t)=>(0,P.jsxs)(`div`,{children:[(0,P.jsx)(`span`,{className:`text-zinc-500 select-none`,children:e.time?`${e.time} `:``}),(0,P.jsx)(`span`,{children:e.output})]},`${e.time}-${t}`))})}const yd=t(`/dashboard/deployments/$deploymentId/map`)({component:bd});function bd(){let{deploymentId:e}=yd.useParams();qc(!0);let t=i({queryKey:H.dashboardSnapshot(),queryFn:async()=>null,initialData:null,retry:!1,staleTime:1/0}),n=(0,M.useMemo)(()=>(t.data?.deployments??[]).find(t=>t.id===e),[e,t.data?.deployments]),r=String(n?.type??``),a=n?.activeTaskStatus??n?.lastStatus??`unknown`,o=i({queryKey:H.deploymentTopology(e),queryFn:async()=>{if(!n)throw Error(`deployment not found`);return sa(n.id)},enabled:!!n&&[`containerlab`,`netlab-c9s`,`clabernetes`].includes(r),retry:!1,staleTime:1e4});return n?(0,P.jsxs)(`div`,{className:`h-screen w-screen flex flex-col bg-background`,children:[(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3 border-b px-4 py-3`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-3 min-w-0`,children:[(0,P.jsx)(p,{to:`/dashboard/deployments/$deploymentId`,params:{deploymentId:e},className:yr({variant:`outline`,size:`icon`,className:`h-9 w-9`}),title:`Back to deployment`,children:(0,P.jsx)(ot,{className:`h-4 w-4`})}),(0,P.jsxs)(`div`,{className:`min-w-0`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-2 min-w-0`,children:[(0,P.jsx)(`div`,{className:`font-semibold truncate`,children:n.name}),(0,P.jsx)(W,{variant:`secondary`,className:`capitalize`,children:a}),(0,P.jsx)(W,{variant:`outline`,className:`capitalize`,children:r||`unknown`})]}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:n.id})]})]}),(0,P.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,P.jsxs)(`a`,{href:`/dashboard/labs/designer?importDeploymentId=${encodeURIComponent(e)}`,target:`_blank`,rel:`noreferrer noopener`,className:yr({variant:`outline`,size:`sm`}),title:`Open this running topology in the Lab Designer (new tab)`,children:[(0,P.jsx)(Mt,{className:`mr-2 h-4 w-4`}),`Edit in Designer`]}),(0,P.jsxs)(p,{to:`/dashboard/deployments/$deploymentId`,params:{deploymentId:e},className:yr({variant:`outline`,size:`sm`}),title:`Open the deployment page`,children:[(0,P.jsx)(ae,{className:`mr-2 h-4 w-4`}),`Details`]})]})]}),(0,P.jsx)(`div`,{className:`flex-1 min-h-0 p-3`,children:(0,P.jsx)(`div`,{className:`h-full`,children:(0,P.jsx)(xl,{topology:o.data,deploymentId:n.id,enableTerminal:[`netlab-c9s`,`clabernetes`].includes(n.type),fullHeight:!0})})})]}):t.isLoading||t.isFetching?(0,P.jsxs)(`div`,{className:`h-screen w-screen p-6`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,P.jsx)(U,{className:`h-9 w-9`}),(0,P.jsx)(U,{className:`h-8 w-64`})]}),(0,P.jsx)(`div`,{className:`mt-6`,children:(0,P.jsx)(U,{className:`h-[75vh] w-full`})})]}):(0,P.jsx)(`div`,{className:`h-screen w-screen p-6`,children:(0,P.jsx)(Cs,{title:`Deployment not found`,description:`This deployment may have been deleted or you don't have access.`,action:{label:`Back`,onClick:()=>window.close()}})})}function xd(e,t,n){return Math.max(t,Math.min(n,e))}function Sd({points:e,className:t,strokeClassName:n=`stroke-foreground`,fillClassName:r=`fill-muted/30`}){let{path:i,area:a}=(0,M.useMemo)(()=>{if(!e.length)return{path:``,area:``};let t=e.map(e=>e.y).filter(e=>Number.isFinite(e)),n=t.length?Math.min(...t):0,r=(t.length?Math.max(...t):1)-n||1,i=e.map((t,i)=>({x:e.length<=1?0:i/(e.length-1)*100,y:xd(40-(t.y-n)/r*40,0,40)})).map((e,t)=>`${t===0?`M`:`L`} ${e.x.toFixed(2)} ${e.y.toFixed(2)}`).join(` `);return{path:i,area:`${i} L 100 40 L 0 40 Z`}},[e]);return e.length?(0,P.jsxs)(`svg`,{viewBox:`0 0 100 40`,preserveAspectRatio:`none`,className:N(`h-24 w-full rounded-md border bg-background`,t),role:`img`,"aria-label":`Trend chart`,children:[(0,P.jsx)(`title`,{children:`Trend chart`}),(0,P.jsx)(`path`,{d:a,className:N(r)}),(0,P.jsx)(`path`,{d:i,className:N(`fill-none stroke-[1.25]`,n),vectorEffect:`non-scaling-stroke`})]}):(0,P.jsx)(`div`,{className:N(`flex h-24 items-center justify-center rounded-md border text-xs text-muted-foreground`,t),children:`No data`})}const Cd=t(`/dashboard/deployments/$deploymentId/capacity`)({component:Fd});function wd(e){try{return JSON.stringify(e,null,2)}catch{return String(e)}}function Td(e,t,n){let r=new Blob([n],{type:t}),i=URL.createObjectURL(r);try{let t=document.createElement(`a`);t.href=i,t.download=e,t.click()}finally{URL.revokeObjectURL(i)}}function Ed(e){let t=e==null?``:String(e);return t.includes(`"`)||t.includes(`,`)||t.includes(`
`)||t.includes(`\r`)?`"${t.replaceAll(`"`,`""`)}"`:t}function Dd(e,t){let n=[e.map(Ed).join(`,`)];for(let e of t)n.push(e.map(Ed).join(`,`));return n.join(`
`)+`
`}function Od(e){if(!e)return null;let t=Date.parse(e);return Number.isFinite(t)?new Date(t):null}function kd(e){return e===void 0||!Number.isFinite(e)?``:`${(e*100).toFixed(1)}%`}function Ad(e,t=3){return e===void 0||!Number.isFinite(e)?``:e.toFixed(t)}function jd(e){let t=Number(e??0);return!Number.isFinite(t)||t<=0?``:t>=1e5||t>=1e4?`${(t/1e3).toFixed(0)}G`:t>=1e3?`${(t/1e3).toFixed(1)}G`:`${t}M`}function Md(e,t){if(!e.length)return null;let n=[...e].filter(e=>Number.isFinite(e)).sort((e,t)=>e-t);if(!n.length)return null;if(t<=0)return n[0];if(t>=1)return n[n.length-1];let r=t*(n.length-1),i=Math.floor(r),a=Math.ceil(r);if(i===a)return n[i];let o=r-i;return n[i]*(1-o)+n[a]*o}function Nd(e){return e.startsWith(`util_`)?`UTILIZATION`:e.includes(`packet_loss`)?`PACKET_LOSS`:`ERROR`}function Pd(e){return e.includes(`memory`)?`MEMORY`:`CPU`}function Fd(){let{deploymentId:e}=Cd.useParams(),t=c(),[n,a]=(0,M.useState)(`24h`),[o,s]=(0,M.useState)(`util_ingress`),[l,u]=(0,M.useState)(`device_cpu`),[d,f]=(0,M.useState)(``),[m,h]=(0,M.useState)(``),[g,_]=(0,M.useState)(`all`),[v,y]=(0,M.useState)(`all`),[b,ee]=(0,M.useState)(`all`),[te,x]=(0,M.useState)(`all`),[S,C]=(0,M.useState)(`none`),[w,ne]=(0,M.useState)(168),[T,re]=(0,M.useState)(`util_ingress`),[ie,ae]=(0,M.useState)(`device_cpu`),[E,D]=(0,M.useState)(null),[O,oe]=(0,M.useState)(null),[se,ce]=(0,M.useState)(null),[k,le]=(0,M.useState)(!1),[ue,de]=(0,M.useState)(``),[fe,pe]=(0,M.useState)(!1),[me,he]=(0,M.useState)(``),[ge,_e]=(0,M.useState)(`all`),[ve,ye]=(0,M.useState)(`all`),[be,xe]=(0,M.useState)(!1),[Se,we]=(0,M.useState)(``),Te=i({queryKey:H.dashboardSnapshot(),queryFn:async()=>null,initialData:null,retry:!1,staleTime:1/0}),Ee=(0,M.useMemo)(()=>(Te.data?.deployments??[]).find(t=>t.id===e),[Te.data?.deployments,e]),De=String((Ee?.config??{}).forwardNetworkId??``),Oe=!!(Ee?.config??{}).forwardEnabled,ke=i({queryKey:H.deploymentCapacitySummary(e),queryFn:()=>Ni(e),enabled:!!(e&&Oe&&De),retry:!1,staleTime:3e4}),A=i({queryKey:H.deploymentCapacityInventory(e),queryFn:()=>Fi(e),enabled:!!(e&&Oe&&De),retry:!1,staleTime:3e4}),Ae=r({mutationFn:async()=>{if(!e)throw Error(`deployment not found`);return Pi(e)},onSuccess:async n=>{j.success(`Refresh queued`,{description:`Run ${String(n.run?.id??``)}`.trim()}),await t.invalidateQueries({queryKey:H.deploymentCapacitySummary(e)}),await t.invalidateQueries({queryKey:H.deploymentCapacityInventory(e)}),await t.invalidateQueries({queryKey:[`deploymentCapacityGrowth`,e]})},onError:e=>j.error(`Failed to refresh`,{description:e.message})}),je=r({mutationFn:async()=>zi(e,{}),onSuccess:e=>ce(e.body),onError:e=>j.error(`Failed to load unhealthy devices`,{description:e.message})}),Me=(0,M.useMemo)(()=>{let e=A.data?.devices??[],t=A.data?.interfaceVrfs??[],n=new Set,r=new Set,i=new Set,a=new Set;for(let t of e){for(let e of t.tagNames??[]){let t=String(e??``).trim();t&&n.add(t)}for(let e of t.groupNames??[]){let t=String(e??``).trim();t&&r.add(t)}let e=String(t.locationName??``).trim();e&&i.add(e)}for(let e of t){let t=String(e.vrf??``).trim();t&&a.add(t)}return{tags:Array.from(n).sort(),groups:Array.from(r).sort(),locations:Array.from(i).sort(),vrfs:Array.from(a).sort()}},[A.data?.devices,A.data?.interfaceVrfs]),Ne=n===`24h`?1:n===`7d`?7:30,Pe=ke.data?.rollups??[],Fe=(0,M.useMemo)(()=>{let e=d.trim().toLowerCase(),t=Pe.filter(e=>e.objectType===`interface`&&e.window===n&&e.metric===o).map(e=>{let t=e.details??{},n=String(t.deviceName??``).trim(),r=String(t.interfaceName??``).trim(),i=String(t.direction??``).trim(),a=String(t.vrf??``).trim()||void 0,o=Array.isArray(t.vrfNames)?t.vrfNames.map(e=>String(e??``).trim()).filter(Boolean):void 0,s=String(t.locationName??``).trim()||void 0,c=Array.isArray(t.tagNames)?t.tagNames.map(e=>String(e??``).trim()).filter(Boolean):void 0,l=Array.isArray(t.groupNames)?t.groupNames.map(e=>String(e??``).trim()).filter(Boolean):void 0;return{id:`${n}:${r}:${i}:${e.metric}:${e.window}`,device:n,iface:r,dir:i,vrf:a,vrfNames:o,locationName:s,tagNames:c,groupNames:l,speedMbps:t.speedMbps??null,admin:String(t.adminStatus??``).trim()||void 0,oper:String(t.operStatus??``).trim()||void 0,p95:e.p95,p99:e.p99,max:e.max,slopePerDay:e.slopePerDay,forecastCrossingTs:e.forecastCrossingTs,threshold:e.threshold,samples:e.samples,raw:e}}),r=(e?t.filter(t=>t.device.toLowerCase().includes(e)||t.iface.toLowerCase().includes(e)||(t.dir||``).toLowerCase().includes(e)):t).filter(e=>{if(b!==`all`&&(e.locationName??``)!==b)return!1;if(te!==`all`){let t=te;if(e.vrf!==t&&!(e.vrfNames??[]).includes(t))return!1}return!(g!==`all`&&!(e.tagNames??[]).includes(g)||v!==`all`&&!(e.groupNames??[]).includes(v))});return r.sort((e,t)=>(t.max??0)-(e.max??0)),r},[Pe,n,o,d,b,te,g,v]),Ie=(0,M.useMemo)(()=>{let e=m.trim().toLowerCase(),t=Pe.filter(e=>e.objectType===`device`&&e.window===n&&e.metric===l).map(e=>{let t=e.details??{},n=String(t.deviceName??``).trim(),r=String(t.locationName??``).trim()||void 0,i=Array.isArray(t.tagNames)?t.tagNames.map(e=>String(e??``).trim()).filter(Boolean):void 0,a=Array.isArray(t.groupNames)?t.groupNames.map(e=>String(e??``).trim()).filter(Boolean):void 0;return{id:`${n}:${e.metric}:${e.window}`,device:n,metric:e.metric,locationName:r,tagNames:i,groupNames:a,vendor:String(t.vendor??``).trim()||void 0,os:String(t.os??``).trim()||void 0,model:String(t.model??``).trim()||void 0,p95:e.p95,p99:e.p99,max:e.max,slopePerDay:e.slopePerDay,forecastCrossingTs:e.forecastCrossingTs,threshold:e.threshold,samples:e.samples,raw:e}}),r=(e?t.filter(t=>t.device.toLowerCase().includes(e)||(t.vendor||``).toLowerCase().includes(e)||(t.os||``).toLowerCase().includes(e)||(t.model||``).toLowerCase().includes(e)):t).filter(e=>!(b!==`all`&&(e.locationName??``)!==b||g!==`all`&&!(e.tagNames??[]).includes(g)||v!==`all`&&!(e.groupNames??[]).includes(v)));return r.sort((e,t)=>(t.max??0)-(e.max??0)),r},[Pe,n,l,m,b,g,v]),Le=(0,M.useMemo)(()=>{if(S===`none`)return[];let e=new Map,t=new Map,n=(n,r)=>{let i=e.get(n)??{group:n,count:0,hotCount:0,sumSpeedGbps:0,sumP95Gbps:0,sumMaxGbps:0,p95Count:0};i.count+=1,t.has(n)||t.set(n,new Set),t.get(n).add(r.device);let a=r.max??0,s=r.p95??void 0;if(i.maxMax=Math.max(i.maxMax??0,a),s!==void 0&&(i.maxP95=Math.max(i.maxP95??0,s),o.startsWith(`util_`))){let e=Number(r.speedMbps??0);if(e>0){let t=s*e/1e3;i.maxP95Gbps=Math.max(i.maxP95Gbps??0,t)}}if(o.startsWith(`util_`)){let e=Number(r.speedMbps??0);if(e>0&&(i.sumSpeedGbps=(i.sumSpeedGbps??0)+e/1e3,s!==void 0&&Number.isFinite(s)&&(i.sumP95Gbps=(i.sumP95Gbps??0)+s*e/1e3,i.p95Count=(i.p95Count??0)+1),r.max!==void 0&&r.max!==null&&Number.isFinite(r.max)&&(i.sumMaxGbps=(i.sumMaxGbps??0)+Number(r.max)*e/1e3)),r.forecastCrossingTs){let e=r.forecastCrossingTs;i.soonestForecast?Date.parse(e)<Date.parse(i.soonestForecast)&&(i.soonestForecast=e):i.soonestForecast=e}}o.startsWith(`util_`)&&a>=(r.threshold??.85)&&(i.hotCount+=1),e.set(n,i)};for(let e of Fe)if(S===`location`)n(e.locationName??`unknown`,e);else if(S===`tag`){let t=e.tagNames?.length?e.tagNames:[`untagged`];for(let r of t)n(r,e)}else if(S===`group`){let t=e.groupNames?.length?e.groupNames:[`ungrouped`];for(let r of t)n(r,e)}else S===`vrf`&&n(e.vrf??e.vrfNames?.[0]??`unknown`,e);let r=Array.from(e.values());if(S===`vrf`){let e=A.data?.routeScale??[],n=A.data?.bgpNeighbors??[];for(let i of r){let r=t.get(i.group)??new Set,a=0,o=0,s=0,c=0;for(let t of e)t.vrf===i.group&&r.has(t.deviceName)&&(a+=Number(t.ipv4Routes??0),o+=Number(t.ipv6Routes??0));for(let e of n)e.vrf===i.group&&r.has(e.deviceName)&&(s+=1,String(e.sessionState??``).toUpperCase().includes(`ESTABLISHED`)&&(c+=1));i.ipv4RoutesSum=a,i.ipv6RoutesSum=o,i.bgpNeighbors=s,i.bgpEstablished=c}}return r.sort((e,t)=>(t.maxP95Gbps??t.maxP95??0)-(e.maxP95Gbps??e.maxP95??0)),r},[Fe,S,o,A.data?.routeScale,A.data?.bgpNeighbors]),Re=(0,M.useMemo)(()=>{if(S===`none`)return[];let e=new Map,t=(t,n)=>{let r=e.get(t)??{group:t,count:0,hotCount:0};r.count+=1;let i=n.max??0,a=n.p95??void 0;r.maxMax=Math.max(r.maxMax??0,i),a!==void 0&&(r.maxP95=Math.max(r.maxP95??0,a)),i>=(n.threshold??.85)&&(r.hotCount+=1),e.set(t,r)};for(let e of Ie)if(S===`location`)t(e.locationName??`unknown`,e);else if(S===`tag`){let n=e.tagNames?.length?e.tagNames:[`untagged`];for(let r of n)t(r,e)}else if(S===`group`){let n=e.groupNames?.length?e.groupNames:[`ungrouped`];for(let r of n)t(r,e)}let n=Array.from(e.values());return n.sort((e,t)=>(t.maxP95??0)-(e.maxP95??0)),n},[Ie,S]),ze=(0,M.useMemo)(()=>{let e=Pe.filter(e=>e.metric.startsWith(`util_`));return{above:e.filter(e=>(e.max??0)>=.85).length,soonest:e.map(e=>({ts:e.forecastCrossingTs??``,r:e})).filter(e=>e.ts).sort((e,t)=>Date.parse(e.ts)-Date.parse(t.ts))[0]?.r}},[Pe]),Be=i({queryKey:[`capacityIfaceHistory`,e,n,o,E?.id??``],queryFn:async()=>E?(await Li(e,{type:Nd(o),days:Ne,maxSamples:400,interfaces:[{deviceName:E.device,interfaceName:E.iface,direction:E.dir}]})).body:null,enabled:!!(E&&e&&Oe&&De),retry:!1,staleTime:1e4}),Ve=i({queryKey:[`capacityDeviceHistory`,e,n,l,O?.id??``],queryFn:async()=>O?(await Ri(e,{type:Pd(l),days:Ne,maxSamples:400,devices:[O.device]})).body:null,enabled:!!(O&&e&&Oe&&De),retry:!1,staleTime:1e4}),He=(0,M.useMemo)(()=>{let e=Be.data?.metrics?.[0];return(Array.isArray(e?.data)?e.data:[]).map(e=>({x:String(e?.instant??``),y:Number(e?.value??NaN)})).filter(e=>e.x&&Number.isFinite(e.y))},[Be.data]),Ue=(0,M.useMemo)(()=>{let e=Ve.data?.metrics?.[0];return(Array.isArray(e?.data)?e.data:[]).map(e=>({x:String(e?.instant??``),y:Number(e?.value??NaN)})).filter(e=>e.x&&Number.isFinite(e.y))},[Ve.data]),We=(0,M.useMemo)(()=>{let e=He.map(e=>e.y);return{p95:Md(e,.95),p99:Md(e,.99),max:e.length?Math.max(...e):null}},[He]),Ge=(0,M.useMemo)(()=>{let e=Ue.map(e=>e.y);return{p95:Md(e,.95),p99:Md(e,.99),max:e.length?Math.max(...e):null}},[Ue]),Ke=(0,M.useMemo)(()=>[{id:`device`,header:`Device`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.device}),width:200},{id:`iface`,header:`Interface`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.iface}),width:220},{id:`dir`,header:`Dir`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.dir||``}),width:90},{id:`vrf`,header:`VRF`,cell:e=>{let t=e.vrf??e.vrfNames?.[0]??``;if(!t)return(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``});let n=(e.vrfNames??[]).length;return(0,P.jsxs)(`div`,{className:`text-xs`,children:[(0,P.jsx)(`div`,{className:`font-mono`,children:t}),n>1?(0,P.jsxs)(`div`,{className:`text-muted-foreground`,children:[n,` vrfs`]}):null]})},width:160},{id:`speed`,header:`Speed`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:jd(e.speedMbps??null)}),width:90,align:`right`},{id:`state`,header:`State`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs text-muted-foreground`,children:[e.admin,e.oper].filter(Boolean).join(` / `)||``}),width:140},{id:`p95`,header:`p95`,align:`right`,cell:e=>o.startsWith(`util_`)?kd(e.p95):Ad(e.p95),width:90},...o.startsWith(`util_`)?[{id:`p95Gbps`,header:`p95 (Gbps)`,align:`right`,cell:e=>{let t=Number(e.speedMbps??0),n=Number(e.p95??NaN);return!t||!Number.isFinite(n)?(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``}):(0,P.jsx)(`span`,{className:`text-xs`,children:(n*t/1e3).toFixed(2)})},width:110}]:[],{id:`max`,header:`Max`,align:`right`,cell:e=>{let t=o.startsWith(`util_`)?kd(e.max):Ad(e.max),n=e.threshold??(o.startsWith(`util_`)?.85:void 0);return(0,P.jsx)(`span`,{className:n!==void 0&&(e.max??0)>=n?`text-destructive font-medium`:``,children:t})},width:90},...o.startsWith(`util_`)?[{id:`maxGbps`,header:`Max (Gbps)`,align:`right`,cell:e=>{let t=Number(e.speedMbps??0),n=Number(e.max??NaN);return!t||!Number.isFinite(n)?(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``}):(0,P.jsx)(`span`,{className:`text-xs`,children:(n*t/1e3).toFixed(2)})},width:110},{id:`headroom85`,header:`Headroom@85 (Gbps)`,align:`right`,cell:e=>{let t=Number(e.speedMbps??0),n=Number(e.p95??NaN),r=Number(e.threshold??.85);return!t||!Number.isFinite(n)||!Number.isFinite(r)?(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``}):(0,P.jsx)(`span`,{className:`text-xs`,children:(Math.max(0,(r-n)*t)/1e3).toFixed(2)})},width:150},{id:`days85`,header:`Days@85`,align:`right`,cell:e=>{if(!e.forecastCrossingTs)return(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``});let t=Od(e.forecastCrossingTs);return t?(0,P.jsx)(`span`,{className:`text-xs`,children:Math.round((t.getTime()-Date.now())/(24*3600*1e3))}):(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``})},width:90}]:[],{id:`slope`,header:`Slope/d`,align:`right`,cell:e=>o.startsWith(`util_`)?kd(e.slopePerDay):Ad(e.slopePerDay),width:100},{id:`forecast`,header:`Forecast`,cell:e=>{if(!e.forecastCrossingTs)return(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``});let t=Od(e.forecastCrossingTs),n=t?Math.round((t.getTime()-Date.now())/(24*3600*1e3)):null;return(0,P.jsxs)(`div`,{className:`text-xs`,children:[(0,P.jsx)(`div`,{className:`font-mono`,children:e.forecastCrossingTs.slice(0,10)}),n===null?null:(0,P.jsxs)(`div`,{className:`text-muted-foreground`,children:[n,`d`]})]})},width:120},{id:`samples`,header:`N`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.samples||0}),width:70}],[o]),qe=(0,M.useMemo)(()=>[{id:`device`,header:`Device`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.device}),width:240},{id:`meta`,header:`Meta`,cell:e=>(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[(0,P.jsx)(`div`,{children:[e.vendor,e.os].filter(Boolean).join(`  `)||``}),(0,P.jsx)(`div`,{className:`font-mono`,children:e.model||``})]}),width:240},{id:`p95`,header:`p95`,align:`right`,cell:e=>kd(e.p95),width:90},{id:`max`,header:`Max`,align:`right`,cell:e=>{let t=e.threshold??.85;return(0,P.jsx)(`span`,{className:(e.max??0)>=t?`text-destructive font-medium`:``,children:kd(e.max)})},width:90},{id:`slope`,header:`Slope/d`,align:`right`,cell:e=>kd(e.slopePerDay),width:100},{id:`forecast`,header:`Forecast`,cell:e=>{if(!e.forecastCrossingTs)return(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``});let t=Od(e.forecastCrossingTs),n=t?Math.round((t.getTime()-Date.now())/(24*3600*1e3)):null;return(0,P.jsxs)(`div`,{className:`text-xs`,children:[(0,P.jsx)(`div`,{className:`font-mono`,children:e.forecastCrossingTs.slice(0,10)}),n===null?null:(0,P.jsxs)(`div`,{className:`text-muted-foreground`,children:[n,`d`]})]})},width:120},{id:`samples`,header:`N`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.samples||0}),width:70}],[]),Je=i({queryKey:[`capacityGrowth`,e,n,T,w,`interface`],queryFn:()=>Ii(e,{metric:T,window:n,objectType:`interface`,compareHours:w,limit:50}),enabled:!!(e&&Oe&&De),retry:!1,staleTime:3e4}),Ye=i({queryKey:[`capacityGrowth`,e,n,ie,w,`device`],queryFn:()=>Ii(e,{metric:ie,window:n,objectType:`device`,compareHours:w,limit:50}),enabled:!!(e&&Oe&&De),retry:!1,staleTime:3e4}),Xe=(0,M.useMemo)(()=>(Je.data?.rows??[]).map(e=>{let t=e?.now?.details??{},n=String(t.deviceName??e.objectId??``).trim(),r=String(t.interfaceName??``).trim(),i=String(t.direction??``).trim(),a=String(t.locationName??``).trim()||void 0,o=Array.isArray(t.tagNames)?t.tagNames.map(e=>String(e??``).trim()).filter(Boolean):void 0,s=Array.isArray(t.groupNames)?t.groupNames.map(e=>String(e??``).trim()).filter(Boolean):void 0;return{id:String(e?.objectId??`${n}:${r}:${i}`),device:n,iface:r,dir:i,locationName:a,tagNames:o,groupNames:s,speedMbps:t.speedMbps??null,nowP95:e?.now?.p95,prevP95:e?.prev?.p95??null,deltaP95:e?.deltaP95??null,deltaP95Gbps:e?.deltaP95Gbps??null,nowMax:e?.now?.max,prevMax:e?.prev?.max??null,deltaMax:e?.deltaMax??null,nowForecast:e?.now?.forecastCrossingTs??void 0,raw:e}}).filter(e=>!(b!==`all`&&(e.locationName??``)!==b||g!==`all`&&!(e.tagNames??[]).includes(g)||v!==`all`&&!(e.groupNames??[]).includes(v))),[Je.data?.rows,b,g,v]),Ze=(0,M.useMemo)(()=>(Ye.data?.rows??[]).map(e=>{let t=e?.now?.details??{},n=String(t.deviceName??e.objectId??``).trim(),r=String(t.locationName??``).trim()||void 0,i=Array.isArray(t.tagNames)?t.tagNames.map(e=>String(e??``).trim()).filter(Boolean):void 0,a=Array.isArray(t.groupNames)?t.groupNames.map(e=>String(e??``).trim()).filter(Boolean):void 0;return{id:String(e?.objectId??n),device:n,locationName:r,tagNames:i,groupNames:a,vendor:String(t.vendor??``).trim()||void 0,os:String(t.os??``).trim()||void 0,model:String(t.model??``).trim()||void 0,nowP95:e?.now?.p95,prevP95:e?.prev?.p95??null,deltaP95:e?.deltaP95??null,nowMax:e?.now?.max,prevMax:e?.prev?.max??null,deltaMax:e?.deltaMax??null,nowForecast:e?.now?.forecastCrossingTs??void 0,raw:e}}).filter(e=>!(b!==`all`&&(e.locationName??``)!==b||g!==`all`&&!(e.tagNames??[]).includes(g)||v!==`all`&&!(e.groupNames??[]).includes(v))),[Ye.data?.rows,b,g,v]),Qe=(0,M.useMemo)(()=>{let e=new Set,t=new Set;for(let n of A.data?.routeScale??[]){let r=String(n.deviceName??``).trim(),i=String(n.vrf??``).trim();r&&e.add(r),i&&t.add(i)}for(let n of A.data?.bgpNeighbors??[]){let r=String(n.deviceName??``).trim(),i=String(n.vrf??``).trim();r&&e.add(r),i&&t.add(i)}return{devices:Array.from(e).sort(),vrfs:Array.from(t).sort()}},[A.data?.routeScale,A.data?.bgpNeighbors]),$e=(0,M.useMemo)(()=>(A.data?.routeScale??[]).filter(e=>!(ge!==`all`&&e.deviceName!==ge||ve!==`all`&&e.vrf!==ve)),[A.data?.routeScale,ge,ve]),et=(0,M.useMemo)(()=>(A.data?.bgpNeighbors??[]).filter(e=>!(ge!==`all`&&e.deviceName!==ge||ve!==`all`&&e.vrf!==ve)),[A.data?.bgpNeighbors,ge,ve]),tt=(0,M.useMemo)(()=>(A.data?.hardwareTcam??[]).filter(e=>!(ge!==`all`&&e.deviceName!==ge)),[A.data?.hardwareTcam,ge]),nt=(0,M.useMemo)(()=>{let e=new Map,t=(e,t)=>`${e}||${t}`;for(let n of A.data?.routeScale??[]){let r=String(n.deviceName??``).trim(),i=String(n.vrf??``).trim();if(!r||!i)continue;let a=t(r,i),o=e.get(a)??{id:a,deviceName:r,vrf:i,ipv4Routes:0,ipv6Routes:0,bgpNeighbors:0,bgpEstablished:0};o.ipv4Routes=Number(n.ipv4Routes??0),o.ipv6Routes=Number(n.ipv6Routes??0),e.set(a,o)}for(let n of A.data?.bgpNeighbors??[]){let r=String(n.deviceName??``).trim(),i=String(n.vrf??``).trim();if(!r||!i)continue;let a=t(r,i),o=e.get(a)??{id:a,deviceName:r,vrf:i,ipv4Routes:0,ipv6Routes:0,bgpNeighbors:0,bgpEstablished:0};o.bgpNeighbors+=1,String(n.sessionState??``).toUpperCase().includes(`ESTABLISHED`)&&(o.bgpEstablished+=1),e.set(a,o)}for(let r of Pe){if(r.objectType!==`interface`||r.window!==n||!r.metric.startsWith(`util_`))continue;let i=r.details??{},a=String(i.deviceName??``).trim(),o=String(i.vrf??``).trim();if(!a||!o)continue;let s=t(a,o),c=e.get(s)??{id:s,deviceName:a,vrf:o,ipv4Routes:0,ipv6Routes:0,bgpNeighbors:0,bgpEstablished:0};c.maxIfaceMax=Math.max(c.maxIfaceMax??0,r.max??0),r.p95!==void 0&&r.p95!==null&&(c.maxIfaceP95=Math.max(c.maxIfaceP95??0,r.p95??0));let l=r.forecastCrossingTs??``;l&&(c.soonestForecast?Date.parse(l)<Date.parse(c.soonestForecast)&&(c.soonestForecast=l):c.soonestForecast=l),e.set(s,c)}let r=Array.from(e.values());return r.sort((e,t)=>(t.maxIfaceMax??0)-(e.maxIfaceMax??0)),r},[A.data?.routeScale,A.data?.bgpNeighbors,Pe,n]);return Ee?(0,P.jsxs)(`div`,{className:`space-y-6 p-6 pb-20`,children:[(0,P.jsxs)(`div`,{className:`flex flex-col gap-4 md:flex-row md:items-center md:justify-between`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,P.jsx)(p,{to:`/dashboard/deployments/$deploymentId`,params:{deploymentId:e},className:yr({variant:`outline`,size:`icon`,className:`h-9 w-9`}),title:`Back to deployment`,children:(0,P.jsx)(ot,{className:`h-4 w-4`})}),(0,P.jsxs)(`div`,{children:[(0,P.jsxs)(`h1`,{className:`text-2xl font-bold tracking-tight flex items-center gap-2`,children:[(0,P.jsx)(Ce,{className:`h-5 w-5`}),` Capacity`]}),(0,P.jsxs)(`p`,{className:`text-sm text-muted-foreground mt-1`,children:[`Deployment: `,(0,P.jsx)(`span`,{className:`font-medium`,children:Ee.name})]})]})]}),(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(q,{value:n,onValueChange:e=>a(e),children:[(0,P.jsx)(Y,{className:`w-[110px]`,children:(0,P.jsx)(J,{placeholder:`Window`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`24h`,children:`24h`}),(0,P.jsx)(Z,{value:`7d`,children:`7d`}),(0,P.jsx)(Z,{value:`30d`,children:`30d`})]})]}),(0,P.jsxs)(q,{value:b,onValueChange:ee,children:[(0,P.jsx)(Y,{className:`w-[190px]`,children:(0,P.jsx)(J,{placeholder:`Location`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`all`,children:`All locations`}),Me.locations.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))]})]}),(0,P.jsxs)(q,{value:te,onValueChange:x,children:[(0,P.jsx)(Y,{className:`w-[170px]`,children:(0,P.jsx)(J,{placeholder:`VRF`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`all`,children:`All VRFs`}),Me.vrfs.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))]})]}),(0,P.jsxs)(q,{value:g,onValueChange:_,children:[(0,P.jsx)(Y,{className:`w-[170px]`,children:(0,P.jsx)(J,{placeholder:`Tag`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`all`,children:`All tags`}),Me.tags.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))]})]}),(0,P.jsxs)(q,{value:v,onValueChange:y,children:[(0,P.jsx)(Y,{className:`w-[170px]`,children:(0,P.jsx)(J,{placeholder:`Group`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`all`,children:`All groups`}),Me.groups.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))]})]}),(0,P.jsxs)(q,{value:S,onValueChange:e=>C(e),children:[(0,P.jsx)(Y,{className:`w-[140px]`,children:(0,P.jsx)(J,{placeholder:`Group by`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`none`,children:`No grouping`}),(0,P.jsx)(Z,{value:`location`,children:`Location`}),(0,P.jsx)(Z,{value:`tag`,children:`Tag`}),(0,P.jsx)(Z,{value:`group`,children:`Group`}),(0,P.jsx)(Z,{value:`vrf`,children:`VRF`})]})]}),(0,P.jsxs)(F,{variant:`outline`,onClick:()=>Ae.mutate(),disabled:Ae.isPending||!Oe||!De,title:!Oe||!De?`Enable Forward and run sync first`:`Enqueue a background rollup task`,children:[(0,P.jsx)(it,{className:`mr-2 h-4 w-4`}),Ae.isPending?`Queueing`:`Refresh`]})]})]}),(0,P.jsxs)(`div`,{className:`grid grid-cols-1 gap-4 md:grid-cols-3`,children:[(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{className:`pb-2`,children:(0,P.jsx)(z,{className:`text-sm`,children:`As Of`})}),(0,P.jsxs)(V,{className:`text-sm`,children:[(0,P.jsx)(`div`,{className:`font-mono text-xs`,children:ke.data?.asOf??A.data?.asOf??``}),(0,P.jsxs)(`div`,{className:`mt-2 flex items-center gap-2`,children:[ke.data?.stale?(0,P.jsx)(W,{variant:`destructive`,children:`Stale`}):(0,P.jsx)(W,{variant:`secondary`,children:`Fresh`}),(0,P.jsx)(W,{variant:`outline`,className:`font-mono text-xs`,children:De||`no-forward`})]})]})]}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{className:`pb-2`,children:(0,P.jsx)(z,{className:`text-sm`,children:`Hot Interfaces`})}),(0,P.jsxs)(V,{className:`text-sm`,children:[(0,P.jsx)(`div`,{className:`text-2xl font-semibold`,children:ze.above}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground mt-1`,children:`util_* max >= 85%`})]})]}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{className:`pb-2`,children:(0,P.jsx)(z,{className:`text-sm`,children:`Soonest Saturation`})}),(0,P.jsx)(V,{className:`text-sm`,children:ze.soonest?.forecastCrossingTs?(0,P.jsxs)(`div`,{className:`space-y-1`,children:[(0,P.jsx)(`div`,{className:`font-mono text-xs`,children:ze.soonest.forecastCrossingTs}),(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[String(ze.soonest.details?.deviceName??``),` `,String(ze.soonest.details?.interfaceName??``),` `,String(ze.soonest.details?.direction??``)]})]}):(0,P.jsx)(`div`,{className:`text-muted-foreground text-sm`,children:``})})]})]}),(0,P.jsxs)(lc,{defaultValue:`interfaces`,className:`space-y-4`,children:[(0,P.jsxs)(uc,{children:[(0,P.jsx)(dc,{value:`interfaces`,children:`Interfaces`}),(0,P.jsx)(dc,{value:`devices`,children:`Devices`}),(0,P.jsx)(dc,{value:`growth`,children:`Growth`}),(0,P.jsx)(dc,{value:`routing`,children:`Routing/BGP`}),(0,P.jsx)(dc,{value:`health`,children:`Health`}),(0,P.jsx)(dc,{value:`raw`,children:`Raw`})]}),(0,P.jsx)(fc,{value:`interfaces`,className:`space-y-4`,children:(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{className:`flex flex-col gap-3 md:flex-row md:items-center md:justify-between`,children:[(0,P.jsx)(z,{className:`text-base`,children:`Interface Capacity`}),(0,P.jsxs)(`div`,{className:`flex flex-col gap-2 md:flex-row md:items-center`,children:[(0,P.jsx)(K,{placeholder:`Filter (device / interface)`,value:d,onChange:e=>f(e.target.value),className:`w-[260px]`}),(0,P.jsxs)(q,{value:o,onValueChange:e=>s(e),children:[(0,P.jsx)(Y,{className:`w-[240px]`,children:(0,P.jsx)(J,{placeholder:`Metric`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`util_ingress`,children:`Utilization (ingress)`}),(0,P.jsx)(Z,{value:`util_egress`,children:`Utilization (egress)`}),(0,P.jsx)(Z,{value:`if_error_ingress`,children:`Errors (ingress)`}),(0,P.jsx)(Z,{value:`if_error_egress`,children:`Errors (egress)`}),(0,P.jsx)(Z,{value:`if_packet_loss_ingress`,children:`Packet loss (ingress)`}),(0,P.jsx)(Z,{value:`if_packet_loss_egress`,children:`Packet loss (egress)`})]})]}),(0,P.jsx)(F,{variant:`outline`,onClick:()=>{let t=[`device`,`interface`,`direction`,`window`,`metric`,`speedMbps`,`adminStatus`,`operStatus`,`p95`,`p99`,`max`,`slopePerDay`,`forecastCrossingTs`,`samples`],r=Fe.map(e=>[e.device,e.iface,e.dir,n,o,e.speedMbps??``,e.admin??``,e.oper??``,e.p95??``,e.p99??``,e.max??``,e.slopePerDay??``,e.forecastCrossingTs??``,e.samples??0]);Td(`capacity_interfaces_${e}_${n}_${o}.csv`,`text/csv`,Dd(t,r))},disabled:Fe.length===0,children:`Export CSV`}),(0,P.jsx)(F,{variant:`outline`,onClick:()=>le(!0),disabled:A.isLoading||A.isError,title:`Pick any interface from NQE inventory and load trend from Forward perf history`,children:`Pick interface`})]})]}),(0,P.jsxs)(V,{className:`space-y-3`,children:[S===`none`?null:(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Group summary (`,S,`)`]}),(0,P.jsx)(Ss,{columns:o.startsWith(`util_`)?[{id:`group`,header:`Group`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.group}),width:220},...S===`vrf`?[{id:`routes`,header:`Routes (v4/v6)`,align:`right`,cell:e=>(0,P.jsxs)(`span`,{className:`text-xs tabular-nums`,children:[Number(e.ipv4RoutesSum??0),`/`,Number(e.ipv6RoutesSum??0)]}),width:130},{id:`bgp`,header:`BGP`,align:`right`,cell:e=>(0,P.jsxs)(`span`,{className:`text-xs tabular-nums`,children:[Number(e.bgpNeighbors??0),` (`,Number(e.bgpEstablished??0),`)`]}),width:100}]:[],{id:`count`,header:`Ifaces`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs tabular-nums`,children:e.count}),width:80},{id:`speed`,header:` Speed (Gbps)`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs tabular-nums`,children:e.sumSpeedGbps===void 0?``:e.sumSpeedGbps.toFixed(1)}),width:120},{id:`p95sum`,header:` p95 (Gbps)`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs tabular-nums`,children:e.sumP95Gbps===void 0?``:e.sumP95Gbps.toFixed(2)}),width:120},{id:`maxsum`,header:` Max (Gbps)`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs tabular-nums`,children:e.sumMaxGbps===void 0?``:e.sumMaxGbps.toFixed(2)}),width:120},{id:`utilp95`,header:`Util@p95`,align:`right`,cell:e=>{let t=Number(e.sumSpeedGbps??0),n=Number(e.sumP95Gbps??0);return t?(0,P.jsx)(`span`,{className:`text-xs tabular-nums`,children:kd(n/t)}):(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``})},width:90},{id:`utilmax`,header:`Util@max`,align:`right`,cell:e=>{let t=Number(e.sumSpeedGbps??0),n=Number(e.sumMaxGbps??0);return t?(0,P.jsx)(`span`,{className:`text-xs tabular-nums`,children:kd(n/t)}):(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``})},width:90},{id:`headroom`,header:`Headroom@85 (Gbps)`,align:`right`,cell:e=>{let t=Number(e.sumSpeedGbps??0),n=Number(e.sumP95Gbps??0);return t?(0,P.jsx)(`span`,{className:`text-xs tabular-nums`,children:Math.max(0,t*.85-n).toFixed(2)}):(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``})},width:150},{id:`p95cov`,header:`p95 cov`,align:`right`,cell:e=>(0,P.jsxs)(`span`,{className:`text-xs tabular-nums`,children:[Number(e.p95Count??0),`/`,e.count]}),width:90},{id:`soonest`,header:`Soonest`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.soonestForecast?e.soonestForecast.slice(0,10):``}),width:110}]:[{id:`group`,header:`Group`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.group}),width:260},{id:`count`,header:`Count`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.count}),width:90},{id:`hot`,header:`Hot`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.hotCount}),width:90},{id:`p95`,header:`Max p95`,align:`right`,cell:e=>Ad(e.maxP95),width:100}],rows:Le,getRowId:e=>e.group,onRowClick:e=>{S===`location`?ee(e.group):S===`tag`?_(e.group===`untagged`?`all`:e.group):S===`group`?y(e.group===`ungrouped`?`all`:e.group):S===`vrf`&&x(e.group===`unknown`?`all`:e.group)},emptyText:`No groups.`,maxHeightClassName:`max-h-[260px]`,minWidthClassName:`min-w-0`})]}),ke.isLoading?(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(U,{className:`h-5 w-56`}),(0,P.jsx)(U,{className:`h-32 w-full`})]}):ke.isError?(0,P.jsxs)(`div`,{className:`text-destructive text-sm`,children:[`Failed to load summary:`,` `,ke.error instanceof Error?ke.error.message:String(ke.error)]}):(0,P.jsx)(Ss,{columns:Ke,rows:Fe,getRowId:e=>e.id,onRowClick:e=>D(e),emptyText:`No rollups for this window/metric yet. Click Refresh to enqueue.`})]})]})}),(0,P.jsx)(fc,{value:`devices`,className:`space-y-4`,children:(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{className:`flex flex-col gap-3 md:flex-row md:items-center md:justify-between`,children:[(0,P.jsx)(z,{className:`text-base`,children:`Device Capacity`}),(0,P.jsxs)(`div`,{className:`flex flex-col gap-2 md:flex-row md:items-center`,children:[(0,P.jsx)(K,{placeholder:`Filter (device / vendor / os)`,value:m,onChange:e=>h(e.target.value),className:`w-[260px]`}),(0,P.jsxs)(q,{value:l,onValueChange:e=>u(e),children:[(0,P.jsx)(Y,{className:`w-[220px]`,children:(0,P.jsx)(J,{placeholder:`Metric`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`device_cpu`,children:`CPU`}),(0,P.jsx)(Z,{value:`device_memory`,children:`Memory`})]})]}),(0,P.jsx)(F,{variant:`outline`,onClick:()=>{let t=[`device`,`window`,`metric`,`vendor`,`os`,`model`,`p95`,`p99`,`max`,`slopePerDay`,`forecastCrossingTs`,`samples`],r=Ie.map(e=>[e.device,n,l,e.vendor??``,e.os??``,e.model??``,e.p95??``,e.p99??``,e.max??``,e.slopePerDay??``,e.forecastCrossingTs??``,e.samples??0]);Td(`capacity_devices_${e}_${n}_${l}.csv`,`text/csv`,Dd(t,r))},disabled:Ie.length===0,children:`Export CSV`}),(0,P.jsx)(F,{variant:`outline`,onClick:()=>pe(!0),disabled:A.isLoading||A.isError,title:`Pick any device from NQE inventory and load trend from Forward perf history`,children:`Pick device`})]})]}),(0,P.jsxs)(V,{className:`space-y-3`,children:[S===`none`?null:(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Group summary (`,S,`)`]}),(0,P.jsx)(Ss,{columns:[{id:`group`,header:`Group`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.group}),width:260},{id:`count`,header:`Count`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.count}),width:90},{id:`hot`,header:`Hot`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.hotCount}),width:90},{id:`p95`,header:`Max p95`,align:`right`,cell:e=>kd(e.maxP95),width:100}],rows:Re,getRowId:e=>e.group,emptyText:`No groups.`,maxHeightClassName:`max-h-[260px]`,minWidthClassName:`min-w-0`})]}),ke.isLoading?(0,P.jsxs)(`div`,{className:`space-y-2`,children:[(0,P.jsx)(U,{className:`h-5 w-56`}),(0,P.jsx)(U,{className:`h-32 w-full`})]}):ke.isError?(0,P.jsxs)(`div`,{className:`text-destructive text-sm`,children:[`Failed to load summary:`,` `,ke.error instanceof Error?ke.error.message:String(ke.error)]}):(0,P.jsx)(Ss,{columns:qe,rows:Ie,getRowId:e=>e.id,onRowClick:e=>oe(e),emptyText:`No rollups for this window/metric yet. Click Refresh to enqueue.`})]})]})}),(0,P.jsxs)(fc,{value:`growth`,className:`space-y-4`,children:[(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{className:`flex flex-col gap-3 md:flex-row md:items-center md:justify-between`,children:[(0,P.jsx)(z,{className:`text-base`,children:`Growth (Delta vs Prior)`}),(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(q,{value:String(w),onValueChange:e=>ne(Number(e)),children:[(0,P.jsx)(Y,{className:`w-[150px]`,children:(0,P.jsx)(J,{placeholder:`Compare`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`24`,children:`24h`}),(0,P.jsx)(Z,{value:`168`,children:`7d`}),(0,P.jsx)(Z,{value:`720`,children:`30d`}),(0,P.jsx)(Z,{value:`2160`,children:`90d`})]})]}),(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`As of`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:Je.data?.asOf??Ye.data?.asOf??ke.data?.asOf??``}),`  `,`Compared to`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:Je.data?.compareAsOf??Ye.data?.compareAsOf??``})]})]})]}),(0,P.jsx)(V,{className:`text-sm text-muted-foreground`,children:`Top growers computed from Skyforge rollups (no Forward time-series pull). Use Refresh to enqueue rollup recomputation.`})]}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{className:`flex flex-col gap-3 md:flex-row md:items-center md:justify-between`,children:[(0,P.jsx)(z,{className:`text-base`,children:`Interfaces`}),(0,P.jsxs)(q,{value:T,onValueChange:e=>re(e),children:[(0,P.jsx)(Y,{className:`w-[240px]`,children:(0,P.jsx)(J,{placeholder:`Metric`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`util_ingress`,children:`Utilization (ingress)`}),(0,P.jsx)(Z,{value:`util_egress`,children:`Utilization (egress)`})]})]})]}),(0,P.jsx)(V,{children:Je.isLoading?(0,P.jsx)(U,{className:`h-32 w-full`}):Je.isError?(0,P.jsxs)(`div`,{className:`text-destructive text-sm`,children:[`Failed to load growth:`,` `,Je.error instanceof Error?Je.error.message:String(Je.error)]}):(0,P.jsx)(Ss,{columns:[{id:`device`,header:`Device`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.device}),width:220},{id:`iface`,header:`Interface`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.iface}),width:220},{id:`dir`,header:`Dir`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.dir}),width:90},{id:`speed`,header:`Speed`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:jd(e.speedMbps??null)}),width:90},{id:`nowP95`,header:`Now p95`,align:`right`,cell:e=>kd(e.nowP95),width:100},{id:`prevP95`,header:`Prev p95`,align:`right`,cell:e=>kd(e.prevP95??void 0),width:100},{id:`deltaP95`,header:` p95`,align:`right`,cell:e=>{let t=e.deltaP95;return t==null?(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``}):(0,P.jsxs)(`span`,{className:t>0?`text-foreground font-medium`:`text-muted-foreground`,children:[t>=0?`+`:``,kd(t)]})},width:90},{id:`deltaGbps`,header:` p95 (Gbps)`,align:`right`,cell:e=>e.deltaP95Gbps!==null&&e.deltaP95Gbps!==void 0?(0,P.jsxs)(`span`,{className:`text-xs`,children:[e.deltaP95Gbps>=0?`+`:``,e.deltaP95Gbps.toFixed(2)]}):(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``}),width:120},{id:`forecast`,header:`Forecast`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.nowForecast?e.nowForecast.slice(0,10):``}),width:120}],rows:Xe,getRowId:e=>e.id,onRowClick:e=>{s(T),D({id:`${e.device}:${e.iface}:${e.dir}:growth`,device:e.device,iface:e.iface,dir:e.dir||`INGRESS`,speedMbps:e.speedMbps??null,samples:0})},emptyText:`No growth rows yet. Click Refresh to enqueue.`})})]}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{className:`flex flex-col gap-3 md:flex-row md:items-center md:justify-between`,children:[(0,P.jsx)(z,{className:`text-base`,children:`Devices`}),(0,P.jsxs)(q,{value:ie,onValueChange:e=>ae(e),children:[(0,P.jsx)(Y,{className:`w-[220px]`,children:(0,P.jsx)(J,{placeholder:`Metric`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`device_cpu`,children:`CPU`}),(0,P.jsx)(Z,{value:`device_memory`,children:`Memory`})]})]})]}),(0,P.jsx)(V,{children:Ye.isLoading?(0,P.jsx)(U,{className:`h-32 w-full`}):Ye.isError?(0,P.jsxs)(`div`,{className:`text-destructive text-sm`,children:[`Failed to load growth:`,` `,Ye.error instanceof Error?Ye.error.message:String(Ye.error)]}):(0,P.jsx)(Ss,{columns:[{id:`device`,header:`Device`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.device}),width:240},{id:`meta`,header:`Meta`,cell:e=>(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[(0,P.jsx)(`div`,{children:[e.vendor,e.os].filter(Boolean).join(`  `)||``}),(0,P.jsx)(`div`,{className:`font-mono`,children:e.model||``})]}),width:240},{id:`nowP95`,header:`Now p95`,align:`right`,cell:e=>kd(e.nowP95),width:100},{id:`prevP95`,header:`Prev p95`,align:`right`,cell:e=>kd(e.prevP95??void 0),width:100},{id:`deltaP95`,header:` p95`,align:`right`,cell:e=>{let t=e.deltaP95;return t==null?(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``}):(0,P.jsxs)(`span`,{className:t>0?`text-foreground font-medium`:`text-muted-foreground`,children:[t>=0?`+`:``,kd(t)]})},width:90},{id:`forecast`,header:`Forecast`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.nowForecast?e.nowForecast.slice(0,10):``}),width:120}],rows:Ze,getRowId:e=>e.id,onRowClick:e=>{u(ie),oe({id:`${e.device}:growth`,device:e.device,metric:ie,vendor:e.vendor,os:e.os,model:e.model,samples:0})},emptyText:`No growth rows yet. Click Refresh to enqueue.`})})]})]}),(0,P.jsxs)(fc,{value:`routing`,className:`space-y-4`,children:[(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{className:`text-base`,children:`VRF Summary (Perf + Scale)`})}),(0,P.jsx)(V,{children:A.isLoading?(0,P.jsx)(U,{className:`h-28 w-full`}):A.isError?(0,P.jsxs)(`div`,{className:`text-destructive text-sm`,children:[`Failed to load inventory:`,` `,A.error instanceof Error?A.error.message:String(A.error)]}):(0,P.jsx)(Ss,{columns:[{id:`device`,header:`Device`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.deviceName}),width:240},{id:`vrf`,header:`VRF`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.vrf}),width:180},{id:`v4`,header:`IPv4`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs tabular-nums`,children:e.ipv4Routes}),width:90},{id:`v6`,header:`IPv6`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs tabular-nums`,children:e.ipv6Routes}),width:90},{id:`bgp`,header:`BGP`,align:`right`,cell:e=>(0,P.jsxs)(`span`,{className:`text-xs tabular-nums`,children:[e.bgpNeighbors,` (`,e.bgpEstablished,`)`]}),width:110},{id:`max`,header:`Max util`,align:`right`,cell:e=>kd(e.maxIfaceMax),width:100},{id:`forecast`,header:`Soonest`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.soonestForecast?e.soonestForecast.slice(0,10):``}),width:120}],rows:nt,getRowId:e=>e.id,onRowClick:e=>{_e(e.deviceName),ye(e.vrf),x(e.vrf)},emptyText:`No VRF summary available yet. Click Refresh to enqueue.`,maxHeightClassName:`max-h-[360px]`,minWidthClassName:`min-w-0`})})]}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{className:`flex flex-col gap-2 md:flex-row md:items-center md:justify-between`,children:[(0,P.jsx)(z,{className:`text-base`,children:`Hardware Capacity (TCAM)`}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Derived from Forward CUSTOM command outputs. Configure a TCAM command collection to populate.`})]}),(0,P.jsx)(V,{children:A.isLoading?(0,P.jsx)(U,{className:`h-28 w-full`}):A.isError?(0,P.jsxs)(`div`,{className:`text-destructive text-sm`,children:[`Failed to load inventory:`,` `,A.error instanceof Error?A.error.message:String(A.error)]}):(0,P.jsx)(Ss,{columns:[{id:`device`,header:`Device`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.deviceName}),width:240},{id:`meta`,header:`Meta`,cell:e=>(0,P.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[(0,P.jsx)(`div`,{children:[e.vendor??``,e.os??``].filter(Boolean).join(`  `)||``}),(0,P.jsx)(`div`,{className:`font-mono`,children:String(e.model??``)})]}),width:240},{id:`used`,header:`Used`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs tabular-nums`,children:Number(e.tcamUsed??0)}),width:90},{id:`total`,header:`Total`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs tabular-nums`,children:Number(e.tcamTotal??0)}),width:90},{id:`util`,header:`Util`,align:`right`,cell:e=>{let t=Number(e.tcamUsed??0),n=Number(e.tcamTotal??0);return n?(0,P.jsx)(`span`,{className:`text-xs`,children:kd(t/n)}):(0,P.jsx)(`span`,{className:`text-muted-foreground text-xs`,children:``})},width:90},{id:`cmd`,header:`Command`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:String(e.commandText??``).slice(0,48)||``}),width:260},{id:`evidence`,header:`Evidence`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs text-muted-foreground`,children:String(e.evidence??``).slice(0,60)||``}),width:320}],rows:tt,getRowId:e=>e.deviceName,onRowClick:e=>{_e(e.deviceName),we([`device: ${String(e.deviceName??``)}`,`command: ${String(e.commandText??``)}`,`used/total: ${Number(e.tcamUsed??0)}/${Number(e.tcamTotal??0)}`,``,String(e.evidence??``)].join(`
`)),xe(!0)},emptyText:`No TCAM rows cached yet. Click Refresh after enabling custom commands.`,maxHeightClassName:`max-h-[320px]`,minWidthClassName:`min-w-0`})})]}),(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{className:`flex flex-col gap-3 md:flex-row md:items-center md:justify-between`,children:[(0,P.jsx)(z,{className:`text-base`,children:`Routing Scale`}),(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,P.jsxs)(q,{value:ge,onValueChange:_e,children:[(0,P.jsx)(Y,{className:`w-[220px]`,children:(0,P.jsx)(J,{placeholder:`Device`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`all`,children:`All devices`}),Qe.devices.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))]})]}),(0,P.jsxs)(q,{value:ve,onValueChange:ye,children:[(0,P.jsx)(Y,{className:`w-[170px]`,children:(0,P.jsx)(J,{placeholder:`VRF`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`all`,children:`All VRFs`}),Qe.vrfs.map(e=>(0,P.jsx)(Z,{value:e,children:e},e))]})]}),(0,P.jsx)(F,{variant:`outline`,onClick:()=>{_e(`all`),ye(`all`)},disabled:ge===`all`&&ve===`all`,children:`Clear`})]})]}),(0,P.jsx)(V,{children:A.isLoading?(0,P.jsx)(U,{className:`h-28 w-full`}):A.isError?(0,P.jsxs)(`div`,{className:`text-destructive text-sm`,children:[`Failed to load inventory:`,` `,A.error instanceof Error?A.error.message:String(A.error)]}):(0,P.jsx)(Ss,{columns:[{id:`device`,header:`Device`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.deviceName}),width:240},{id:`vrf`,header:`VRF`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.vrf}),width:180},{id:`v4`,header:`IPv4`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.ipv4Routes}),width:90},{id:`v6`,header:`IPv6`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.ipv6Routes}),width:90}],rows:$e,getRowId:e=>`${e.deviceName}:${e.vrf}`,emptyText:`No routing scale cached yet. Click Refresh to enqueue.`})})]}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{className:`text-base`,children:`BGP Neighbors`})}),(0,P.jsx)(V,{children:A.isLoading?(0,P.jsx)(U,{className:`h-28 w-full`}):A.isError?(0,P.jsxs)(`div`,{className:`text-destructive text-sm`,children:[`Failed to load inventory:`,` `,A.error instanceof Error?A.error.message:String(A.error)]}):(0,P.jsx)(Ss,{columns:[{id:`device`,header:`Device`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.deviceName}),width:220},{id:`vrf`,header:`VRF`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.vrf}),width:160},{id:`nbr`,header:`Neighbor`,cell:e=>(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:e.neighborAddress}),width:220},{id:`state`,header:`State`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.sessionState??``}),width:120},{id:`rx`,header:`Rx`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.receivedPrefixes??``}),width:90},{id:`tx`,header:`Tx`,align:`right`,cell:e=>(0,P.jsx)(`span`,{className:`text-xs`,children:e.advertisedPrefixes??``}),width:90}],rows:et,getRowId:e=>`${e.deviceName}:${e.vrf}:${e.neighborAddress}`,emptyText:`No BGP cache yet. Click Refresh to enqueue.`})})]})]}),(0,P.jsx)(fc,{value:`health`,className:`space-y-4`,children:(0,P.jsxs)(L,{children:[(0,P.jsxs)(R,{className:`flex flex-col gap-3 md:flex-row md:items-center md:justify-between`,children:[(0,P.jsx)(z,{className:`text-base`,children:`Health Issues`}),(0,P.jsx)(F,{variant:`outline`,onClick:()=>je.mutate(),disabled:je.isPending,children:je.isPending?`Loading`:`Load unhealthy devices`})]}),(0,P.jsx)(V,{className:`space-y-2`,children:se?(0,P.jsx)(`pre`,{className:`max-h-[60vh] overflow-auto rounded-md border bg-muted/40 p-3 text-xs`,children:wd(se)}):(0,P.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Loads Forward health signals (including high utilization) around the latest processed snapshot.`})})]})}),(0,P.jsxs)(fc,{value:`raw`,className:`space-y-4`,children:[(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{className:`text-base`,children:`Raw Rollups`})}),(0,P.jsx)(V,{className:`space-y-2`,children:ke.isLoading?(0,P.jsx)(U,{className:`h-32 w-full`}):ke.isError?(0,P.jsx)(`div`,{className:`text-destructive text-sm`,children:ke.error instanceof Error?ke.error.message:String(ke.error)}):(0,P.jsx)(`pre`,{className:`max-h-[65vh] overflow-auto rounded-md border bg-muted/40 p-3 text-xs`,children:wd(ke.data?.rollups??[])})})]}),(0,P.jsxs)(L,{children:[(0,P.jsx)(R,{children:(0,P.jsx)(z,{className:`text-base`,children:`Raw Inventory`})}),(0,P.jsx)(V,{className:`space-y-2`,children:A.isLoading?(0,P.jsx)(U,{className:`h-32 w-full`}):A.isError?(0,P.jsx)(`div`,{className:`text-destructive text-sm`,children:A.error instanceof Error?A.error.message:String(A.error)}):(0,P.jsx)(`pre`,{className:`max-h-[65vh] overflow-auto rounded-md border bg-muted/40 p-3 text-xs`,children:wd(A.data??{})})})]})]})]}),(0,P.jsx)(Zn,{open:!!E,onOpenChange:e=>!e&&D(null),children:(0,P.jsxs)(er,{className:`max-w-3xl`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{className:`text-base`,children:`Interface Trend`})}),E?(0,P.jsxs)(`div`,{className:`space-y-3`,children:[(0,P.jsxs)(`div`,{className:`text-sm`,children:[(0,P.jsxs)(`span`,{className:`font-mono text-xs`,children:[E.device,` `,E.iface,` `,E.dir]}),` `,(0,P.jsx)(W,{variant:`outline`,className:`ml-2`,children:n}),(0,P.jsx)(W,{variant:`secondary`,className:`ml-2`,children:o}),(0,P.jsxs)(q,{value:E.dir,onValueChange:e=>D(t=>t&&{...t,dir:String(e)}),children:[(0,P.jsx)(Y,{className:`ml-2 inline-flex h-7 w-[140px]`,children:(0,P.jsx)(J,{placeholder:`Direction`})}),(0,P.jsxs)(X,{children:[(0,P.jsx)(Z,{value:`INGRESS`,children:`INGRESS`}),(0,P.jsx)(Z,{value:`EGRESS`,children:`EGRESS`})]})]}),E.vrf||E.vrfNames?.length?(0,P.jsxs)(`div`,{className:`mt-2 flex flex-wrap items-center gap-2 text-xs`,children:[(0,P.jsx)(W,{variant:`outline`,className:`font-mono text-xs`,children:`VRF`}),(0,P.jsxs)(`span`,{className:`font-mono text-xs`,children:[E.vrf??(E.vrfNames??[]).slice(0,3).join(`, `),(E.vrfNames??[]).length>3?``:``]}),(0,P.jsx)(F,{variant:`outline`,className:`h-7 px-2`,onClick:()=>{_e(E.device),ye(E.vrf??E.vrfNames?.[0]??`all`)},title:`Filter Routing/BGP tables to this device/VRF`,children:`Filter routing`})]}):null]}),Be.isLoading?(0,P.jsx)(U,{className:`h-24 w-full`}):Be.isError?(0,P.jsx)(`div`,{className:`text-sm text-destructive`,children:`Failed to load history`}):(0,P.jsx)(Sd,{points:He}),(()=>{let e=E.vrfNames?.length?E.vrfNames:E.vrf?[E.vrf]:[];if(!e.length)return null;let t=(A.data?.routeScale??[]).filter(t=>t.deviceName===E.device&&e.includes(t.vrf)),n=(A.data?.bgpNeighbors??[]).filter(t=>t.deviceName===E.device&&e.includes(t.vrf)),r=t.reduce((e,t)=>e+Number(t.ipv4Routes??0),0),i=t.reduce((e,t)=>e+Number(t.ipv6Routes??0),0),a=n.filter(e=>String(e.sessionState??``).toUpperCase().includes(`ESTABLISHED`)).length;return(0,P.jsxs)(`div`,{className:`rounded-md border bg-muted/20 p-3 text-xs`,children:[(0,P.jsxs)(`div`,{className:`flex flex-wrap items-center justify-between gap-2`,children:[(0,P.jsxs)(`div`,{className:`text-muted-foreground`,children:[`Routing context for`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:e.slice(0,3).join(`, `)}),e.length>3?``:``]}),(0,P.jsx)(F,{variant:`outline`,className:`h-7 px-2`,onClick:()=>{_e(E.device),ye(e[0]??`all`)},children:`View in Routing tab`})]}),(0,P.jsxs)(`div`,{className:`mt-2 grid grid-cols-2 gap-2`,children:[(0,P.jsxs)(`div`,{children:[`FIB routes (sum):`,` `,(0,P.jsxs)(`span`,{className:`font-mono`,children:[`v4=`,r,` v6=`,i]})]}),(0,P.jsxs)(`div`,{className:`text-right`,children:[`BGP neighbors:`,` `,(0,P.jsxs)(`span`,{className:`font-mono`,children:[n.length,` (`,a,` established)`]})]})]})]})})(),(0,P.jsxs)(`div`,{className:`grid grid-cols-2 gap-3 text-xs text-muted-foreground`,children:[(0,P.jsxs)(`div`,{children:[`p95:`,` `,o.startsWith(`util_`)?kd(E.p95??We.p95??void 0):Ad(E.p95??We.p95??void 0)]}),(0,P.jsxs)(`div`,{className:`text-right`,children:[`max:`,` `,o.startsWith(`util_`)?kd(E.max??We.max??void 0):Ad(E.max??We.max??void 0)]}),(0,P.jsxs)(`div`,{children:[`slope/day:`,` `,o.startsWith(`util_`)?kd(E.slopePerDay):Ad(E.slopePerDay)]}),(0,P.jsxs)(`div`,{className:`text-right`,children:[`forecast:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:E.forecastCrossingTs??``})]}),(0,P.jsxs)(`div`,{children:[`speed: `,jd(E.speedMbps??null)]}),(0,P.jsxs)(`div`,{className:`text-right`,children:[`p95 (Gbps): `,(()=>{if(!o.startsWith(`util_`))return``;let e=Number(E.speedMbps??0),t=Number(E.p95??We.p95??NaN);return!e||!Number.isFinite(t)?``:(t*e/1e3).toFixed(2)})()]})]})]}):null]})}),(0,P.jsx)(Zn,{open:!!O,onOpenChange:e=>!e&&oe(null),children:(0,P.jsxs)(er,{className:`max-w-3xl`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{className:`text-base`,children:`Device Trend`})}),O?(0,P.jsxs)(`div`,{className:`space-y-3`,children:[(0,P.jsxs)(`div`,{className:`text-sm`,children:[(0,P.jsx)(`span`,{className:`font-mono text-xs`,children:O.device}),` `,(0,P.jsx)(W,{variant:`outline`,className:`ml-2`,children:n}),(0,P.jsx)(W,{variant:`secondary`,className:`ml-2`,children:l})]}),Ve.isLoading?(0,P.jsx)(U,{className:`h-24 w-full`}):Ve.isError?(0,P.jsx)(`div`,{className:`text-sm text-destructive`,children:`Failed to load history`}):(0,P.jsx)(Sd,{points:Ue}),(0,P.jsxs)(`div`,{className:`grid grid-cols-2 gap-3 text-xs text-muted-foreground`,children:[(0,P.jsxs)(`div`,{children:[`p95:`,` `,kd(O.p95??Ge.p95??void 0)]}),(0,P.jsxs)(`div`,{className:`text-right`,children:[`max:`,` `,kd(O.max??Ge.max??void 0)]}),(0,P.jsxs)(`div`,{children:[`slope/day: `,kd(O.slopePerDay)]}),(0,P.jsxs)(`div`,{className:`text-right`,children:[`forecast:`,` `,(0,P.jsx)(`span`,{className:`font-mono`,children:O.forecastCrossingTs??``})]})]})]}):null]})}),(0,P.jsx)(Zn,{open:k,onOpenChange:e=>!e&&le(!1),children:(0,P.jsxs)(er,{className:`max-w-2xl`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{className:`text-base`,children:`Pick Interface`})}),(0,P.jsxs)(`div`,{className:`space-y-3`,children:[(0,P.jsx)(K,{placeholder:`Search device/interface`,value:ue,onChange:e=>de(e.target.value)}),(0,P.jsx)(`div`,{className:`max-h-[55vh] overflow-auto rounded-md border`,children:(()=>{let e=A.data?.interfaces??[],t=ue.trim().toLowerCase(),n=(t?e.filter(e=>{let n=String(e.deviceName??``).toLowerCase(),r=String(e.interfaceName??``).toLowerCase();return n.includes(t)||r.includes(t)}):e).slice(0,200);return n.length?(0,P.jsx)(`div`,{className:`divide-y`,children:n.map(e=>{let t=String(e.deviceName??``),n=String(e.interfaceName??``),r=jd(e.speedMbps??null);return(0,P.jsx)(`button`,{type:`button`,className:`w-full px-3 py-2 text-left hover:bg-muted/40`,onClick:()=>{D({id:`${t}:${n}:INGRESS:pick`,device:t,iface:n,dir:`INGRESS`,speedMbps:e.speedMbps??null,admin:e.adminStatus??void 0,oper:e.operStatus??void 0,samples:0}),le(!1)},children:(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,P.jsxs)(`div`,{className:`font-mono text-xs`,children:[t,` `,n]}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:r})]})},`${t}:${n}`)})}):(0,P.jsx)(`div`,{className:`p-4 text-sm text-muted-foreground`,children:`No matches.`})})()}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Loads a trend directly from Forward perf history (not limited to the top-50 rollups).`})]})]})}),(0,P.jsx)(Zn,{open:be,onOpenChange:e=>!e&&xe(!1),children:(0,P.jsxs)(er,{className:`max-w-4xl`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{className:`text-base`,children:`TCAM Evidence`})}),(0,P.jsx)(`pre`,{className:`max-h-[70vh] overflow-auto rounded-md border bg-muted/40 p-3 text-xs`,children:Se||``})]})}),(0,P.jsx)(Zn,{open:fe,onOpenChange:e=>!e&&pe(!1),children:(0,P.jsxs)(er,{className:`max-w-2xl`,children:[(0,P.jsx)(tr,{children:(0,P.jsx)(rr,{className:`text-base`,children:`Pick Device`})}),(0,P.jsxs)(`div`,{className:`space-y-3`,children:[(0,P.jsx)(K,{placeholder:`Search device`,value:me,onChange:e=>he(e.target.value)}),(0,P.jsx)(`div`,{className:`max-h-[55vh] overflow-auto rounded-md border`,children:(()=>{let e=A.data?.devices??[],t=me.trim().toLowerCase(),n=(t?e.filter(e=>{let n=String(e.deviceName??``).toLowerCase(),r=String(e.vendor??``).toLowerCase(),i=String(e.os??``).toLowerCase();return n.includes(t)||r.includes(t)||i.includes(t)}):e).slice(0,200);return n.length?(0,P.jsx)(`div`,{className:`divide-y`,children:n.map(e=>{let t=String(e.deviceName??``);return(0,P.jsx)(`button`,{type:`button`,className:`w-full px-3 py-2 text-left hover:bg-muted/40`,onClick:()=>{oe({id:`${t}:pick`,device:t,metric:l,vendor:e.vendor??void 0,os:e.os??void 0,model:e.model??void 0,samples:0}),pe(!1)},children:(0,P.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,P.jsx)(`div`,{className:`font-mono text-xs`,children:t}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:[e.vendor??``,e.os??``].filter(Boolean).join(`  `)||``})]})},t)})}):(0,P.jsx)(`div`,{className:`p-4 text-sm text-muted-foreground`,children:`No matches.`})})()}),(0,P.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Loads a trend directly from Forward perf history.`})]})]})})]}):(0,P.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,P.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,P.jsx)(p,{to:`/dashboard/deployments/$deploymentId`,params:{deploymentId:e},className:yr({variant:`outline`,size:`icon`,className:`h-9 w-9`}),children:(0,P.jsx)(ot,{className:`h-4 w-4`})}),(0,P.jsx)(`h1`,{className:`text-2xl font-bold tracking-tight`,children:`Capacity`})]}),(0,P.jsx)(L,{children:(0,P.jsx)(V,{className:`pt-6 text-sm text-muted-foreground`,children:`Deployment not found.`})})]})}var Id=Ts.update({id:`/webhooks`,path:`/webhooks`,getParentRoute:()=>_s}),Ld=Os.update({id:`/syslog`,path:`/syslog`,getParentRoute:()=>_s}),Rd=zs.update({id:`/status`,path:`/status`,getParentRoute:()=>_s}),zd=Hs.update({id:`/snmp`,path:`/snmp`,getParentRoute:()=>_s}),Bd=rc.update({id:`/notifications`,path:`/notifications`,getParentRoute:()=>_s}),Vd=pc.update({id:`/design`,path:`/design`,getParentRoute:()=>_s}),Hd=hc.update({id:`/`,path:`/`,getParentRoute:()=>_s}),Ud=_c.update({id:`/docs/`,path:`/docs/`,getParentRoute:()=>_s}),Wd=vc.update({id:`/dashboard/`,path:`/dashboard/`,getParentRoute:()=>_s}),Gd=bc.update({id:`/admin/`,path:`/admin/`,getParentRoute:()=>_s}),Kd=Sc.update({id:`/docs/$slug`,path:`/docs/$slug`,getParentRoute:()=>_s}),qd=Mc.update({id:`/dashboard/settings`,path:`/dashboard/settings`,getParentRoute:()=>_s}),Jd=Fc.update({id:`/dashboard/servicenow`,path:`/dashboard/servicenow`,getParentRoute:()=>_s}),Yd=Lc.update({id:`/dashboard/s3`,path:`/dashboard/s3`,getParentRoute:()=>_s}),Xd=zc.update({id:`/dashboard/integrations`,path:`/dashboard/integrations`,getParentRoute:()=>_s}),Zd=Vc.update({id:`/admin/settings`,path:`/admin/settings`,getParentRoute:()=>_s}),Qd=Gc.update({id:`/admin/governance`,path:`/admin/governance`,getParentRoute:()=>_s}),$d=Jc.update({id:`/dashboard/runs/`,path:`/dashboard/runs/`,getParentRoute:()=>_s}),ef=Zc.update({id:`/dashboard/forward/`,path:`/dashboard/forward/`,getParentRoute:()=>_s}),tf=el.update({id:`/dashboard/docs/`,path:`/dashboard/docs/`,getParentRoute:()=>_s}),nf=nl.update({id:`/dashboard/deployments/`,path:`/dashboard/deployments/`,getParentRoute:()=>_s}),rf=ol.update({id:`/dashboard/runs/$runId`,path:`/dashboard/runs/$runId`,getParentRoute:()=>_s}),af=Al.update({id:`/dashboard/labs/map`,path:`/dashboard/labs/map`,getParentRoute:()=>_s}),of=Rl.update({id:`/dashboard/labs/designer`,path:`/dashboard/labs/designer`,getParentRoute:()=>_s}),sf=Kl.update({id:`/dashboard/forward/credentials`,path:`/dashboard/forward/credentials`,getParentRoute:()=>_s}),cf=Yl.update({id:`/dashboard/forward/collector`,path:`/dashboard/forward/collector`,getParentRoute:()=>_s}),lf=Zl.update({id:`/dashboard/forward/cluster`,path:`/dashboard/forward/cluster`,getParentRoute:()=>_s}),uf=zu.update({id:`/dashboard/forward/analytics`,path:`/dashboard/forward/analytics`,getParentRoute:()=>_s}),df=Gu.update({id:`/dashboard/docs/$slug`,path:`/dashboard/docs/$slug`,getParentRoute:()=>_s}),ff=dd.update({id:`/dashboard/deployments/new`,path:`/dashboard/deployments/new`,getParentRoute:()=>_s}),pf=hd.update({id:`/dashboard/deployments/$deploymentId/`,path:`/dashboard/deployments/$deploymentId/`,getParentRoute:()=>_s}),mf=yd.update({id:`/dashboard/deployments/$deploymentId/map`,path:`/dashboard/deployments/$deploymentId/map`,getParentRoute:()=>_s}),hf={IndexRoute:Hd,DesignRoute:Vd,NotificationsRoute:Bd,SnmpRoute:zd,StatusRoute:Rd,SyslogRoute:Ld,WebhooksRoute:Id,AdminGovernanceRoute:Qd,AdminSettingsRoute:Zd,DashboardIntegrationsRoute:Xd,DashboardS3Route:Yd,DashboardServicenowRoute:Jd,DashboardSettingsRoute:qd,DocsSlugRoute:Kd,AdminIndexRoute:Gd,DashboardIndexRoute:Wd,DocsIndexRoute:Ud,DashboardDeploymentsNewRoute:ff,DashboardDocsSlugRoute:df,DashboardForwardAnalyticsRoute:uf,DashboardForwardClusterRoute:lf,DashboardForwardCollectorRoute:cf,DashboardForwardCredentialsRoute:sf,DashboardLabsDesignerRoute:of,DashboardLabsMapRoute:af,DashboardRunsRunIdRoute:rf,DashboardDeploymentsIndexRoute:nf,DashboardDocsIndexRoute:tf,DashboardForwardIndexRoute:ef,DashboardRunsIndexRoute:$d,DashboardDeploymentsDeploymentIdCapacityRoute:Cd.update({id:`/dashboard/deployments/$deploymentId/capacity`,path:`/dashboard/deployments/$deploymentId/capacity`,getParentRoute:()=>_s}),DashboardDeploymentsDeploymentIdMapRoute:mf,DashboardDeploymentsDeploymentIdIndexRoute:pf};const gf=f({routeTree:_s._addFileChildren(hf)._addFileTypes(),defaultPreload:`intent`,defaultPreloadDelay:50,context:{queryClient:void 0}});var _f=new a({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1,staleTime:1e4}}});Xn.createRoot(document.getElementById(`root`)).render((0,P.jsx)(M.StrictMode,{children:(0,P.jsx)(d,{client:_f,children:(0,P.jsx)(l,{router:gf,context:{queryClient:_f}})})}));