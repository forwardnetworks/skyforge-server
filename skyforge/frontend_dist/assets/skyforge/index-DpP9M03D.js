import{a as e}from"./rolldown-runtime-DAKAggwm.js";import{$ as t,$t as n,A as r,An as i,At as a,B as o,Bn as s,Bt as c,C as l,Cn as u,Ct as d,D as f,Dn as p,Dt as m,E as h,En as g,Et as _,F as ee,Fn as v,Ft as y,G as b,Gn as te,Gt as x,H as ne,Hn as S,Ht as C,I as re,In as ie,It as ae,J as w,Jt as T,K as oe,Kn as E,Kt as se,L as ce,Ln as le,Lt as ue,M as de,Mn as fe,Mt as pe,N as me,Nn as he,Nt as ge,O as _e,On as ve,Ot as ye,P as be,Pn as xe,Pt as D,Q as Se,Qn as Ce,Qt as we,R as Te,Rn as Ee,Rt as De,S as Oe,Sn as ke,St as Ae,T as je,Tn as Me,Tt as Ne,U as Pe,Un as Fe,Ut as Ie,V as Le,Vn as Re,Vt as O,W as ze,Wn as Be,Wt as Ve,X as He,Xn as Ue,Xt as We,Y as Ge,Yn as Ke,Yt as qe,Z as Je,Zt as Ye,_ as Xe,_n as Ze,_t as Qe,a as $e,an as et,at as tt,b as nt,bn as rt,bt as it,c as at,cn as ot,ct as st,d as ct,dn as lt,dt as ut,en as dt,et as ft,f as pt,fn as mt,ft as ht,g as gt,gn as _t,gt as vt,h as yt,hn as bt,ht as xt,i as St,in as Ct,it as wt,j as Tt,jn as Et,jt as Dt,k as Ot,kn as kt,kt as At,l as jt,ln as Mt,lt as Nt,m as Pt,mn as Ft,mt as It,n as Lt,nn as Rt,nt as k,o as zt,on as Bt,ot as Vt,p as Ht,pn as Ut,pt as Wt,q as Gt,qn as Kt,qt,r as Jt,rn as Yt,rt as Xt,s as Zt,sn as Qt,st as $t,t as en,tn,tt as nn,u as rn,un as an,ut as on,v as sn,vn as cn,vt as ln,w as un,wn as dn,wt as fn,x as pn,xn as mn,xt as hn,y as gn,yn as _n,yt as vn,z as yn,zn as bn,zt as xn}from"./react-DZOyTRAJ.js";import{a as Sn,c as Cn,d as wn,f as Tn,i as En,l as Dn,m as On,n as A,o as kn,p as An,r as jn,s as Mn,t as j,u as Nn}from"./tanstack-Dzy0OqW0.js";import{n as Pn,r as Fn,t as In}from"./ui-utils-l2x0dF3k.js";import{a as Ln,c as Rn,i as zn,l as Bn,n as Vn,o as Hn,r as Un,s as Wn,t as Gn}from"./vendor-EXe299qw.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var Kn=e(Ue(),1),M=e(Ce(),1);const qn=`/api`;function Jn(e){let t=e.startsWith(`/`)?e:`/`;return`${qn}/oidc/login?next=${encodeURIComponent(t)}`}var Yn=class extends Error{status;bodyText;constructor(e,t,n){super(e),this.name=`ApiError`,this.status=t,this.bodyText=n}};async function N(e,t){let n=(t?.method??`GET`).toUpperCase(),r=await fetch(`${e}`,{credentials:`include`,...t,headers:{"Content-Type":`application/json`,...t?.headers??{}}});if(r.status===401){let e=await r.text().catch(()=>``);if(n===`GET`&&typeof window<`u`){let e=window.location.pathname+(window.location.search??``);window.location.href=Jn(e)}throw new Yn(`unauthorized`,r.status,e)}if(r.status===403){let e=await r.text().catch(()=>``);throw new Yn(`forbidden`,r.status,e)}if(!r.ok){let e=await r.text().catch(()=>``);throw new Yn(`request failed (${r.status})`,r.status,e)}return r.status===204?{}:await r.json()}async function Xn(){return N(`/api/session`)}async function Zn(){let e=await fetch(`/auth/logout`,{method:`POST`,credentials:`include`,headers:{"Content-Type":`application/json`},body:`{}`});if(!e.ok){let t=await e.text().catch(()=>``);throw Error(`logout failed (${e.status}): ${t}`)}}async function Qn(){return N(`/api/workspaces`)}async function $n(){return N(`/api/dashboard/snapshot`)}async function er(e,t){let n=new URLSearchParams;t?.include_read&&n.set(`include_read`,t.include_read),t?.limit&&n.set(`limit`,t.limit);let r=n.toString();return N(`/notifications/for-user/${encodeURIComponent(e)}${r?`?${r}`:``}`)}async function tr(e){return N(`/notifications/for-user/${encodeURIComponent(e)}/read-all`,{method:`PUT`})}async function nr(e){return N(`/notifications/single/${encodeURIComponent(e)}/read`,{method:`PUT`})}async function rr(e){return N(`/notifications/single/${encodeURIComponent(e)}`,{method:`DELETE`})}async function ir(e){return N(`/api/workspaces/${encodeURIComponent(e)}/netlab/servers`)}async function ar(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/netlab/servers`,{method:`PUT`,body:JSON.stringify(t)})}async function or(e,t){await N(`/api/workspaces/${encodeURIComponent(e)}/netlab/servers/${encodeURIComponent(t)}`,{method:`DELETE`})}async function sr(e){return N(`/api/workspaces/${encodeURIComponent(e)}/eve/servers`)}async function cr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/eve/servers`,{method:`PUT`,body:JSON.stringify(t)})}async function lr(e,t){await N(`/api/workspaces/${encodeURIComponent(e)}/eve/servers/${encodeURIComponent(t)}`,{method:`DELETE`})}async function ur(){return N(`/api/user/git-credentials`)}async function dr(e){return N(`/api/user/git-credentials`,{method:`PUT`,body:JSON.stringify(e)})}async function fr(){return N(`/api/user/git-credentials/rotate`,{method:`POST`,body:`{}`})}async function pr(e,t,n){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/forward`,{method:`PUT`,body:JSON.stringify(n)})}async function mr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/forward/sync`,{method:`POST`,body:`{}`})}async function hr(e,t,n){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/links/impair`,{method:`POST`,body:JSON.stringify(n)})}async function gr(e,t,n){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/links/admin`,{method:`POST`,body:JSON.stringify(n)})}async function _r(e,t,n){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/links/capture`,{method:`POST`,body:JSON.stringify(n)})}async function vr(e,t,n){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/nodes/${encodeURIComponent(n)}/interfaces`)}async function yr(e,t,n){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/nodes/${encodeURIComponent(n)}/running-config`)}async function br(e,t,n=`json`){let r=new URLSearchParams;return r.set(`format`,n),N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/inventory?${r.toString()}`)}async function xr(e,t,n,r){let i=new URLSearchParams;r?.tail&&i.set(`tail`,String(r.tail)),r?.container&&i.set(`container`,r.container);let a=i.toString();return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/nodes/${encodeURIComponent(n)}/logs${a?`?${a}`:``}`)}async function Sr(e,t,n){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/nodes/${encodeURIComponent(n)}/describe`)}async function Cr(e,t,n){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/nodes/${encodeURIComponent(n)}/save-config`,{method:`POST`,body:`{}`})}async function wr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/links/stats`)}async function Tr(e,t){let n=new URLSearchParams;t?.source&&n.set(`source`,t.source),t?.repo&&n.set(`repo`,t.repo),t?.dir&&n.set(`dir`,t.dir);let r=n.toString();return N(`/api/workspaces/${encodeURIComponent(e)}/netlab/templates${r?`?${r}`:``}`)}async function Er(e,t){let n=new URLSearchParams;return t.source&&n.set(`source`,t.source),t.repo&&n.set(`repo`,t.repo),t.dir&&n.set(`dir`,t.dir),n.set(`template`,t.template),N(`/api/workspaces/${encodeURIComponent(e)}/netlab/template?${n.toString()}`)}async function Dr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/netlab/validate`,{method:`POST`,body:JSON.stringify(t)})}async function Or(e,t){let n=new URLSearchParams;t?.source&&n.set(`source`,t.source),t?.repo&&n.set(`repo`,t.repo),t?.dir&&n.set(`dir`,t.dir);let r=n.toString();return N(`/api/workspaces/${encodeURIComponent(e)}/containerlab/templates${r?`?${r}`:``}`)}async function kr(e,t){let n=new URLSearchParams;t?.source&&n.set(`source`,t.source),t?.repo&&n.set(`repo`,t.repo),t?.dir&&n.set(`dir`,t.dir);let r=n.toString();return N(`/api/workspaces/${encodeURIComponent(e)}/terraform/templates${r?`?${r}`:``}`)}async function Ar(e,t){let n=new URLSearchParams;return t.source&&n.set(`source`,t.source),t.repo&&n.set(`repo`,t.repo),t.dir&&n.set(`dir`,t.dir),n.set(`file`,t.file),N(`/api/workspaces/${encodeURIComponent(e)}/containerlab/template?${n.toString()}`)}async function jr(e,t){let n=new URLSearchParams;t?.source&&n.set(`source`,t.source),t?.repo&&n.set(`repo`,t.repo),t?.dir&&n.set(`dir`,t.dir);let r=n.toString();return N(`/api/workspaces/${encodeURIComponent(e)}/labpp/templates${r?`?${r}`:``}`)}async function Mr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments`,{method:`POST`,body:JSON.stringify(t)})}async function Nr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/containerlab/topologies`,{method:`POST`,body:JSON.stringify(t)})}async function Pr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments-designer/clabernetes/from-template`,{method:`POST`,body:JSON.stringify(t)})}async function Fr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments-designer/containerlab/from-template`,{method:`POST`,body:JSON.stringify(t)})}async function Ir(e){return N(`/api/workspaces`,{method:`POST`,body:JSON.stringify(e)})}async function Lr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/members`,{method:`PUT`,body:JSON.stringify(t)})}async function Rr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/topology`)}async function zr(e){let t=new URLSearchParams;e?.q&&t.set(`q`,e.q),e?.n&&t.set(`n`,String(e.n));let n=t.toString();return N(`/api/registry/repos${n?`?${n}`:``}`)}async function Br(e,t){let n=new URLSearchParams;t?.q&&n.set(`q`,t.q);let r=n.toString();return N(`/api/registry/repos/${encodeURIComponent(e)}/tags${r?`?${r}`:``}`)}async function Vr(e,t){let n=new URLSearchParams;return n.set(`confirm`,t.confirm),t.force&&n.set(`force`,`true`),N(`/api/workspaces/${encodeURIComponent(e)}?${n.toString()}`,{method:`DELETE`})}async function Hr(){return N(`/api/forward/collector-configs`)}async function Ur(e){return N(`/api/forward/collector-configs`,{method:`POST`,body:JSON.stringify(e)})}async function Wr(e){return N(`/api/forward/collector-configs/${encodeURIComponent(e)}`,{method:`DELETE`})}async function Gr(e,t){let n=new URLSearchParams;t&&t>0&&n.set(`tail`,String(t));let r=n.toString();return N(`/api/forward/collector-configs/${encodeURIComponent(e)}/logs${r?`?${r}`:``}`)}async function Kr(e){return N(`/api/forward/collector-configs/${encodeURIComponent(e)}/restart`,{method:`POST`,body:`{}`})}async function qr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/settings`,{method:`PUT`,body:JSON.stringify(t)})}async function Jr(e,t){let n=new URLSearchParams;t?.prefix&&n.set(`prefix`,t.prefix),t?.limit&&n.set(`limit`,t.limit);let r=n.toString();return N(`/api/workspaces/${encodeURIComponent(e)}/artifacts${r?`?${r}`:``}`)}async function Yr(e,t){let n=new URLSearchParams({key:t});return N(`/api/workspaces/${encodeURIComponent(e)}/artifacts/download?${n.toString()}`)}async function Xr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/artifacts/object`,{method:`POST`,body:JSON.stringify(t)})}async function Zr(e,t){let n=new URLSearchParams({key:t});return N(`/api/workspaces/${encodeURIComponent(e)}/artifacts/object?${n.toString()}`,{method:`DELETE`})}async function Qr(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/artifacts/folder`,{method:`POST`,body:JSON.stringify({prefix:t})})}async function $r(){return N(`/api/pki/root`)}async function ei(){return N(`/api/pki/ssh/root`)}async function ti(){return N(`/api/pki/certs`)}async function ni(){return N(`/api/pki/ssh/certs`)}async function ri(e){return N(`/api/pki/issue`,{method:`POST`,body:JSON.stringify(e)})}async function ii(e){return N(`/api/pki/ssh/issue`,{method:`POST`,body:JSON.stringify(e)})}async function ai(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit),e?.before_id&&t.set(`before_id`,e.before_id);let n=t.toString();return N(`/api/webhooks/events${n?`?${n}`:``}`)}async function oi(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit),e?.before_id&&t.set(`before_id`,e.before_id),e?.source_ip&&t.set(`source_ip`,e.source_ip),e?.unassigned&&t.set(`unassigned`,e.unassigned);let n=t.toString();return N(`/api/syslog/events${n?`?${n}`:``}`)}async function si(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit),e?.before_id&&t.set(`before_id`,e.before_id);let n=t.toString();return N(`/api/snmp/traps/events${n?`?${n}`:``}`)}async function ci(){return N(`/api/admin/governance/summary`)}async function li(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit);let n=t.toString();return N(`/api/admin/governance/resources${n?`?${n}`:``}`)}async function ui(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit);let n=t.toString();return N(`/api/admin/governance/costs${n?`?${n}`:``}`)}async function di(e){let t=new URLSearchParams;e?.limit&&t.set(`limit`,e.limit);let n=t.toString();return N(`/api/admin/governance/usage${n?`?${n}`:``}`)}async function fi(){await N(`/api/admin/governance/sync`,{method:`POST`,body:`{}`})}async function pi(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/start`,{method:`POST`,body:`{}`})}async function mi(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/stop`,{method:`POST`,body:`{}`})}async function hi(e,t,n){let r=new URLSearchParams;n?.forwardDelete&&r.set(`forward_delete`,`true`);let i=r.toString();return N(`/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}${i?`?${i}`:``}`,{method:`DELETE`})}async function gi(){return N(`/api/ui/config`)}async function _i(){return N(`/status/summary`)}async function vi(e,t){let n=new URLSearchParams;return t&&n.set(`workspace_id`,t),N(`/api/runs/${encodeURIComponent(String(e))}/cancel${n.toString()?`?${n.toString()}`:``}`,{method:`POST`,body:`{}`})}async function yi(e){return N(`/api/workspaces/${encodeURIComponent(e)}/variable-groups`)}async function bi(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/variable-groups`,{method:`POST`,body:JSON.stringify(t)})}async function xi(e,t,n){return N(`/api/workspaces/${encodeURIComponent(e)}/variable-groups/${encodeURIComponent(t)}`,{method:`PUT`,body:JSON.stringify(n)})}async function Si(e,t){return N(`/api/workspaces/${encodeURIComponent(e)}/variable-groups/${encodeURIComponent(t)}`,{method:`DELETE`})}async function Ci(){try{let e=await fetch(`/api/session`,{credentials:`include`,headers:{"Content-Type":`application/json`}});return e.ok?await e.json():null}catch{return null}}async function wi(e){if(typeof window>`u`)return!1;let t=e.pollIntervalMs??750,n=e.timeoutMs??2*6e4;if((await Ci())?.authenticated)return!0;let r=Math.max(0,Math.floor((window.screen.width-520)/2)),i=Math.max(0,Math.floor((window.screen.height-720)/2)),a=[`popup=yes`,`width=520`,`height=720`,`left=${r}`,`top=${i}`].join(`,`),o=window.open(e.loginHref,`skyforge_login`,a);if(!o)return!1;try{o.focus()}catch{}return await new Promise(e=>{let r=Date.now(),i=window.setInterval(async()=>{try{if(o.closed){window.clearInterval(i),e(!1);return}if(Date.now()-r>n){window.clearInterval(i);try{o.close()}catch{}e(!1);return}if((await Ci())?.authenticated){window.clearInterval(i);try{o.close()}catch{}e(!0)}}catch{}},t)})}function P(...e){return Pn(Fn(e))}var F=Ke(),Ti=Ae,Ei=m,Di=M.forwardRef(({className:e,inset:t,children:n,...r},i)=>(0,F.jsxs)(_,{ref:i,className:P(`flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent`,t&&`pl-8`,e),...r,children:[n,(0,F.jsx)(le,{className:`ml-auto h-4 w-4`})]}));Di.displayName=_.displayName;var Oi=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Ne,{ref:n,className:P(`z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2`,e),...t}));Oi.displayName=Ne.displayName;var ki=M.forwardRef(({className:e,sideOffset:t=4,...n},r)=>(0,F.jsx)(vn,{children:(0,F.jsx)(It,{ref:r,sideOffset:t,className:P(`z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2`,e),...n})}));ki.displayName=It.displayName;var Ai=M.forwardRef(({className:e,inset:t,...n},r)=>(0,F.jsx)(vt,{ref:r,className:P(`relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50`,t&&`pl-8`,e),...n}));Ai.displayName=vt.displayName;var ji=M.forwardRef(({className:e,children:t,checked:n,...r},i)=>(0,F.jsxs)(Wt,{ref:i,className:P(`relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50`,e),checked:n,...r,children:[(0,F.jsx)(`span`,{className:`absolute left-2 flex h-3.5 w-3.5 items-center justify-center`,children:(0,F.jsx)(Qe,{children:(0,F.jsx)(s,{className:`h-4 w-4`})})}),t]}));ji.displayName=Wt.displayName;var Mi=M.forwardRef(({className:e,children:t,...n},r)=>(0,F.jsxs)(hn,{ref:r,className:P(`relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50`,e),...n,children:[(0,F.jsx)(`span`,{className:`absolute left-2 flex h-3.5 w-3.5 items-center justify-center`,children:(0,F.jsx)(Qe,{children:(0,F.jsx)(he,{className:`h-2 w-2 fill-current`})})}),t]}));Mi.displayName=hn.displayName;var Ni=M.forwardRef(({className:e,inset:t,...n},r)=>(0,F.jsx)(ln,{ref:r,className:P(`px-2 py-1.5 text-sm font-semibold`,t&&`pl-8`,e),...n}));Ni.displayName=ln.displayName;var Pi=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(d,{ref:n,className:P(`-mx-1 my-1 h-px bg-muted`,e),...t}));Pi.displayName=d.displayName;var Fi=({className:e,...t})=>(0,F.jsx)(`span`,{className:P(`ml-auto text-xs tracking-widest opacity-60`,e),...t});Fi.displayName=`DropdownMenuShortcut`;var Ii=[{label:`Dashboard`,href:`/`,icon:ot},{label:`Deployments`,href:`/dashboard/deployments`,icon:rt},{label:`Lab Designer`,href:`/dashboard/labs/designer`,icon:Ft,newTab:!0},{label:`Collector`,href:`/dashboard/forward`,icon:qe},{label:`S3`,href:`/dashboard/s3`,icon:Ie},{label:`SSOT`,href:``,icon:ve,children:[{label:`NetBox`,href:`/netbox/`,icon:dt,external:!0},{label:`Nautobot`,href:`/nautobot/`,icon:dt,external:!0}]},{label:`Webhooks`,href:`/webhooks`,icon:Dt},{label:`Syslog`,href:`/syslog`,icon:Ut},{label:`SNMP`,href:`/snmp`,icon:O},{label:`Git`,href:`/git/`,icon:_t,external:!0},{label:`DNS`,href:`${qn}/dns/sso?next=/dns/`,icon:dt,external:!0},{label:`Coder`,href:`/coder/launch`,icon:fe,external:!0},{label:`Coder Admin`,href:`/coder/`,icon:fe,external:!0,adminOnly:!0},{label:`API Testing`,href:`${qn}/yaade/sso`,icon:n,external:!0},{label:`Docs`,href:`/docs/`,icon:Fe,external:!0},{label:`Settings`,href:`/admin/settings`,icon:C,adminOnly:!0},{label:`Governance`,href:`/admin/governance`,icon:O,adminOnly:!0}];function Li(e){let t=An({select:e=>e.location.pathname}),[n,r]=(0,M.useState)({SSOT:!0}),i=`_blank`,a=`noreferrer noopener`,o=e=>!!e.external||!!e.newTab,s=e=>e?e===`/`?t===`/`:e.endsWith(`/`)?t.startsWith(e):t===e||t.startsWith(`${e}/`):!1,c=e=>{r(t=>({...t,[e]:!t[e]}))};return(0,F.jsx)(`nav`,{className:`grid items-start gap-2`,children:(0,F.jsxs)(`div`,{className:`space-y-2`,children:[e.collapsed?null:(0,F.jsx)(`h4`,{className:`px-3 text-xs font-semibold uppercase tracking-wide text-muted-foreground`,children:`Overview`}),(0,F.jsx)(`div`,{className:`grid gap-1`,children:Ii.filter(t=>t.adminOnly?!!e.isAdmin:!0).map(t=>{let r=t.icon;if(t.children){let o=t.children.some(e=>s(e.href)),l=n[t.label];return e.collapsed?(0,F.jsxs)(Ti,{children:[(0,F.jsx)(Ei,{asChild:!0,children:(0,F.jsx)(`button`,{className:P(`group flex items-center justify-center rounded-md px-2 py-2 text-sm font-medium transition-colors w-full`,`hover:bg-accent hover:text-accent-foreground`,o?`bg-accent text-accent-foreground`:`transparent`),title:t.label,children:(0,F.jsx)(r,{className:`h-5 w-5`})})}),(0,F.jsxs)(ki,{side:`right`,align:`start`,sideOffset:10,children:[(0,F.jsx)(Ni,{children:t.label}),(0,F.jsx)(Pi,{}),t.children.map(e=>(0,F.jsx)(Ai,{asChild:!0,children:e.external?(0,F.jsxs)(`a`,{href:e.href,target:i,rel:a,className:`flex items-center gap-2 cursor-pointer w-full`,children:[(0,F.jsx)(e.icon,{className:`h-4 w-4 mr-2`}),e.label]}):(0,F.jsxs)(wn,{to:e.href,className:`flex items-center gap-2 cursor-pointer w-full`,children:[(0,F.jsx)(e.icon,{className:`h-4 w-4 mr-2`}),e.label]})},e.href))]})]},t.label):(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsxs)(`button`,{onClick:()=>c(t.label),className:P(`group flex w-full items-center justify-between rounded-md px-3 py-2 text-sm font-medium transition-colors`,`hover:bg-accent hover:text-accent-foreground`,o?`text-foreground font-semibold`:`text-muted-foreground`),children:[(0,F.jsxs)(`div`,{className:`flex items-center`,children:[(0,F.jsx)(r,{className:`mr-2 h-4 w-4`}),(0,F.jsx)(`span`,{children:t.label})]}),l?(0,F.jsx)(bn,{className:`h-4 w-4 opacity-50`}):(0,F.jsx)(le,{className:`h-4 w-4 opacity-50`})]}),l&&(0,F.jsx)(`div`,{className:`grid gap-1 pl-4 border-l ml-4 border-border/50`,children:t.children.map(e=>{let t=s(e.href),n=e.icon,r=P(`group flex items-center rounded-md px-3 py-2 text-sm font-medium transition-colors`,`hover:bg-accent hover:text-accent-foreground`,t?`bg-accent text-accent-foreground`:`text-muted-foreground`);return e.external?(0,F.jsxs)(`a`,{href:e.href,target:i,rel:a,className:r,children:[(0,F.jsx)(n,{className:`mr-2 h-4 w-4 opacity-70 group-hover:opacity-100`}),(0,F.jsx)(`span`,{children:e.label})]},e.href):(0,F.jsxs)(wn,{to:e.href,className:r,children:[(0,F.jsx)(n,{className:`mr-2 h-4 w-4 opacity-70 group-hover:opacity-100`}),(0,F.jsx)(`span`,{children:e.label})]},e.href)})})]},t.label)}let l=P(`group flex items-center rounded-md px-3 py-2 text-sm font-medium transition-colors`,`hover:bg-accent hover:text-accent-foreground`,s(t.href)?`bg-accent`:`transparent`,e.collapsed&&`justify-center px-2`),u=P(`transition-transform duration-200 group-hover:scale-110 group-hover:text-primary`,e.collapsed?`h-5 w-5`:`mr-2 h-4 w-4`);return t.external?(0,F.jsxs)(`a`,{href:t.href,target:i,rel:a,className:l,title:e.collapsed?t.label:void 0,children:[(0,F.jsx)(r,{className:u}),e.collapsed?null:(0,F.jsx)(`span`,{children:t.label})]},t.href):(0,F.jsxs)(wn,{to:t.href,className:l,title:e.collapsed?t.label:void 0,target:o(t)?i:void 0,rel:o(t)?a:void 0,children:[(0,F.jsx)(r,{className:u}),e.collapsed?null:(0,F.jsx)(`span`,{children:t.label})]},t.href)})})]})})}var Ri=on,zi=Nt,Bi=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(st,{ref:n,className:P(`fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0`,e),...t}));Bi.displayName=st.displayName;var Vi=M.forwardRef(({className:e,children:t,...n},r)=>(0,F.jsxs)(zi,{children:[(0,F.jsx)(Bi,{}),(0,F.jsxs)(Vt,{ref:r,className:P(`fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg`,e),...n,children:[t,(0,F.jsxs)(tt,{className:`absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground`,children:[(0,F.jsx)(At,{className:`h-4 w-4`}),(0,F.jsx)(`span`,{className:`sr-only`,children:`Close`})]})]})]}));Vi.displayName=Vt.displayName;var Hi=({className:e,...t})=>(0,F.jsx)(`div`,{className:P(`flex flex-col space-y-1.5 text-center sm:text-left`,e),...t});Hi.displayName=`DialogHeader`;var Ui=({className:e,...t})=>(0,F.jsx)(`div`,{className:P(`flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2`,e),...t});Ui.displayName=`DialogFooter`;var Wi=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(ut,{ref:n,className:P(`text-lg font-semibold leading-none tracking-tight`,e),...t}));Wi.displayName=ut.displayName;var Gi=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)($t,{ref:n,className:P(`text-sm text-muted-foreground`,e),...t}));Gi.displayName=$t.displayName;var Ki=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Xt,{ref:n,className:P(`flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground`,e),...t}));Ki.displayName=Xt.displayName;var qi=({children:e,...t})=>(0,F.jsx)(Ri,{...t,children:(0,F.jsx)(Vi,{className:`overflow-hidden p-0 shadow-lg`,children:(0,F.jsx)(Ki,{className:`[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5`,children:e})})}),Ji=M.forwardRef(({className:e,...t},n)=>(0,F.jsxs)(`div`,{className:`flex items-center border-b px-3`,"cmdk-input-wrapper":``,children:[(0,F.jsx)(Ve,{className:`mr-2 h-4 w-4 shrink-0 opacity-50`}),(0,F.jsx)(Xt.Input,{ref:n,className:P(`flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50`,e),...t})]}));Ji.displayName=Xt.Input.displayName;var Yi=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Xt.List,{ref:n,className:P(`max-h-[300px] overflow-y-auto overflow-x-hidden`,e),...t}));Yi.displayName=Xt.List.displayName;var Xi=M.forwardRef((e,t)=>(0,F.jsx)(Xt.Empty,{ref:t,className:`py-6 text-center text-sm`,...e}));Xi.displayName=Xt.Empty.displayName;var Zi=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Xt.Group,{ref:n,className:P(`overflow-hidden p-1 text-popover-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground`,e),...t}));Zi.displayName=Xt.Group.displayName;var Qi=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Xt.Separator,{ref:n,className:P(`-mx-1 h-px bg-border`,e),...t}));Qi.displayName=Xt.Separator.displayName;var $i=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Xt.Item,{ref:n,className:P(`relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50`,e),...t}));$i.displayName=Xt.Item.displayName;var ea=({className:e,...t})=>(0,F.jsx)(`span`,{className:P(`ml-auto text-xs tracking-widest text-muted-foreground`,e),...t});ea.displayName=`CommandShortcut`;function ta(){let[e,t]=M.useState(!1),n=Tn();M.useEffect(()=>{let e=e=>{e.key===`k`&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),t(e=>!e))};return document.addEventListener(`keydown`,e),()=>document.removeEventListener(`keydown`,e)},[]);let r=M.useCallback(e=>{t(!1),e()},[]);return(0,F.jsxs)(qi,{open:e,onOpenChange:t,children:[(0,F.jsx)(Ji,{placeholder:`Type a command or search...`}),(0,F.jsxs)(Yi,{children:[(0,F.jsx)(Xi,{children:`No results found.`}),(0,F.jsxs)(Zi,{heading:`Suggestions`,children:[(0,F.jsxs)($i,{onSelect:()=>r(()=>n({to:`/`})),children:[(0,F.jsx)(ot,{className:`mr-2 h-4 w-4`}),(0,F.jsx)(`span`,{children:`Dashboard`})]}),(0,F.jsxs)($i,{onSelect:()=>r(()=>n({to:`/dashboard/deployments`})),children:[(0,F.jsx)(rt,{className:`mr-2 h-4 w-4`}),(0,F.jsx)(`span`,{children:`Deployments`})]}),(0,F.jsxs)($i,{onSelect:()=>r(()=>n({to:`/status`})),children:[(0,F.jsx)(Kt,{className:`mr-2 h-4 w-4`}),(0,F.jsx)(`span`,{children:`Platform Status`})]})]}),(0,F.jsx)(Qi,{}),(0,F.jsx)(Zi,{heading:`Infrastructure`,children:(0,F.jsxs)($i,{onSelect:()=>r(()=>n({to:`/dashboard/s3`})),children:[(0,F.jsx)(Ie,{className:`mr-2 h-4 w-4`}),(0,F.jsx)(`span`,{children:`S3 Storage`})]})}),(0,F.jsx)(Qi,{}),(0,F.jsxs)(Zi,{heading:`Events & Monitoring`,children:[(0,F.jsxs)($i,{onSelect:()=>r(()=>n({to:`/notifications`})),children:[(0,F.jsx)(Be,{className:`mr-2 h-4 w-4`}),(0,F.jsx)(`span`,{children:`Notifications`})]}),(0,F.jsxs)($i,{onSelect:()=>r(()=>n({to:`/webhooks`})),children:[(0,F.jsx)(Dt,{className:`mr-2 h-4 w-4`}),(0,F.jsx)(`span`,{children:`Webhooks`})]}),(0,F.jsxs)($i,{onSelect:()=>r(()=>n({to:`/syslog`})),children:[(0,F.jsx)(Ut,{className:`mr-2 h-4 w-4`}),(0,F.jsx)(`span`,{children:`Syslog`})]}),(0,F.jsxs)($i,{onSelect:()=>r(()=>n({to:`/snmp`})),children:[(0,F.jsx)(O,{className:`mr-2 h-4 w-4`}),(0,F.jsx)(`span`,{children:`SNMP Traps`})]})]})]})]})}const I={session:()=>[`session`],uiConfig:()=>[`uiConfig`],dashboardSnapshot:()=>[`dashboardSnapshot`],statusSummary:()=>[`statusSummary`],runLogs:e=>[`runLogs`,e],deploymentTopology:(e,t)=>[`deploymentTopology`,e,t],deploymentUIEvents:(e,t)=>[`deploymentUIEvents`,e,t],workspaces:()=>[`workspaces`],workspaceForwardConfig:e=>[`workspaceForwardConfig`,e],workspaceForwardCollectors:e=>[`workspaceForwardCollectors`,e],forwardCollectors:()=>[`forwardCollectors`],userForwardCollector:()=>[`userForwardCollector`],userCollectorRuntime:()=>[`userCollectorRuntime`],userCollectorLogs:()=>[`userCollectorLogs`],userGitCredentials:()=>[`userGitCredentials`],userForwardCollectorConfigs:()=>[`userForwardCollectorConfigs`],userForwardCollectorConfigRuntime:e=>[`userForwardCollectorConfigRuntime`,e],userForwardCollectorConfigLogs:e=>[`userForwardCollectorConfigLogs`,e],storageFiles:()=>[`storageFiles`],workspaceArtifacts:e=>[`workspaceArtifacts`,e],workspaceEveServers:e=>[`workspaceEveServers`,e],workspaceNetlabServers:e=>[`workspaceNetlabServers`,e],notifications:(e,t)=>[`notifications`,e?`1`:`0`,t??``],syslogEvents:e=>[`syslogEvents`,e??``],snmpTrapEvents:e=>[`snmpTrapEvents`,e??``],workspaceTemplates:(e,t,n,r,i)=>[`workspaceTemplates`,e,t,n,r??``,i??``],pkiRoot:()=>[`pkiRoot`],pkiCerts:()=>[`pkiCerts`],pkiSshRoot:()=>[`pkiSshRoot`],pkiSshCerts:()=>[`pkiSshCerts`],webhookEvents:e=>[`webhookEvents`,e??``],notificationSettings:()=>[`notificationSettings`],governanceSummary:()=>[`governanceSummary`],governanceResources:e=>[`governanceResources`,e??``],governanceCosts:e=>[`governanceCosts`,e??``],governanceUsage:e=>[`governanceUsage`,e??``],registryRepos:e=>[`registryRepos`,e],registryTags:(e,t)=>[`registryTags`,e,t]};var na=({...e})=>(0,F.jsx)(nn,{className:`toaster group`,toastOptions:{classNames:{toast:`group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg`,description:`group-[.toast]:text-muted-foreground`,actionButton:`group-[.toast]:bg-primary group-[.toast]:text-primary-foreground`,cancelButton:`group-[.toast]:bg-muted group-[.toast]:text-muted-foreground`}},...e}),ra=In(`inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0`,{variants:{variant:{default:`bg-primary text-primary-foreground hover:bg-primary/90`,destructive:`bg-destructive text-destructive-foreground hover:bg-destructive/90`,outline:`border border-input bg-background hover:bg-accent hover:text-accent-foreground`,secondary:`bg-secondary text-secondary-foreground hover:bg-secondary/80`,ghost:`hover:bg-accent hover:text-accent-foreground`,link:`text-primary underline-offset-4 hover:underline`},size:{default:`h-10 px-4 py-2`,sm:`h-9 rounded-md px-3`,lg:`h-11 rounded-md px-8`,icon:`h-10 w-10`}},defaultVariants:{variant:`default`,size:`default`}}),L=M.forwardRef(({className:e,variant:t,size:n,...r},i)=>(0,F.jsx)(`button`,{className:P(ra({variant:t,size:n,className:e})),ref:i,...r}));L.displayName=`Button`;var ia=In(`rounded-lg border text-card-foreground shadow-sm`,{variants:{variant:{default:`bg-card`,elevated:`bg-card shadow-lg`,gradient:`bg-gradient-to-br from-card to-card/60`,glass:`bg-card/95 backdrop-blur supports-[backdrop-filter]:bg-card/60`,glow:`bg-card shadow-lg shadow-primary/10`,interactive:`bg-card hover:shadow-md transition-shadow cursor-pointer`,success:`border-green-500/50 bg-green-500/5`,warning:`border-amber-500/50 bg-amber-500/5`,danger:`border-red-500/50 bg-red-500/5`,info:`border-blue-500/50 bg-blue-500/5`,flat:`bg-card shadow-none`},size:{default:``,compact:`p-3`,comfortable:`p-6`}},defaultVariants:{variant:`default`,size:`default`}}),R=M.forwardRef(({className:e,variant:t,size:n,...r},i)=>(0,F.jsx)(`div`,{ref:i,className:P(ia({variant:t,size:n,className:e})),...r}));R.displayName=`Card`;var z=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`div`,{ref:n,className:P(`flex flex-col space-y-1.5 p-6`,e),...t}));z.displayName=`CardHeader`;var B=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`div`,{ref:n,className:P(`text-2xl font-semibold leading-none tracking-tight`,e),...t}));B.displayName=`CardTitle`;var V=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`div`,{ref:n,className:P(`text-sm text-muted-foreground`,e),...t}));V.displayName=`CardDescription`;var H=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`div`,{ref:n,className:P(`p-6 pt-0`,e),...t}));H.displayName=`CardContent`;var aa=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`div`,{ref:n,className:P(`flex items-center p-6 pt-0`,e),...t}));aa.displayName=`CardFooter`;var oa=(0,M.createContext)({theme:`system`,setTheme:()=>null});function sa({children:e,defaultTheme:t=`system`,storageKey:n=`vite-ui-theme`}){let[r,i]=(0,M.useState)(()=>localStorage.getItem(n)||t);(0,M.useEffect)(()=>{let e=window.document.documentElement;if(e.classList.remove(`light`,`dark`),r===`system`){let t=window.matchMedia(`(prefers-color-scheme: dark)`).matches?`dark`:`light`;e.classList.add(t);return}e.classList.add(r)},[r]);let a={theme:r,setTheme:e=>{localStorage.setItem(n,e),i(e)}};return(0,F.jsx)(oa.Provider,{value:a,children:e})}const ca=()=>{let e=(0,M.useContext)(oa);if(e===void 0)throw Error(`useTheme must be used within a ThemeProvider`);return e};function la(){let{setTheme:e}=ca();return(0,F.jsxs)(Ti,{children:[(0,F.jsx)(Ei,{asChild:!0,children:(0,F.jsxs)(L,{variant:`outline`,size:`icon`,children:[(0,F.jsx)(De,{className:`h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0`}),(0,F.jsx)(tn,{className:`absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100`}),(0,F.jsx)(`span`,{className:`sr-only`,children:`Toggle theme`})]})}),(0,F.jsxs)(ki,{align:`end`,children:[(0,F.jsx)(Ai,{onClick:()=>e(`light`),children:`Light`}),(0,F.jsx)(Ai,{onClick:()=>e(`dark`),children:`Dark`}),(0,F.jsx)(Ai,{onClick:()=>e(`system`),children:`System`})]})]})}var ua=on,da=ht,fa=Nt,pa=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(st,{className:P(`fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0`,e),...t,ref:n}));pa.displayName=st.displayName;var ma=In(`fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500`,{variants:{side:{top:`inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top`,bottom:`inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom`,left:`inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm`,right:`inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm`}},defaultVariants:{side:`right`}}),ha=M.forwardRef(({side:e=`right`,className:t,children:n,...r},i)=>(0,F.jsxs)(fa,{children:[(0,F.jsx)(pa,{}),(0,F.jsxs)(Vt,{ref:i,className:P(ma({side:e}),t),...r,children:[n,(0,F.jsxs)(tt,{className:`absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary`,children:[(0,F.jsx)(At,{className:`h-4 w-4`}),(0,F.jsx)(`span`,{className:`sr-only`,children:`Close`})]})]})]}));ha.displayName=Vt.displayName;var ga=({className:e,...t})=>(0,F.jsx)(`div`,{className:P(`flex flex-col space-y-2 text-center sm:text-left`,e),...t});ga.displayName=`SheetHeader`;var _a=({className:e,...t})=>(0,F.jsx)(`div`,{className:P(`flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2`,e),...t});_a.displayName=`SheetFooter`;var va=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(ut,{ref:n,className:P(`text-lg font-semibold text-foreground`,e),...t}));va.displayName=ut.displayName;var ya=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)($t,{ref:n,className:P(`text-sm text-muted-foreground`,e),...t}));ya.displayName=$t.displayName;var ba=M.forwardRef(({...e},t)=>(0,F.jsx)(`nav`,{ref:t,"aria-label":`breadcrumb`,...e}));ba.displayName=`Breadcrumb`;var xa=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`ol`,{ref:n,className:P(`flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5`,e),...t}));xa.displayName=`BreadcrumbList`;var Sa=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`li`,{ref:n,className:P(`inline-flex items-center gap-1.5`,e),...t}));Sa.displayName=`BreadcrumbItem`;var Ca=M.forwardRef(({asChild:e,className:t,...n},r)=>(0,F.jsx)(e?wt:`a`,{ref:r,className:P(`transition-colors hover:text-foreground`,t),...n}));Ca.displayName=`BreadcrumbLink`;var wa=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`span`,{ref:n,role:`link`,"aria-disabled":`true`,"aria-current":`page`,className:P(`font-normal text-foreground`,e),...t}));wa.displayName=`BreadcrumbPage`;var Ta=({children:e,className:t,...n})=>(0,F.jsx)(`li`,{role:`presentation`,"aria-hidden":`true`,className:P(`[&>svg]:size-3.5`,t),...n,children:e??(0,F.jsx)(le,{})});Ta.displayName=`BreadcrumbSeparator`;var Ea=({className:e,...t})=>(0,F.jsxs)(`span`,{role:`presentation`,"aria-hidden":`true`,className:P(`flex h-9 w-9 items-center justify-center`,e),...t,children:[(0,F.jsx)(Me,{className:`h-4 w-4`}),(0,F.jsx)(`span`,{className:`sr-only`,children:`More`})]});Ea.displayName=`BreadcrumbEllipsis`;function Da(){let e=An({select:e=>e.status===`pending`}),[t,n]=M.useState(!1);return M.useEffect(()=>{let t;return e?n(!0):t=setTimeout(()=>n(!1),500),()=>clearTimeout(t)},[e]),t?(0,F.jsx)(`div`,{className:P(`fixed top-0 left-0 z-[100] h-1 w-full bg-transparent overflow-hidden`),children:(0,F.jsx)(`div`,{className:P(`h-full w-full bg-primary/80 origin-left animate-progress`)})}):null}var Oa=new Map;function ka(e){let t=Oa.get(e);if(t)return t.refs+=1,t;let n=new EventSource(e,{withCredentials:!0});n.onerror=()=>{};let r={url:e,es:n,refs:1};return Oa.set(e,r),r}function Aa(e){let t=Oa.get(e);t&&(--t.refs,!(t.refs>0)&&(Oa.delete(e),t.es.close()))}function ja(e,t){let n=ka(e).es;for(let[e,r]of Object.entries(t))n.addEventListener(e,r);return{close:()=>{for(let[e,r]of Object.entries(t))n.removeEventListener(e,r);Aa(e)}}}function Ma(e,t,n){let r=En(),i=(0,M.useMemo)(()=>{let e=new URLSearchParams;return e.set(`include_read`,t?`true`:`false`),e.set(`limit`,n),`${qn}/notifications/events?${e.toString()}`},[t,n]);(0,M.useEffect)(()=>{if(!e)return;let a=ja(i,{snapshot:e=>{try{let i=JSON.parse(e.data);if(!i||!Array.isArray(i.notifications))return;r.setQueryData(I.notifications(t,n),i)}catch{}}});return()=>{a.close()}},[e,t,n,r,i])}const Na=Nn()({component:Pa,errorComponent:Ia,notFoundComponent:Fa});function Pa(){let e=An({select:e=>e.location}),t=Tn(),n=En(),[r,i]=(0,M.useState)(!1),[a,o]=(0,M.useState)(!1),[s,c]=(0,M.useState)(!1),[l,u]=(0,M.useState)(!1),d=(0,M.useMemo)(()=>e.pathname===`/dashboard/labs/designer`,[e.pathname]),f=(0,M.useMemo)(()=>d||e.pathname===`/dashboard/labs/map`,[d,e.pathname]);(0,M.useEffect)(()=>{d&&c(!0)},[d]),(0,M.useEffect)(()=>{window.location.pathname===`/index.html`&&t({to:`/`,replace:!0})},[t]);let p=A({queryKey:I.session(),queryFn:Xn,retry:!1,staleTime:3e4}),m=(0,M.useMemo)(()=>`${e.pathname}${e.searchStr??``}${e.hash??``}`,[e.pathname,e.searchStr,e.hash]),h=(0,M.useMemo)(()=>Jn(m),[m]),g=(0,M.useMemo)(()=>[`/dashboard`,`/admin`,`/webhooks`,`/syslog`,`/snmp`].some(t=>e.pathname.startsWith(t)),[e.pathname]);(0,M.useEffect)(()=>{u(!1)},[e.pathname]);let _=p.data?.displayName||p.data?.username||``,ee=!!p.data?.isAdmin,v=g&&!p.isLoading&&!p.data?.authenticated,y=p.data?.username??``;Ma(!!y,!1,`20`);let b=A({queryKey:I.notifications(!1,`20`),enabled:!!y,queryFn:async()=>({notifications:(await er(y,{include_read:`false`,limit:`20`})).notifications??[]}),staleTime:1/0,initialData:{notifications:[]}}),te=(0,M.useMemo)(()=>(b.data?.notifications??[]).filter(e=>!e.is_read).length,[b.data?.notifications]);return(0,F.jsx)(sa,{defaultTheme:`dark`,storageKey:`vite-ui-theme`,children:(0,F.jsxs)(`div`,{className:`min-h-full`,children:[(0,F.jsx)(Da,{}),(0,F.jsx)(`header`,{className:`sticky top-0 z-40 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60`,style:{backgroundImage:`linear-gradient(to right, rgba(0,0,0,0.8), rgba(0,0,0,0.4)), url('/assets/skyforge/header-background.png')`,backgroundSize:`cover`,backgroundPosition:`left 50%`,height:`120px`},children:(0,F.jsxs)(`div`,{className:`mx-auto flex h-full max-w-[1600px] items-center justify-between gap-4 px-4`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-6`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,F.jsxs)(ua,{open:l,onOpenChange:u,children:[(0,F.jsx)(da,{asChild:!0,children:(0,F.jsxs)(L,{variant:`ghost`,size:`icon`,className:`lg:hidden`,children:[(0,F.jsx)(Rt,{className:`h-5 w-5`}),(0,F.jsx)(`span`,{className:`sr-only`,children:`Toggle menu`})]})}),(0,F.jsx)(ha,{side:`left`,className:`w-[240px] p-0`,children:(0,F.jsx)(`div`,{className:`px-2 py-6`,children:(0,F.jsx)(Li,{collapsed:!1,isAdmin:ee})})})]}),(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`div`,{className:`text-[10px] uppercase tracking-wider text-muted-foreground leading-none`,children:`Technical Services`}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2 text-lg font-bold tracking-tight`,children:[(0,F.jsx)(E,{className:`h-5 w-5 text-orange-500`}),(0,F.jsx)(`span`,{children:`Skyforge`})]})]}),(0,F.jsx)(`div`,{className:`h-8 w-px bg-border hidden md:block`}),(0,F.jsx)(`img`,{src:`/assets/skyforge/FN-logo.svg`,alt:`Forward Networks`,className:`h-6 w-auto hidden sm:block`})]}),(0,F.jsxs)(L,{variant:`outline`,className:`hidden md:flex h-9 w-64 items-center justify-start px-3 text-sm text-muted-foreground font-normal`,onClick:()=>{let e=new KeyboardEvent(`keydown`,{key:`k`,metaKey:!0,bubbles:!0});document.dispatchEvent(e)},children:[(0,F.jsx)(Ve,{className:`mr-2 h-4 w-4`}),(0,F.jsx)(`span`,{children:`Search...`}),(0,F.jsxs)(`kbd`,{className:`pointer-events-none ml-auto inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100`,children:[(0,F.jsx)(`span`,{className:`text-xs`,children:`⌘`}),`K`]})]})]}),(0,F.jsxs)(`nav`,{className:`flex items-center gap-4 text-sm`,children:[(0,F.jsxs)(L,{variant:`ghost`,size:`icon`,className:`relative text-muted-foreground hover:text-foreground`,"aria-label":`Notifications`,onClick:()=>void t({to:`/notifications`}),children:[(0,F.jsx)(Be,{className:`h-4 w-4`}),te>0?(0,F.jsx)(`span`,{className:`absolute -right-1 -top-1 inline-flex h-4 min-w-[16px] items-center justify-center rounded-full bg-primary px-1 text-[10px] font-semibold text-primary-foreground`,children:te>99?`99+`:te}):null]}),(0,F.jsx)(la,{}),p.data?.authenticated?(0,F.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,F.jsxs)(`div`,{className:`hidden md:flex flex-col items-end`,children:[(0,F.jsx)(`span`,{className:`text-[10px] text-muted-foreground uppercase leading-none`,children:`Signed in as`}),(0,F.jsx)(`span`,{className:`text-xs font-medium leading-none mt-1`,children:_})]}),(0,F.jsx)(L,{variant:`outline`,size:`sm`,disabled:r,onClick:async()=>{try{i(!0),await Zn(),window.location.href=`/status?signin=1`}finally{i(!1)}},children:r?`…`:`Logout`})]}):(0,F.jsx)(L,{variant:`outline`,size:`sm`,disabled:a,onClick:async()=>{try{if(o(!0),!await wi({loginHref:h})){window.location.href=h;return}await n.invalidateQueries({queryKey:I.session()})}finally{o(!1)}},children:a?`…`:`Login`})]})]})}),(0,F.jsxs)(`div`,{className:P(`mx-auto flex min-h-[calc(100vh-64px)]`,f?`max-w-none`:`max-w-[1600px]`),children:[p.data?.authenticated&&(0,F.jsx)(`aside`,{className:P(`hidden lg:block border-r bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60`,`transition-all duration-300 ease-in-out`,s?`w-[64px]`:`w-[220px]`),children:(0,F.jsxs)(`div`,{className:`relative h-full`,children:[(0,F.jsx)(`div`,{className:P(`h-full px-4 py-4`,s&&`px-2`),children:(0,F.jsx)(Li,{collapsed:s,isAdmin:ee})}),(0,F.jsx)(`button`,{className:P(`absolute -right-3 top-4 flex h-7 w-7 items-center justify-center rounded-full border bg-background text-foreground shadow-sm`,`hover:bg-accent hover:text-accent-foreground transition-colors`),onClick:()=>c(e=>!e),"aria-label":s?`Expand navigation`:`Collapse navigation`,children:s?(0,F.jsx)(le,{className:`h-4 w-4`}):(0,F.jsx)(Ee,{className:`h-4 w-4`})})]})}),(0,F.jsx)(`main`,{className:P(`flex-1 w-full overflow-hidden flex flex-col`,f?`px-0 py-0`:`px-4 py-6`),children:v?(0,F.jsx)(`div`,{className:`mx-auto max-w-xl`,children:(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Login Required`}),(0,F.jsx)(V,{children:`Sign in to access this page.`})]}),(0,F.jsxs)(H,{className:`flex flex-col gap-3`,children:[(0,F.jsx)(L,{variant:`default`,disabled:a,onClick:async()=>{try{if(o(!0),!await wi({loginHref:h})){window.location.href=h;return}await n.invalidateQueries({queryKey:I.session()})}finally{o(!1)}},children:a?`…`:`Login`}),(0,F.jsx)(`a`,{className:`text-sm text-muted-foreground underline`,href:h,children:`Login with redirect instead`})]})]})}):(0,F.jsxs)(F.Fragment,{children:[f?null:(0,F.jsx)(`div`,{className:`mb-6`,children:(0,F.jsx)(ba,{children:(0,F.jsxs)(xa,{children:[(0,F.jsx)(Sa,{children:(0,F.jsx)(Ca,{href:`/`,children:`Dashboard`})}),`                    `,e.pathname.split(`/`).filter(Boolean).map((e,t,n)=>{let r=`/${n.slice(0,t+1).join(`/`)}`,i=t===n.length-1;return(0,F.jsxs)(M.Fragment,{children:[(0,F.jsx)(Ta,{}),(0,F.jsx)(Sa,{children:i?(0,F.jsx)(wa,{className:`capitalize`,children:e}):(0,F.jsx)(Ca,{href:r,className:`capitalize`,children:e})})]},r)})]})})}),(0,F.jsx)(Cn,{}),f?null:(0,F.jsxs)(`footer`,{className:`mt-auto pt-12 pb-6 flex items-center justify-between text-xs text-muted-foreground border-t`,children:[(0,F.jsx)(`div`,{className:`flex gap-4`,children:(0,F.jsxs)(`span`,{children:[`Questions? Reach out at `,(0,F.jsx)(`span`,{className:`font-mono text-primary`,children:`#ask-skyforge`})]})}),(0,F.jsx)(`a`,{className:`hover:text-foreground transition-colors underline hover:no-underline`,href:`/git/skyforge/skyforge/issues/new`,target:`_blank`,rel:`noreferrer`,children:`File an issue`})]})]})})]}),(0,F.jsx)(ta,{}),(0,F.jsx)(na,{})]})})}function Fa(){return(0,F.jsx)(`div`,{className:`flex flex-col items-center justify-center min-h-[50vh] space-y-4 text-center`,children:(0,F.jsxs)(R,{variant:`glass`,className:`max-w-md`,children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{className:`text-2xl`,children:`Page not found`}),(0,F.jsx)(V,{children:`This route hasn’t been migrated yet (or the URL is incorrect).`})]}),(0,F.jsxs)(H,{className:`flex flex-wrap justify-center gap-3`,children:[(0,F.jsx)(L,{variant:`default`,asChild:!0,children:(0,F.jsx)(wn,{to:`/dashboard/deployments`,children:`Go to deployments`})}),(0,F.jsx)(L,{variant:`outline`,asChild:!0,children:(0,F.jsx)(wn,{to:`/status`,children:`Platform status`})})]})]})})}function Ia(e){let t=e.error instanceof Error?e.error.message:typeof e.error==`string`?e.error:`Unknown error`;return(0,F.jsxs)(`div`,{className:`space-y-6`,children:[(0,F.jsxs)(R,{variant:`danger`,children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Application error`}),(0,F.jsx)(V,{className:`text-red-200/80`,children:t})]}),(0,F.jsxs)(H,{className:`flex flex-wrap gap-3`,children:[(0,F.jsx)(L,{variant:`outline`,className:`border-red-500/50 bg-red-500/10 hover:bg-red-500/20 text-red-100`,onClick:()=>e.reset(),children:`Try again`}),(0,F.jsx)(L,{variant:`secondary`,asChild:!0,children:(0,F.jsx)(wn,{to:`/dashboard/deployments`,children:`Go to deployments`})})]})]}),e.error instanceof Error&&e.error.stack&&(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{children:(0,F.jsx)(B,{className:`text-sm`,children:`Error Stack Trace`})}),(0,F.jsx)(H,{children:(0,F.jsx)(`pre`,{className:`overflow-auto whitespace-pre-wrap text-xs text-muted-foreground p-4 rounded-md bg-muted`,children:e.error.stack})})]})]})}function La(e,t){let n=En(),r=(0,M.useMemo)(()=>`${qn}/webhooks/events/stream?limit=${encodeURIComponent(t)}`,[t]);(0,M.useEffect)(()=>{if(!e)return;let i=ja(r,{snapshot:e=>{try{let r=JSON.parse(e.data);n.setQueryData(I.webhookEvents(t),r)}catch{}}});return()=>{i.close()}},[e,t,n,r])}var Ra=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`div`,{className:`relative w-full overflow-auto`,children:(0,F.jsx)(`table`,{ref:n,className:P(`w-full caption-bottom text-sm`,e),...t})}));Ra.displayName=`Table`;var za=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`thead`,{ref:n,className:P(`[&_tr]:border-b`,e),...t}));za.displayName=`TableHeader`;var Ba=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`tbody`,{ref:n,className:P(`[&_tr:last-child]:border-0`,e),...t}));Ba.displayName=`TableBody`;var Va=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`tfoot`,{ref:n,className:P(`border-t bg-muted/50 font-medium [&>tr]:last:border-b-0`,e),...t}));Va.displayName=`TableFooter`;var U=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`tr`,{ref:n,className:P(`border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted`,e),...t}));U.displayName=`TableRow`;var W=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`th`,{ref:n,className:P(`h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0`,e),...t}));W.displayName=`TableHead`;var G=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`td`,{ref:n,className:P(`p-4 align-middle [&:has([role=checkbox])]:pr-0`,e),...t}));G.displayName=`TableCell`;var Ha=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`caption`,{ref:n,className:P(`mt-4 text-sm text-muted-foreground`,e),...t}));Ha.displayName=`TableCaption`;function K({className:e,...t}){return(0,F.jsx)(`div`,{className:P(`animate-pulse rounded-md bg-muted`,e),...t})}function Ua({title:e,description:t,icon:n,action:r,className:i,...a}){return(0,F.jsx)(`div`,{className:P(`flex min-h-[400px] flex-col items-center justify-center rounded-md border border-dashed p-8 text-center animate-in fade-in zoom-in duration-300`,i),...a,children:(0,F.jsxs)(`div`,{className:`mx-auto flex max-w-[420px] flex-col items-center justify-center text-center`,children:[n&&(0,F.jsx)(`div`,{className:`flex h-20 w-20 items-center justify-center rounded-full bg-muted`,children:(0,F.jsx)(n,{className:`h-10 w-10 text-muted-foreground`})}),(0,F.jsx)(`h3`,{className:`mt-4 text-lg font-semibold`,children:e}),t&&(0,F.jsx)(`p`,{className:`mb-4 mt-2 text-sm text-muted-foreground`,children:t}),r&&(0,F.jsx)(L,{onClick:r.onClick,variant:`outline`,size:`sm`,children:r.label})]})})}const Wa=Dn(`/webhooks`)({component:Ga});function Ga(){La(!0,`200`);let e=A({queryKey:I.webhookEvents(`200`),queryFn:()=>ai({limit:`200`}),staleTime:1/0}),t=e.data?.events??[];return(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsx)(R,{variant:`glass`,children:(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Webhook inbox`}),(0,F.jsx)(V,{children:`Recent webhook events routed to your user.`})]})}),(0,F.jsx)(R,{children:(0,F.jsx)(H,{className:`p-0`,children:e.isLoading?(0,F.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,F.jsx)(K,{className:`h-12 w-full`}),(0,F.jsx)(K,{className:`h-12 w-full`}),(0,F.jsx)(K,{className:`h-12 w-full`})]}):e.isError?(0,F.jsx)(`div`,{className:`p-8 text-center text-destructive`,children:`Failed to load webhook events.`}):t.length===0?(0,F.jsx)(Ua,{icon:Ut,title:`No webhook events`,description:`No webhook events have been received yet.`}):(0,F.jsxs)(Ra,{children:[(0,F.jsx)(za,{children:(0,F.jsxs)(U,{children:[(0,F.jsx)(W,{className:`w-[180px]`,children:`Time`}),(0,F.jsx)(W,{className:`w-[140px]`,children:`Source`}),(0,F.jsx)(W,{children:`Event`}),(0,F.jsx)(W,{className:`w-[100px] text-right`,children:`ID`})]})}),(0,F.jsx)(Ba,{children:t.map(e=>(0,F.jsxs)(U,{children:[(0,F.jsx)(G,{className:`text-muted-foreground whitespace-nowrap text-xs`,children:e.receivedAt??``}),(0,F.jsx)(G,{children:e.sourceIp??``}),(0,F.jsxs)(G,{className:`font-medium text-sm`,children:[e.method,` `,e.path]}),(0,F.jsx)(G,{className:`font-mono text-xs text-muted-foreground text-right`,children:String(e.id)})]},String(e.id)))})]})})})]})}function Ka(e,t){let n=En(),r=(0,M.useMemo)(()=>`${qn}/syslog/events/stream?limit=${encodeURIComponent(t)}`,[t]);(0,M.useEffect)(()=>{if(!e)return;let i=ja(r,{snapshot:e=>{try{let r=JSON.parse(e.data);n.setQueryData(I.syslogEvents(t),r)}catch{}}});return()=>{i.close()}},[e,t,n,r])}const qa=Dn(`/syslog`)({component:Ja});function Ja(){Ka(!0,`200`);let e=A({queryKey:I.syslogEvents(`200`),queryFn:()=>oi({limit:`200`}),staleTime:1/0}),t=e.data?.events??[];return(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsx)(R,{variant:`glass`,children:(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Syslog inbox`}),(0,F.jsx)(V,{children:`Recent syslog events mapped to your user.`})]})}),(0,F.jsx)(R,{children:(0,F.jsx)(H,{className:`p-0`,children:e.isLoading?(0,F.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,F.jsx)(K,{className:`h-12 w-full`}),(0,F.jsx)(K,{className:`h-12 w-full`}),(0,F.jsx)(K,{className:`h-12 w-full`})]}):e.isError?(0,F.jsx)(`div`,{className:`p-8 text-center text-destructive`,children:`Failed to load syslog events.`}):t.length===0?(0,F.jsx)(Ua,{icon:Ut,title:`No syslog events`,description:`No syslog messages have been received yet.`}):(0,F.jsxs)(Ra,{children:[(0,F.jsx)(za,{children:(0,F.jsxs)(U,{children:[(0,F.jsx)(W,{className:`w-[180px]`,children:`Time`}),(0,F.jsx)(W,{className:`w-[140px]`,children:`Source`}),(0,F.jsx)(W,{className:`w-[140px]`,children:`App`}),(0,F.jsx)(W,{children:`Message`})]})}),(0,F.jsx)(Ba,{children:t.map(e=>(0,F.jsxs)(U,{children:[(0,F.jsx)(G,{className:`text-muted-foreground whitespace-nowrap text-xs`,children:e.receivedAt??``}),(0,F.jsx)(G,{className:`font-mono text-xs`,children:e.sourceIp??``}),(0,F.jsx)(G,{className:`text-xs`,children:e.appName??``}),(0,F.jsx)(G,{className:`font-medium text-foreground text-sm line-clamp-2`,children:e.message??``})]},String(e.id)))})]})})})]})}function Ya(e){let t=En(),n=(0,M.useMemo)(()=>`/status/summary/events`,[]);(0,M.useEffect)(()=>{if(!e)return;let r=ja(n,{snapshot:e=>{try{let n=JSON.parse(e.data);t.setQueryData(I.statusSummary(),n)}catch{}}});return()=>{r.close()}},[e,t,n])}var Xa=In(`inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2`,{variants:{variant:{default:`border-transparent bg-primary text-primary-foreground hover:bg-primary/80`,secondary:`border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80`,destructive:`border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80`,outline:`text-foreground`}},defaultVariants:{variant:`default`}});function Za({className:e,variant:t,...n}){return(0,F.jsx)(`div`,{className:P(Xa({variant:t}),e),...n})}var Qa={blue:`from-blue-500/10 via-blue-500/5 to-transparent`,green:`from-emerald-500/10 via-emerald-500/5 to-transparent`,purple:`from-purple-500/10 via-purple-500/5 to-transparent`,orange:`from-orange-500/10 via-orange-500/5 to-transparent`,red:`from-red-500/10 via-red-500/5 to-transparent`};const $a=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`div`,{ref:n,className:P(`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4`,e),...t}));$a.displayName=`BentoGrid`;const eo=M.forwardRef(({className:e,gradient:t=`blue`,children:n,...r},i)=>(0,F.jsx)(`div`,{ref:i,className:P(`relative overflow-hidden rounded-xl border border-border bg-card p-6`,`bg-gradient-to-br`,Qa[t],e),...r,children:n}));eo.displayName=`BentoItem`;const to=M.forwardRef(({title:e,value:t,gradient:n=`blue`,icon:r,subtitle:i,trend:a,className:o},s)=>(0,F.jsxs)(eo,{ref:s,gradient:n,className:o,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-2 mb-2`,children:[r&&(0,F.jsx)(`div`,{className:`text-muted-foreground`,children:r}),(0,F.jsx)(`h3`,{className:`text-sm font-medium text-muted-foreground/80`,children:e})]}),(0,F.jsxs)(`div`,{className:`flex items-end justify-between`,children:[(0,F.jsx)(`div`,{className:`text-3xl font-bold`,children:t}),a&&(0,F.jsxs)(`div`,{className:P(`flex items-center gap-1 text-sm`,a.direction===`up`?`text-emerald-500`:`text-red-500`),children:[a.direction===`up`?(0,F.jsx)(D,{className:`w-4 h-4`}):(0,F.jsx)(y,{className:`w-4 h-4`}),a.value,`%`]})]}),i&&(0,F.jsx)(`p`,{className:`text-xs text-muted-foreground/70 mt-2`,children:i})]}));to.displayName=`BentoStatCard`;const no=M.forwardRef(({userName:e,subtitle:t,className:n},r)=>(0,F.jsx)(eo,{ref:r,gradient:`purple`,className:P(`md:col-span-2`,n),children:(0,F.jsxs)(`div`,{className:`flex items-center gap-3 mb-3`,children:[(0,F.jsx)(`div`,{className:`p-2 rounded-full bg-purple-500/10`,children:(0,F.jsx)(pe,{className:`w-5 h-5 text-purple-500`})}),(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`h2`,{className:`text-xl font-bold`,children:e?`Welcome back, ${e}`:`Welcome to Skyforge`}),t&&(0,F.jsx)(`p`,{className:`text-sm text-muted-foreground/80`,children:t})]})]})}));no.displayName=`BentoWelcomeCard`;const ro=M.forwardRef(({actions:e,className:t},n)=>(0,F.jsxs)(eo,{ref:n,gradient:`blue`,className:P(`md:col-span-2`,t),children:[(0,F.jsx)(`h3`,{className:`font-semibold mb-4`,children:`Quick Actions`}),(0,F.jsx)(`div`,{className:`grid grid-cols-2 gap-3`,children:e.map((e,t)=>(0,F.jsxs)(ft.button,{onClick:e.onClick,className:`flex items-center gap-2 p-3 rounded-lg bg-muted/50 hover:bg-muted transition-colors text-left`,whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.icon,(0,F.jsx)(`span`,{className:`text-sm font-medium`,children:e.label})]},t))})]}));ro.displayName=`BentoQuickActions`;const io=M.forwardRef(({servers:e,className:t},n)=>(0,F.jsxs)(eo,{ref:n,gradient:`green`,className:P(`md:col-span-2`,t),children:[(0,F.jsx)(`h3`,{className:`font-semibold mb-4`,children:`Server Status`}),(0,F.jsx)(`div`,{className:`grid grid-cols-2 gap-3`,children:e.map((e,t)=>(0,F.jsxs)(`div`,{className:`flex items-center justify-between p-3 rounded-lg bg-muted/30`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(`div`,{className:P(`w-2 h-2 rounded-full`,e.status===`online`?`bg-emerald-500`:e.status===`degraded`?`bg-amber-500`:`bg-red-500`)}),(0,F.jsx)(`span`,{className:`text-sm font-medium`,children:e.name})]}),e.cpu!==void 0&&(0,F.jsxs)(Za,{variant:`secondary`,className:`text-xs`,children:[e.cpu,`%`]})]},t))})]}));io.displayName=`BentoServerStatus`;const ao=Dn(`/status`)({component:oo});function oo(){Ya(!0);let e=A({queryKey:I.statusSummary(),queryFn:_i,staleTime:1/0}),t=A({queryKey:I.uiConfig(),queryFn:gi,staleTime:1/0}),n=e.data,r=n?.checks??[],i=r.filter(e=>e.status!==`up`&&e.status!==`ok`);return(0,F.jsxs)(`div`,{className:`space-y-8 p-6`,children:[(0,F.jsxs)($a,{className:`gap-4`,children:[(0,F.jsx)(no,{subtitle:`Here's what's happening with your infrastructure today.`}),e.isLoading?(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(eo,{className:`h-32`,children:(0,F.jsx)(K,{className:`h-full w-full`})}),(0,F.jsx)(eo,{className:`h-32`,children:(0,F.jsx)(K,{className:`h-full w-full`})}),(0,F.jsx)(eo,{className:`h-32`,children:(0,F.jsx)(K,{className:`h-full w-full`})})]}):(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(to,{title:`Active Deployments`,value:n?.deploymentsActive??0,gradient:`green`,icon:(0,F.jsx)(fe,{className:`w-5 h-5`}),subtitle:`${n?.deploymentsTotal??0} total deployments`}),(0,F.jsx)(to,{title:`Services Operational`,value:`${n?.up??0} / ${r.length}`,gradient:n?.up===r.length?`green`:`orange`,icon:(0,F.jsx)(v,{className:`w-5 h-5`})}),(0,F.jsx)(to,{title:`Services Down`,value:n?.down??0,gradient:n?.down?`red`:`blue`,icon:(0,F.jsx)(Kt,{className:`w-5 h-5`})}),(0,F.jsxs)(eo,{gradient:`purple`,className:`relative overflow-hidden`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between mb-3`,children:[(0,F.jsxs)(`h3`,{className:`font-semibold flex items-center gap-2 text-sm text-muted-foreground/80`,children:[(0,F.jsx)(ye,{className:`w-4 h-4`}),`Platform Health`]}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsxs)(`span`,{className:`relative flex h-2 w-2`,children:[(0,F.jsx)(`span`,{className:`animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75`}),(0,F.jsx)(`span`,{className:`relative inline-flex rounded-full h-2 w-2 bg-emerald-500`})]}),(0,F.jsx)(`span`,{className:`text-xs text-muted-foreground`,children:`Live`})]})]}),(0,F.jsx)(`div`,{className:`flex items-end gap-4`,children:(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`span`,{className:P(`text-3xl font-bold`,n?.status===`ok`?`text-emerald-500`:n?.status===`degraded`?`text-amber-500`:`text-muted-foreground`),children:(n?.status??`checking`).toUpperCase()}),(0,F.jsx)(`p`,{className:`text-xs text-muted-foreground mt-1`,children:n?.timestamp?`Refreshed ${new Date(n.timestamp).toLocaleTimeString()}`:`Checking...`})]})})]})]})]}),(0,F.jsxs)(`div`,{className:`grid gap-4 md:grid-cols-3`,children:[t.data?.externalUrl&&(0,F.jsxs)(R,{variant:`glass`,className:`border-green-500/20 bg-green-500/5`,children:[(0,F.jsx)(z,{children:(0,F.jsxs)(B,{className:`text-base flex items-center gap-2 text-green-500`,children:[(0,F.jsx)(bt,{className:`w-4 h-4`}),`Public Access`]})}),(0,F.jsxs)(H,{className:`text-sm text-muted-foreground space-y-3`,children:[(0,F.jsx)(`p`,{children:`This environment is securely accessible via Cloudflare Tunnel.`}),(0,F.jsx)(`div`,{className:`rounded bg-background/50 p-2 border`,children:(0,F.jsx)(`a`,{className:`text-primary hover:underline break-all font-mono text-xs`,href:t.data.externalUrl,target:`_blank`,rel:`noreferrer`,children:t.data.externalUrl})})]})]}),(0,F.jsxs)(R,{variant:`glass`,children:[(0,F.jsx)(z,{children:(0,F.jsxs)(B,{className:`text-base flex items-center gap-2`,children:[(0,F.jsx)(xn,{className:`w-4 h-4 text-orange-500`}),`Skyforge at a Glance`]})}),(0,F.jsxs)(H,{className:`text-sm text-muted-foreground space-y-3`,children:[(0,F.jsx)(`p`,{children:`Skyforge coordinates lab + cloud tooling into repeatable, auditable workflows for platform teams.`}),(0,F.jsxs)(`ul`,{className:`list-disc pl-4 space-y-1`,children:[(0,F.jsx)(`li`,{children:`Teams can still run tools manually; Skyforge standardizes the "happy path".`}),(0,F.jsx)(`li`,{children:`Enables consistent lab delivery across on-prem and cloud environments.`}),(0,F.jsx)(`li`,{children:`Creates shared context for collaboration, troubleshooting, and handoffs.`})]})]})]}),(0,F.jsxs)(R,{variant:`glass`,children:[(0,F.jsx)(z,{children:(0,F.jsxs)(B,{className:`text-base flex items-center gap-2`,children:[(0,F.jsx)(mn,{className:`w-4 h-4 text-blue-500`}),`What You Can Do Here`]})}),(0,F.jsxs)(H,{className:`text-sm text-muted-foreground space-y-2`,children:[(0,F.jsx)(wn,{className:`text-primary hover:underline`,to:`/dashboard/deployments`,children:`→ Open the dashboard`}),(0,F.jsx)(wn,{className:`text-primary hover:underline`,to:`/dashboard/deployments/new`,children:`→ Create a deployment`}),(0,F.jsx)(wn,{className:`text-primary hover:underline`,to:`/dashboard/s3`,children:`→ Browse artifacts (S3)`}),(0,F.jsx)(`p`,{className:`text-xs text-muted-foreground mt-3`,children:`Status is refreshed automatically via Server-Sent Events.`})]})]}),(0,F.jsxs)(R,{variant:`glass`,children:[(0,F.jsx)(z,{children:(0,F.jsxs)(B,{className:`text-base flex items-center gap-2`,children:[(0,F.jsx)(a,{className:`w-4 h-4 text-purple-500`}),`How Workflows Run`]})}),(0,F.jsxs)(H,{className:`text-sm text-muted-foreground space-y-2`,children:[(0,F.jsx)(`p`,{children:`Skyforge connects source control, automation, and lab capacity into one delivery loop.`}),(0,F.jsxs)(`ol`,{className:`list-decimal pl-4 space-y-1`,children:[(0,F.jsx)(`li`,{children:`Choose a blueprint (Git).`}),(0,F.jsx)(`li`,{children:`Run deployments (native task engine).`}),(0,F.jsx)(`li`,{children:`Validate on lab servers (BYOS + In-Cluster).`}),(0,F.jsx)(`li`,{children:`Store artifacts + state (Skyforge storage).`})]})]})]})]}),(0,F.jsx)($a,{className:`gap-4`,children:(0,F.jsxs)(eo,{gradient:`blue`,className:`md:col-span-4 hover-lift`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between mb-6`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,F.jsx)(`div`,{className:`p-2 rounded-lg bg-blue-500/10`,children:(0,F.jsx)(Kt,{className:`w-5 h-5 text-blue-500`})}),(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`h3`,{className:`font-semibold`,children:`Integrated Toolchain & Status`}),(0,F.jsx)(`p`,{className:`text-xs text-muted-foreground`,children:`Live health checks for all platform services.`})]})]}),i.length>0&&(0,F.jsxs)(Za,{variant:`destructive`,className:`animate-pulse`,children:[i.length,` Service`,i.length>1?`s`:``,` Reporting Issues`]})]}),(0,F.jsx)(`div`,{className:`grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4`,children:[{id:`gitea`,name:`Git`,path:`/git/`,icon:_t},{id:`netbox`,name:`NetBox`,path:`/netbox/`,icon:dt},{id:`nautobot`,name:`Nautobot`,path:`/nautobot/`,icon:dt},{id:`coder`,name:`Coder`,path:`/coder/launch`,icon:fe},{id:`yaade`,name:`API Testing`,path:`${qn}/yaade/sso`,icon:ye},{id:`webhooks`,name:`Webhooks`,path:`/dashboard/webhooks`,icon:a}].map(e=>{let t=r.find(t=>t.name.toLowerCase().includes(e.id)),n=t?t.status===`up`||t.status===`ok`:!0,i=n?`bg-emerald-500`:`bg-red-500`,a=e.icon;return(0,F.jsxs)(`a`,{href:e.path,target:e.path.startsWith(`http`)||e.path.startsWith(`/api`)||e.path.includes(`/`)?`_blank`:`_self`,className:`flex flex-col items-center justify-center p-4 rounded-lg bg-background/50 border hover:bg-background/80 transition-colors group relative overflow-hidden`,children:[(0,F.jsx)(`div`,{className:`absolute top-2 right-2 w-2 h-2 rounded-full ${i} ${n?``:`animate-pulse`}`}),(0,F.jsx)(a,{className:`w-6 h-6 mb-2 text-muted-foreground group-hover:text-primary transition-colors`}),(0,F.jsx)(`span`,{className:`text-sm font-medium`,children:e.name}),(0,F.jsx)(`span`,{className:P(`text-[10px] mt-1 capitalize font-medium`,n?`text-emerald-500/80`:`text-red-500`),children:t?.status??`Operational`})]},e.id)})}),i.length>0&&(0,F.jsxs)(`div`,{className:`mt-6 pt-6 border-t`,children:[(0,F.jsx)(`h4`,{className:`text-xs font-semibold uppercase tracking-wider text-muted-foreground mb-3`,children:`Service Alerts`}),(0,F.jsx)(`div`,{className:`flex flex-wrap gap-2`,children:i.map(e=>(0,F.jsxs)(Za,{variant:`outline`,className:`text-[10px] border-red-500/30 text-red-400 bg-red-500/5`,children:[e.name,`: `,e.status]},e.name))})]})]})})]})}function so(e,t){let n=En(),r=(0,M.useMemo)(()=>`${qn}/snmp/traps/events/stream?limit=${encodeURIComponent(t)}`,[t]);(0,M.useEffect)(()=>{if(!e)return;let i=ja(r,{snapshot:e=>{try{let r=JSON.parse(e.data);n.setQueryData(I.snmpTrapEvents(t),r)}catch{}}});return()=>{i.close()}},[e,t,n,r])}const co=Dn(`/snmp`)({component:lo});function lo(){so(!0,`200`);let e=A({queryKey:I.snmpTrapEvents(`200`),queryFn:()=>si({limit:`200`}),staleTime:1/0}),t=e.data?.events??[];return(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsx)(R,{variant:`glass`,children:(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`SNMP trap inbox`}),(0,F.jsx)(V,{children:`Recent SNMP trap events routed to your user.`})]})}),(0,F.jsx)(R,{children:(0,F.jsx)(H,{className:`p-0`,children:e.isLoading?(0,F.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,F.jsx)(K,{className:`h-12 w-full`}),(0,F.jsx)(K,{className:`h-12 w-full`}),(0,F.jsx)(K,{className:`h-12 w-full`})]}):e.isError?(0,F.jsx)(`div`,{className:`p-8 text-center text-destructive`,children:`Failed to load SNMP trap events.`}):t.length===0?(0,F.jsx)(Ua,{icon:Ut,title:`No trap events`,description:`No SNMP traps have been received yet.`}):(0,F.jsxs)(Ra,{children:[(0,F.jsx)(za,{children:(0,F.jsxs)(U,{children:[(0,F.jsx)(W,{className:`w-[180px]`,children:`Time`}),(0,F.jsx)(W,{className:`w-[140px]`,children:`Source`}),(0,F.jsx)(W,{children:`OID`}),(0,F.jsx)(W,{className:`w-[100px] text-right`,children:`ID`})]})}),(0,F.jsx)(Ba,{children:t.map(e=>(0,F.jsxs)(U,{children:[(0,F.jsx)(G,{className:`text-muted-foreground whitespace-nowrap text-xs`,children:e.receivedAt??``}),(0,F.jsx)(G,{className:`font-mono text-xs`,children:e.sourceIp??``}),(0,F.jsx)(G,{className:`font-medium text-foreground text-sm font-mono`,children:e.oid??``}),(0,F.jsx)(G,{className:`font-mono text-xs text-muted-foreground text-right`,children:String(e.id)})]},String(e.id)))})]})})})]})}function uo({className:e,children:t,...n}){return(0,F.jsx)(`div`,{className:P(`w-full overflow-x-auto rounded-md border`,e),...n,children:(0,F.jsx)(`div`,{className:`min-w-[800px]`,children:t})})}var fo=M.forwardRef(({className:e,...n},r)=>(0,F.jsx)(Se,{className:P(`peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input`,e),...n,ref:r,children:(0,F.jsx)(t,{className:P(`pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0`)})}));fo.displayName=Se.displayName;var po=In(`text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70`),q=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Je,{ref:n,className:P(po(),e),...t}));q.displayName=Je.displayName;var mo=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Ge,{ref:n,className:P(`peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground`,e),...t,children:(0,F.jsx)(He,{className:P(`flex items-center justify-center text-current`),children:(0,F.jsx)(s,{className:`h-4 w-4`})})}));mo.displayName=Ge.displayName;var ho=oe,go=b,_o=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(ze,{className:P(`fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0`,e),...t,ref:n}));_o.displayName=ze.displayName;var vo=M.forwardRef(({className:e,...t},n)=>(0,F.jsxs)(go,{children:[(0,F.jsx)(_o,{}),(0,F.jsx)(ne,{ref:n,className:P(`fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg`,e),...t})]}));vo.displayName=ne.displayName;var yo=({className:e,...t})=>(0,F.jsx)(`div`,{className:P(`flex flex-col space-y-2 text-center sm:text-left`,e),...t});yo.displayName=`AlertDialogHeader`;var bo=({className:e,...t})=>(0,F.jsx)(`div`,{className:P(`flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2`,e),...t});bo.displayName=`AlertDialogFooter`;var xo=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Gt,{ref:n,className:P(`text-lg font-semibold`,e),...t}));xo.displayName=Gt.displayName;var So=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Pe,{ref:n,className:P(`text-sm text-muted-foreground`,e),...t}));So.displayName=Pe.displayName;var Co=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(o,{ref:n,className:P(ra(),e),...t}));Co.displayName=o.displayName;var wo=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Le,{ref:n,className:P(ra({variant:`outline`}),`mt-2 sm:mt-0`,e),...t}));wo.displayName=Le.displayName;const To=Dn(`/notifications`)({component:Eo});function Eo(){let[e,t]=(0,M.useState)(!1),[n,r]=(0,M.useState)(null),[i,a]=(0,M.useState)(!1),[o,c]=(0,M.useState)(new Set),l=En(),u=A({queryKey:I.session(),queryFn:Xn,staleTime:3e4,retry:!1}).data?.username??``;Ma(!!u,e,`50`);let d=A({queryKey:I.notifications(e,`50`),enabled:!!u,queryFn:async()=>({notifications:(await er(u,{include_read:e?`true`:`false`,limit:`50`})).notifications??[]}),staleTime:1/0,initialData:{notifications:[]}}),f=(0,M.useMemo)(()=>d.data?.notifications??[],[d.data?.notifications]),p=(0,M.useMemo)(()=>f.filter(e=>!e.is_read).length,[f]),m=e=>{c(e?new Set(f.map(e=>String(e.id))):new Set)},h=(e,t)=>{let n=new Set(o);t?n.add(e):n.delete(e),c(n)},g=async()=>{try{let t=Array.from(o).map(e=>nr(e));await Promise.all(t),k.success(`${o.size} notifications marked as read`),c(new Set),await l.invalidateQueries({queryKey:I.notifications(e,`50`)})}catch(e){k.error(`Failed to mark selection as read`,{description:e.message})}},_=async()=>{try{let t=Array.from(o).map(e=>rr(e));await Promise.all(t),k.success(`${o.size} notifications deleted`),c(new Set),await l.invalidateQueries({queryKey:I.notifications(e,`50`)})}catch(e){k.error(`Failed to delete selection`,{description:e.message})}},ee=async()=>{try{await tr(u),k.success(`All notifications marked as read`)}catch(e){k.error(`Failed to mark notifications as read`,{description:e.message})}},v=async e=>{try{await nr(e),k.success(`Notification marked as read`)}catch(e){k.error(`Failed to mark notification as read`,{description:e.message})}};return(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsx)(R,{variant:`glass`,children:(0,F.jsx)(z,{children:(0,F.jsxs)(`div`,{className:`flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,F.jsx)(`div`,{className:`p-2 rounded-full bg-primary/10`,children:(0,F.jsx)(Be,{className:`h-6 w-6 text-primary`})}),(0,F.jsxs)(`div`,{children:[(0,F.jsx)(B,{children:`Notifications`}),(0,F.jsx)(V,{children:`Stay updated with platform events and system alerts.`})]})]}),(0,F.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(fo,{id:`show-read`,checked:e,onCheckedChange:t}),(0,F.jsx)(q,{htmlFor:`show-read`,className:`cursor-pointer`,children:`Show read`})]}),(0,F.jsx)(L,{variant:`outline`,size:`sm`,disabled:!u||p===0,onClick:ee,children:`Mark all read`})]})]})})}),o.size>0&&(0,F.jsxs)(`div`,{className:`fixed bottom-6 left-1/2 -translate-x-1/2 z-50 flex items-center gap-4 rounded-full border bg-background/95 p-2 px-6 shadow-xl backdrop-blur animate-in slide-in-from-bottom-10 fade-in duration-300`,children:[(0,F.jsxs)(`span`,{className:`text-sm font-medium`,children:[o.size,` selected`]}),(0,F.jsx)(`div`,{className:`h-4 w-px bg-border`}),(0,F.jsxs)(L,{size:`sm`,variant:`ghost`,onClick:g,children:[(0,F.jsx)(s,{className:`mr-2 h-4 w-4`}),`Mark read`]}),(0,F.jsxs)(L,{size:`sm`,variant:`destructive`,onClick:_,children:[(0,F.jsx)(ae,{className:`mr-2 h-4 w-4`}),`Delete`]}),(0,F.jsx)(L,{size:`sm`,variant:`ghost`,onClick:()=>c(new Set),children:`Cancel`})]}),(0,F.jsx)(R,{children:(0,F.jsx)(H,{className:`p-0`,children:d.isLoading?(0,F.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,F.jsx)(K,{className:`h-12 w-full`}),(0,F.jsx)(K,{className:`h-12 w-full`}),(0,F.jsx)(K,{className:`h-12 w-full`})]}):d.isError?(0,F.jsx)(`div`,{className:`p-8 text-center text-destructive`,children:`Failed to load notifications.`}):f.length===0?(0,F.jsx)(Ua,{icon:Ut,title:`No notifications`,description:e?`You don't have any notifications at the moment.`:`You've read all your notifications!`}):(0,F.jsx)(uo,{className:`border-none`,children:(0,F.jsxs)(Ra,{children:[(0,F.jsx)(za,{children:(0,F.jsxs)(U,{children:[(0,F.jsx)(W,{className:`w-[50px]`,children:(0,F.jsx)(mo,{checked:f.length>0&&o.size===f.length,onCheckedChange:m})}),(0,F.jsx)(W,{className:`w-[180px]`,children:`Time`}),(0,F.jsx)(W,{children:`Title & Message`}),(0,F.jsx)(W,{className:`w-[120px]`,children:`Category`}),(0,F.jsx)(W,{className:`w-[80px] text-right`,children:`Actions`})]})}),(0,F.jsx)(Ba,{children:f.map(e=>{let t=String(e.id),n=o.has(t);return(0,F.jsxs)(U,{className:e.is_read?`opacity-60 grayscale-[0.5]`:``,"data-state":n?`selected`:void 0,children:[(0,F.jsx)(G,{children:(0,F.jsx)(mo,{checked:n,onCheckedChange:e=>h(t,e)})}),(0,F.jsx)(G,{className:`text-muted-foreground text-xs whitespace-nowrap`,children:e.created_at??``}),(0,F.jsxs)(G,{children:[(0,F.jsx)(`div`,{className:`font-medium text-sm`,children:e.title??``}),e.message?(0,F.jsx)(`div`,{className:`mt-1 text-xs text-muted-foreground line-clamp-2`,children:e.message}):null]}),(0,F.jsx)(G,{children:(0,F.jsx)(`span`,{className:`inline-flex items-center rounded-full bg-muted px-2 py-0.5 text-[10px] font-medium text-muted-foreground capitalize`,children:e.category??`System`})}),(0,F.jsx)(G,{className:`text-right`,children:(0,F.jsxs)(Ti,{children:[(0,F.jsx)(Ei,{asChild:!0,children:(0,F.jsxs)(L,{variant:`ghost`,size:`icon`,className:`h-8 w-8`,children:[(0,F.jsx)(Me,{className:`h-4 w-4`}),(0,F.jsx)(`span`,{className:`sr-only`,children:`Open menu`})]})}),(0,F.jsxs)(ki,{align:`end`,children:[!e.is_read&&(0,F.jsxs)(Ai,{onClick:()=>v(t),children:[(0,F.jsx)(s,{className:`mr-2 h-4 w-4`}),(0,F.jsx)(`span`,{children:`Mark as read`})]}),(0,F.jsxs)(Ai,{className:`text-destructive focus:text-destructive`,onClick:()=>{r(t),a(!0)},children:[(0,F.jsx)(ae,{className:`mr-2 h-4 w-4`}),(0,F.jsx)(`span`,{children:`Delete`})]})]})]})})]},t)})})]})})})}),(0,F.jsx)(ho,{open:i,onOpenChange:a,children:(0,F.jsxs)(vo,{children:[(0,F.jsxs)(yo,{children:[(0,F.jsx)(xo,{children:`Delete notification?`}),(0,F.jsx)(So,{children:`This action cannot be undone.`})]}),(0,F.jsxs)(bo,{children:[(0,F.jsx)(wo,{children:`Cancel`}),(0,F.jsx)(Co,{onClick:async()=>{if(n)try{await rr(n),k.success(`Notification deleted`),a(!1),r(null)}catch(e){k.error(`Failed to delete notification`,{description:e.message})}},className:ra({variant:`destructive`}),children:`Delete`})]})]})})]})}var J=M.forwardRef(({className:e,type:t,...n},r)=>(0,F.jsx)(`input`,{type:t,className:P(`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,e),ref:r,...n}));J.displayName=`Input`;var Y=me,X=Te,Z=M.forwardRef(({className:e,children:t,...n},r)=>(0,F.jsxs)(ce,{ref:r,className:P(`flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1`,e),...n,children:[t,(0,F.jsx)(f,{asChild:!0,children:(0,F.jsx)(bn,{className:`h-4 w-4 opacity-50`})})]}));Z.displayName=ce.displayName;var Do=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(ee,{ref:n,className:P(`flex cursor-default items-center justify-center py-1`,e),...t,children:(0,F.jsx)(ie,{className:`h-4 w-4`})}));Do.displayName=ee.displayName;var Oo=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(be,{ref:n,className:P(`flex cursor-default items-center justify-center py-1`,e),...t,children:(0,F.jsx)(bn,{className:`h-4 w-4`})}));Oo.displayName=be.displayName;var Q=M.forwardRef(({className:e,children:t,position:n=`popper`,...r},i)=>(0,F.jsx)(de,{children:(0,F.jsxs)(je,{ref:i,className:P(`relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2`,n===`popper`&&`data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1`,e),position:n,...r,children:[(0,F.jsx)(Do,{}),(0,F.jsx)(yn,{className:P(`p-1`,n===`popper`&&`h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]`),children:t}),(0,F.jsx)(Oo,{})]})}));Q.displayName=je.displayName;var ko=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Tt,{ref:n,className:P(`py-1.5 pl-8 pr-2 text-sm font-semibold`,e),...t}));ko.displayName=Tt.displayName;var $=M.forwardRef(({className:e,children:t,...n},i)=>(0,F.jsxs)(_e,{ref:i,className:P(`relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50`,e),...n,children:[(0,F.jsx)(`span`,{className:`absolute left-2 flex h-3.5 w-3.5 items-center justify-center`,children:(0,F.jsx)(Ot,{children:(0,F.jsx)(s,{className:`h-4 w-4`})})}),(0,F.jsx)(r,{children:t})]}));$.displayName=_e.displayName;var Ao=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(re,{ref:n,className:P(`-mx-1 my-1 h-px bg-muted`,e),...t}));Ao.displayName=re.displayName;var jo=l,Mo=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(Oe,{ref:n,className:P(`inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground`,e),...t}));Mo.displayName=Oe.displayName;var No=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(un,{ref:n,className:P(`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm`,e),...t}));No.displayName=un.displayName;var Po=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(pn,{ref:n,className:P(`mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2`,e),...t}));Po.displayName=pn.displayName;const Fo=Dn(`/design`)({component:Io});function Io(){return(0,F.jsxs)(`div`,{className:`space-y-10 p-6 pb-20`,children:[(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsx)(`h1`,{className:`text-3xl font-bold tracking-tight`,children:`Design System`}),(0,F.jsx)(`p`,{className:`text-muted-foreground`,children:`A catalog of all reusable UI components available in the portal.`})]}),(0,F.jsxs)(`section`,{className:`space-y-4`,children:[(0,F.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Buttons`}),(0,F.jsxs)(`div`,{className:`flex flex-wrap gap-4`,children:[(0,F.jsx)(L,{variant:`default`,children:`Default`}),(0,F.jsx)(L,{variant:`secondary`,children:`Secondary`}),(0,F.jsx)(L,{variant:`destructive`,children:`Destructive`}),(0,F.jsx)(L,{variant:`outline`,children:`Outline`}),(0,F.jsx)(L,{variant:`ghost`,children:`Ghost`}),(0,F.jsx)(L,{variant:`link`,children:`Link`}),(0,F.jsx)(L,{size:`sm`,children:`Small`}),(0,F.jsx)(L,{size:`lg`,children:`Large`}),(0,F.jsx)(L,{size:`icon`,children:(0,F.jsx)(C,{className:`h-4 w-4`})}),(0,F.jsx)(L,{disabled:!0,children:`Disabled`}),(0,F.jsxs)(L,{variant:`outline`,className:`gap-2`,children:[(0,F.jsx)(Yt,{className:`h-4 w-4`}),` With Icon`]})]})]}),(0,F.jsxs)(`section`,{className:`space-y-4`,children:[(0,F.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Badges`}),(0,F.jsxs)(`div`,{className:`flex flex-wrap gap-4`,children:[(0,F.jsx)(Za,{children:`Default`}),(0,F.jsx)(Za,{variant:`secondary`,children:`Secondary`}),(0,F.jsx)(Za,{variant:`outline`,children:`Outline`}),(0,F.jsx)(Za,{variant:`destructive`,children:`Destructive`})]})]}),(0,F.jsxs)(`section`,{className:`space-y-4`,children:[(0,F.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Cards`}),(0,F.jsxs)(`div`,{className:`grid gap-4 md:grid-cols-2 lg:grid-cols-4`,children:[(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Default Card`}),(0,F.jsx)(V,{children:`Standard container style`})]}),(0,F.jsx)(H,{children:`Content goes here`})]}),(0,F.jsxs)(R,{variant:`glass`,children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Glass Card`}),(0,F.jsx)(V,{children:`Backdrop blur effect`})]}),(0,F.jsx)(H,{children:`Popular for headers`})]}),(0,F.jsxs)(R,{variant:`flat`,children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Flat Card`}),(0,F.jsx)(V,{children:`No shadow, border only`})]}),(0,F.jsx)(H,{children:`Clean look`})]}),(0,F.jsxs)(R,{variant:`danger`,children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Danger Card`}),(0,F.jsx)(V,{children:`For error states`})]}),(0,F.jsx)(H,{className:`text-sm`,children:`Something went wrong`})]})]})]}),(0,F.jsxs)(`section`,{className:`space-y-4`,children:[(0,F.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Bento Grid`}),(0,F.jsxs)($a,{children:[(0,F.jsx)(to,{title:`Total Revenue`,value:`$45,231.89`,icon:(0,F.jsx)(kt,{className:`h-4 w-4`}),gradient:`blue`}),(0,F.jsx)(to,{title:`Active Users`,value:`+2350`,icon:(0,F.jsx)(pe,{className:`h-4 w-4`}),gradient:`green`}),(0,F.jsx)(eo,{gradient:`purple`,className:`md:col-span-2`,children:(0,F.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,F.jsx)(`div`,{className:`p-2 bg-background/20 rounded-full`,children:(0,F.jsx)(fe,{className:`h-6 w-6`})}),(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`h3`,{className:`font-semibold text-lg`,children:`Cloud Infrastructure`}),(0,F.jsx)(`p`,{className:`text-sm text-muted-foreground/80`,children:`Manage your cloud resources and deployments from a single dashboard.`})]})]})})]})]}),(0,F.jsxs)(`section`,{className:`space-y-4`,children:[(0,F.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Form Inputs`}),(0,F.jsx)(R,{children:(0,F.jsxs)(H,{className:`pt-6 space-y-4 max-w-md`,children:[(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsx)(q,{htmlFor:`email`,children:`Email address`}),(0,F.jsx)(J,{type:`email`,id:`email`,placeholder:`name@example.com`})]}),(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsx)(q,{children:`Framework`}),(0,F.jsxs)(Y,{children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`Select framework`})}),(0,F.jsxs)(Q,{children:[(0,F.jsx)($,{value:`react`,children:`React`}),(0,F.jsx)($,{value:`vue`,children:`Vue`}),(0,F.jsx)($,{value:`svelte`,children:`Svelte`})]})]})]}),(0,F.jsxs)(`div`,{className:`flex items-center space-x-2`,children:[(0,F.jsx)(fo,{id:`airplane-mode`}),(0,F.jsx)(q,{htmlFor:`airplane-mode`,children:`Airplane Mode`})]})]})})]}),(0,F.jsxs)(`section`,{className:`space-y-4`,children:[(0,F.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Tabs`}),(0,F.jsxs)(jo,{defaultValue:`account`,className:`w-[400px]`,children:[(0,F.jsxs)(Mo,{children:[(0,F.jsx)(No,{value:`account`,children:`Account`}),(0,F.jsx)(No,{value:`password`,children:`Password`})]}),(0,F.jsx)(Po,{value:`account`,children:(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Account`}),(0,F.jsx)(V,{children:`Make changes to your account here.`})]}),(0,F.jsx)(H,{className:`space-y-2`,children:(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`name`,children:`Name`}),(0,F.jsx)(J,{id:`name`,defaultValue:`Pedro Duarte`})]})}),(0,F.jsx)(aa,{children:(0,F.jsx)(L,{children:`Save changes`})})]})}),(0,F.jsx)(Po,{value:`password`,children:(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Password`}),(0,F.jsx)(V,{children:`Change your password here.`})]}),(0,F.jsx)(H,{className:`space-y-2`,children:(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`current`,children:`Current password`}),(0,F.jsx)(J,{id:`current`,type:`password`})]})}),(0,F.jsx)(aa,{children:(0,F.jsx)(L,{children:`Save password`})})]})})]})]}),(0,F.jsxs)(`section`,{className:`space-y-4`,children:[(0,F.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Feedback & Status`}),(0,F.jsxs)(`div`,{className:`grid gap-6 md:grid-cols-2`,children:[(0,F.jsxs)(`div`,{className:`space-y-4`,children:[(0,F.jsx)(`h3`,{className:`text-sm font-medium text-muted-foreground`,children:`Empty State`}),(0,F.jsx)(`div`,{className:`border rounded-lg p-4`,children:(0,F.jsx)(Ua,{icon:Ut,title:`No items found`,description:`You haven't created any items yet.`,action:{label:`Create Item`,onClick:()=>k(`Clicked create`)},className:`min-h-[200px]`})})]}),(0,F.jsxs)(`div`,{className:`space-y-4`,children:[(0,F.jsx)(`h3`,{className:`text-sm font-medium text-muted-foreground`,children:`Skeleton Loading`}),(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(K,{className:`h-5 w-[140px] mb-2`}),(0,F.jsx)(K,{className:`h-4 w-[250px]`})]}),(0,F.jsxs)(H,{className:`space-y-2`,children:[(0,F.jsx)(K,{className:`h-4 w-full`}),(0,F.jsx)(K,{className:`h-4 w-full`}),(0,F.jsx)(K,{className:`h-4 w-3/4`})]})]})]})]})]}),(0,F.jsxs)(`section`,{className:`space-y-4`,children:[(0,F.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Toast Notifications`}),(0,F.jsxs)(`div`,{className:`flex flex-wrap gap-4`,children:[(0,F.jsx)(L,{variant:`outline`,onClick:()=>k(`Event has been created`),children:`Simple Toast`}),(0,F.jsx)(L,{variant:`outline`,onClick:()=>k.success(`Event created successfully`),children:`Success`}),(0,F.jsx)(L,{variant:`outline`,onClick:()=>k.error(`Failed to create event`),children:`Error`}),(0,F.jsx)(L,{variant:`outline`,onClick:()=>k.info(`New updates available`,{description:`Refresh to see changes`}),children:`With Description`}),(0,F.jsx)(L,{variant:`outline`,onClick:()=>k(`Event deleted`,{action:{label:`Undo`,onClick:()=>console.log(`Undo`)}}),children:`With Action`})]})]}),(0,F.jsxs)(`section`,{className:`space-y-4`,children:[(0,F.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Breadcrumbs`}),(0,F.jsx)(`div`,{className:`p-4 border rounded-lg`,children:(0,F.jsx)(ba,{children:(0,F.jsxs)(xa,{children:[(0,F.jsx)(Sa,{children:(0,F.jsx)(Ca,{href:`/`,children:`Dashboard`})}),`              `,(0,F.jsx)(Ta,{}),(0,F.jsx)(Sa,{children:(0,F.jsx)(Ca,{href:`/components`,children:`Components`})}),(0,F.jsx)(Ta,{}),(0,F.jsx)(Sa,{children:(0,F.jsx)(wa,{children:`Breadcrumb`})})]})})})]})]})}const Lo=Dn(`/`)({component:Ro});function Ro(){let e=Tn(),t=A({queryKey:I.session(),queryFn:Xn,retry:!1,staleTime:3e4});return(0,M.useEffect)(()=>{t.isLoading||(t.data?.authenticated?e({to:`/dashboard/deployments`,replace:!0}):e({to:`/status`,replace:!0}))},[t.data?.authenticated,t.isLoading,e]),null}const zo=Dn(`/dashboard/`)({component:Bo});function Bo(){let e=Tn();return(0,M.useEffect)(()=>{e({to:`/dashboard/deployments`,replace:!0})},[e]),null}const Vo=Dn(`/admin/`)({component:Ho});function Ho(){let e=Tn();return(0,M.useEffect)(()=>{e({to:`/admin/settings`,replace:!0})},[e]),null}const Uo=Dn(`/dashboard/s3`)({component:Wo});function Wo(){let e=A({queryKey:I.workspaces(),queryFn:Qn,staleTime:3e4}),t=e.data?.workspaces??[],[n,r]=(0,M.useState)(``),[i,a]=(0,M.useState)(``);(0,M.useEffect)(()=>{if(t.length===0)return;let e=window.localStorage.getItem(`skyforge.lastWorkspaceId.s3`)??``,n=t.some(t=>t.id===e)?e:t[0]?.id??``;r(e=>e||n)},[t]);let o=A({queryKey:I.workspaceArtifacts(n),queryFn:async()=>Jr(n,{prefix:i||void 0}),staleTime:1e4,enabled:!!n}),s=o.data?.items??[],c=(0,F.jsxs)(`div`,{className:`p-4 border-b flex flex-col gap-3 md:flex-row md:items-center md:justify-between`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,F.jsx)(`div`,{className:`text-sm font-medium`,children:`Workspace`}),(0,F.jsxs)(Y,{value:n,onValueChange:e=>{r(e),window.localStorage.setItem(`skyforge.lastWorkspaceId.s3`,e)},disabled:t.length===0,children:[(0,F.jsx)(Z,{className:`w-[280px]`,children:(0,F.jsx)(X,{placeholder:`Select workspace`})}),(0,F.jsx)(Q,{children:t.map(e=>(0,F.jsxs)($,{value:e.id,children:[e.name,` (`,e.slug,`)`]},e.id))})]})]}),(0,F.jsxs)(`div`,{className:`flex flex-col gap-2 sm:flex-row sm:items-center`,children:[(0,F.jsx)(J,{placeholder:`Prefix (e.g. topology/)`,value:i,onChange:e=>a(e.target.value),className:`w-[260px]`}),(0,F.jsx)(L,{variant:`outline`,size:`sm`,onClick:()=>o.refetch(),disabled:!n,children:`Refresh`}),(0,F.jsxs)(L,{variant:`outline`,size:`sm`,onClick:async()=>{if(!n)return;let e=window.prompt(`Folder prefix (e.g. uploads/)`);if(e)try{await Qr(n,e),k.success(`Folder created`),await o.refetch()}catch(e){k.error(`Create folder failed`,{description:e.message})}},disabled:!n,children:[(0,F.jsx)(cn,{className:`mr-2 h-3 w-3`}),`Folder`]}),(0,F.jsxs)(L,{variant:`outline`,size:`sm`,onClick:()=>{if(!n)return;let e=document.createElement(`input`);e.type=`file`,e.onchange=()=>{let t=e.files?.[0];t&&(async()=>{try{let e=new Uint8Array(await t.arrayBuffer()),r=``,a=32*1024;for(let t=0;t<e.length;t+=a){let n=e.subarray(t,t+a);r+=btoa(String.fromCharCode(...n))}let s=(i||``)+t.name;await Xr(n,{key:s,contentBase64:r,contentType:t.type||`application/octet-stream`}),k.success(`Uploaded`,{description:s}),await o.refetch()}catch(e){k.error(`Upload failed`,{description:e.message})}})()},e.click()},disabled:!n,children:[(0,F.jsx)(ge,{className:`mr-2 h-3 w-3`}),`Upload`]})]})]});return(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsx)(R,{variant:`glass`,children:(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`S3`}),(0,F.jsx)(V,{children:`Workspace artifacts and generated files (backed by the platform object store).`})]})}),(0,F.jsx)(R,{children:(0,F.jsx)(H,{className:`p-0`,children:e.isLoading||o.isLoading?(0,F.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,F.jsx)(K,{className:`h-12 w-full`}),(0,F.jsx)(K,{className:`h-12 w-full`}),(0,F.jsx)(K,{className:`h-12 w-full`})]}):(0,F.jsxs)(`div`,{children:[c,e.isError||o.isError?(0,F.jsx)(`div`,{className:`p-8 text-center text-destructive`,children:`Failed to list objects.`}):s.length===0?(0,F.jsx)(`div`,{className:`p-6`,children:(0,F.jsx)(Ua,{icon:Ut,title:`No objects found`,description:`No artifacts found for this workspace.`})}):(0,F.jsx)(`div`,{children:(0,F.jsxs)(Ra,{children:[(0,F.jsx)(za,{children:(0,F.jsxs)(U,{children:[(0,F.jsx)(W,{children:`Object`}),(0,F.jsx)(W,{className:`w-[260px] text-right`,children:`Actions`})]})}),(0,F.jsx)(Ba,{children:s.map(e=>(0,F.jsxs)(U,{children:[(0,F.jsx)(G,{className:`font-mono text-xs`,children:e.key}),(0,F.jsx)(G,{className:`text-right`,children:(0,F.jsxs)(`div`,{className:`flex justify-end gap-2`,children:[e.key.toLowerCase().endsWith(`.json`)&&(0,F.jsxs)(L,{variant:`outline`,size:`sm`,onClick:async()=>{try{let t=await Yr(n,e.key),r=atob(t.fileData),i=new Uint8Array(r.length);for(let e=0;e<r.length;e++)i[e]=r.charCodeAt(e);let a=new TextDecoder().decode(i),o=JSON.stringify(JSON.parse(a),null,2),s=new Blob([o],{type:`application/json`}),c=URL.createObjectURL(s);window.open(c,`_blank`,`noopener,noreferrer`),window.setTimeout(()=>URL.revokeObjectURL(c),1e4)}catch(e){k.error(`View failed`,{description:e.message})}},children:[(0,F.jsx)(u,{className:`mr-2 h-3 w-3`}),`View`]}),(0,F.jsxs)(L,{variant:`outline`,size:`sm`,onClick:async()=>{try{let t=await Yr(n,e.key),r=atob(t.fileData),i=new Uint8Array(r.length);for(let e=0;e<r.length;e++)i[e]=r.charCodeAt(e);let a=new Blob([i]),o=URL.createObjectURL(a),s=document.createElement(`a`);s.href=o,s.download=e.key.split(`/`).pop()||`artifact`,document.body.appendChild(s),s.click(),s.remove(),URL.revokeObjectURL(o)}catch(e){k.error(`Download failed`,{description:e.message})}},children:[(0,F.jsx)(g,{className:`mr-2 h-3 w-3`}),`Download`]}),(0,F.jsxs)(L,{variant:`destructive`,size:`sm`,onClick:async()=>{if(confirm(`Delete ${e.key}?`))try{await Zr(n,e.key),k.success(`Deleted`,{description:e.key}),await o.refetch()}catch(e){k.error(`Delete failed`,{description:e.message})}},children:[(0,F.jsx)(ae,{className:`mr-2 h-3 w-3`}),`Delete`]})]})})]},e.key))})]})})]})})})]})}var Go=Rn({tab:Wn([`tls`,`ssh`]).optional().catch(`tls`)});const Ko=Dn(`/dashboard/pki`)({validateSearch:e=>Go.parse(e),loaderDeps:({search:{tab:e}})=>({tab:e}),loader:async({context:{queryClient:e}})=>{await Promise.all([e.ensureQueryData({queryKey:I.pkiRoot(),queryFn:$r,staleTime:6e4}),e.ensureQueryData({queryKey:I.pkiSshRoot(),queryFn:ei,staleTime:6e4}),e.ensureQueryData({queryKey:I.pkiCerts(),queryFn:ti,staleTime:15e3}),e.ensureQueryData({queryKey:I.pkiSshCerts(),queryFn:ni,staleTime:15e3})])},component:qo});function qo(){let e=En(),t=Ko.useNavigate(),{tab:n}=Ko.useSearch(),r=A({queryKey:I.pkiRoot(),queryFn:$r,staleTime:6e4}),i=A({queryKey:I.pkiSshRoot(),queryFn:ei,staleTime:6e4}),a=A({queryKey:I.pkiCerts(),queryFn:ti,staleTime:15e3}),o=A({queryKey:I.pkiSshCerts(),queryFn:ni,staleTime:15e3}),[s,l]=(0,M.useState)(``),[u,d]=(0,M.useState)(``),f=e=>{t({search:t=>({...t,tab:e}),replace:!0})},p=j({mutationFn:async()=>{let e=s.trim();if(!e)throw Error(`Common name is required`);return ri({commonName:e})},onSuccess:async()=>{l(``),k.success(`TLS Certificate Issued`,{description:`Download ready.`}),await e.invalidateQueries({queryKey:I.pkiCerts()})},onError:e=>{k.error(`Failed to issue TLS certificate`,{description:e.message})}}),m=j({mutationFn:async()=>{let e=u.split(/[,\s]+/g).map(e=>e.trim()).filter(Boolean);if(e.length===0)throw Error(`At least one principal is required`);return ii({principals:e})},onSuccess:async()=>{d(``),k.success(`SSH Certificate Issued`,{description:`Download ready.`}),await e.invalidateQueries({queryKey:I.pkiSshCerts()})},onError:e=>{k.error(`Failed to issue SSH certificate`,{description:e.message})}}),h=a.data?.certs??[],_=o.data?.certs??[],ee=(0,M.useMemo)(()=>i.data?.publicKey??``,[i.data?.publicKey]),v=(0,M.useMemo)(()=>r.data?.pem??``,[r.data?.pem]);return(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsx)(R,{variant:`glass`,children:(0,F.jsx)(z,{children:(0,F.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,F.jsx)(`div`,{className:`p-2 rounded-full bg-primary/10`,children:(0,F.jsx)(c,{className:`h-6 w-6 text-primary`})}),(0,F.jsxs)(`div`,{children:[(0,F.jsx)(B,{children:`PKI Management`}),(0,F.jsx)(V,{children:`Issue and manage TLS and SSH certificates signed by Skyforge.`})]})]})})}),(0,F.jsxs)(jo,{value:n,onValueChange:f,className:`space-y-6`,children:[(0,F.jsx)(`div`,{className:`flex items-center justify-between`,children:(0,F.jsxs)(Mo,{children:[(0,F.jsxs)(No,{value:`tls`,className:`gap-2`,children:[(0,F.jsx)(Ct,{className:`h-4 w-4`}),`TLS Certificates`]}),(0,F.jsxs)(No,{value:`ssh`,className:`gap-2`,children:[(0,F.jsx)(lt,{className:`h-4 w-4`}),`SSH Certificates`]})]})}),(0,F.jsxs)(Po,{value:`tls`,className:`space-y-6 animate-in fade-in-50 duration-300`,children:[(0,F.jsxs)(`div`,{className:`grid gap-6 lg:grid-cols-2`,children:[(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{className:`text-sm`,children:`CA Root Certificate`}),(0,F.jsx)(V,{children:`Trust this PEM for Skyforge-issued TLS certs.`})]}),(0,F.jsxs)(H,{children:[r.isLoading?(0,F.jsx)(K,{className:`h-40 w-full`}):(0,F.jsx)(`textarea`,{className:`h-40 w-full rounded-md border bg-muted p-2 font-mono text-[10px] text-muted-foreground focus:outline-none`,readOnly:!0,value:v}),r.isError&&(0,F.jsx)(`div`,{className:`mt-2 text-xs text-destructive`,children:`Failed to load CA root.`})]})]}),(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{className:`text-sm`,children:`Issue New TLS Certificate`}),(0,F.jsx)(V,{children:`Create a short-lived certificate for internal services.`})]}),(0,F.jsxs)(H,{className:`space-y-4`,children:[(0,F.jsxs)(`div`,{className:`grid gap-2`,children:[(0,F.jsx)(q,{htmlFor:`common-name`,children:`Common name (CN)`}),(0,F.jsx)(J,{id:`common-name`,value:s,onChange:e=>l(e.target.value),placeholder:`e.g. service.internal`})]}),(0,F.jsxs)(L,{className:`w-full`,disabled:p.isPending,onClick:()=>p.mutate(),children:[p.isPending&&(0,F.jsx)(qt,{className:`mr-2 h-4 w-4 animate-spin`}),p.isPending?`Generating…`:`Issue Certificate`]})]})]})]}),(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{children:(0,F.jsx)(B,{children:`Issued TLS Certificates`})}),(0,F.jsxs)(H,{className:`p-0`,children:[a.isLoading?(0,F.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,F.jsx)(K,{className:`h-10 w-full`}),(0,F.jsx)(K,{className:`h-10 w-full`})]}):h.length===0?(0,F.jsx)(Ua,{icon:Ut,title:`No TLS certificates`,description:`You haven't issued any TLS certificates yet.`}):(0,F.jsx)(uo,{className:`border-none`,children:(0,F.jsxs)(Ra,{children:[(0,F.jsx)(za,{children:(0,F.jsxs)(U,{children:[(0,F.jsx)(W,{children:`Common Name`}),(0,F.jsx)(W,{children:`Expires`}),(0,F.jsx)(W,{className:`text-right`,children:`Action`})]})}),(0,F.jsx)(Ba,{children:h.map(e=>(0,F.jsxs)(U,{children:[(0,F.jsx)(G,{className:`font-medium`,children:e.commonName}),(0,F.jsx)(G,{className:`text-muted-foreground text-xs`,children:e.expiresAt}),(0,F.jsx)(G,{className:`text-right`,children:(0,F.jsx)(L,{variant:`ghost`,size:`sm`,asChild:!0,children:(0,F.jsxs)(`a`,{href:`${qn}/pki/certs/${encodeURIComponent(e.id)}/download`,target:`_blank`,rel:`noreferrer`,children:[(0,F.jsx)(g,{className:`mr-2 h-3 w-3`}),`Download Bundle`]})})})]},e.id))})]})}),a.isError&&(0,F.jsx)(`div`,{className:`p-4 text-center text-xs text-destructive`,children:`Failed to list certs.`})]})]})]}),(0,F.jsxs)(Po,{value:`ssh`,className:`space-y-6 animate-in fade-in-50 duration-300`,children:[(0,F.jsxs)(`div`,{className:`grid gap-6 lg:grid-cols-2`,children:[(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{className:`text-sm`,children:`SSH CA Public Key`}),(0,F.jsx)(V,{children:`Trust this key for Skyforge-issued SSH certs.`})]}),(0,F.jsxs)(H,{children:[i.isLoading?(0,F.jsx)(K,{className:`h-40 w-full`}):(0,F.jsx)(`textarea`,{className:`h-40 w-full rounded-md border bg-muted p-2 font-mono text-[10px] text-muted-foreground focus:outline-none`,readOnly:!0,value:ee}),i.isError&&(0,F.jsx)(`div`,{className:`mt-2 text-xs text-destructive`,children:`Failed to load SSH CA key.`})]})]}),(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{className:`text-sm`,children:`Issue New SSH Certificate`}),(0,F.jsx)(V,{children:`Authorize keys for specific principals.`})]}),(0,F.jsxs)(H,{className:`space-y-4`,children:[(0,F.jsxs)(`div`,{className:`grid gap-2`,children:[(0,F.jsx)(q,{htmlFor:`principals`,children:`Principals (comma separated)`}),(0,F.jsx)(J,{id:`principals`,value:u,onChange:e=>d(e.target.value),placeholder:`e.g. root, ubuntu, admin`})]}),(0,F.jsxs)(L,{className:`w-full`,disabled:m.isPending,onClick:()=>m.mutate(),children:[m.isPending&&(0,F.jsx)(qt,{className:`mr-2 h-4 w-4 animate-spin`}),m.isPending?`Generating…`:`Issue Certificate`]})]})]})]}),(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{children:(0,F.jsx)(B,{children:`Issued SSH Certificates`})}),(0,F.jsxs)(H,{className:`p-0`,children:[o.isLoading?(0,F.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,F.jsx)(K,{className:`h-10 w-full`}),(0,F.jsx)(K,{className:`h-10 w-full`})]}):_.length===0?(0,F.jsx)(Ua,{icon:Ut,title:`No SSH certificates`,description:`You haven't issued any SSH certificates yet.`}):(0,F.jsx)(uo,{className:`border-none`,children:(0,F.jsxs)(Ra,{children:[(0,F.jsx)(za,{children:(0,F.jsxs)(U,{children:[(0,F.jsx)(W,{children:`Principals`}),(0,F.jsx)(W,{children:`Expires`}),(0,F.jsx)(W,{className:`text-right`,children:`Action`})]})}),(0,F.jsx)(Ba,{children:_.map(e=>(0,F.jsxs)(U,{children:[(0,F.jsx)(G,{className:`font-medium`,children:e.principals.map(e=>(0,F.jsx)(`span`,{className:`inline-flex items-center rounded-md bg-muted px-2 py-1 text-xs font-medium text-muted-foreground mr-1`,children:e},e))}),(0,F.jsx)(G,{className:`text-muted-foreground text-xs`,children:e.expiresAt}),(0,F.jsx)(G,{className:`text-right`,children:(0,F.jsx)(L,{variant:`ghost`,size:`sm`,asChild:!0,children:(0,F.jsxs)(`a`,{href:`${qn}/pki/ssh/certs/${encodeURIComponent(e.id)}/download`,target:`_blank`,rel:`noreferrer`,children:[(0,F.jsx)(g,{className:`mr-2 h-3 w-3`}),`Download Bundle`]})})})]},e.id))})]})}),o.isError&&(0,F.jsx)(`div`,{className:`p-4 text-center text-xs text-destructive`,children:`Failed to list SSH certs.`})]})]})]})]})]})}const Jo=Dn(`/dashboard/forward`)({component:Xo});function Yo(e,t){if(e===`cloud`)return`https://fwd.app`;let n=t.trim();return n?/^https?:\/\//i.test(n)?n:`https://${n}`:``}function Xo(){let e=En(),t=A({queryKey:I.userForwardCollectorConfigs(),queryFn:Hr,refetchInterval:5e3,staleTime:1e4,retry:!1}),n=(0,M.useMemo)(()=>t.data?.collectors??[],[t.data?.collectors]),[r,i]=(0,M.useState)(``),a=A({queryKey:I.userForwardCollectorConfigLogs(r),queryFn:async()=>Gr(r,300),enabled:!!r,refetchInterval:r?3e3:!1,retry:!1}),[o,s]=(0,M.useState)(`cloud`),[c,l]=(0,M.useState)(``),[u,d]=(0,M.useState)(!0),[f,p]=(0,M.useState)(``),[m,h]=(0,M.useState)(!1),[g,_]=(0,M.useState)(``),[ee,v]=(0,M.useState)(``),[y,b]=(0,M.useState)(!0),te=A({queryKey:I.userGitCredentials(),queryFn:ur,staleTime:6e4,retry:!1});(0,M.useEffect)(()=>{d(o!==`cloud`)},[o]),(0,M.useEffect)(()=>{if(m||f.trim())return;let e=(te.data?.username??``).trim();e&&p(`skyforge-${e}`)},[m,f,te.data?.username]);let x=j({mutationFn:async()=>{let e=f.trim();if(!e)throw Error(`Collector name is required`);let t=Yo(o,c);if(!t)throw Error(`Forward URL is required`);if(!g.trim()||!ee.trim())throw Error(`Forward username/password are required`);return Ur({name:e,baseUrl:t,skipTlsVerify:o===`onprem`?u:!1,username:g.trim(),password:ee,setDefault:y})},onSuccess:async()=>{k.success(`Collector created`),v(``),await e.invalidateQueries({queryKey:I.userForwardCollectorConfigs()})},onError:e=>k.error(`Failed to create collector`,{description:e.message})}),ne=j({mutationFn:async e=>Kr(e),onSuccess:async()=>{k.success(`Collector restarted`),await e.invalidateQueries({queryKey:I.userForwardCollectorConfigs()})},onError:e=>k.error(`Failed to restart collector`,{description:e.message})}),S=j({mutationFn:async e=>Wr(e),onSuccess:async()=>{k.success(`Collector deleted`),i(``),await e.invalidateQueries({queryKey:I.userForwardCollectorConfigs()})},onError:e=>k.error(`Failed to delete collector`,{description:e.message})}),C=j({mutationFn:async e=>{for(let t of e)await Wr(t)},onSuccess:async()=>{k.success(`Collectors deleted`),i(``),await e.invalidateQueries({queryKey:I.userForwardCollectorConfigs()})},onError:e=>k.error(`Failed to delete collectors`,{description:e.message})});return(0,F.jsxs)(`div`,{className:`p-6 space-y-6`,children:[(0,F.jsx)(`div`,{className:`flex items-start justify-between gap-4`,children:(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`h1`,{className:`text-2xl font-bold`,children:`Collector`}),(0,F.jsx)(`p`,{className:`text-sm text-muted-foreground mt-1`,children:`Create one or more per-user in-cluster Forward collectors. Select a collector per deployment.`})]})}),(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Create collector`}),(0,F.jsx)(V,{children:`Creates a Forward collector and deploys a matching in-cluster Deployment. Deleting here only deletes the in-cluster Deployment and the saved credentials; it does not delete the Forward-side collector.`})]}),(0,F.jsxs)(H,{className:`space-y-4`,children:[(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsx)(q,{children:`Collector name`}),(0,F.jsx)(J,{value:f,onChange:e=>{h(!0),p(e.target.value)},placeholder:`skyforge-yourname`})]}),(0,F.jsxs)(`div`,{className:`grid gap-4 md:grid-cols-2`,children:[(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsx)(q,{children:`Forward target`}),(0,F.jsxs)(Y,{value:o,onValueChange:e=>s(e),children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{})}),(0,F.jsxs)(Q,{children:[(0,F.jsx)($,{value:`cloud`,children:`fwd.app (cloud)`}),(0,F.jsx)($,{value:`onprem`,children:`on-prem`})]})]})]}),o===`onprem`?(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsx)(q,{children:`On-prem host`}),(0,F.jsx)(J,{value:c,onChange:e=>l(e.target.value),placeholder:`forward.example.com (:port)`})]}):null]}),o===`onprem`?(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(mo,{checked:u,onCheckedChange:e=>d(!!e)}),(0,F.jsx)(q,{className:`text-sm`,children:`Skip TLS verification`})]}):null,(0,F.jsxs)(`div`,{className:`grid gap-4 md:grid-cols-2`,children:[(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsx)(q,{children:`Forward username`}),(0,F.jsx)(J,{value:g,onChange:e=>_(e.target.value),placeholder:`you@company.com`})]}),(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsx)(q,{children:`Forward password`}),(0,F.jsx)(J,{type:`password`,value:ee,onChange:e=>v(e.target.value),placeholder:`••••••••`})]})]}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(mo,{checked:y,onCheckedChange:e=>b(!!e)}),(0,F.jsx)(q,{className:`text-sm`,children:`Make default`})]}),(0,F.jsx)(L,{onClick:()=>x.mutate(),disabled:x.isPending,children:x.isPending?`Creating…`:`Create`})]})]}),(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-4`,children:[(0,F.jsx)(B,{children:`Configured collectors`}),n.length>0?(0,F.jsx)(L,{variant:`destructive`,size:`sm`,disabled:C.isPending,onClick:()=>{let e=n.map(e=>String(e.id)).filter(Boolean);e.length!==0&&confirm(`Delete ${e.length} collector(s)? This removes in-cluster Deployments and saved credentials.`)&&C.mutate(e)},children:C.isPending?`Deleting…`:`Delete all`}):null]}),(0,F.jsx)(V,{children:`Each entry maps to one in-cluster Deployment and one Forward collector.`})]}),(0,F.jsxs)(H,{className:`space-y-3`,children:[t.isLoading?(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Loading…`}):null,t.isError?(0,F.jsx)(`div`,{className:`text-sm text-destructive`,children:`Failed to load collectors.`}):n.length===0?(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`No collectors configured yet.`}):null,n.map(e=>{let t=!!e.runtime?.ready,n=typeof e.forwardCollector?.connected==`boolean`?e.forwardCollector.connected:void 0;return(0,F.jsxs)(`div`,{className:`rounded-md border p-3 space-y-2`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,F.jsxs)(`div`,{className:`min-w-0`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-2 min-w-0`,children:[(0,F.jsx)(`div`,{className:`font-medium truncate`,children:e.name}),e.isDefault?(0,F.jsx)(Za,{variant:`secondary`,children:`default`}):null,e.decryptionFailed?(0,F.jsx)(Za,{variant:`destructive`,children:`re-save creds`}):null]}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:e.id})]}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(L,{variant:`outline`,size:`sm`,onClick:()=>i(t=>t===e.id?``:e.id),children:r===e.id?`Hide logs`:`Logs`}),(0,F.jsx)(L,{variant:`outline`,size:`sm`,onClick:()=>ne.mutate(e.id),disabled:ne.isPending,children:`Restart`}),(0,F.jsx)(L,{variant:`destructive`,size:`sm`,onClick:()=>{confirm(`Delete collector "${e.name}"?`)&&S.mutate(e.id)},disabled:S.isPending,children:`Delete`})]})]}),(0,F.jsxs)(`div`,{className:`text-sm`,children:[`Status:`,` `,(0,F.jsx)(`span`,{className:t?`text-emerald-600`:`text-muted-foreground`,children:t?`Running`:`Starting…`})]}),(0,F.jsxs)(`div`,{className:`text-sm`,children:[`Forward:`,` `,typeof n==`boolean`?(0,F.jsx)(`span`,{className:n?`text-emerald-600`:`text-muted-foreground`,children:n?`Connected`:`Not connected`}):(0,F.jsx)(`span`,{className:`text-muted-foreground`,children:`Unknown`})]}),e.forwardCollector?.version?(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Version: `,(0,F.jsx)(`span`,{className:`font-mono`,children:String(e.forwardCollector.version)})]}):null,e.forwardCollector?.updateStatus?(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Update: `,(0,F.jsx)(`span`,{className:`font-mono`,children:String(e.forwardCollector.updateStatus)})]}):null,e.forwardCollector?.externalIp?(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`External IP: `,(0,F.jsx)(`span`,{className:`font-mono`,children:String(e.forwardCollector.externalIp)})]}):null,Array.isArray(e.forwardCollector?.internalIps)&&(e.forwardCollector?.internalIps??[]).length>0?(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Internal IPs:`,` `,(0,F.jsx)(`span`,{className:`font-mono`,children:(e.forwardCollector?.internalIps??[]).filter(Boolean).join(`, `)})]}):null,e.runtime?.podName?(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Pod: `,(0,F.jsx)(`span`,{className:`font-mono`,children:String(e.runtime.podName)}),` (`,String(e.runtime.podPhase??``),`)`]}):null,r===e.id?(0,F.jsx)(`pre`,{className:`bg-muted p-3 rounded-md overflow-auto font-mono text-xs whitespace-pre-wrap`,children:a.isLoading?`Loading…`:(a.data?.logs??``).trim()||`No logs yet.`}):null]},e.id)})]})]})]})}const Zo=Dn(`/admin/settings`)({component:Qo});function Qo(){let e=!!En().getQueryData(I.session())?.isAdmin;return(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsx)(R,{variant:`glass`,children:(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`System settings`}),(0,F.jsx)(V,{children:`Admin-only settings for Skyforge.`})]})}),!e&&(0,F.jsx)(R,{variant:`danger`,children:(0,F.jsx)(H,{className:`pt-6`,children:(0,F.jsx)(`div`,{className:`text-center font-medium`,children:`Admin access required.`})})}),(0,F.jsx)(R,{children:(0,F.jsx)(H,{className:`pt-6`,children:(0,F.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`This build uses Server-Sent Events (SSE) for live updates; polling configuration has been removed.`})})})]})}var $o=Rn({q:Bn().optional().catch(``),tab:Wn([`resources`,`costs`,`usage`]).optional().catch(`resources`)});const es=Dn(`/admin/governance`)({validateSearch:e=>$o.parse(e),loaderDeps:({search:{q:e,tab:t}})=>({q:e,tab:t}),loader:async({context:{queryClient:e}})=>{(await e.ensureQueryData({queryKey:I.session(),queryFn:Xn,staleTime:3e4,retry:!1}))?.isAdmin&&await Promise.all([e.ensureQueryData({queryKey:I.governanceSummary(),queryFn:ci}),e.ensureQueryData({queryKey:I.governanceResources(`500`),queryFn:()=>li({limit:`500`})}),e.ensureQueryData({queryKey:I.governanceCosts(`50`),queryFn:()=>ui({limit:`50`})}),e.ensureQueryData({queryKey:I.governanceUsage(`50`),queryFn:()=>di({limit:`50`})})])},component:ts});function ts(){let e=En(),t=es.useNavigate(),{q:n,tab:r}=es.useSearch(),i=!!A({queryKey:I.session(),queryFn:Xn,staleTime:3e4,retry:!1}).data?.isAdmin,a=A({queryKey:I.governanceSummary(),queryFn:ci,staleTime:3e4,enabled:i}),o=A({queryKey:I.governanceResources(`500`),queryFn:()=>li({limit:`500`}),staleTime:3e4,enabled:i}),s=A({queryKey:I.governanceCosts(`50`),queryFn:()=>ui({limit:`50`}),staleTime:3e4,enabled:i}),c=A({queryKey:I.governanceUsage(`50`),queryFn:()=>di({limit:`50`}),staleTime:3e4,enabled:i}),l=(0,M.useMemo)(()=>{let e=o.data?.resources??[],t=n?.trim().toLowerCase()||``;return t?e.filter(e=>[e.name,e.resourceId,e.resourceType,e.workspaceName,e.owner,e.provider].filter(Boolean).join(` `).toLowerCase().includes(t)):e},[o.data?.resources,n]),u=j({mutationFn:async()=>{await fi()},onSuccess:async()=>{k.success(`Governance sources synced`,{description:`Resource inventory updated.`}),await Promise.all([e.invalidateQueries({queryKey:I.governanceSummary()}),e.invalidateQueries({queryKey:I.governanceResources(`500`)}),e.invalidateQueries({queryKey:I.governanceCosts(`50`)}),e.invalidateQueries({queryKey:I.governanceUsage(`50`)})])},onError:e=>{k.error(`Failed to sync governance sources`,{description:e.message})}}),d=a.data,f=e=>{t({search:t=>({...t,q:e}),replace:!0})};return(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsx)(R,{variant:`glass`,children:(0,F.jsx)(z,{children:(0,F.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,F.jsxs)(`div`,{children:[(0,F.jsx)(B,{children:`Governance`}),(0,F.jsx)(V,{children:`Admin-only inventory, cost, and usage telemetry.`})]}),(0,F.jsxs)(L,{variant:`outline`,size:`sm`,disabled:u.isPending||!i,onClick:()=>u.mutate(),children:[(0,F.jsx)(T,{className:`mr-2 h-4 w-4 ${u.isPending?`animate-spin`:``}`}),u.isPending?`Syncing…`:`Sync sources`]})]})})}),!i&&(0,F.jsx)(R,{variant:`danger`,children:(0,F.jsx)(H,{className:`pt-6`,children:(0,F.jsx)(`div`,{className:`text-center font-medium text-destructive`,children:`Admin access required.`})})}),(a.isError||o.isError||s.isError||c.isError)&&(0,F.jsx)(R,{variant:`danger`,children:(0,F.jsx)(H,{className:`pt-6`,children:(0,F.jsx)(`div`,{className:`text-center font-medium`,children:`Failed to load governance data.`})})}),a.isLoading?(0,F.jsx)($a,{children:[1,2,3,4].map(e=>(0,F.jsxs)(eo,{className:`h-32`,children:[(0,F.jsx)(K,{className:`h-4 w-24 mb-4`}),(0,F.jsx)(K,{className:`h-8 w-16`})]},e))}):(0,F.jsxs)($a,{children:[(0,F.jsx)(to,{title:`Resources tracked`,value:String(d?.resourceCount??`—`),icon:(0,F.jsx)(ve,{className:`h-5 w-5`}),gradient:`blue`}),(0,F.jsx)(to,{title:`Active resources`,value:String(d?.activeResources??`—`),icon:(0,F.jsx)(Kt,{className:`h-5 w-5`}),gradient:`green`}),(0,F.jsx)(to,{title:`Workspaces tracked`,value:String(d?.workspacesTracked??`—`),icon:(0,F.jsx)(Mt,{className:`h-5 w-5`}),gradient:`purple`}),(0,F.jsx)(to,{title:`Last 30d spend`,value:d?`${d.costLast30Days} ${d.costCurrency}`:`—`,icon:(0,F.jsx)(p,{className:`h-5 w-5`}),gradient:`orange`})]}),(0,F.jsxs)(jo,{value:r,onValueChange:e=>{t({search:t=>({...t,tab:e}),replace:!0})},className:`space-y-6`,children:[(0,F.jsxs)(Mo,{children:[(0,F.jsxs)(No,{value:`resources`,className:`gap-2`,children:[(0,F.jsx)(ve,{className:`h-4 w-4`}),`Resources`]}),(0,F.jsxs)(No,{value:`costs`,className:`gap-2`,children:[(0,F.jsx)(kt,{className:`h-4 w-4`}),`Financials`]}),(0,F.jsxs)(No,{value:`usage`,className:`gap-2`,children:[(0,F.jsx)(Re,{className:`h-4 w-4`}),`Telemetry`]})]}),(0,F.jsx)(Po,{value:`resources`,className:`space-y-6 animate-in fade-in-50`,children:(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{children:(0,F.jsxs)(`div`,{className:`flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between`,children:[(0,F.jsx)(B,{children:`Resource Inventory`}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsxs)(`div`,{className:`relative`,children:[(0,F.jsx)(Ve,{className:`absolute left-2 top-2.5 h-4 w-4 text-muted-foreground`}),(0,F.jsx)(J,{className:`pl-8 w-full sm:w-[300px]`,placeholder:`Search resources…`,value:n||``,onChange:e=>f(e.target.value)})]}),!o.isLoading&&(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground whitespace-nowrap hidden sm:block`,children:[l.length,` shown`]})]})]})}),(0,F.jsx)(H,{children:o.isLoading?(0,F.jsxs)(`div`,{className:`space-y-4`,children:[(0,F.jsx)(K,{className:`h-10 w-full`}),(0,F.jsx)(K,{className:`h-10 w-full`}),(0,F.jsx)(K,{className:`h-10 w-full`})]}):l.length===0?(0,F.jsx)(Ua,{icon:Ut,title:`No resources found`,description:`No resources match your search criteria.`}):(0,F.jsxs)(Ra,{children:[(0,F.jsx)(za,{children:(0,F.jsxs)(U,{children:[(0,F.jsx)(W,{children:`Name`}),(0,F.jsx)(W,{children:`Provider`}),(0,F.jsx)(W,{children:`Type`}),(0,F.jsx)(W,{children:`Workspace`}),(0,F.jsx)(W,{children:`Owner`}),(0,F.jsx)(W,{children:`Status`})]})}),(0,F.jsx)(Ba,{children:l.slice(0,500).map(e=>(0,F.jsxs)(U,{children:[(0,F.jsx)(G,{className:`font-medium`,children:e.name}),(0,F.jsx)(G,{children:e.provider}),(0,F.jsx)(G,{children:e.resourceType}),(0,F.jsx)(G,{children:e.workspaceName}),(0,F.jsx)(G,{children:e.owner}),(0,F.jsx)(G,{children:(0,F.jsx)(Za,{variant:e.status===`active`?`default`:`secondary`,children:e.status??`unknown`})})]},e.resourceId))})]})})]})}),(0,F.jsx)(Po,{value:`costs`,className:`space-y-6 animate-in fade-in-50`,children:(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Cost Snapshots`}),(0,F.jsx)(V,{children:`Historical spend data per provider.`})]}),(0,F.jsx)(H,{children:s.isLoading?(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsx)(K,{className:`h-12 w-full`}),(0,F.jsx)(K,{className:`h-12 w-full`})]}):(s.data?.costs??[]).length===0?(0,F.jsx)(Ua,{icon:kt,title:`No cost data`,description:`No financial snapshots available.`}):(0,F.jsxs)(Ra,{children:[(0,F.jsx)(za,{children:(0,F.jsxs)(U,{children:[(0,F.jsx)(W,{children:`Provider`}),(0,F.jsx)(W,{children:`Currency`}),(0,F.jsx)(W,{children:`Amount`}),(0,F.jsx)(W,{className:`text-right`,children:`Period End`})]})}),(0,F.jsx)(Ba,{children:(s.data?.costs??[]).slice(0,50).map((e,t)=>(0,F.jsxs)(U,{children:[(0,F.jsx)(G,{className:`font-medium`,children:e.provider}),(0,F.jsx)(G,{children:e.currency}),(0,F.jsx)(G,{children:e.amount}),(0,F.jsx)(G,{className:`text-right text-muted-foreground`,children:e.periodEnd})]},t))})]})})]})}),(0,F.jsx)(Po,{value:`usage`,className:`space-y-6 animate-in fade-in-50`,children:(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Usage Telemetry`}),(0,F.jsx)(V,{children:`System usage metrics and limits.`})]}),(0,F.jsx)(H,{children:c.isLoading?(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsx)(K,{className:`h-12 w-full`}),(0,F.jsx)(K,{className:`h-12 w-full`})]}):(c.data?.usage??[]).length===0?(0,F.jsx)(Ua,{icon:Re,title:`No usage data`,description:`No telemetry snapshots available.`}):(0,F.jsxs)(Ra,{children:[(0,F.jsx)(za,{children:(0,F.jsxs)(U,{children:[(0,F.jsx)(W,{children:`Provider`}),(0,F.jsx)(W,{children:`Metric`}),(0,F.jsx)(W,{children:`Value`}),(0,F.jsx)(W,{className:`text-right`,children:`Collected At`})]})}),(0,F.jsx)(Ba,{children:(c.data?.usage??[]).slice(0,50).map((e,t)=>(0,F.jsxs)(U,{children:[(0,F.jsx)(G,{className:`font-medium`,children:e.provider}),(0,F.jsx)(G,{children:e.metric}),(0,F.jsx)(G,{children:e.value}),(0,F.jsx)(G,{className:`text-right text-muted-foreground`,children:e.collectedAt})]},t))})]})})]})})]})]})}const ns=Dn(`/dashboard/workspaces/`)({beforeLoad:()=>{throw On({to:`/dashboard/deployments`})}});function rs(e){let t=En(),n=(0,M.useMemo)(()=>`${qn}/dashboard/events`,[]);(0,M.useEffect)(()=>{if(!e)return;let r=ja(n,{snapshot:e=>{try{let n=JSON.parse(e.data);t.setQueryData(I.dashboardSnapshot(),n)}catch{}}});return()=>{r.close()}},[e,t,n])}function is(e,t){if(!t)return`none`;let n=String(e?.username??``).trim();return e?.isAdmin?`admin`:n?String(t.createdBy??``).toLowerCase()===n.toLowerCase()||(t.owners??[]).some(e=>String(e).toLowerCase()===n.toLowerCase())?`owner`:(t.editors??[]).some(e=>String(e).toLowerCase()===n.toLowerCase())?`editor`:(t.viewers??[]).some(e=>String(e).toLowerCase()===n.toLowerCase())||t.isPublic?`viewer`:`none`:`none`}function as(e){return e===`admin`||e===`owner`||e===`editor`}function os(e){return e===`admin`||e===`owner`}var ss=Rn({workspace:Bn().optional().catch(``)});const cs=Dn(`/dashboard/deployments/`)({validateSearch:e=>ss.parse(e),loaderDeps:({search:{workspace:e}})=>({workspace:e}),loader:async({context:{queryClient:e}})=>{await e.ensureQueryData({queryKey:I.workspaces(),queryFn:Qn,staleTime:3e4})},component:ls});function ls(){rs(!0);let e=Tn(),t=En(),{workspace:n}=cs.useSearch(),r=A({queryKey:I.dashboardSnapshot(),queryFn:$n,initialData:()=>t.getQueryData(I.dashboardSnapshot())??null,retry:!1,staleTime:1/0}),[i,a]=(0,M.useState)(null),[o,s]=(0,M.useState)(!1),[c,l]=(0,M.useState)(!1),u=A({queryKey:I.session(),queryFn:Xn,staleTime:3e4,retry:!1}),[d,f]=(0,M.useState)(``),[p,m]=(0,M.useState)(`all`),[h,g]=(0,M.useState)(`all`),[_,ee]=(0,M.useState)(!0),v=A({queryKey:I.workspaces(),queryFn:Qn,staleTime:3e4}).data?.workspaces??[],y=`skyforge.lastWorkspaceId.deployments`,b=(0,M.useMemo)(()=>{if(n&&v.some(e=>e.id===n))return n;let e=typeof window<`u`?window.localStorage.getItem(y)??``:``;return e&&v.some(t=>t.id===e)?e:v[0]?.id??``},[n,v]);(0,M.useEffect)(()=>{b&&(typeof window<`u`&&window.localStorage.setItem(y,b),n!==b&&e({search:{workspace:b},replace:!0}))},[b]);let te=(0,M.useMemo)(()=>v.find(e=>e.id===b)??null,[v,b]),x=(0,M.useMemo)(()=>as(is(u.data,te)),[u.data,te]),ne=t=>{typeof window<`u`&&window.localStorage.setItem(y,t),e({search:{workspace:t},replace:!0})},re=(0,M.useMemo)(()=>{let e=r.data?.deployments??[];return b?e.filter(e=>e.workspaceId===b):e},[b,r.data?.deployments]),ie=(0,M.useMemo)(()=>re.filter(e=>{if(d&&!e.name.toLowerCase().includes(d.toLowerCase()))return!1;if(p!==`all`){let t=(e.activeTaskStatus??e.lastStatus??`unknown`).toLowerCase();if(p===`running`&&![`running`,`active`,`healthy`].includes(t)||p===`stopped`&&![`created`,`stopped`,`success`,`succeeded`].includes(t)||p===`failed`&&![`failed`,`error`,`crashloopbackoff`].includes(t))return!1}return!(h!==`all`&&(h===`netlab`&&!e.type.startsWith(`netlab`)||h===`containerlab`&&![`containerlab`,`clabernetes`].includes(e.type)||h===`terraform`&&e.type!==`terraform`))}),[re,d,p,h]),w=(0,M.useMemo)(()=>{let e=r.data?.runs??[];return b?e.filter(e=>String(e.workspaceId??``)===b):e},[b,r.data?.runs]),T=Jn(window.location.pathname+window.location.search),oe=async e=>{try{await pi(e.workspaceId,e.id),k.success(`Deployment starting`,{description:`${e.name} is queued to start.`})}catch(e){k.error(`Failed to start`,{description:e.message})}},E=async e=>{try{await mi(e.workspaceId,e.id),k.success(`Deployment stopping`,{description:`${e.name} is queued to stop.`})}catch(e){k.error(`Failed to stop`,{description:e.message})}},se=async()=>{if(i)try{await hi(i.workspaceId,i.id,{forwardDelete:c}),k.success(`Deployment deleted`,{description:`${i.name} has been removed.`}),await t.invalidateQueries({queryKey:I.dashboardSnapshot()}),s(!1),a(null),l(!1)}catch(e){k.error(`Failed to delete`,{description:e.message})}},ce=e=>{switch(e){case`netlab`:return`Netlab (BYOS)`;case`netlab-c9s`:return`Netlab`;case`containerlab`:return`Containerlab (BYOS)`;case`clabernetes`:return`Containerlab`;default:return e}},ue=!!i?.config?.forwardNetworkId;return(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsxs)(`div`,{className:`flex flex-col gap-4 md:flex-row md:items-center md:justify-between border-b pb-6`,children:[(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`h1`,{className:`text-2xl font-bold tracking-tight`,children:`Deployments`}),(0,F.jsx)(`p`,{className:`text-muted-foreground text-sm`,children:`Manage deployments and monitor workspace activity.`})]}),(0,F.jsx)(`div`,{className:`flex items-center gap-3`,children:(0,F.jsxs)(`div`,{className:`flex items-center gap-2 bg-muted/50 p-1 rounded-lg border`,children:[(0,F.jsxs)(Y,{value:b,onValueChange:ne,disabled:v.length===0,children:[(0,F.jsx)(Z,{className:`w-[200px] h-8 bg-transparent border-0 focus:ring-0 shadow-none`,children:(0,F.jsx)(X,{placeholder:`Select workspace`})}),(0,F.jsx)(Q,{children:v.map(e=>(0,F.jsxs)($,{value:e.id,children:[e.name,` (`,e.slug,`)`]},e.id))})]}),(0,F.jsx)(`div`,{className:`h-4 w-px bg-border`}),(0,F.jsx)(wn,{to:`/dashboard/workspaces/new`,title:`Create workspace`,className:ra({variant:`ghost`,size:`icon`,className:`h-8 w-8`}),children:(0,F.jsx)(We,{className:`h-4 w-4`})}),(0,F.jsx)(wn,{to:`/dashboard/workspaces/$workspaceId`,params:{workspaceId:b},title:`Workspace Settings`,className:ra({variant:`ghost`,size:`icon`,className:`h-8 w-8`}),disabled:!b||!x,children:(0,F.jsx)(C,{className:`h-4 w-4`})})]})})]}),!r.data&&(0,F.jsx)(R,{className:`border-dashed`,children:(0,F.jsx)(H,{className:`pt-6`,children:(0,F.jsxs)(`div`,{className:`flex flex-col items-center justify-center space-y-4 py-8`,children:[(0,F.jsx)(K,{className:`h-4 w-64`}),(0,F.jsxs)(`div`,{className:`text-center text-muted-foreground`,children:[`Loading dashboard…`,(0,F.jsxs)(`div`,{className:`mt-2 text-xs`,children:[`If you are logged out,`,` `,(0,F.jsx)(`a`,{className:`text-primary underline hover:no-underline`,href:T,onClick:e=>{e.preventDefault(),(async()=>{if(!await wi({loginHref:T})){window.location.href=T;return}await t.invalidateQueries({queryKey:I.session()})})()},children:`login`}),`.`]})]})]})})}),(0,F.jsxs)(`div`,{className:`flex flex-col lg:flex-row gap-6 relative items-start`,children:[(0,F.jsxs)(`div`,{className:`flex-1 min-w-0 space-y-4 w-full`,children:[(0,F.jsxs)(`div`,{className:`flex flex-col sm:flex-row gap-3`,children:[(0,F.jsxs)(`div`,{className:`relative flex-1`,children:[(0,F.jsx)(Ve,{className:`absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground`}),(0,F.jsx)(J,{placeholder:`Search deployments...`,className:`pl-9`,value:d,onChange:e=>f(e.target.value)})]}),(0,F.jsxs)(Y,{value:p,onValueChange:m,children:[(0,F.jsxs)(Z,{className:`w-[140px]`,children:[(0,F.jsx)(Ze,{className:`mr-2 h-4 w-4 text-muted-foreground`}),(0,F.jsx)(X,{placeholder:`Status`})]}),(0,F.jsxs)(Q,{children:[(0,F.jsx)($,{value:`all`,children:`All Status`}),(0,F.jsx)($,{value:`running`,children:`Running`}),(0,F.jsx)($,{value:`stopped`,children:`Stopped`}),(0,F.jsx)($,{value:`failed`,children:`Failed`})]})]}),(0,F.jsxs)(Y,{value:h,onValueChange:g,children:[(0,F.jsxs)(Z,{className:`w-[140px]`,children:[(0,F.jsx)(S,{className:`mr-2 h-4 w-4 text-muted-foreground`}),(0,F.jsx)(X,{placeholder:`Type`})]}),(0,F.jsxs)(Q,{children:[(0,F.jsx)($,{value:`all`,children:`All Types`}),(0,F.jsx)($,{value:`netlab`,children:`Netlab`}),(0,F.jsx)($,{value:`containerlab`,children:`Containerlab`}),(0,F.jsx)($,{value:`terraform`,children:`Terraform`})]})]}),(0,F.jsxs)(wn,{to:`/dashboard/deployments/new`,search:{workspace:b},className:ra({variant:`default`}),children:[(0,F.jsx)(We,{className:`mr-2 h-4 w-4`}),` Create`]})]}),(0,F.jsx)(R,{children:(0,F.jsx)(H,{className:`p-0`,children:r.data?ie.length===0?(0,F.jsx)(Ua,{icon:Ut,title:`No deployments found`,description:d||p!==`all`?`Try adjusting your filters.`:`You haven't created any deployments in this workspace yet.`,action:!d&&p===`all`?{label:`Create deployment`,onClick:()=>e({to:`/dashboard/deployments/new`,search:{workspace:b}})}:void 0}):(0,F.jsx)(uo,{className:`border-none`,children:(0,F.jsxs)(Ra,{children:[(0,F.jsx)(za,{children:(0,F.jsxs)(U,{children:[(0,F.jsx)(W,{children:`Name`}),(0,F.jsx)(W,{children:`Type`}),(0,F.jsx)(W,{children:`Status`}),(0,F.jsx)(W,{className:`text-right`,children:`Actions`})]})}),(0,F.jsx)(Ba,{children:ie.map(t=>(0,F.jsxs)(U,{children:[(0,F.jsx)(G,{className:`font-medium text-foreground`,children:(0,F.jsx)(wn,{to:`/dashboard/deployments/$deploymentId`,params:{deploymentId:t.id},className:`hover:underline flex items-center gap-2`,children:t.name})}),(0,F.jsx)(G,{className:`text-muted-foreground`,children:ce(t.type)}),(0,F.jsx)(G,{children:(0,F.jsx)(us,{status:t.activeTaskStatus??t.lastStatus??`unknown`})}),(0,F.jsx)(G,{className:`text-right`,children:(0,F.jsxs)(Ti,{children:[(0,F.jsx)(Ei,{asChild:!0,children:(0,F.jsxs)(L,{variant:`ghost`,size:`icon`,className:`h-8 w-8`,children:[(0,F.jsx)(Me,{className:`h-4 w-4`}),(0,F.jsx)(`span`,{className:`sr-only`,children:`Open menu`})]})}),(0,F.jsxs)(ki,{align:`end`,children:[(0,F.jsx)(Ni,{children:`Actions`}),(0,F.jsxs)(Ai,{onClick:()=>e({to:`/dashboard/deployments/$deploymentId`,params:{deploymentId:t.id}}),children:[(0,F.jsx)(mt,{className:`mr-2 h-4 w-4`}),`Details`]}),(0,F.jsx)(Pi,{}),(0,F.jsxs)(Ai,{onClick:()=>oe(t),disabled:!!t.activeTaskId,children:[(0,F.jsx)(Ye,{className:`mr-2 h-4 w-4`}),`Start`]}),(0,F.jsxs)(Ai,{onClick:()=>E(t),disabled:!t.activeTaskId,children:[(0,F.jsx)(xe,{className:`mr-2 h-4 w-4`}),`Stop`]}),(0,F.jsx)(Pi,{}),(0,F.jsxs)(Ai,{onClick:()=>{a(t),s(!0)},className:`text-destructive focus:text-destructive`,disabled:!!t.activeTaskId,children:[(0,F.jsx)(ae,{className:`mr-2 h-4 w-4`}),`Delete`]})]})]})})]},t.id))})]})}):(0,F.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,F.jsx)(K,{className:`h-10 w-full`}),(0,F.jsx)(K,{className:`h-10 w-full`}),(0,F.jsx)(K,{className:`h-10 w-full`})]})})})]}),(0,F.jsxs)(`div`,{className:P(`transition-all duration-300 ease-in-out border-l space-y-4 shrink-0`,_?`w-full lg:w-80 xl:w-96 pl-6 opacity-100`:`w-0 lg:w-12 pl-0 opacity-100 border-none lg:border-l`),children:[(0,F.jsx)(`div`,{className:P(`flex items-center gap-2 h-[40px]`,!_&&`justify-center`),children:_?(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(Kt,{className:`h-4 w-4 text-muted-foreground`}),(0,F.jsx)(`h3`,{className:`flex-1 text-sm font-semibold text-muted-foreground uppercase tracking-wider`,children:`Activity Feed`}),(0,F.jsx)(L,{variant:`ghost`,size:`icon`,className:`h-6 w-6 text-muted-foreground hover:text-foreground`,onClick:()=>ee(!1),title:`Collapse feed`,children:(0,F.jsx)(le,{className:`h-4 w-4`})})]}):(0,F.jsx)(L,{variant:`ghost`,size:`icon`,className:`h-8 w-8 text-muted-foreground hover:text-foreground`,onClick:()=>ee(!0),title:`Expand activity feed`,children:(0,F.jsx)(Ee,{className:`h-4 w-4`})})}),(0,F.jsx)(`div`,{className:P(`space-y-3`,!_&&`hidden`),children:r.data?w.length===0?(0,F.jsx)(R,{children:(0,F.jsx)(H,{className:`p-6 text-center text-sm text-muted-foreground`,children:`No recent activity.`})}):(0,F.jsx)(`div`,{className:`space-y-3`,children:w.slice(0,15).map(e=>([`success`,`failed`,`canceled`,`error`].includes(String(e.status??``).toLowerCase()),(0,F.jsx)(wn,{to:`/dashboard/runs/$runId`,params:{runId:String(e.id??``)},className:`block group`,children:(0,F.jsx)(R,{className:`hover:border-primary/50 transition-colors`,children:(0,F.jsxs)(H,{className:`p-3`,children:[(0,F.jsxs)(`div`,{className:`flex items-start justify-between gap-2`,children:[(0,F.jsxs)(`div`,{className:`flex flex-col gap-1 min-w-0`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsxs)(`span`,{className:`font-mono text-xs font-medium text-foreground`,children:[`#`,String(e.id??``)]}),(0,F.jsx)(`span`,{className:`text-xs text-muted-foreground truncate max-w-[120px]`,children:String(e.tpl_alias??e.type??`Run`)})]}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground truncate`,children:String(e.message||`No message`)})]}),(0,F.jsx)(us,{status:String(e.status??``),size:`xs`})]}),(0,F.jsxs)(`div`,{className:`mt-2 flex items-center justify-between text-[10px] text-muted-foreground`,children:[(0,F.jsx)(`span`,{children:String(e.user_name??`system`)}),(0,F.jsx)(`span`,{children:new Date(String(e.created)).toLocaleString(void 0,{month:`short`,day:`numeric`,hour:`numeric`,minute:`numeric`})})]})]})})},String(e.id??Math.random()))))}):(0,F.jsxs)(`div`,{className:`space-y-3`,children:[(0,F.jsx)(K,{className:`h-20 w-full`}),(0,F.jsx)(K,{className:`h-20 w-full`})]})})]})]}),(0,F.jsx)(ho,{open:o,onOpenChange:s,children:(0,F.jsxs)(vo,{children:[(0,F.jsxs)(yo,{children:[(0,F.jsx)(xo,{children:`Delete deployment?`}),(0,F.jsxs)(So,{children:[`This will remove "`,i?.name,`" from Skyforge and trigger provider cleanup. This action cannot be undone.`]})]}),ue&&(0,F.jsxs)(`div`,{className:`flex items-start gap-3 rounded-md border p-3`,children:[(0,F.jsx)(mo,{checked:c,onCheckedChange:e=>l(!!e),id:`delete-forward-network`}),(0,F.jsx)(`label`,{htmlFor:`delete-forward-network`,className:`text-sm leading-tight cursor-pointer`,children:`Also delete the Forward network associated with this deployment.`})]}),(0,F.jsxs)(bo,{children:[(0,F.jsx)(wo,{children:`Cancel`}),(0,F.jsx)(Co,{onClick:se,className:ra({variant:`destructive`}),children:`Delete`})]})]})})]})}function us({status:e,size:t=`default`}){let n=`secondary`,r=e.toLowerCase();return[`running`,`active`,`healthy`,`succeeded`,`success`].includes(r)&&(n=`default`),[`failed`,`error`,`stopped`,`crashloopbackoff`].includes(r)&&(n=`destructive`),(0,F.jsx)(Za,{variant:n,className:`capitalize ${t===`xs`?`px-1.5 py-0 text-[10px] h-5`:``}`,children:e})}var ds=Xe,fs=M.createContext({}),ps=({...e})=>(0,F.jsx)(fs.Provider,{value:{name:e.name},children:(0,F.jsx)(gt,{...e})}),ms=()=>{let e=M.useContext(fs),t=M.useContext(hs),{getFieldState:n,formState:r}=nt(),i=n(e.name,r);if(!e)throw Error(`useFormField should be used within <FormField>`);let{id:a}=t;return{id:a,name:e.name,formItemId:`${a}-form-item`,formDescriptionId:`${a}-form-item-description`,formMessageId:`${a}-form-item-message`,...i}},hs=M.createContext({}),gs=M.forwardRef(({className:e,...t},n)=>{let r=M.useId();return(0,F.jsx)(hs.Provider,{value:{id:r},children:(0,F.jsx)(`div`,{ref:n,className:P(`space-y-2`,e),...t})})});gs.displayName=`FormItem`;var _s=M.forwardRef(({className:e,...t},n)=>{let{error:r,formItemId:i}=ms();return(0,F.jsx)(q,{ref:n,className:P(r&&`text-destructive`,e),htmlFor:i,...t})});_s.displayName=`FormLabel`;var vs=M.forwardRef(({...e},t)=>{let{error:n,formItemId:r,formDescriptionId:i,formMessageId:a}=ms();return(0,F.jsx)(wt,{ref:t,id:r,"aria-describedby":n?`${i} ${a}`:`${i}`,"aria-invalid":!!n,...e})});vs.displayName=`FormControl`;var ys=M.forwardRef(({className:e,...t},n)=>{let{formDescriptionId:r}=ms();return(0,F.jsx)(`p`,{ref:n,id:r,className:P(`text-sm text-muted-foreground`,e),...t})});ys.displayName=`FormDescription`;var bs=M.forwardRef(({className:e,children:t,...n},r)=>{let{error:i,formMessageId:a}=ms(),o=i?String(i?.message):t;return o?(0,F.jsx)(`p`,{ref:r,id:a,className:P(`text-sm font-medium text-destructive`,e),...n,children:o}):null});bs.displayName=`FormMessage`;var xs=M.forwardRef(({className:e,...t},n)=>(0,F.jsx)(`textarea`,{className:P(`flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,e),ref:n,...t}));xs.displayName=`Textarea`;var Ss=Rn({name:Bn().min(2,`Name must be at least 2 characters`),slug:Bn().min(2,`Slug must be at least 2 characters`).regex(/^[a-z0-9-]+$/,`Slug must contain only lowercase letters, numbers, and dashes`),description:Bn().optional(),isPublic:Hn().default(!1),blueprint:Bn().optional(),sharedUsers:Bn().optional(),awsAccountId:Bn().optional(),awsRoleName:Bn().optional(),awsRegion:Bn().optional(),awsAuthMethod:Bn().optional()});const Cs=Dn(`/dashboard/workspaces/new`)({component:ws});function ws(){let e=Tn(),t=En(),n=gn({resolver:yt(Ss),defaultValues:{name:``,slug:``,description:``,isPublic:!1,blueprint:`skyforge/blueprints`,sharedUsers:``,awsAccountId:``,awsRoleName:``,awsRegion:`us-east-1`,awsAuthMethod:`sso`}}),r=j({mutationFn:e=>Ir({name:e.name,slug:e.slug,description:e.description||``,isPublic:!!e.isPublic,allowCustomNetlabServers:!1,allowExternalTemplateRepos:!1,awsAccountId:(e.awsAccountId||``).trim(),awsAuthMethod:(e.awsAuthMethod||``).trim(),awsRegion:(e.awsRegion||``).trim(),awsRoleName:(e.awsRoleName||``).trim(),blueprint:(e.blueprint||``).trim(),externalTemplateRepos:[],sharedUsers:(e.sharedUsers||``).split(`,`).map(e=>e.trim()).filter(Boolean)}),onSuccess:async n=>{k.success(`Workspace created`,{description:`Workspace "${n.name}" has been created successfully.`}),await t.invalidateQueries({queryKey:I.workspaces()}),await e({to:`/dashboard/deployments`,search:{workspace:n.id}})},onError:e=>{k.error(`Failed to create workspace`,{description:e.message})}});function i(e){r.mutate(e)}function a(e){let t=e.target.value;if(n.setValue(`name`,t),!n.getFieldState(`slug`).isDirty){let e=t.toLowerCase().replace(/[^a-z0-9]+/g,`-`).replace(/^-|-$/g,``);n.setValue(`slug`,e)}}return(0,F.jsxs)(`div`,{className:`max-w-2xl mx-auto p-6 space-y-6`,children:[(0,F.jsx)(`div`,{className:`flex items-center justify-between`,children:(0,F.jsx)(`h1`,{className:`text-2xl font-bold tracking-tight`,children:`Create Workspace`})}),(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Workspace Details`}),(0,F.jsx)(V,{children:`Workspaces organize your deployments and resources.`})]}),(0,F.jsx)(H,{children:(0,F.jsx)(ds,{...n,children:(0,F.jsxs)(`form`,{onSubmit:n.handleSubmit(i),className:`space-y-6`,children:[(0,F.jsx)(ps,{control:n.control,name:`name`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`Name`}),(0,F.jsx)(vs,{children:(0,F.jsx)(J,{placeholder:`My Project`,...e,onChange:t=>{e.onChange(t),a(t)}})}),(0,F.jsx)(ys,{children:`A display name for your workspace.`}),(0,F.jsx)(bs,{})]})}),(0,F.jsx)(ps,{control:n.control,name:`slug`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`Slug`}),(0,F.jsx)(vs,{children:(0,F.jsx)(J,{placeholder:`my-project`,...e})}),(0,F.jsx)(ys,{children:`Unique identifier used in URLs. Only lowercase letters, numbers, and dashes.`}),(0,F.jsx)(bs,{})]})}),(0,F.jsx)(ps,{control:n.control,name:`description`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`Description`}),(0,F.jsx)(vs,{children:(0,F.jsx)(xs,{placeholder:`Describe the purpose of this workspace...`,...e})}),(0,F.jsx)(ys,{children:`Optional description for your team.`}),(0,F.jsx)(bs,{})]})}),(0,F.jsx)(ps,{control:n.control,name:`isPublic`,render:({field:e})=>(0,F.jsxs)(gs,{className:`flex items-center justify-between rounded-lg border p-4`,children:[(0,F.jsxs)(`div`,{className:`space-y-0.5`,children:[(0,F.jsx)(_s,{children:`Public workspace`}),(0,F.jsxs)(ys,{children:[`Required for BYOS Netlab via `,(0,F.jsx)(`code`,{className:`font-mono`,children:`topologyUrl`}),` when using workspace templates.`]})]}),(0,F.jsx)(vs,{children:(0,F.jsx)(fo,{checked:e.value,onCheckedChange:e.onChange})})]})}),(0,F.jsx)(ps,{control:n.control,name:`blueprint`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`Blueprint repo`}),(0,F.jsx)(vs,{children:(0,F.jsx)(J,{placeholder:`skyforge/blueprints`,...e})}),(0,F.jsx)(ys,{children:`Default template catalog repo (format: owner/repo).`}),(0,F.jsx)(bs,{})]})}),(0,F.jsx)(ps,{control:n.control,name:`sharedUsers`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`Shared users (viewers)`}),(0,F.jsx)(vs,{children:(0,F.jsx)(J,{placeholder:`alice,bob`,...e})}),(0,F.jsx)(ys,{children:`Comma-separated usernames.`}),(0,F.jsx)(bs,{})]})}),(0,F.jsxs)(`div`,{className:`grid gap-4 md:grid-cols-2`,children:[(0,F.jsx)(ps,{control:n.control,name:`awsAccountId`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`AWS account ID (optional)`}),(0,F.jsx)(vs,{children:(0,F.jsx)(J,{placeholder:`123456789012`,...e})}),(0,F.jsx)(bs,{})]})}),(0,F.jsx)(ps,{control:n.control,name:`awsRoleName`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`AWS role name (optional)`}),(0,F.jsx)(vs,{children:(0,F.jsx)(J,{placeholder:`MyRole`,...e})}),(0,F.jsx)(bs,{})]})}),(0,F.jsx)(ps,{control:n.control,name:`awsRegion`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`AWS region`}),(0,F.jsx)(vs,{children:(0,F.jsx)(J,{placeholder:`us-east-1`,...e})}),(0,F.jsx)(bs,{})]})}),(0,F.jsx)(ps,{control:n.control,name:`awsAuthMethod`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`AWS auth method`}),(0,F.jsx)(vs,{children:(0,F.jsx)(J,{placeholder:`sso`,...e})}),(0,F.jsx)(bs,{})]})})]}),(0,F.jsxs)(`div`,{className:`flex justify-end gap-4`,children:[(0,F.jsx)(L,{type:`button`,variant:`ghost`,onClick:()=>e({to:`/dashboard/deployments`}),children:`Cancel`}),(0,F.jsx)(L,{type:`submit`,disabled:r.isPending,children:r.isPending?`Creating...`:`Create Workspace`})]})]})})})]})]})}const Ts=[{label:"Device (`NETLAB_DEVICE`)",key:`NETLAB_DEVICE`},{label:"BGP AS (`NETLAB_BGP_AS`)",key:`NETLAB_BGP_AS`},{label:"P2P IPv4 pool (`NETLAB_ADDRESSING_P2P_IPV4`)",key:`NETLAB_ADDRESSING_P2P_IPV4`},{label:"P2P IPv6 mode (`NETLAB_ADDRESSING_P2P_IPV6`)",key:`NETLAB_ADDRESSING_P2P_IPV6`},{label:"Loopback IPv4 pool (`NETLAB_ADDRESSING_LOOPBACK_IPV4`)",key:`NETLAB_ADDRESSING_LOOPBACK_IPV4`},{label:"LAN IPv4 pool (`NETLAB_ADDRESSING_LAN_IPV4`)",key:`NETLAB_ADDRESSING_LAN_IPV4`},{label:"Netlab `--set` overrides (`SKYFORGE_NETLAB_SET_OVERRIDES`)",key:`SKYFORGE_NETLAB_SET_OVERRIDES`}],Es=[{label:`Arista EOS (eos)`,value:`eos`},{label:`Cisco IOL (iol)`,value:`iol`},{label:`Cisco IOSv (iosv)`,value:`iosv`},{label:`Cisco IOSvL2 (iosvl2)`,value:`iosvl2`},{label:`Cisco CSR1000v (csr)`,value:`csr`},{label:`Cisco ASA (asav)`,value:`asav`},{label:`Cisco NX-OSv9k (nxos)`,value:`nxos`},{label:`Juniper vMX (vmx)`,value:`vmx`},{label:`Juniper vJunos Router (vjunos-router)`,value:`vjunos-router`},{label:`Juniper vJunos Switch (vjunos-switch)`,value:`vjunos-switch`},{label:`Nokia SR OS (sros)`,value:`sros`},{label:`Linux (linux)`,value:`linux`}];function Ds(e){return String(e??``).trim().toUpperCase()===`SKYFORGE_NETLAB_SET_OVERRIDES`}function Os(e){switch(String(e??``).trim().toUpperCase()){case`NETLAB_DEVICE`:return Es;case`NETLAB_BGP_AS`:return[{label:`65000`,value:`65000`},{label:`65100`,value:`65100`},{label:`65200`,value:`65200`},{label:`65500`,value:`65500`}];case`NETLAB_ADDRESSING_P2P_IPV4`:return[{label:`198.18.0.0/16 (benchmark range)`,value:`198.18.0.0/16`},{label:`172.16.0.0/12`,value:`172.16.0.0/12`},{label:`100.64.0.0/10`,value:`100.64.0.0/10`}];case`NETLAB_ADDRESSING_P2P_IPV6`:return[{label:`false (disable / avoid LLA-only)`,value:`false`},{label:`true`,value:`true`}];case`NETLAB_ADDRESSING_LOOPBACK_IPV4`:return[{label:`10.0.0.0/24`,value:`10.0.0.0/24`},{label:`198.18.1.0/24`,value:`198.18.1.0/24`},{label:`172.16.0.0/24`,value:`172.16.0.0/24`}];case`NETLAB_ADDRESSING_LAN_IPV4`:return[{label:`172.18.0.0/16`,value:`172.18.0.0/16`},{label:`198.18.128.0/17`,value:`198.18.128.0/17`}];default:return null}}function ks({workspaceId:e,allowEdit:t}){let n=En(),[r,i]=(0,M.useState)(!1),[a,o]=(0,M.useState)(null),[s,c]=(0,M.useState)(null),l=A({queryKey:[`workspaceVariableGroups`,e],queryFn:async()=>yi(e),staleTime:3e4}),u=l.data?.groups??[],d=j({mutationFn:async t=>Si(e,t),onSuccess:()=>{k.success(`Variable group deleted`),n.invalidateQueries({queryKey:[`workspaceVariableGroups`,e]}),c(null)},onError:e=>k.error(`Failed to delete group`,{description:e.message})});return(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{children:(0,F.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,F.jsxs)(`div`,{children:[(0,F.jsx)(B,{children:`Variable Groups`}),(0,F.jsx)(V,{children:`Define sets of environment variables that can be injected into deployments.`})]}),(0,F.jsxs)(L,{size:`sm`,onClick:()=>i(!0),disabled:!t,children:[(0,F.jsx)(We,{className:`mr-2 h-4 w-4`}),`New Group`]})]})}),(0,F.jsx)(H,{children:l.isLoading?(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Loading groups…`}):u.length===0?(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground border border-dashed rounded-lg p-8 text-center`,children:`No variable groups defined.`}):(0,F.jsx)(`div`,{className:`rounded-md border`,children:(0,F.jsxs)(Ra,{children:[(0,F.jsx)(za,{children:(0,F.jsxs)(U,{children:[(0,F.jsx)(W,{children:`Name`}),(0,F.jsx)(W,{children:`Variables`}),(0,F.jsx)(W,{className:`text-right`,children:`Actions`})]})}),(0,F.jsx)(Ba,{children:u.map(e=>(0,F.jsxs)(U,{children:[(0,F.jsx)(G,{className:`font-medium`,children:e.name}),(0,F.jsxs)(G,{className:`text-muted-foreground text-xs`,children:[Object.keys(e.variables??{}).length,` variables`]}),(0,F.jsx)(G,{className:`text-right`,children:(0,F.jsxs)(`div`,{className:`flex justify-end gap-2`,children:[(0,F.jsx)(L,{variant:`ghost`,size:`icon`,className:`h-8 w-8`,onClick:()=>o(e),disabled:!t,children:(0,F.jsx)(we,{className:`h-4 w-4`})}),(0,F.jsx)(L,{variant:`ghost`,size:`icon`,className:`h-8 w-8 text-destructive hover:text-destructive`,onClick:()=>c(e),disabled:!t,children:(0,F.jsx)(ae,{className:`h-4 w-4`})})]})})]},e.id))})]})})}),(0,F.jsx)(As,{open:r,onOpenChange:i,workspaceId:e,allowEdit:t,mode:`create`}),a&&(0,F.jsx)(As,{open:!!a,onOpenChange:e=>!e&&o(null),workspaceId:e,allowEdit:t,mode:`edit`,initialData:a}),(0,F.jsx)(ho,{open:!!s,onOpenChange:e=>!e&&c(null),children:(0,F.jsxs)(vo,{children:[(0,F.jsxs)(yo,{children:[(0,F.jsx)(xo,{children:`Delete variable group?`}),(0,F.jsxs)(So,{children:[`This will permanently delete `,(0,F.jsx)(`strong`,{children:s?.name}),`.`]})]}),(0,F.jsxs)(bo,{children:[(0,F.jsx)(wo,{children:`Cancel`}),(0,F.jsx)(Co,{className:`bg-destructive text-destructive-foreground hover:bg-destructive/90`,onClick:()=>s&&d.mutate(s.id),children:d.isPending?`Deleting…`:`Delete`})]})]})})]})}function As({open:e,onOpenChange:t,workspaceId:n,allowEdit:r,mode:i,initialData:a}){let o=En(),[s,c]=(0,M.useState)(a?.name??``),[l,u]=(0,M.useState)(!1),[d,f]=(0,M.useState)(()=>a?.variables?Object.entries(a.variables).map(([e,t])=>({key:e,value:t})):[{key:``,value:``}]),p=j({mutationFn:async()=>{let e={};for(let t of d)t.key.trim()&&(e[t.key.trim()]=t.value);let t={name:s.trim(),variables:e};if(i===`create`)return bi(n,t);if(!a)throw Error(`Missing initial data for edit`);return xi(n,a.id,t)},onSuccess:()=>{k.success(i===`create`?`Group created`:`Group updated`),o.invalidateQueries({queryKey:[`workspaceVariableGroups`,n]}),t(!1),i===`create`&&(c(``),f([{key:``,value:``}]))},onError:e=>k.error(`Failed to save group`,{description:e.message})});return(0,F.jsxs)(Ri,{open:e,onOpenChange:t,children:[(0,F.jsxs)(Vi,{className:`max-w-2xl`,children:[(0,F.jsxs)(Hi,{children:[(0,F.jsx)(Wi,{children:i===`create`?`Create Variable Group`:`Edit Variable Group`}),(0,F.jsx)(Gi,{children:`Define environment variables as key-value pairs.`})]}),(0,F.jsxs)(`div`,{className:`space-y-4 py-4`,children:[(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsx)(q,{children:`Group Name`}),(0,F.jsx)(J,{value:s,onChange:e=>c(e.target.value),placeholder:`e.g. Production Vars`,disabled:!r})]}),(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,F.jsx)(q,{children:`Variables`}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(L,{type:`button`,variant:`ghost`,size:`sm`,onClick:()=>u(!0),children:`Supported vars`}),(0,F.jsxs)(L,{type:`button`,variant:`outline`,size:`sm`,onClick:()=>f([...d,{key:``,value:``}]),disabled:!r,children:[(0,F.jsx)(We,{className:`mr-2 h-3 w-3`}),` Add Variable`]})]})]}),(0,F.jsx)(`div`,{className:`space-y-2 max-h-[320px] overflow-y-auto pr-2`,children:d.map((e,t)=>{let n=String(e.key??``).trim(),i=Ts.some(e=>e.key===n)?n:`__custom__`,a=Ds(n),o=Os(n),s=e=>{f(n=>{let r=[...n];return r[t]={...r[t],...e},r})};return(0,F.jsxs)(`div`,{className:`grid grid-cols-12 gap-2 items-start`,children:[(0,F.jsxs)(`div`,{className:`col-span-5 space-y-1`,children:[(0,F.jsx)(q,{className:`text-xs text-muted-foreground`,children:`Key`}),(0,F.jsxs)(Y,{value:i,onValueChange:e=>s({key:e===`__custom__`?``:e}),disabled:!r,children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`Select key…`})}),(0,F.jsxs)(Q,{children:[Ts.map(e=>(0,F.jsx)($,{value:e.key,children:e.label},e.key)),(0,F.jsx)($,{value:`__custom__`,children:`Custom…`})]})]}),i===`__custom__`&&(0,F.jsx)(J,{placeholder:`KEY`,value:e.key,onChange:e=>s({key:e.target.value}),className:`font-mono text-xs`,disabled:!r})]}),(0,F.jsxs)(`div`,{className:`col-span-6 space-y-1`,children:[(0,F.jsx)(q,{className:`text-xs text-muted-foreground`,children:`Value`}),a?(0,F.jsx)(xs,{value:e.value,onChange:e=>s({value:e.target.value}),placeholder:`One \`key=value\` per line.
Example:
addressing.p2p.ipv4=198.18.0.0/16`,className:`font-mono text-xs min-h-[120px]`,disabled:!r}):o?(0,F.jsx)(`div`,{className:`space-y-2`,children:(()=>{let t=String(e.value??``).trim(),n=o.some(e=>e.value===t),i=t?n?t:`__custom__`:`none`;return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)(Y,{value:i,onValueChange:e=>{s(e===`none`?{value:``}:e===`__custom__`?{value:n?``:t}:{value:e})},disabled:!r,children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`Select value…`})}),(0,F.jsxs)(Q,{children:[(0,F.jsx)($,{value:`none`,children:`None`}),o.map(e=>(0,F.jsx)($,{value:e.value,children:e.label},e.value)),(0,F.jsx)($,{value:`__custom__`,children:`Custom…`})]})]}),i===`__custom__`&&(0,F.jsx)(J,{placeholder:`VALUE`,value:e.value,onChange:e=>s({value:e.target.value}),className:`font-mono text-xs`,disabled:!r})]})})()}):(0,F.jsx)(J,{placeholder:`VALUE`,value:e.value,onChange:e=>s({value:e.target.value}),className:`font-mono text-xs`,disabled:!r})]}),(0,F.jsx)(`div`,{className:`col-span-1 flex justify-end pt-6`,children:(0,F.jsx)(L,{type:`button`,variant:`ghost`,size:`icon`,className:`h-8 w-8`,onClick:()=>{f(e=>{let n=e.filter((e,n)=>n!==t);return n.length?n:[{key:``,value:``}]})},disabled:!r,children:(0,F.jsx)(ae,{className:`h-4 w-4 text-muted-foreground`})})})]},t)})})]})]}),(0,F.jsxs)(Ui,{children:[(0,F.jsx)(L,{variant:`outline`,onClick:()=>t(!1),children:`Cancel`}),(0,F.jsxs)(L,{onClick:()=>p.mutate(),disabled:!r||p.isPending||!s.trim(),children:[p.isPending&&(0,F.jsx)(et,{className:`mr-2 h-4 w-4 animate-spin`}),`Save Group`]})]})]}),(0,F.jsx)(ho,{open:l,onOpenChange:u,children:(0,F.jsxs)(vo,{children:[(0,F.jsxs)(yo,{children:[(0,F.jsx)(xo,{children:`Supported NETLAB_ variables`}),(0,F.jsx)(So,{children:"These are the most useful Netlab defaults you can override via environment variables (plus Skyforge’s multiline `SKYFORGE_NETLAB_SET_OVERRIDES`)."})]}),(0,F.jsx)(`div`,{className:`max-h-[50vh] overflow-auto rounded-md border bg-muted/30 p-3 font-mono text-xs`,children:Ts.map(e=>(0,F.jsxs)(`div`,{className:`flex gap-2`,children:[(0,F.jsx)(`span`,{className:`text-foreground`,children:e.key}),(0,F.jsxs)(`span`,{className:`text-muted-foreground`,children:[`— `,e.label]})]},e.key))}),(0,F.jsx)(bo,{children:(0,F.jsx)(Co,{children:`Close`})})]})})]})}const js=Dn(`/dashboard/workspaces/$workspaceId`)({component:Ps});function Ms(e){let t=String(e??``).trim();if(!t)return``;try{return new URL(t).hostname||t}catch{return t.replace(/^https?:\/\//,``).split(`/`)[0]??t}}function Ns(e){return Ms(e)||`server`}function Ps(){let{workspaceId:e}=js.useParams(),t=Tn(),n=En(),r=A({queryKey:I.session(),queryFn:Xn,staleTime:3e4,retry:!1}),i=A({queryKey:I.workspaces(),queryFn:Qn}),a=(0,M.useMemo)(()=>(i.data?.workspaces??[]).find(t=>t.id===e)??null,[i.data,e]),o=(0,M.useMemo)(()=>is(r.data,a),[r.data,a]),s=(0,M.useMemo)(()=>as(o),[o]),c=(0,M.useMemo)(()=>os(o),[o]),[l,u]=(0,M.useState)(``),[d,f]=(0,M.useState)(``),[p,m]=(0,M.useState)(``),[h,g]=(0,M.useState)([]),[_,ee]=(0,M.useState)(``),[v,y]=(0,M.useState)(``),[b,te]=(0,M.useState)(``),[x,ne]=(0,M.useState)(``),[S,C]=(0,M.useState)(!0),[re,ie]=(0,M.useState)(``),[ae,w]=(0,M.useState)(``),[T,oe]=(0,M.useState)(``),[E,se]=(0,M.useState)(!0),[ce,le]=(0,M.useState)(``),[ue,de]=(0,M.useState)(``),fe=j({mutationFn:async()=>Vr(e,{confirm:_.trim()||(a?.slug??e)}),onSuccess:async()=>{k.success(`Workspace deleted`),await n.invalidateQueries({queryKey:I.workspaces()}),await t({to:`/dashboard/deployments`})},onError:e=>k.error(`Failed to delete workspace`,{description:e.message})});(0,M.useEffect)(()=>{a&&(f((a.owners??[]).join(`,`)),m((a.editors??[]).join(`,`)),u((a.viewers??[]).join(`,`)),g((a.externalTemplateRepos??[]).filter(e=>!!e&&typeof e.id==`string`&&typeof e.name==`string`&&typeof e.repo==`string`).map(e=>({id:String(e.id??``).trim(),name:String(e.name??``).trim(),repo:String(e.repo??``).trim(),defaultBranch:String(e.defaultBranch??``).trim()||void 0}))))},[a]);let pe=A({queryKey:[`userGitCredentials`],queryFn:ur,staleTime:3e4});(0,M.useEffect)(()=>{let e=pe.data;e&&y(e.httpsUsername??``)},[pe.data]);let me=j({mutationFn:async e=>dr(e),onSuccess:async()=>{k.success(`Git credentials updated`),te(``),await n.invalidateQueries({queryKey:[`userGitCredentials`]})},onError:e=>k.error(`Failed to update git credentials`,{description:e.message})}),he=j({mutationFn:fr,onSuccess:async()=>{k.success(`Deploy key rotated`),await n.invalidateQueries({queryKey:[`userGitCredentials`]})},onError:e=>k.error(`Failed to rotate deploy key`,{description:e.message})}),ge=j({mutationFn:async t=>Lr(e,{isPublic:t.isPublic,owners:t.owners,ownerGroups:a?.ownerGroups??[],editors:t.editors,editorGroups:a?.editorGroups??[],viewers:t.viewers,viewerGroups:a?.viewerGroups??[]}),onSuccess:async()=>{k.success(`Workspace updated`),await n.invalidateQueries({queryKey:I.workspaces()})},onError:e=>k.error(`Failed to update workspace`,{description:e.message})}),_e=j({mutationFn:async t=>qr(e,{allowExternalTemplateRepos:(t.externalTemplateRepos??[]).length>0,allowCustomEveServers:!0,allowCustomNetlabServers:!0,externalTemplateRepos:t.externalTemplateRepos??[]}),onSuccess:async()=>{k.success(`Workspace feature flags updated`),await n.invalidateQueries({queryKey:I.workspaces()})},onError:e=>k.error(`Failed to update settings`,{description:e.message})}),ve=A({queryKey:I.workspaceNetlabServers(e),queryFn:async()=>ir(e),staleTime:3e4}),ye=A({queryKey:[`workspaceEveServers`,e],queryFn:async()=>sr(e),staleTime:3e4}),be=j({mutationFn:async()=>ar(e,{name:Ns(x),apiUrl:x.trim(),apiInsecure:S,apiUser:re.trim()||void 0,apiPassword:ae.trim()||void 0}),onSuccess:async()=>{k.success(`Netlab server saved`),ne(``),C(!0),ie(``),w(``),await n.invalidateQueries({queryKey:I.workspaceNetlabServers(e)})},onError:e=>k.error(`Failed to save Netlab server`,{description:e.message})}),xe=j({mutationFn:async t=>or(e,t),onSuccess:async()=>{k.success(`Netlab server deleted`),await n.invalidateQueries({queryKey:I.workspaceNetlabServers(e)})},onError:e=>k.error(`Failed to delete Netlab server`,{description:e.message})}),D=j({mutationFn:async()=>cr(e,{name:Ns(T),apiUrl:T.trim(),skipTlsVerify:E,apiUser:ce.trim()||void 0,apiPassword:ue.trim()||void 0}),onSuccess:async()=>{k.success(`EVE-NG server saved`),oe(``),se(!0),le(``),de(``),await n.invalidateQueries({queryKey:[`workspaceEveServers`,e]})},onError:e=>k.error(`Failed to save EVE-NG server`,{description:e.message})}),Se=j({mutationFn:async t=>lr(e,t),onSuccess:async()=>{k.success(`EVE-NG server deleted`),await n.invalidateQueries({queryKey:[`workspaceEveServers`,e]})},onError:e=>k.error(`Failed to delete EVE-NG server`,{description:e.message})}),Ce=e=>e.split(`,`).map(e=>e.trim()).filter(Boolean);return i.isLoading?(0,F.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,F.jsx)(K,{className:`h-8 w-64`}),(0,F.jsx)(K,{className:`h-28 w-full`})]}):a?(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between border-b pb-6`,children:[(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`h1`,{className:`text-2xl font-bold tracking-tight`,children:a.name}),(0,F.jsxs)(`div`,{className:`mt-1 text-sm text-muted-foreground`,children:[(0,F.jsx)(`span`,{className:`font-mono`,children:a.slug}),` `,(0,F.jsx)(Za,{variant:a.isPublic?`default`:`secondary`,children:a.isPublic?`Public`:`Private`})]})]}),(0,F.jsx)(wn,{to:`/dashboard/deployments`,search:{workspace:a.id},children:(0,F.jsx)(L,{variant:`outline`,children:`Back to deployments`})})]}),(0,F.jsxs)(jo,{defaultValue:`access`,className:`space-y-6`,children:[(0,F.jsxs)(Mo,{children:[(0,F.jsx)(No,{value:`access`,children:`Access`}),(0,F.jsx)(No,{value:`variables`,children:`Variables`}),(0,F.jsx)(No,{value:`features`,children:`Features`}),c&&(0,F.jsx)(No,{value:`danger`,children:`Danger`})]}),(0,F.jsxs)(Po,{value:`access`,className:`space-y-6`,children:[!s&&(0,F.jsx)(R,{children:(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Read-only access`}),(0,F.jsx)(V,{children:`You can view this workspace but cannot edit or delete it.`})]})}),(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Visibility`}),(0,F.jsx)(V,{children:"BYOS Netlab via `topologyUrl` requires public access to the selected topology."})]}),(0,F.jsxs)(H,{className:`flex items-center justify-between`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Public workspace`}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Controls Gitea repo visibility and template accessibility.`})]}),(0,F.jsx)(fo,{checked:!!a.isPublic,disabled:!s,onCheckedChange:e=>{let t=Ce(d);ge.mutate({isPublic:e,owners:t,editors:Ce(p),viewers:Ce(l)})}})]})]}),(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Members`}),(0,F.jsx)(V,{children:`Comma-separated usernames. (Groups are not editable here yet.)`})]}),(0,F.jsxs)(H,{className:`space-y-4`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Owners`}),(0,F.jsx)(J,{value:d,onChange:e=>f(e.target.value),placeholder:`alice,bob`,disabled:!s})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Editors`}),(0,F.jsx)(J,{value:p,onChange:e=>m(e.target.value),placeholder:`alice,bob`,disabled:!s})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Viewers`}),(0,F.jsx)(J,{value:l,onChange:e=>u(e.target.value),placeholder:`alice,bob`,disabled:!s})]}),(0,F.jsx)(`div`,{className:`flex justify-end`,children:(0,F.jsx)(L,{variant:`default`,disabled:!s||ge.isPending,onClick:()=>ge.mutate({isPublic:!!a.isPublic,owners:Ce(d),editors:Ce(p),viewers:Ce(l)}),children:ge.isPending?`Saving…`:`Save members`})})]})]})]}),(0,F.jsx)(Po,{value:`variables`,className:`space-y-6`,children:(0,F.jsx)(ks,{workspaceId:e,allowEdit:s})}),(0,F.jsx)(Po,{value:`features`,className:`space-y-6`,children:(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Workspace features`}),(0,F.jsx)(V,{children:`Configure external template sources and BYOS servers for this workspace.`})]}),(0,F.jsxs)(H,{className:`space-y-4`,children:[(0,F.jsxs)(`div`,{className:`rounded-md border p-3 space-y-3`,children:[(0,F.jsx)(`div`,{className:`text-sm font-medium`,children:`BYOS Netlab servers`}),(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Add one or more Netlab API endpoints. When at least one is configured, `,(0,F.jsx)(`span`,{className:`font-mono`,children:`Netlab (BYOS)`}),` becomes available in Create deployment.`]}),(0,F.jsx)(`div`,{className:`space-y-2`,children:(ve.data?.servers??[]).length===0?(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`No Netlab servers configured.`}):(ve.data?.servers??[]).map(e=>(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3 rounded-md border p-3`,children:[(0,F.jsxs)(`div`,{className:`min-w-0`,children:[(0,F.jsx)(`div`,{className:`font-medium`,children:Ms(e.apiUrl)||e.name}),(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground truncate`,children:[e.apiUrl,` `,e.apiInsecure?`(insecure)`:``,` `,e.apiUser?`· ${e.apiUser}`:``,` `,e.hasPassword?`· password set`:``]})]}),(0,F.jsx)(L,{type:`button`,variant:`destructive`,size:`sm`,disabled:!s||xe.isPending,onClick:()=>xe.mutate(e.id),children:`Delete`})]},e.id))}),(0,F.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`API URL`}),(0,F.jsx)(J,{value:x,disabled:!s,onChange:e=>ne(e.target.value),placeholder:`https://netlab.local.forwardnetworks.com:8080`}),(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Custom ports are supported (e.g. `,(0,F.jsx)(`span`,{className:`font-mono`,children:`:8080`}),`) but won’t be shown in dropdown labels.`]})]}),(0,F.jsxs)(`div`,{className:`flex items-center justify-between rounded-md border p-3 md:col-span-2`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(`div`,{className:`text-sm font-medium`,children:`Skip TLS verification`}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Disable certificate verification for this server.`})]}),(0,F.jsx)(fo,{checked:S,onCheckedChange:C,disabled:!s})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Username`}),(0,F.jsx)(J,{value:re,disabled:!s,onChange:e=>ie(e.target.value),placeholder:`user`})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Password`}),(0,F.jsx)(J,{value:ae,disabled:!s,onChange:e=>w(e.target.value),placeholder:`password`,type:`password`})]})]}),(0,F.jsx)(`div`,{className:`flex justify-end`,children:(0,F.jsx)(L,{type:`button`,disabled:!s||be.isPending||!x.trim(),onClick:()=>be.mutate(),children:be.isPending?`Saving…`:`Add Netlab server`})})]}),(0,F.jsxs)(`div`,{className:`rounded-md border p-3 space-y-3`,children:[(0,F.jsx)(`div`,{className:`text-sm font-medium`,children:`BYOS EVE-NG servers (LabPP)`}),(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Add one or more EVE-NG API endpoints. When at least one is configured, `,(0,F.jsx)(`span`,{className:`font-mono`,children:`LabPP`}),` becomes available in Create deployment.`]}),(0,F.jsx)(`div`,{className:`space-y-2`,children:(ye.data?.servers??[]).length===0?(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`No EVE-NG servers configured.`}):(ye.data?.servers??[]).map(e=>(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3 rounded-md border p-3`,children:[(0,F.jsxs)(`div`,{className:`min-w-0`,children:[(0,F.jsx)(`div`,{className:`font-medium`,children:Ms(e.apiUrl)||e.name}),(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground truncate`,children:[e.apiUrl,` `,e.skipTlsVerify?`(skip TLS verify)`:``,` `,e.apiUser?`· ${e.apiUser}`:``,` `,e.hasPassword?`· password set`:``]})]}),(0,F.jsx)(L,{type:`button`,variant:`destructive`,size:`sm`,disabled:!s||Se.isPending,onClick:()=>Se.mutate(e.id),children:`Delete`})]},e.id))}),(0,F.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`API URL`}),(0,F.jsx)(J,{value:T,disabled:!s,onChange:e=>oe(e.target.value),placeholder:`https://eve.example:8080/api`}),(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Custom ports are supported (e.g. `,(0,F.jsx)(`span`,{className:`font-mono`,children:`:8080`}),`) but won’t be shown in dropdown labels.`]})]}),(0,F.jsxs)(`div`,{className:`flex items-center justify-between rounded-md border p-3 md:col-span-2`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(`div`,{className:`text-sm font-medium`,children:`Skip TLS verification`}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Disable certificate verification for this server.`})]}),(0,F.jsx)(fo,{checked:E,onCheckedChange:se,disabled:!s})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Username`}),(0,F.jsx)(J,{value:ce,disabled:!s,onChange:e=>le(e.target.value),placeholder:`user`})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Password`}),(0,F.jsx)(J,{value:ue,disabled:!s,onChange:e=>de(e.target.value),placeholder:`password`,type:`password`})]})]}),(0,F.jsx)(`div`,{className:`flex justify-end`,children:(0,F.jsx)(L,{type:`button`,disabled:!s||D.isPending||!T.trim(),onClick:()=>D.mutate(),children:D.isPending?`Saving…`:`Add EVE-NG server`})})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,F.jsxs)(`div`,{children:[(0,F.jsx)(q,{children:`External template repos`}),(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Repos are either `,(0,F.jsx)(`span`,{className:`font-mono`,children:`owner/repo`}),` (Gitea) or a git URL (https://… or git@host:repo.git). Used by the deployment UI when Template source is set to External repo.`]})]}),(0,F.jsx)(L,{type:`button`,variant:`outline`,size:`sm`,disabled:!s,onClick:()=>g(e=>[...e,{id:`repo-${e.length+1}`,name:`Repo ${e.length+1}`,repo:``,defaultBranch:``}]),children:`Add repo`})]}),(0,F.jsx)(`div`,{className:`space-y-3`,children:h.length===0?(0,F.jsx)(`div`,{className:`rounded-md border bg-muted/30 p-3 text-sm text-muted-foreground`,children:`No external repos configured.`}):h.map((e,t)=>(0,F.jsxs)(`div`,{className:`rounded-md border p-3 space-y-3`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,F.jsxs)(`div`,{className:`text-sm font-medium`,children:[`Repo `,t+1]}),(0,F.jsx)(L,{type:`button`,variant:`ghost`,size:`sm`,disabled:!s,onClick:()=>g(e=>e.filter((e,n)=>n!==t)),children:`Remove`})]}),(0,F.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`ID`}),(0,F.jsx)(J,{value:e.id,disabled:!s,onChange:e=>g(n=>n.map((n,r)=>r===t?{...n,id:e.target.value}:n)),placeholder:`my-repo`})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Name`}),(0,F.jsx)(J,{value:e.name,disabled:!s,onChange:e=>g(n=>n.map((n,r)=>r===t?{...n,name:e.target.value}:n)),placeholder:`My templates`})]}),(0,F.jsxs)(`div`,{className:`space-y-1 md:col-span-2`,children:[(0,F.jsx)(q,{children:`Repo`}),(0,F.jsx)(J,{value:e.repo,disabled:!s,onChange:e=>g(n=>n.map((n,r)=>r===t?{...n,repo:e.target.value}:n)),placeholder:`owner/repo`})]}),(0,F.jsxs)(`div`,{className:`space-y-1 md:col-span-2`,children:[(0,F.jsx)(q,{children:`Default branch`}),(0,F.jsx)(J,{value:e.defaultBranch??``,disabled:!s,onChange:e=>g(n=>n.map((n,r)=>r===t?{...n,defaultBranch:e.target.value}:n)),placeholder:`main`})]})]})]},`${e.id}-${t}`))})]}),(0,F.jsxs)(`div`,{className:`rounded-md border p-3 space-y-3`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`div`,{className:`text-sm font-medium`,children:`Git credentials (your user)`}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Use this deploy key for SSH-based repos and an HTTPS token for https:// clones.`})]}),(0,F.jsxs)(`div`,{className:`flex gap-2`,children:[(0,F.jsx)(L,{type:`button`,variant:`outline`,size:`sm`,disabled:he.isPending||pe.isLoading,onClick:()=>he.mutate(),children:`Rotate key`}),(0,F.jsx)(L,{type:`button`,variant:`outline`,size:`sm`,disabled:!pe.data?.sshPublicKey,onClick:async()=>{let e=pe.data?.sshPublicKey??``;try{await navigator.clipboard.writeText(e),k.success(`Copied public key`)}catch{k.error(`Failed to copy`)}},children:`Copy public key`})]})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`SSH deploy key (public)`}),(0,F.jsx)(xs,{readOnly:!0,value:pe.data?.sshPublicKey??``,placeholder:`Loading…`})]}),(0,F.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`HTTPS username`}),(0,F.jsx)(J,{value:v,disabled:me.isPending,onChange:e=>y(e.target.value),placeholder:`username`})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`HTTPS token`}),(0,F.jsx)(J,{value:b,disabled:me.isPending,onChange:e=>te(e.target.value),placeholder:`token`,type:`password`})]})]}),(0,F.jsxs)(`div`,{className:`flex justify-end gap-2`,children:[(0,F.jsx)(L,{type:`button`,variant:`secondary`,disabled:me.isPending||pe.isLoading||!pe.data?.hasHttpsToken,onClick:()=>me.mutate({httpsUsername:v,clearToken:!0}),children:`Clear token`}),(0,F.jsx)(L,{type:`button`,disabled:me.isPending||pe.isLoading,onClick:()=>me.mutate({httpsUsername:v,httpsToken:b}),children:`Save git credentials`})]})]}),(0,F.jsx)(`div`,{className:`flex justify-end`,children:(0,F.jsx)(L,{variant:`default`,disabled:!s||_e.isPending,onClick:()=>{let e=h.map(e=>({id:String(e.id??``).trim(),name:String(e.name??``).trim(),repo:String(e.repo??``).trim(),defaultBranch:String(e.defaultBranch??``).trim()||void 0})).filter(e=>e.id&&e.name&&e.repo);if(e.some(e=>!e.id||!e.name||!e.repo)){k.error(`External repos must include id, name, and repo`);return}_e.mutate({externalTemplateRepos:e})},children:_e.isPending?`Saving…`:`Save settings`})})]})]})}),c&&(0,F.jsx)(Po,{value:`danger`,className:`space-y-6`,children:(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Delete workspace`}),(0,F.jsx)(V,{children:`Deletes the workspace and backing resources. This cannot be undone.`})]}),(0,F.jsxs)(H,{className:`space-y-4`,children:[(0,F.jsxs)(`div`,{className:`text-sm text-muted-foreground`,children:[`Type `,(0,F.jsx)(`span`,{className:`font-mono`,children:a.slug}),` to confirm.`]}),(0,F.jsx)(J,{value:_,onChange:e=>ee(e.target.value),placeholder:a.slug}),(0,F.jsx)(`div`,{className:`flex justify-end`,children:(0,F.jsx)(L,{variant:`destructive`,disabled:fe.isPending||_.trim().toLowerCase()!==a.slug.toLowerCase(),onClick:()=>fe.mutate(),children:fe.isPending?`Deleting…`:`Delete workspace`})})]})]})})]})]}):(0,F.jsxs)(`div`,{className:`p-6 space-y-4`,children:[(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Workspace not found.`}),(0,F.jsx)(L,{variant:`outline`,onClick:()=>t({to:`/dashboard/workspaces`}),children:`Back`})]})}function Fs(e,t){let n=En(),r=(0,M.useMemo)(()=>`${qn}/runs/${encodeURIComponent(e)}/events`,[e]);(0,M.useEffect)(()=>{if(!t||!e)return;let i=ja(r,{output:t=>{try{console.log(`Run event:`,t.data);let r=JSON.parse(t.data);if(!r||!Array.isArray(r.entries))return;n.setQueryData(I.runLogs(e),e=>{let t=(e?.entries??[]).concat(r.entries);return{cursor:Number(r.cursor??e?.cursor??0),entries:t}})}catch{}}});return()=>{i.close()}},[t,n,e,r])}const Is=Dn(`/dashboard/runs/$runId`)({component:Ls});function Ls(){let{runId:e}=Is.useParams();Fs(e,!0);let t=En(),n=Tn(),r=A({queryKey:I.dashboardSnapshot(),queryFn:$n,initialData:()=>t.getQueryData(I.dashboardSnapshot())??null,retry:!1,staleTime:1/0}),i=(r.data?.runs??[]).find(t=>String(t.id??``)===e),a=String(i?.status??``).toLowerCase(),o=a===`queued`||a===`running`,s=A({queryKey:I.runLogs(e),queryFn:async()=>({cursor:0,entries:[]}),retry:!1,staleTime:1/0}),c=Jn(window.location.pathname+window.location.search);return(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsx)(R,{variant:`glass`,children:(0,F.jsx)(z,{children:(0,F.jsxs)(`div`,{className:`flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between`,children:[(0,F.jsx)(`div`,{children:(0,F.jsxs)(B,{children:[`Run `,e]})}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(wn,{className:ra({variant:`outline`,size:`sm`}),to:`/dashboard/deployments`,children:`Back`}),(0,F.jsx)(L,{variant:`destructive`,size:`sm`,disabled:!i||!o,onClick:()=>{if(!i)return;let r=String(i.workspaceId??``);if(!r){k.error(`Cannot cancel run`,{description:`Missing workspace ID.`});return}(async()=>{try{await vi(e,r),k.success(`Run canceled`),await t.invalidateQueries({queryKey:I.dashboardSnapshot()}),n({to:`/dashboard/deployments`,search:{workspace:r}})}catch(e){k.error(`Cancel failed`,{description:e.message})}})()},children:`Cancel`}),(0,F.jsx)(L,{variant:`outline`,size:`sm`,onClick:()=>t.setQueryData(I.runLogs(e),{cursor:0,entries:[]}),children:`Clear`})]})]})})}),!r.data&&(0,F.jsx)(R,{className:`border-dashed`,children:(0,F.jsxs)(H,{className:`pt-6 text-center text-muted-foreground`,children:[`Loading dashboard…`,(0,F.jsxs)(`div`,{className:`mt-2 text-xs`,children:[`If you are logged out,`,` `,(0,F.jsx)(`a`,{className:`text-primary underline hover:no-underline`,href:c,onClick:e=>{e.preventDefault(),(async()=>{if(!await wi({loginHref:c})){window.location.href=c;return}await t.invalidateQueries({queryKey:I.session()})})()},children:`login`}),`.`]})]})}),(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{children:(0,F.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,F.jsx)(B,{children:`Metadata`}),(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Cursor: `,String(s.data?.cursor??0)]})]})}),(0,F.jsx)(H,{children:(0,F.jsxs)(`div`,{className:`grid grid-cols-1 gap-4 md:grid-cols-3`,children:[(0,F.jsx)(Rs,{label:`Type`,value:String(i?.tpl_alias??``)}),(0,F.jsx)(Rs,{label:`Status`,value:String(i?.status??``)}),(0,F.jsx)(Rs,{label:`Workspace`,value:String(i?.workspaceId??``)}),(0,F.jsx)(Rs,{label:`Created`,value:String(i?.created??``)}),(0,F.jsx)(Rs,{label:`Started`,value:String(i?.start??``)}),(0,F.jsx)(Rs,{label:`Finished`,value:String(i?.end??``)})]})})]}),(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{children:(0,F.jsx)(B,{children:`Output`})}),(0,F.jsx)(H,{children:(0,F.jsx)(`div`,{className:`rounded-md border bg-zinc-950 p-4 font-mono text-xs text-zinc-100`,children:(0,F.jsx)(zs,{entries:s.data?.entries??[]})})})]})]})}function Rs(e){return(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(`div`,{className:`text-[11px] uppercase tracking-wide text-muted-foreground`,children:e.label}),(0,F.jsx)(`div`,{className:`break-all font-medium text-sm`,children:e.value||`—`})]})}function zs(e){let t=(0,M.useRef)(null);return(0,M.useEffect)(()=>{let e=t.current;e&&(e.scrollTop=e.scrollHeight)},[e.entries.length]),e.entries.length===0?(0,F.jsx)(`div`,{className:`text-zinc-500`,children:`Waiting for output…`}):(0,F.jsx)(`div`,{ref:t,className:`max-h-[65vh] overflow-auto whitespace-pre-wrap`,children:e.entries.map((e,t)=>(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`span`,{className:`text-zinc-500 select-none`,children:e.time?`${e.time} `:``}),(0,F.jsx)(`span`,{children:e.output})]},`${e.time}-${t}`))})}function Bs(){return{downloadImage:(0,M.useCallback)((e,t)=>{e&&Un(e,{cacheBust:!0,backgroundColor:`#18181b`}).then(e=>{let n=document.createElement(`a`);n.download=t,n.href=e,n.click()}).catch(e=>{console.error(`Failed to download image`,e)})},[])}}var Vs=Vn(),Hs=Gn();function Us({workspaceId:e,deploymentId:t,nodeId:n,nodeKind:r,onClose:i,className:a}){let o=(0,M.useRef)(null),s=(0,M.useRef)(null),c=(0,M.useRef)(null),l=(0,M.useRef)(null),[u,d]=(0,M.useState)(`disconnected`),f=(0,M.useMemo)(()=>{let e=String(r??``).toLowerCase();return e.includes(`eos`)||e.includes(`ceos`)?`Cli`:`sh`},[r]),p=(0,M.useMemo)(()=>{if(!e||!t||!n)return``;let r=`${window.location.protocol===`https:`?`wss`:`ws`}://${window.location.host}/api/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/terminal/ws`,i=new URLSearchParams;return i.set(`node`,n),i.set(`command`,f),`${r}?${i.toString()}`},[f,t,n,e]);return(0,M.useEffect)(()=>{if(!o.current||!p)return;let e=new Vs.Terminal({convertEol:!0,cursorBlink:!0,fontFamily:`ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace`,fontSize:12,theme:{background:`#09090b`}}),t=new Hs.FitAddon;e.loadAddon(t),e.open(o.current),t.fit(),e.writeln(`\x1B[1mSkyforge Terminal\x1B[0m`),e.writeln(`Node: ${n}  Command: ${f}`),e.writeln(``),s.current=e,c.current=t;let r=new WebSocket(p);l.current=r,d(`connecting`);let i=()=>{let e=s.current;if(!e)return;let t=e.cols??80,n=e.rows??24;try{r.send(JSON.stringify({type:`resize`,cols:t,rows:n}))}catch{}};r.onopen=()=>{d(`connected`),i(),e.focus()},r.onmessage=t=>{let n=null;try{n=JSON.parse(String(t.data))}catch{e.write(String(t.data));return}if(n){if(n.type===`output`){e.write(n.data??``);return}if(n.type===`info`){e.writeln(`\r\n[info] ${n.data??``}`);return}if(n.type===`error`){e.writeln(`\r\n[error] ${n.data??``}`);return}}},r.onclose=t=>{d(`closed`);let n=typeof t.code==`number`?t.code:0,r=t.reason?` ${t.reason}`:``;e.writeln(`\r\n[disconnected]${n?` (code ${n})`:``}${r}`)},r.onerror=()=>{d(`error`),e.writeln(`\r
[error] websocket error (check browser console/network)`)};let a=e.onData(e=>{try{r.send(JSON.stringify({type:`stdin`,data:e}))}catch{}}),u=()=>{t.fit(),i()};return window.addEventListener(`resize`,u),()=>{window.removeEventListener(`resize`,u),a.dispose();try{r.close()}catch{}l.current=null,e.dispose(),s.current=null,c.current=null,d(`disconnected`)}},[f,n,p]),(0,F.jsxs)(`div`,{className:`flex flex-col h-full w-full ${a??``}`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-2 p-2 text-xs text-muted-foreground bg-zinc-900 border-b border-zinc-800`,children:[(0,F.jsxs)(`div`,{className:`truncate`,children:[(0,F.jsx)(`span`,{className:`font-mono text-zinc-300`,children:n}),(0,F.jsx)(`span`,{className:`mx-2 text-zinc-600`,children:`/`}),(0,F.jsx)(`span`,{children:u})]}),i?(0,F.jsx)(L,{variant:`ghost`,size:`sm`,className:`h-6 px-2 text-xs`,onClick:()=>{let e=l.current;if(e&&e.readyState===WebSocket.OPEN)try{e.close()}catch{}i()},children:`Close`}):null]}),(0,F.jsx)(`div`,{className:`flex-1 bg-zinc-950 p-2 min-h-0`,children:(0,F.jsx)(`div`,{ref:o,className:`h-full w-full`})})]})}function Ws({open:e,onOpenChange:t,workspaceId:n,deploymentId:r,nodeId:i,nodeKind:a}){let o=`${n}-${r}-${i}-${e}`;return(0,F.jsx)(Ri,{open:e,onOpenChange:t,children:(0,F.jsxs)(Vi,{className:`max-w-5xl h-[70vh] flex flex-col p-0 gap-0 overflow-hidden`,children:[(0,F.jsx)(Hi,{className:`px-6 py-4 border-b`,children:(0,F.jsxs)(Wi,{className:`flex items-center gap-2`,children:[(0,F.jsx)(ue,{className:`h-4 w-4`}),`Terminal`]})}),(0,F.jsx)(`div`,{className:`flex-1 min-h-0`,children:e?(0,F.jsx)(Us,{workspaceId:n,deploymentId:r,nodeId:i,nodeKind:a,onClose:()=>t(!1)},o):null})]})})}function Gs({workspaceId:e,deploymentId:t,nodeId:n,nodeKind:r,nodeIp:i,onClose:a,className:o}){let s=(0,M.useMemo)(()=>{let e=[n];return r&&e.push(String(r)),e.join(` • `)},[n,r]),c=A({queryKey:[`deploymentNodeLogs`,e,t,n,400],enabled:!!e&&!!t&&!!n,queryFn:async()=>xr(e,t,n,{tail:400,container:n}),refetchOnWindowFocus:!1,retry:1});return(0,F.jsxs)(`div`,{className:`flex flex-col h-full w-full ${o??``}`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-2 p-2 border-b bg-muted/40 text-xs`,children:[(0,F.jsxs)(`div`,{className:`truncate flex items-center gap-2`,children:[(0,F.jsx)(`span`,{className:`font-mono font-medium`,children:s}),i?(0,F.jsx)(`span`,{className:`font-mono text-muted-foreground`,children:i}):null,c.data?.namespace&&c.data?.podName?(0,F.jsxs)(`span`,{className:`text-muted-foreground`,children:[c.data.namespace,`/`,c.data.podName]}):null]}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsxs)(L,{variant:`outline`,size:`sm`,className:`h-7`,onClick:()=>c.refetch(),disabled:c.isFetching,children:[(0,F.jsx)(qt,{className:c.isFetching?`mr-2 h-3 w-3 animate-spin`:`mr-2 h-3 w-3`}),`Refresh`]}),a?(0,F.jsx)(L,{variant:`ghost`,size:`sm`,className:`h-7`,onClick:a,children:`Close`}):null]})]}),(0,F.jsx)(`div`,{className:`flex-1 overflow-auto bg-muted/10 p-4`,children:(0,F.jsx)(`pre`,{className:`text-xs font-mono whitespace-pre-wrap`,children:c.isLoading?`Loading…`:c.isError?`Failed to load logs: ${String(c.error)}`:c.data?.logs||``})})]})}function Ks({open:e,onOpenChange:t,workspaceId:n,deploymentId:r,nodeId:i,nodeKind:a,nodeIp:o}){return(0,F.jsx)(Ri,{open:e,onOpenChange:t,children:(0,F.jsxs)(Vi,{className:`max-w-5xl h-[70vh] flex flex-col p-0 gap-0 overflow-hidden`,children:[(0,F.jsx)(Hi,{className:`px-6 py-4 border-b`,children:(0,F.jsxs)(Wi,{className:`flex items-center gap-2`,children:[(0,F.jsx)(ue,{className:`h-4 w-4`}),`Node logs`]})}),(0,F.jsx)(`div`,{className:`flex-1 min-h-0`,children:e?(0,F.jsx)(Gs,{workspaceId:n,deploymentId:r,nodeId:i,nodeKind:a,nodeIp:o,onClose:()=>t(!1)}):null})]})})}function qs({workspaceId:e,deploymentId:t,nodeId:n,nodeKind:r,nodeIp:i,onClose:a,className:o}){let s=(0,M.useMemo)(()=>{let e=[n];return r&&e.push(String(r)),e.join(` • `)},[n,r]),c=A({queryKey:[`deploymentNodeDescribe`,e,t,n],enabled:!!e&&!!t&&!!n,queryFn:async()=>Sr(e,t,n),refetchOnWindowFocus:!1,retry:1});return(0,F.jsxs)(`div`,{className:`flex flex-col h-full w-full ${o??``}`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-2 p-2 border-b bg-muted/40 text-xs`,children:[(0,F.jsxs)(`div`,{className:`truncate flex items-center gap-2`,children:[(0,F.jsx)(`span`,{className:`font-mono font-medium`,children:s}),i?(0,F.jsx)(`span`,{className:`font-mono text-muted-foreground`,children:i}):null]}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsxs)(L,{variant:`outline`,size:`sm`,className:`h-7`,onClick:()=>c.refetch(),disabled:c.isFetching,children:[(0,F.jsx)(qt,{className:c.isFetching?`mr-2 h-3 w-3 animate-spin`:`mr-2 h-3 w-3`}),`Refresh`]}),a?(0,F.jsx)(L,{variant:`ghost`,size:`sm`,className:`h-7`,onClick:a,children:`Close`}):null]})]}),(0,F.jsx)(`div`,{className:`flex-1 overflow-auto bg-muted/10 p-4`,children:(0,F.jsx)(`pre`,{className:`text-xs font-mono whitespace-pre-wrap`,children:c.isLoading?`Loading…`:c.isError?`Failed to load node status: ${String(c.error)}`:JSON.stringify(c.data??{},null,2)})})]})}function Js({open:e,onOpenChange:t,workspaceId:n,deploymentId:r,nodeId:i,nodeKind:a,nodeIp:o}){return(0,F.jsx)(Ri,{open:e,onOpenChange:t,children:(0,F.jsxs)(Vi,{className:`max-w-5xl h-[70vh] flex flex-col p-0 gap-0 overflow-hidden`,children:[(0,F.jsx)(Hi,{className:`px-6 py-4 border-b`,children:(0,F.jsxs)(Wi,{className:`flex items-center gap-2`,children:[(0,F.jsx)(ue,{className:`h-4 w-4`}),`Node status`]})}),(0,F.jsx)(`div`,{className:`flex-1 min-h-0`,children:e?(0,F.jsx)(qs,{workspaceId:n,deploymentId:r,nodeId:i,nodeKind:a,nodeIp:o,onClose:()=>t(!1)}):null})]})})}function Ys(e,t,n){let r=En(),i=(0,M.useMemo)(()=>`${qn}/workspaces/${encodeURIComponent(e)}/deployments/${encodeURIComponent(t)}/ui-events/events`,[t,e]);(0,M.useEffect)(()=>{if(!n||!e||!t)return;let a=n=>{try{let i=JSON.parse(n.data);if(!i||!Array.isArray(i.events))return;r.setQueryData(I.deploymentUIEvents(e,t),e=>{let t=(e?.events??[]).concat(i.events),n=t.slice(Math.max(0,t.length-300));return{cursor:Number(i.cursor??e?.cursor??0),events:n}})}catch{}},o=ja(i,{"ui-events":a});return()=>o.close()},[t,n,r,i,e])}var Xs={custom:({data:e})=>{let t=e.icon===`switch`?dt:e.icon===`cloud`?fe:e.icon===`client`?an:Ie,n=e.status===`running`?`default`:e.status===`stopped`?`secondary`:`destructive`,r=!!e?.highlight,i=String(e?.vendor??``);return(0,F.jsxs)(R,{className:`min-w-[180px] border-2 shadow-md ${r?`border-primary ring-2 ring-primary/30`:``}`,children:[(0,F.jsx)(z,{className:`p-3 pb-2`,children:(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(({vendor:e})=>{let t=String(e).toLowerCase();return t===`cisco`?(0,F.jsx)(`div`,{className:`h-6 w-6 rounded-md flex items-center justify-center`,title:`Cisco`,style:{background:`rgba(0, 142, 204, 0.15)`,color:`rgb(0, 142, 204)`},children:(0,F.jsx)(`svg`,{viewBox:`0 0 24 24`,width:`16`,height:`16`,"aria-hidden":`true`,children:[{x:4,h:8},{x:7,h:10},{x:10,h:12},{x:13,h:10},{x:16,h:8}].map(e=>(0,F.jsx)(`rect`,{x:e.x,y:14-e.h,width:`2`,height:e.h,rx:`1`,fill:`currentColor`},e.x))})}):t===`arista`?(0,F.jsx)(`div`,{className:`h-6 w-6 rounded-md flex items-center justify-center`,title:`Arista`,style:{background:`rgba(232, 43, 44, 0.14)`,color:`rgb(232, 43, 44)`},children:(0,F.jsx)(`svg`,{viewBox:`0 0 24 24`,width:`16`,height:`16`,"aria-hidden":`true`,children:(0,F.jsx)(`path`,{d:`M12 3 4.5 21h3.6l1.6-4h4.6l1.6 4h3.6L12 3zm-1 11 1-2.6 1 2.6h-2z`,fill:`currentColor`})})}):t===`linux`?(0,F.jsx)(`div`,{className:`h-6 w-6 rounded-md flex items-center justify-center`,title:`Linux`,style:{background:`rgba(34, 197, 94, 0.12)`,color:`rgb(34, 197, 94)`},children:(0,F.jsxs)(`svg`,{viewBox:`0 0 24 24`,width:`16`,height:`16`,"aria-hidden":`true`,children:[(0,F.jsx)(`circle`,{cx:`12`,cy:`9`,r:`4`,fill:`#111827`}),(0,F.jsx)(`ellipse`,{cx:`12`,cy:`16`,rx:`5`,ry:`6`,fill:`#111827`}),(0,F.jsx)(`ellipse`,{cx:`12`,cy:`17`,rx:`3.3`,ry:`4.2`,fill:`#ffffff`}),(0,F.jsx)(`path`,{d:`M12 10l2 1-2 1-2-1 2-1z`,fill:`#f59e0b`})]})}):(0,F.jsx)(`div`,{className:`h-6 w-6 rounded-md flex items-center justify-center bg-muted text-[11px] font-bold`,title:`Unknown`,children:`?`})},{vendor:i}),(0,F.jsx)(`div`,{className:`p-1.5 bg-muted rounded-md`,title:String(e?.kind??``),children:(0,F.jsx)(t,{className:`w-4 h-4`})})]}),(0,F.jsx)(Za,{variant:n,className:`text-[10px] h-5`,children:String(e.status)})]})}),(0,F.jsxs)(H,{className:`p-3 pt-0`,children:[(0,F.jsx)(B,{className:`text-sm font-bold truncate`,children:String(e.label)}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground mt-1 truncate font-mono`,children:String(e.ip||`10.0.0.x`)}),(0,F.jsx)(Zt,{type:`target`,position:Ht.Top,className:`!bg-muted-foreground`}),(0,F.jsx)(Zt,{type:`source`,position:Ht.Bottom,className:`!bg-muted-foreground`})]})]})}};function Zs({topology:e,workspaceId:t,deploymentId:n,enableTerminal:r,fullHeight:i,className:a}){let o=(0,M.useCallback)(e=>{let t=String(e??``).toLowerCase();return t?t.includes(`arista`)||t.includes(`eos`)||t.includes(`ceos`)||t.includes(`veos`)?`arista`:t.includes(`cisco`)||t.includes(`ios`)||t.includes(`nxos`)||t.includes(`csr`)||t.includes(`c8k`)||t.includes(`iosxr`)?`cisco`:t.includes(`linux`)||t.includes(`ubuntu`)||t.includes(`debian`)||t.includes(`alpine`)||t.includes(`rocky`)||t.includes(`centos`)?`linux`:`unknown`:`unknown`},[]),s=(0,M.useMemo)(()=>{if(!e||!Array.isArray(e.nodes)||e.nodes.length===0)return{nodes:[],edges:[]};let t=Math.max(1,Math.ceil(Math.sqrt(e.nodes.length)));return{nodes:e.nodes.map((e,n)=>{let r=n%t,i=Math.floor(n/t),a=String(e.kind??``),s=o(a),c=s===`linux`?`client`:s===`arista`||s===`cisco`?`switch`:`server`,l=String(e.status??`unknown`),u=String(e.pingIp??e.mgmtIp??``),d=String(e.mgmtHost??``);return{id:String(e.id),position:{x:r*240,y:i*160},data:{label:String(e.label??e.id),icon:c,status:l,ip:u,mgmtHost:d,kind:a,vendor:s},type:`custom`}}),edges:(e.edges??[]).map(e=>({id:String(e.id),source:String(e.source),target:String(e.target),label:e.label?String(e.label):void 0,animated:!1}))}},[e,o]),[c,l,u]=pt(s.nodes),[d,f,p]=ct(s.edges),m=(0,M.useRef)(null),{downloadImage:h}=Bs(),[_,ee]=(0,M.useState)(null),[v,y]=(0,M.useState)(null),[b,te]=(0,M.useState)(null),[x,ne]=(0,M.useState)(null),[S,C]=(0,M.useState)(null),[re,ie]=(0,M.useState)(null),[ae,w]=(0,M.useState)(!1),[T,oe]=(0,M.useState)(!1),[E,se]=(0,M.useState)(!1),[ce,le]=(0,M.useState)(null),[ue,de]=(0,M.useState)({}),fe=(0,M.useRef)(null),pe=(0,M.useRef)({}),me=(0,M.useRef)(!1),[he,ge]=(0,M.useState)(``),[_e,ve]=(0,M.useState)(`grid`),ye=(0,M.useMemo)(()=>!t||!n?``:`skyforge.topology.positions.${t}.${n}`,[n,t]),[be,xe]=(0,M.useState)(()=>({})),[D,Se]=(0,M.useState)(null),[Ce,we]=(0,M.useState)(!1),[Te,Ee]=(0,M.useState)(null),[De,Oe]=(0,M.useState)(!1),[ke,Ae]=(0,M.useState)(!1),[je,Me]=(0,M.useState)(null),[Ne,Pe]=(0,M.useState)({side:`source`,duration:`10`,packets:`2500`,snaplen:`192`}),[Fe,Ie]=(0,M.useState)(!1),[Le,Re]=(0,M.useState)(null),[O,ze]=(0,M.useState)({delayMs:``,jitterMs:``,lossPct:``,dupPct:``,corruptPct:``,reorderPct:``,rateKbps:``});(0,M.useEffect)(()=>{if(ye)try{let e=window.localStorage.getItem(ye);if(!e)return;let t=JSON.parse(e);t&&typeof t==`object`&&xe(t)}catch{}},[ye]);let Be=!!(t&&n);Ys(t??``,n??``,Be);let He=A({queryKey:t&&n?I.deploymentUIEvents(t,n):[`deploymentUIEvents`,`none`],queryFn:async()=>({cursor:0,events:[]}),initialData:{cursor:0,events:[]},staleTime:1/0,enabled:Be}),Ue=(0,M.useMemo)(()=>ec(He.data?.events??[]),[He.data?.events]);(0,M.useEffect)(()=>{l(nc(s.nodes,_e,be,he)),pe.current=Object.fromEntries(s.edges.map(e=>[String(e.id),typeof e.label==`string`?e.label:void 0])),f(tc(s.edges,ue,E,pe.current,Ue))},[s.edges,s.nodes,Ue,ue,_e,be,he,f,l,E]),(0,M.useEffect)(()=>{f(e=>tc(e,ue,E,pe.current,Ue))},[Ue,ue,f,E]),(0,M.useEffect)(()=>{if(!t||!n||me.current)return;let e=new URLSearchParams(window.location.search),r=e.get(`node`)?.trim(),i=e.get(`action`)?.trim();if(!r||!i){me.current=!0;return}i===`terminal`&&ee({id:r}),i===`logs`&&y({id:r}),i===`describe`&&te({id:r}),i===`interfaces`&&(Se({id:r}),we(!0)),i===`running-config`&&(Ee({id:r}),Oe(!0)),me.current=!0,e.delete(`node`),e.delete(`action`);let a=e.toString(),o=`${window.location.pathname}${a?`?${a}`:``}${window.location.hash||``}`;window.history.replaceState(null,``,o)},[n,t]),(0,M.useEffect)(()=>{if(!x)return;let e=()=>ne(null),t=e=>{e.key===`Escape`&&ne(null)};return window.addEventListener(`click`,e),window.addEventListener(`keydown`,t),()=>{window.removeEventListener(`click`,e),window.removeEventListener(`keydown`,t)}},[x]);let We=j({mutationFn:async e=>{if(!t||!n)throw Error(`missing workspace/deployment`);return Cr(t,n,e)},onSuccess:(e,t)=>{if(e?.skipped){k.message(`Save config skipped`,{description:e.message||`Node ${t}`});return}k.success(`Save config queued/applied`,{description:e.stdout||`Node ${t}`})},onError:e=>{k.error(`Save config failed`,{description:e?.message??String(e)})}}),Ge=j({mutationFn:async e=>{if(!t||!n)throw Error(`missing workspace/deployment`);return gr(t,n,e)},onSuccess:e=>{let t=e.results.filter(e=>e.error);if(t.length){k.error(`Link admin applied with errors`,{description:t.map(e=>`${e.node}: ${e.error}`).join(`; `)});return}k.success(`Link ${e.action} applied`)},onError:e=>k.error(`Link admin failed`,{description:e?.message??String(e)})}),Ke=j({mutationFn:async e=>{if(!t||!n)throw Error(`missing workspace/deployment`);return _r(t,n,e)},onSuccess:e=>{k.success(`Pcap captured`,{description:`${e.sizeBytes} bytes • ${e.artifactKey}`})},onError:e=>k.error(`Pcap capture failed`,{description:e?.message??String(e)})}),qe=j({mutationFn:async e=>{if(!t||!n)throw Error(`missing workspace/deployment`);return vr(t,n,e)},onError:e=>k.error(`Failed to load interfaces`,{description:e?.message??String(e)})}),Je=j({mutationFn:async e=>{if(!t||!n)throw Error(`missing workspace/deployment`);return yr(t,n,e)},onError:e=>k.error(`Failed to load running config`,{description:e?.message??String(e)})}),Ye=(0,M.useCallback)(async e=>{if(!t)return;let n=await Yr(t,e),r=String(n?.fileData??``);if(!r)throw Error(`missing fileData`);let i=Uint8Array.from(atob(r),e=>e.charCodeAt(0)),a=new Blob([i],{type:`application/vnd.tcpdump.pcap`}),o=URL.createObjectURL(a),s=document.createElement(`a`);s.href=o,s.download=e.split(`/`).pop()||`capture.pcap`,s.click(),URL.revokeObjectURL(o)},[t]),Xe=(0,M.useCallback)(async()=>{if(!t||!n)return;let e=await br(t,n,`csv`),r=String(e.csv??``);if(!r.trim())throw Error(`empty inventory csv`);let i=new Blob([r],{type:`text/csv`}),a=URL.createObjectURL(i),o=document.createElement(`a`);o.href=a,o.download=`${n}-inventory.csv`,o.click(),URL.revokeObjectURL(a)},[n,t]);(0,M.useEffect)(()=>{if(!S)return;let e=()=>C(null),t=e=>{e.key===`Escape`&&C(null)};return window.addEventListener(`click`,e),window.addEventListener(`keydown`,t),()=>{window.removeEventListener(`click`,e),window.removeEventListener(`keydown`,t)}},[S]),(0,M.useEffect)(()=>{Ce&&D?.id&&qe.mutate(D.id)},[qe,D?.id,Ce]),(0,M.useEffect)(()=>{if(!Ce||!Fe||!D?.id)return;let e=window.setInterval(()=>{qe.mutate(D.id)},2e3);return()=>window.clearInterval(e)},[qe,Fe,D?.id,Ce]),(0,M.useEffect)(()=>{De&&Te?.id&&Je.mutate(Te.id)},[Je,Te?.id,De]);let Ze=(0,M.useCallback)(e=>f(t=>Pt(e,t)),[f]),Qe=(0,M.useCallback)((e,r)=>{if(e.preventDefault(),!t||!n)return;let i=m.current?.getBoundingClientRect();C({x:i?e.clientX-i.left:e.clientX,y:i?e.clientY-i.top:e.clientY,node:r})},[n,t]),et=(0,M.useCallback)((e,r)=>{if(!t||!n)return;e.preventDefault();let i=m.current?.getBoundingClientRect();ne({x:i?e.clientX-i.left:e.clientX,y:i?e.clientY-i.top:e.clientY,edge:r})},[n,t]),tt=(0,M.useCallback)(async(e,r)=>{if(!(!t||!n))try{oe(!0);let i={edgeId:r,action:e};if(e===`set`){let e=O.delayMs.trim()?Number(O.delayMs.trim()):void 0,t=O.jitterMs.trim()?Number(O.jitterMs.trim()):void 0,n=O.lossPct.trim()?Number(O.lossPct.trim()):void 0,r=O.dupPct.trim()?Number(O.dupPct.trim()):void 0,a=O.corruptPct.trim()?Number(O.corruptPct.trim()):void 0,o=O.reorderPct.trim()?Number(O.reorderPct.trim()):void 0,s=O.rateKbps.trim()?Number(O.rateKbps.trim()):void 0;Number.isFinite(e)&&(i.delayMs=e),Number.isFinite(t)&&(i.jitterMs=t),Number.isFinite(n)&&(i.lossPct=n),Number.isFinite(r)&&(i.dupPct=r),Number.isFinite(a)&&(i.corruptPct=a),Number.isFinite(o)&&(i.reorderPct=o),Number.isFinite(s)&&(i.rateKbps=s)}let a=(await hr(t,n,i)).results.filter(e=>e.error);a.length?k.error(`Link impairment applied with errors`,{description:a.map(e=>`${e.node}: ${e.error}`).join(`; `)}):k.success(e===`clear`?`Link impairment cleared`:`Link impairment applied`)}catch(e){k.error(`Failed to apply link impairment`,{description:e?.message??String(e)})}finally{oe(!1)}},[n,O.corruptPct,O.delayMs,O.dupPct,O.jitterMs,O.lossPct,O.rateKbps,O.reorderPct,t]);return(0,M.useEffect)(()=>{if(!E||!t||!n)return;le(null),fe.current=null;let e=`/api/workspaces/${encodeURIComponent(t)}/deployments/${encodeURIComponent(n)}/links/stats/events`,r=new EventSource(e,{withCredentials:!0}),i=e=>{try{let t=JSON.parse(String(e.data??`{}`));if(t.type===`error`){le(t.error||`failed to stream link stats`);return}if(t.type!==`snapshot`||!t.snapshot)return;let n=t.snapshot,r=Date.parse(n.generatedAt||``);if(!Number.isFinite(r))return;let i={};for(let e of n.edges??[])i[String(e.edgeId)]=e;let a=fe.current;if(fe.current={atMs:r,byEdge:i},!a)return;let o=(r-a.atMs)/1e3;if(!(o>0))return;let s={};for(let[e,t]of Object.entries(i)){let n=a.byEdge[e];if(!n)continue;let r=(e,t)=>Math.max(0,e-t),i=r(t.sourceTxBytes,n.sourceTxBytes),c=r(t.sourceRxBytes,n.sourceRxBytes),l=r(t.targetTxBytes,n.targetTxBytes),u=r(t.targetRxBytes,n.targetRxBytes),d=Math.max(i,u)+Math.max(l,c),f=r(t.sourceTxPackets,n.sourceTxPackets),p=r(t.sourceRxPackets,n.sourceRxPackets),m=r(t.targetTxPackets,n.targetTxPackets),h=r(t.targetRxPackets,n.targetRxPackets),g=(Math.max(f,h)+Math.max(m,p))/o,_=(r(t.sourceRxDropped,n.sourceRxDropped)+r(t.sourceTxDropped,n.sourceTxDropped)+r(t.targetRxDropped,n.targetRxDropped)+r(t.targetTxDropped,n.targetTxDropped))/o;s[e]={bps:d*8/o,pps:g,drops:_}}de(s)}catch(e){le(e?.message??String(e))}};return r.addEventListener(`stats`,i),r.onerror=()=>le(`link stats stream disconnected`),wr(t,n).catch(()=>{}),()=>{r.removeEventListener(`stats`,i),r.close()}},[n,E,t]),(0,F.jsxs)(`div`,{className:`w-full bg-background/50 overflow-hidden relative ${i?`h-full`:`h-[600px]`} border rounded-xl ${a??``}`,ref:m,children:[(0,F.jsxs)(rn,{nodes:c,edges:d,onNodesChange:u,onEdgesChange:p,onConnect:Ze,onNodeContextMenu:Qe,onEdgeContextMenu:et,onEdgeMouseEnter:(e,t)=>{let n=m.current?.getBoundingClientRect(),r=n?e.clientX-n.left:e.clientX,i=n?e.clientY-n.top:e.clientY;Re({id:String(t.id),x:r,y:i})},onEdgeMouseMove:e=>{if(!Le)return;let t=m.current?.getBoundingClientRect(),n=t?e.clientX-t.left:e.clientX,r=t?e.clientY-t.top:e.clientY;Re(e=>e?{...e,x:n,y:r}:null)},onEdgeMouseLeave:()=>Re(null),onNodeDragStop:(e,t)=>{ye&&xe(e=>{let n={...e,[String(t.id)]:{x:t.position.x,y:t.position.y}};try{window.localStorage.setItem(ye,JSON.stringify(n))}catch{}return n})},nodeTypes:Xs,fitView:!0,className:`bg-muted/10`,children:[(0,F.jsx)(jt,{position:`top-right`,children:(0,F.jsxs)(R,{className:`shadow-sm border bg-background/85 backdrop-blur`,children:[(0,F.jsx)(z,{className:`p-3 pb-2`,children:(0,F.jsx)(B,{className:`text-sm`,children:`Tools`})}),(0,F.jsxs)(H,{className:`p-3 pt-0 space-y-2`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-2 rounded-md border bg-background/70 px-2 py-1`,children:[(0,F.jsx)(Ve,{className:`h-4 w-4 text-muted-foreground`}),(0,F.jsx)(J,{value:he,onChange:e=>ge(e.target.value),placeholder:`Search nodes…`,className:`h-7 w-56 border-0 bg-transparent p-0 text-sm focus-visible:ring-0`}),he.trim()?(0,F.jsx)(L,{variant:`ghost`,size:`sm`,className:`h-7 px-2`,onClick:()=>ge(``),children:`Clear`}):null]}),(0,F.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,F.jsxs)(L,{variant:E?`default`:`outline`,size:`sm`,onClick:()=>{se(e=>{let t=!e;return t||(le(null),de({}),fe.current=null),t})},disabled:!t||!n,title:`Show live link utilization (SSE)`,children:[(0,F.jsx)(Kt,{className:`mr-2 h-4 w-4`}),`Live stats`]}),(0,F.jsxs)(L,{variant:`outline`,size:`sm`,onClick:()=>ve(e=>e===`grid`?`circle`:`grid`),title:`Toggle layout`,children:[(0,F.jsx)(Qt,{className:`mr-2 h-4 w-4`}),_e===`grid`?`Grid`:`Circle`]}),(0,F.jsx)(L,{variant:`outline`,size:`sm`,onClick:()=>{if(xe({}),ye)try{window.localStorage.removeItem(ye)}catch{}},title:`Reset pinned node positions`,children:`Reset`}),(0,F.jsx)(L,{variant:`outline`,size:`sm`,onClick:()=>Xe().catch(e=>k.error(`Failed to download inventory`,{description:e.message})),disabled:!t||!n,title:`Download inventory CSV`,children:`Inventory`}),(0,F.jsxs)(L,{variant:`outline`,size:`sm`,onClick:()=>m.current&&h(m.current,`topology.png`),children:[(0,F.jsx)(g,{className:`mr-2 h-4 w-4`}),`PNG`]})]}),(0,F.jsx)(`div`,{className:`text-[11px] text-muted-foreground`,children:`Tip: Right-click a node or link for actions.`})]})]})}),(0,F.jsx)(zt,{}),(0,F.jsx)(at,{zoomable:!0,pannable:!0,className:`bg-background border rounded-lg`}),(0,F.jsx)($e,{gap:12,size:1})]}),E&&ce?(0,F.jsxs)(`div`,{className:`absolute bottom-2 left-2 z-40 rounded-md border bg-background/90 px-3 py-2 text-xs text-muted-foreground shadow-sm`,children:[`Live stats: `,ce]}):null,Le&&E&&ue[Le.id]?(0,F.jsxs)(`div`,{className:`absolute z-40 rounded-md border bg-background/90 px-3 py-2 text-xs shadow-sm`,style:{left:Le.x+12,top:Le.y+12},children:[(0,F.jsx)(`div`,{className:`font-mono`,children:Le.id}),(0,F.jsxs)(`div`,{className:`text-muted-foreground`,children:[Qs(ue[Le.id].bps),` • `,Math.round(ue[Le.id].pps),` pps •`,` `,ue[Le.id].drops.toFixed(1),` drops/s`]})]}):null,Be&&(He.data?.events?.length??0)>0?(0,F.jsx)(`div`,{className:`absolute bottom-2 right-2 z-40 w-[420px] max-w-[92vw]`,children:(0,F.jsxs)(R,{className:`shadow-sm border bg-background/90 backdrop-blur`,children:[(0,F.jsx)(z,{className:`p-3 pb-2`,children:(0,F.jsx)(B,{className:`text-sm`,children:`Recent activity`})}),(0,F.jsx)(H,{className:`p-3 pt-0 space-y-2`,children:(He.data?.events??[]).slice(-8).reverse().map(e=>(0,F.jsxs)(`div`,{className:`flex items-start justify-between gap-2 text-xs`,children:[(0,F.jsxs)(`div`,{className:`min-w-0`,children:[(0,F.jsx)(`div`,{className:`font-mono truncate`,children:e.eventType}),(0,F.jsx)(`div`,{className:`text-muted-foreground truncate`,children:e.createdAt})]}),(0,F.jsx)(`div`,{className:`text-muted-foreground font-mono truncate`,children:e.createdBy?e.createdBy:``})]},String(e.id)))})]})}):null,r&&t&&n?(0,F.jsx)(Ws,{open:!!_,onOpenChange:e=>{e||ee(null)},workspaceId:t,deploymentId:n,nodeId:_?.id??``,nodeKind:_?.kind??``}):null,t&&n?(0,F.jsx)(Ks,{open:!!v,onOpenChange:e=>{e||y(null)},workspaceId:t,deploymentId:n,nodeId:v?.id??``,nodeKind:v?.kind??``,nodeIp:v?.ip??``}):null,t&&n?(0,F.jsx)(Js,{open:!!b,onOpenChange:e=>{e||te(null)},workspaceId:t,deploymentId:n,nodeId:b?.id??``,nodeKind:b?.kind??``,nodeIp:b?.ip??``}):null,(0,F.jsx)(Ri,{open:Ce,onOpenChange:e=>{we(e),e||Se(null)},children:(0,F.jsxs)(Vi,{className:`max-w-3xl`,children:[(0,F.jsx)(Hi,{children:(0,F.jsx)(Wi,{children:`Interfaces`})}),(0,F.jsx)(rc,{node:D?.id??``,data:qe.data,loading:qe.isPending,error:qe.isError?qe.error?.message??`failed`:``,autoRefresh:Fe,onToggleAutoRefresh:()=>Ie(e=>!e)})]})}),(0,F.jsx)(Ri,{open:De,onOpenChange:e=>{Oe(e),e||Ee(null)},children:(0,F.jsxs)(Vi,{className:`max-w-4xl`,children:[(0,F.jsx)(Hi,{children:(0,F.jsx)(Wi,{children:`Running config`})}),(0,F.jsx)(ic,{node:Te?.id??``,data:Je.data,loading:Je.isPending,error:Je.isError?Je.error?.message??`failed`:``})]})}),S&&t&&n?(0,F.jsx)(`div`,{className:`absolute z-50`,style:{left:S.x,top:S.y},onContextMenu:e=>e.preventDefault(),children:(0,F.jsxs)(R,{className:`w-64 shadow-lg border bg-background/95 backdrop-blur`,children:[(0,F.jsxs)(z,{className:`p-3 pb-2`,children:[(0,F.jsx)(B,{className:`text-sm`,children:`Node Actions`}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:String(S.node?.data?.label??S.node.id)})]}),(0,F.jsxs)(H,{className:`p-3 pt-0 space-y-2`,children:[(0,F.jsx)(L,{size:`sm`,className:`w-full`,disabled:!r,onClick:()=>{let e=String(S.node?.data?.kind??``);C(null),ee({id:String(S.node.id),kind:e})},children:`Open terminal…`}),(0,F.jsx)(L,{size:`sm`,variant:`outline`,className:`w-full`,disabled:!r,onClick:()=>{let e=String(S.node.id),t=`${window.location.pathname}?node=${encodeURIComponent(e)}&action=terminal`;window.open(t,`_blank`,`noopener,noreferrer`),C(null)},children:`Open terminal (new tab)`}),(0,F.jsx)(L,{size:`sm`,variant:`secondary`,className:`w-full`,onClick:()=>{let e=String(S.node?.data?.kind??``),t=String(S.node?.data?.ip??``);C(null),y({id:String(S.node.id),kind:e,ip:t})},children:`View logs…`}),(0,F.jsx)(L,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{let e=String(S.node.id),t=`${window.location.pathname}?node=${encodeURIComponent(e)}&action=logs`;window.open(t,`_blank`,`noopener,noreferrer`),C(null)},children:`View logs (new tab)`}),(0,F.jsx)(L,{size:`sm`,variant:`secondary`,className:`w-full`,onClick:()=>{let e=String(S.node?.data?.kind??``),t=String(S.node?.data?.ip??``);C(null),te({id:String(S.node.id),kind:e,ip:t})},children:`Describe…`}),(0,F.jsx)(L,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{let e=String(S.node.id),t=`${window.location.pathname}?node=${encodeURIComponent(e)}&action=describe`;window.open(t,`_blank`,`noopener,noreferrer`),C(null)},children:`Describe (new tab)`}),(0,F.jsx)(L,{size:`sm`,variant:`secondary`,className:`w-full`,onClick:()=>{let e=String(S.node?.data?.kind??``),t=String(S.node?.data?.ip??``),n=String(S.node.id);C(null),Se({id:n,kind:e,ip:t}),we(!0)},children:`Interfaces…`}),(0,F.jsx)(L,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{let e=String(S.node.id),t=`${window.location.pathname}?node=${encodeURIComponent(e)}&action=interfaces`;window.open(t,`_blank`,`noopener,noreferrer`),C(null)},children:`Interfaces (new tab)`}),(0,F.jsx)(L,{size:`sm`,variant:`secondary`,className:`w-full`,disabled:We.isPending,onClick:()=>{let e=String(S.node.id);C(null),We.mutate(e)},children:We.isPending?`Saving…`:`Save config`}),(0,F.jsx)(L,{size:`sm`,variant:`secondary`,className:`w-full`,onClick:()=>{let e=String(S.node.id);C(null),Ee({id:e}),Oe(!0)},children:`Running config…`}),(0,F.jsx)(L,{size:`sm`,variant:`outline`,className:`w-full`,onClick:()=>{let e=String(S.node.id),t=`${window.location.pathname}?node=${encodeURIComponent(e)}&action=running-config`;window.open(t,`_blank`,`noopener,noreferrer`),C(null)},children:`Running config (new tab)`}),(0,F.jsx)(L,{size:`sm`,variant:`ghost`,className:`w-full`,onClick:()=>{let e=String(S.node?.data?.ip??``).trim();if(!e){k.error(`No management IP available`);return}navigator.clipboard?.writeText(e),k.success(`Copied management IP`),C(null)},children:`Copy management IP`}),(0,F.jsx)(L,{size:`sm`,variant:`ghost`,className:`w-full`,onClick:()=>{let e=String(S.node.id);navigator.clipboard?.writeText(e),k.success(`Copied node name`),C(null)},children:`Copy node name`}),(0,F.jsx)(L,{size:`sm`,variant:`ghost`,className:`w-full`,onClick:()=>{let e=String(S.node?.data?.ip??``).trim();if(!e){k.error(`No management IP available`);return}let t=`ssh admin@${e}`;navigator.clipboard?.writeText(t),k.success(`Copied SSH command`),C(null)},children:`Copy SSH command`}),(0,F.jsx)(L,{size:`sm`,variant:`ghost`,className:`w-full`,onClick:()=>C(null),children:`Close`})]})]})}):null,x&&t&&n?(0,F.jsx)(`div`,{className:`absolute z-50`,style:{left:x.x,top:x.y},onContextMenu:e=>e.preventDefault(),children:(0,F.jsxs)(R,{className:`w-64 shadow-lg border bg-background/95 backdrop-blur`,children:[(0,F.jsxs)(z,{className:`p-3 pb-2`,children:[(0,F.jsx)(B,{className:`text-sm`,children:`Link Actions`}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:String(x.edge.label??x.edge.id)})]}),(0,F.jsxs)(H,{className:`p-3 pt-0 space-y-2`,children:[(0,F.jsx)(L,{size:`sm`,variant:Ue.edgeDown.has(String(x.edge.id))?`secondary`:`destructive`,className:`w-full`,disabled:Ge.isPending,onClick:()=>{let e=String(x.edge.id),t=Ue.edgeDown.has(e);ne(null),Ge.mutate({edgeId:e,action:t?`up`:`down`})},children:Ue.edgeDown.has(String(x.edge.id))?`Bring link up`:`Bring link down`}),(0,F.jsx)(L,{size:`sm`,variant:`outline`,className:`w-full`,disabled:Ke.isPending,onClick:()=>{Me({id:String(x.edge.id),label:String(x.edge.label??``)}),ne(null),Ae(!0)},children:`Capture pcap…`}),Ue.lastCaptureByEdge[String(x.edge.id)]?(0,F.jsx)(L,{size:`sm`,variant:`secondary`,className:`w-full`,onClick:()=>{let e=Ue.lastCaptureByEdge[String(x.edge.id)];ne(null),Ye(e).catch(e=>k.error(`Failed to download pcap`,{description:e.message}))},children:`Download last pcap`}):null,(0,F.jsx)(L,{size:`sm`,className:`w-full`,onClick:()=>{ie({id:String(x.edge.id),label:String(x.edge.label??``)}),ne(null),w(!0)},children:`Configure impairment…`}),(0,F.jsx)(L,{size:`sm`,variant:`secondary`,className:`w-full`,disabled:T,onClick:()=>{let e=String(x.edge.id);ne(null),tt(`clear`,e)},children:`Clear impairment`}),(0,F.jsx)(L,{size:`sm`,variant:`ghost`,className:`w-full`,onClick:()=>ne(null),children:`Close`})]})]})}):null,(0,F.jsx)(Ri,{open:ke,onOpenChange:e=>{Ae(e),e||Me(null)},children:(0,F.jsxs)(Vi,{className:`max-w-lg`,children:[(0,F.jsx)(Hi,{children:(0,F.jsx)(Wi,{children:`Capture pcap`})}),(0,F.jsxs)(`div`,{className:`space-y-4`,children:[je?.label?(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:je.label}):null,(0,F.jsxs)(`div`,{className:`grid grid-cols-2 gap-3`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`capSide`,children:`Side`}),(0,F.jsxs)(`select`,{id:`capSide`,className:`h-9 w-full rounded-md border bg-background px-3 text-sm`,value:Ne.side,onChange:e=>Pe(t=>({...t,side:e.target.value})),children:[(0,F.jsx)(`option`,{value:`source`,children:`Source`}),(0,F.jsx)(`option`,{value:`target`,children:`Target`})]})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`capDuration`,children:`Duration (s)`}),(0,F.jsx)(J,{id:`capDuration`,inputMode:`numeric`,value:Ne.duration,onChange:e=>Pe(t=>({...t,duration:e.target.value}))})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`capPackets`,children:`Max packets`}),(0,F.jsx)(J,{id:`capPackets`,inputMode:`numeric`,value:Ne.packets,onChange:e=>Pe(t=>({...t,packets:e.target.value}))})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`capSnaplen`,children:`Snaplen`}),(0,F.jsx)(J,{id:`capSnaplen`,inputMode:`numeric`,value:Ne.snaplen,onChange:e=>Pe(t=>({...t,snaplen:e.target.value}))})]})]}),(0,F.jsxs)(`div`,{className:`flex gap-2 justify-end`,children:[(0,F.jsx)(L,{variant:`secondary`,onClick:()=>Ae(!1),disabled:Ke.isPending,children:`Cancel`}),(0,F.jsx)(L,{onClick:()=>{let e=String(je?.id??``);if(!e){k.error(`No link selected`);return}let t=Number(Ne.duration.trim()||`10`),n=Number(Ne.packets.trim()||`2500`),r=Number(Ne.snaplen.trim()||`192`);Ke.mutateAsync({edgeId:e,side:Ne.side,durationSeconds:t,maxPackets:n,snaplen:r}).then(e=>(k.success(`Pcap ready`,{description:e.artifactKey}),Ye(e.artifactKey).catch(()=>{}))).finally(()=>Ae(!1))},disabled:Ke.isPending,children:Ke.isPending?`Capturing…`:`Capture`})]})]})]})}),(0,F.jsx)(Ri,{open:ae,onOpenChange:e=>{w(e),e||ie(null)},children:(0,F.jsxs)(Vi,{className:`max-w-lg`,children:[(0,F.jsx)(Hi,{children:(0,F.jsx)(Wi,{children:`Configure Link Impairment`})}),(0,F.jsxs)(`div`,{className:`space-y-4`,children:[re?.label?(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:re.label}):null,(0,F.jsxs)(`div`,{className:`grid grid-cols-2 gap-3`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`delayMs`,children:`Delay (ms)`}),(0,F.jsx)(J,{id:`delayMs`,inputMode:`numeric`,placeholder:`e.g. 50`,value:O.delayMs,onChange:e=>ze(t=>({...t,delayMs:e.target.value}))})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`jitterMs`,children:`Jitter (ms)`}),(0,F.jsx)(J,{id:`jitterMs`,inputMode:`numeric`,placeholder:`e.g. 10`,value:O.jitterMs,onChange:e=>ze(t=>({...t,jitterMs:e.target.value}))})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`lossPct`,children:`Loss (%)`}),(0,F.jsx)(J,{id:`lossPct`,inputMode:`decimal`,placeholder:`e.g. 1.0`,value:O.lossPct,onChange:e=>ze(t=>({...t,lossPct:e.target.value}))})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`dupPct`,children:`Duplicate (%)`}),(0,F.jsx)(J,{id:`dupPct`,inputMode:`decimal`,placeholder:`e.g. 0.1`,value:O.dupPct,onChange:e=>ze(t=>({...t,dupPct:e.target.value}))})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`corruptPct`,children:`Corrupt (%)`}),(0,F.jsx)(J,{id:`corruptPct`,inputMode:`decimal`,placeholder:`e.g. 0.05`,value:O.corruptPct,onChange:e=>ze(t=>({...t,corruptPct:e.target.value}))})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`reorderPct`,children:`Reorder (%)`}),(0,F.jsx)(J,{id:`reorderPct`,inputMode:`decimal`,placeholder:`e.g. 0.2`,value:O.reorderPct,onChange:e=>ze(t=>({...t,reorderPct:e.target.value}))})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{htmlFor:`rateKbps`,children:`Rate (kbit/s)`}),(0,F.jsx)(J,{id:`rateKbps`,inputMode:`numeric`,placeholder:`e.g. 100000`,value:O.rateKbps,onChange:e=>ze(t=>({...t,rateKbps:e.target.value}))})]})]}),(0,F.jsxs)(`div`,{className:`flex gap-2 justify-end`,children:[(0,F.jsx)(L,{variant:`secondary`,onClick:()=>w(!1),disabled:T,children:`Cancel`}),(0,F.jsx)(L,{onClick:()=>{let e=String(re?.id??``);if(!e){k.error(`No link selected`);return}tt(`set`,e).finally(()=>w(!1))},disabled:T,children:`Apply`})]})]}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Tip: Right-click a link in the topology to configure impairment.`})]})})]})}function Qs(e){return e>0?e>=1e9?`${(e/1e9).toFixed(2)} Gbps`:e>=1e6?`${(e/1e6).toFixed(1)} Mbps`:e>=1e3?`${(e/1e3).toFixed(0)} Kbps`:`${Math.round(e)} bps`:`0 bps`}function $s(e){if(!Number.isFinite(e)||e<=0)return`0 B`;let t=[`B`,`KB`,`MB`,`GB`,`TB`],n=e,r=0;for(;n>=1024&&r<t.length-1;)n/=1024,r++;let i=r===0||r===1?0:1;return`${n.toFixed(i)} ${t[r]}`}function ec(e){let t=new Set,n={};for(let r of e??[]){let e=String(r?.eventType??``),i=r?.payload??{},a=String(i?.edgeId??``).trim();if(a&&(e===`link.down`&&t.add(a),e===`link.up`&&t.delete(a),e===`link.capture`)){let e=String(i?.artifactKey??``).trim();e&&(n[a]=e)}}return{edgeDown:t,lastCaptureByEdge:n}}function tc(e,t,n,r,i){return e.map(e=>{let a=String(e.id),o=r[a]??(typeof e.label==`string`?e.label:void 0),s=i.edgeDown.has(a);if(!n)return{...e,label:s?o?`${o} · DOWN`:`DOWN`:o,animated:!1,style:s?{stroke:`hsl(var(--destructive))`,strokeWidth:2,strokeDasharray:`6 6`}:void 0};let c=t[a];if(!c)return{...e,label:s?o?`${o} · DOWN`:`DOWN`:o,animated:!1,style:s?{stroke:`hsl(var(--destructive))`,strokeWidth:2,strokeDasharray:`6 6`}:void 0};let l=c.bps??0,u=1+Math.min(9,Math.log10(Math.max(1,l))/1.2),d=o?`${o} · ${Qs(l)}`:Qs(l),f=s?`${d} · DOWN`:d;return{...e,label:f,animated:!s&&l>0,style:{...e.style??{},strokeWidth:u,...s?{stroke:`hsl(var(--destructive))`,strokeDasharray:`6 6`}:{}}}})}function nc(e,t,n,r){let i=r.trim().toLowerCase(),a=new Set;if(i)for(let t of e){let e=String(t?.data?.label??t.id).toLowerCase(),n=String(t.id).toLowerCase(),r=String(t?.data?.ip??``).toLowerCase();(e.includes(i)||n.includes(i)||r.includes(i))&&a.add(String(t.id))}let o=e.length||1,s=Math.max(260,o*30);return e.map((e,r)=>{let c=String(e.id),l=n[c],u=l??e.position;if(!l&&t===`circle`){let e=r/o*Math.PI*2;u={x:Math.cos(e)*s,y:Math.sin(e)*s}}let d=i?a.has(c):!1,f=i?!a.has(c):!1;return{...e,position:u,data:{...e.data,highlight:d},style:f?{...e.style??{},opacity:.25}:e.style}})}function rc(e){if(e.loading)return(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Loading…`});if(e.error)return(0,F.jsx)(`div`,{className:`text-sm text-destructive`,children:e.error});let t=e.data?.interfaces??[];return t.length?(0,F.jsxs)(`div`,{className:`space-y-3`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:e.node}),(0,F.jsx)(L,{size:`sm`,variant:e.autoRefresh?`default`:`outline`,onClick:e.onToggleAutoRefresh,children:e.autoRefresh?`Auto refresh: on`:`Auto refresh: off`})]}),(0,F.jsx)(`div`,{className:`rounded-md border overflow-auto max-h-[60vh]`,children:(0,F.jsxs)(`table`,{className:`w-full text-xs`,children:[(0,F.jsx)(`thead`,{className:`bg-muted/50 sticky top-0`,children:(0,F.jsxs)(`tr`,{children:[(0,F.jsx)(`th`,{className:`text-left p-2`,children:`Interface`}),(0,F.jsx)(`th`,{className:`text-left p-2`,children:`Peer`}),(0,F.jsx)(`th`,{className:`text-left p-2`,children:`State`}),(0,F.jsx)(`th`,{className:`text-right p-2`,children:`RX`}),(0,F.jsx)(`th`,{className:`text-right p-2`,children:`TX`}),(0,F.jsx)(`th`,{className:`text-right p-2`,children:`Drops`})]})}),(0,F.jsx)(`tbody`,{children:t.map(e=>(0,F.jsxs)(`tr`,{className:`border-t`,children:[(0,F.jsx)(`td`,{className:`p-2 font-mono`,children:e.ifName}),(0,F.jsx)(`td`,{className:`p-2 font-mono text-muted-foreground`,children:e.peerNode?`${e.peerNode}:${e.peerIf??``}`:`—`}),(0,F.jsx)(`td`,{className:`p-2`,children:e.operState??`—`}),(0,F.jsx)(`td`,{className:`p-2 text-right font-mono`,children:$s(Number(e.rxBytes??0))}),(0,F.jsx)(`td`,{className:`p-2 text-right font-mono`,children:$s(Number(e.txBytes??0))}),(0,F.jsx)(`td`,{className:`p-2 text-right font-mono`,children:Number(e.rxDropped??0)+Number(e.txDropped??0)})]},e.ifName))})]})})]}):(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`No interfaces found.`})}function ic(e){if(e.loading)return(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Loading…`});if(e.error)return(0,F.jsx)(`div`,{className:`text-sm text-destructive`,children:e.error});if(e.data?.skipped)return(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:e.data.message||`Skipped`});let t=String(e.data?.stdout??``);return(0,F.jsxs)(`div`,{className:`space-y-3`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:e.node}),(0,F.jsx)(L,{size:`sm`,variant:`outline`,onClick:()=>{navigator.clipboard?.writeText(t),k.success(`Copied running config`)},disabled:!t,children:`Copy`})]}),(0,F.jsx)(`pre`,{className:`max-h-[65vh] overflow-auto rounded-md border bg-zinc-950 p-4 font-mono text-xs text-zinc-100 whitespace-pre-wrap`,children:t||`No output`}),e.data?.stderr?(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground whitespace-pre-wrap`,children:e.data.stderr}):null]})}const ac=Dn(`/dashboard/labs/map`)({component:sc});function oc(e){let t=zn.parse(String(e??``))?.topology??{},n=t?.nodes??{},r=Object.entries(n).map(([e,t])=>{let n=String(t?.kind??``);return{id:String(e),label:String(e),kind:n,status:`unknown`,mgmtIp:``}}),i=[],a=Array.isArray(t?.links)?t.links:[];for(let e=0;e<a.length;e++){let t=a[e],n=Array.isArray(t?.endpoints)?t.endpoints:[];if(n.length!==2)continue;let r=String(n[0]??``),o=String(n[1]??``),s=r.split(`:`)[0],c=o.split(`:`)[0];!s||!c||i.push({id:`e${e+1}`,source:s,target:c,label:`${r} ↔ ${o}`})}return{nodes:r,edges:i}}function sc(){let e=ac.useSearch(),t=String(e?.workspaceId??``),n=String(e?.source??`workspace`),r=String(e?.dir??`containerlab/designer`),i=String(e?.file??``),a=A({queryKey:I.workspaces(),queryFn:Qn,retry:!1,staleTime:3e4}),o=A({queryKey:t?[`containerlabTemplateMap`,t,n,r,i]:[`containerlabTemplateMap`,`none`],queryFn:async()=>{if(!t)throw Error(`workspaceId is required`);if(!i)throw Error(`file is required`);return Ar(t,{source:n,dir:r,file:i})},enabled:!!t&&!!i,retry:!1,staleTime:3e4}),s=(0,M.useMemo)(()=>{if(!o.data?.yaml)return null;try{return oc(o.data.yaml)}catch{return null}},[o.data?.yaml]);return!t||!i?(0,F.jsx)(`div`,{className:`h-screen w-screen p-6`,children:(0,F.jsxs)(`div`,{className:`max-w-2xl space-y-4`,children:[(0,F.jsx)(`div`,{className:`text-2xl font-bold tracking-tight`,children:`Lab map`}),(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Open this page from the Lab Designer “Open map” button, or provide query params.`}),(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{children:(0,F.jsx)(B,{children:`Parameters`})}),(0,F.jsxs)(H,{className:`space-y-3`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Workspace`}),(0,F.jsx)(J,{value:t,readOnly:!0,placeholder:a.isLoading?`Loading…`:`workspaceId missing`})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`File`}),(0,F.jsx)(J,{value:i,readOnly:!0,placeholder:`file missing`})]}),(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground`,children:[`Example: `,(0,F.jsx)(`span`,{className:`font-mono`,children:`/dashboard/labs/map?workspaceId=<id>&source=workspace&dir=containerlab/designer&file=lab.clab.yml`})]})]})]})]})}):o.isLoading||o.isFetching?(0,F.jsxs)(`div`,{className:`h-screen w-screen p-6`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,F.jsx)(K,{className:`h-9 w-9`}),(0,F.jsx)(K,{className:`h-8 w-64`})]}),(0,F.jsx)(`div`,{className:`mt-6`,children:(0,F.jsx)(K,{className:`h-[75vh] w-full`})})]}):!o.data||!s?(0,F.jsx)(`div`,{className:`h-screen w-screen p-6`,children:(0,F.jsx)(Ua,{title:`Map unavailable`,description:o.isError?`Failed to load template.`:`Template YAML could not be parsed into a topology.`,action:{label:`Close`,onClick:()=>window.close()}})}):(0,F.jsxs)(`div`,{className:`h-screen w-screen flex flex-col bg-background`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3 border-b px-4 py-3`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-3 min-w-0`,children:[(0,F.jsx)(wn,{to:`/dashboard/labs/designer`,search:{},className:ra({variant:`outline`,size:`icon`,className:`h-9 w-9`}),title:`Back to designer`,children:(0,F.jsx)(te,{className:`h-4 w-4`})}),(0,F.jsxs)(`div`,{className:`min-w-0`,children:[(0,F.jsx)(`div`,{className:`font-semibold truncate`,children:`Lab map`}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:o.data.path})]})]}),(0,F.jsx)(`div`,{className:`flex items-center gap-2`,children:(0,F.jsx)(L,{variant:`outline`,size:`sm`,onClick:()=>{navigator.clipboard?.writeText(o.data.yaml)},children:`Copy YAML`})})]}),(0,F.jsxs)(`div`,{className:`flex-1 min-h-0 grid grid-cols-1 lg:grid-cols-[1fr_520px]`,children:[(0,F.jsx)(`div`,{className:`min-h-0 p-3`,children:(0,F.jsx)(`div`,{className:`h-full rounded-xl border overflow-hidden`,children:(0,F.jsx)(Zs,{topology:s,workspaceId:t,enableTerminal:!1,fullHeight:!0})})}),(0,F.jsx)(`div`,{className:`min-h-0 border-l bg-background p-3`,children:(0,F.jsxs)(R,{className:`h-full`,children:[(0,F.jsx)(z,{className:`pb-3`,children:(0,F.jsx)(B,{children:`YAML`})}),(0,F.jsx)(H,{className:`h-[calc(100%-56px)]`,children:(0,F.jsx)(xs,{value:o.data.yaml,readOnly:!0,className:`h-full font-mono text-xs`})})]})})]})]})}function cc(e){let[t,n]=(0,M.useState)(``),[r,i]=(0,M.useState)(``),[a,o]=(0,M.useState)(``),s=A({queryKey:I.registryRepos(t),queryFn:async()=>zr({q:t,n:500}),retry:!1,staleTime:3e4}),c=A({queryKey:a?I.registryTags(a,r):[`registryTags`,`none`],queryFn:async()=>Br(a,{q:r}),enabled:!!a,retry:!1,staleTime:3e4}),l=(0,M.useMemo)(()=>{let t=(e.value||``).trim(),n=t.lastIndexOf(`:`);return n<=0?{repo:t,tag:``}:{repo:t.slice(0,n),tag:t.slice(n+1)}},[e.value]);return(0,F.jsxs)(`div`,{className:`space-y-3 ${e.className??``}`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Image`}),(0,F.jsx)(J,{value:e.value,onChange:t=>e.onChange(t.target.value),placeholder:`repo:tag`}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:"Registry-backed picker. Requires server env `SKYFORGE_REGISTRY_URL`."})]}),(0,F.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-3`,children:[(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,F.jsx)(q,{children:`Repository`}),(0,F.jsx)(L,{size:`sm`,variant:`ghost`,onClick:()=>{l.repo&&(o(l.repo),k.message(`Repository selected`,{description:l.repo}))},children:`Use current`})]}),(0,F.jsx)(J,{value:t,onChange:e=>n(e.target.value),placeholder:`Search repos…`}),(0,F.jsx)(`div`,{className:`max-h-40 overflow-auto rounded-md border`,children:s.isError?(0,F.jsx)(`div`,{className:`p-2 text-xs text-destructive`,children:`Failed to load repos.`}):s.isLoading?(0,F.jsx)(`div`,{className:`p-2 text-xs text-muted-foreground`,children:`Loading…`}):(0,F.jsx)(`div`,{className:`divide-y`,children:(s.data?.repositories??[]).slice(0,200).map(e=>(0,F.jsx)(`button`,{type:`button`,className:`w-full text-left px-2 py-1.5 text-xs font-mono hover:bg-accent ${a===e?`bg-accent`:``}`,onClick:()=>o(e),children:e},e))})})]}),(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-2`,children:[(0,F.jsx)(q,{children:`Tag`}),(0,F.jsx)(L,{size:`sm`,variant:`ghost`,onClick:()=>{if(!a)return;let t=`${a}:${l.tag||`latest`}`;e.onChange(t)},disabled:!a,children:`Set image`})]}),(0,F.jsx)(J,{value:r,onChange:e=>i(e.target.value),placeholder:`Search tags…`,disabled:!a}),(0,F.jsx)(`div`,{className:`max-h-40 overflow-auto rounded-md border`,children:a?c.isError?(0,F.jsx)(`div`,{className:`p-2 text-xs text-destructive`,children:`Failed to load tags.`}):c.isLoading?(0,F.jsx)(`div`,{className:`p-2 text-xs text-muted-foreground`,children:`Loading…`}):(0,F.jsx)(`div`,{className:`divide-y`,children:(c.data?.tags??[]).slice(0,300).map(t=>(0,F.jsx)(`button`,{type:`button`,className:`w-full text-left px-2 py-1.5 text-xs font-mono hover:bg-accent`,onClick:()=>e.onChange(`${a}:${t}`),children:t},t))}):(0,F.jsx)(`div`,{className:`p-2 text-xs text-muted-foreground`,children:`Select a repo…`})})]})]})]})}function lc(e){let t=String(e??``).trim();return t&&t.toLowerCase().replace(/[^a-z0-9-]+/g,`-`).replace(/^-+|-+$/g,``).slice(0,48)||`node`}function uc(e){let t=new Set,n=new Map;for(let r of e){let e=lc(r.id||r.label||`node`),i=e,a=2;for(;t.has(i);)i=`${e}-${a++}`;t.add(i),n.set(r.id,i)}return n}function dc(e){let t=[],n=lc(e.name||`lab`),r=uc(e.nodes),i=new Map,a=e=>{let t=(i.get(e)??0)+1;return i.set(e,t),`eth${t}`},o={};for(let n of e.nodes){let e=r.get(n.id)||lc(n.id),i=String(n.id||n.label||``).trim();i&&lc(i)!==i&&t.push(`Node ${i}: name will be '${lc(i)}'`),i&&lc(i)!==e&&t.push(`Node ${i}: name adjusted to '${e}'`);let a=(n.kind||``).trim()||void 0,s=(n.image||``).trim()||void 0;s||t.push(`Node ${e}: missing image`),o[e]={...a?{kind:a}:{},...s?{image:s}:{},...n.env&&Object.keys(n.env).length?{env:n.env}:{},...n.mgmtIpv4?{mgmt_ipv4:n.mgmtIpv4}:{}}}let s=[];for(let n of e.links){let e=r.get(n.source),i=r.get(n.target);if(!e||!i){t.push(`Link ${n.id}: missing endpoint(s)`);continue}let o=a(n.source),c=a(n.target);s.push({endpoints:[`${e}:${o}`,`${i}:${c}`]})}let c={name:n,topology:{nodes:o,...s.length?{links:s}:{}}},l=(e,t=0)=>{let n=`  `.repeat(t);if(e==null)return`null`;if(typeof e==`string`)return JSON.stringify(e);if(typeof e==`number`||typeof e==`boolean`)return String(e);if(Array.isArray(e))return e.length===0?`[]`:e.map(e=>{if(typeof e==`object`&&e&&!Array.isArray(e)){let r=l(e,t+1).split(`
`);return`${n}- ${r[0].trimStart()}\n${r.slice(1).map(e=>`${n}  ${e}`).join(`
`)}`}return`${n}- ${l(e,0)}`}).join(`
`);if(typeof e==`object`){let r=Object.keys(e);return r.length===0?`{}`:r.map(r=>{let i=e[r];return i===void 0?``:typeof i==`object`&&i?`${n}${r}:\n${l(i,t+1)}`:`${n}${r}: ${l(i,0)}`}).filter(Boolean).join(`
`)}return JSON.stringify(String(e))};return{yaml:l(c,0)+`
`,warnings:t}}var fc=Rn({workspaceId:Bn().optional().catch(``),importDeploymentId:Bn().optional().catch(``)});const pc=Dn(`/dashboard/labs/designer`)({validateSearch:e=>fc.parse(e),component:hc});function mc(e){let t=String(e.data?.kind??``),n=String(e.data?.label??e.id),r=t.toLowerCase().includes(`linux`)||t.toLowerCase().includes(`host`),a=r?Ie:i,o=r?`border-emerald-500/60`:`border-sky-500/60`;return(0,F.jsxs)(`div`,{className:[`rounded-xl border bg-background/95 px-3 py-2 shadow-sm min-w-[140px]`,e.selected?`ring-2 ring-primary/60`:``,o].join(` `),children:[(0,F.jsx)(Zt,{type:`target`,position:Ht.Top}),(0,F.jsx)(Zt,{type:`target`,position:Ht.Left}),(0,F.jsx)(Zt,{type:`source`,position:Ht.Right}),(0,F.jsx)(Zt,{type:`source`,position:Ht.Bottom}),(0,F.jsxs)(`div`,{className:`flex items-start gap-2`,children:[(0,F.jsx)(`div`,{className:`mt-0.5 rounded-md border bg-muted p-1.5`,children:(0,F.jsx)(a,{className:`h-4 w-4`})}),(0,F.jsxs)(`div`,{className:`min-w-0`,children:[(0,F.jsx)(`div`,{className:`font-medium leading-tight truncate`,children:n}),(0,F.jsx)(`div`,{className:`text-[11px] text-muted-foreground truncate`,children:t||`node`})]})]})]})}function hc(){let e=pc.useSearch(),t=`skyforge.labDesigner.v1`,n=(0,M.useRef)(null),r=En(),[i,a]=(0,M.useState)(`lab`),[o,s]=(0,M.useState)(``),[c,l]=(0,M.useState)(`clabernetes`),[u,d]=(0,M.useState)(``),[f,p]=(0,M.useState)(!0),[m,h]=(0,M.useState)(null),[_,ee]=(0,M.useState)(`containerlab/designer`),[v,y]=(0,M.useState)(``),[b,te]=(0,M.useState)(!0),[ne,S]=(0,M.useState)(``),[C,re]=(0,M.useState)(null),[ie,ae]=(0,M.useState)(``),[w,T]=(0,M.useState)(!1),[oe,E]=(0,M.useState)(``),[ce,le]=(0,M.useState)(`generated`),[ue,de]=(0,M.useState)(``),[fe,pe]=(0,M.useState)(!1),[me,he]=(0,M.useState)(`blueprints`),[ge,_e]=(0,M.useState)(`containerlab`),[ve,ye]=(0,M.useState)(``),[be,xe]=(0,M.useState)(!0),[D,Se,Ce]=pt([{id:`r1`,position:{x:80,y:80},data:{label:`r1`,kind:`linux`,image:``},type:`designerNode`}]),[we,Te,Ee]=ct([]),De=(0,M.useMemo)(()=>D.find(e=>e.id===ie)??null,[D,ie]),Oe=(0,M.useMemo)(()=>({name:i,nodes:D.map(e=>({id:String(e.id),label:String(e.data?.label??e.id),kind:String(e.data?.kind??``),image:String(e.data?.image??``),position:{x:e.position.x,y:e.position.y}})),links:we.map(e=>({id:String(e.id),source:String(e.source),target:String(e.target)}))}),[we,i,D]),{yaml:ke,warnings:Ae}=(0,M.useMemo)(()=>dc(Oe),[Oe]),je=(0,M.useMemo)(()=>ce===`custom`?String(ue??``):ke,[ue,ke,ce]),Me=(0,M.useMemo)(()=>String(_??``).trim().replace(/^\/+|\/+$/g,``)||`containerlab/designer`,[_]),Ne=(0,M.useMemo)(()=>{let e=String(v??``).trim()||`${i||`lab`}.clab.yml`;return e.endsWith(`.yml`)||e.endsWith(`.yaml`)?e:`${e}.yml`},[i,v]);(0,M.useEffect)(()=>{if(!fe||!o)return;let e=`skyforge.labDesigner.importPrefs.${o}`;try{let t=window.localStorage.getItem(e);if(!t)return;let n=JSON.parse(t);(n?.source===`workspace`||n?.source===`blueprints`)&&he(n.source),typeof n?.dir==`string`&&_e(n.dir)}catch{}},[fe,o]),(0,M.useEffect)(()=>{if(!o)return;let e=`skyforge.labDesigner.importPrefs.${o}`;try{window.localStorage.setItem(e,JSON.stringify({source:me,dir:ge}))}catch{}},[ge,me,o]);let Pe=()=>{let e=D.length+1,t=`n${e}`,n=new Set(D.map(e=>e.id));for(;n.has(t);)e++,t=`n${e}`;let r={x:120+D.length*40,y:120+D.length*30},i={id:t,position:r,data:{label:t,kind:`linux`,image:``},type:`designerNode`};Se(e=>[...e,i]),ae(t)},Fe=()=>{let e=D.length;if(!e)return;let t=Math.max(1,Math.ceil(Math.sqrt(e)));Se(e=>e.map((e,n)=>({...e,position:{x:120+n%t*260,y:120+Math.floor(n/t)*180}}))),requestAnimationFrame(()=>C?.fitView({padding:.15,duration:300}))},Ie=()=>{let e=new Blob([je],{type:`text/yaml`}),t=document.createElement(`a`);t.href=URL.createObjectURL(e),t.download=`${i||`lab`}.clab.yml`,document.body.appendChild(t),t.click(),t.remove(),setTimeout(()=>URL.revokeObjectURL(t.href),5e3)};(0,M.useEffect)(()=>{let t=String(e.workspaceId??``).trim(),n=String(e.importDeploymentId??``).trim();if(!t||!n)return;s(t),p(!1),h(null);let r=!1;return(async()=>{try{let e=await Rr(t,n);if(r)return;let i=(e.nodes??[]).map((e,t)=>({id:String(e.id),position:{x:120+t%4*260,y:120+Math.floor(t/4)*180},data:{label:String(e.label||e.id),kind:String(e.kind||``),image:``},type:`designerNode`})),a=(e.edges??[]).map(e=>({id:String(e.id),source:String(e.source),target:String(e.target),label:e.label||`${e.source} ↔ ${e.target}`}));if(!i.length)throw Error(`No nodes found in deployment topology`);Se(i),Te(a),ae(String(i[0].id)),k.success(`Imported running topology`,{description:`Deployment ${n}`}),requestAnimationFrame(()=>C?.fitView({padding:.15,duration:250}))}catch(e){if(r)return;k.error(`Failed to import deployment topology`,{description:e.message})}})(),()=>{r=!0}},[e.importDeploymentId,e.workspaceId]);let Le=()=>{try{let e={labName:i,workspaceId:o,runtime:c,netlabServer:u,useSavedConfig:f,lastSaved:m,nodes:D,edges:we};window.localStorage.setItem(t,JSON.stringify(e)),k.success(`Draft saved`)}catch(e){k.error(`Failed to save draft`,{description:e.message})}},Re=()=>{try{let e=window.localStorage.getItem(t);if(!e){k.message(`No saved draft`);return}let n=JSON.parse(e);typeof n?.labName==`string`&&a(n.labName),typeof n?.workspaceId==`string`&&s(n.workspaceId),(n?.runtime===`clabernetes`||n?.runtime===`containerlab`)&&l(n.runtime),typeof n?.netlabServer==`string`&&d(n.netlabServer),typeof n?.useSavedConfig==`boolean`&&p(n.useSavedConfig),n?.lastSaved&&typeof n.lastSaved==`object`&&h(n.lastSaved),Array.isArray(n?.nodes)&&Se(n.nodes),Array.isArray(n?.edges)&&Te(n.edges),k.success(`Draft loaded`)}catch(e){k.error(`Failed to load draft`,{description:e.message})}},O=A({queryKey:I.workspaces(),queryFn:Qn,retry:!1,staleTime:3e4}),ze=A({queryKey:o?I.workspaceNetlabServers(o):[`workspaceNetlabServers`,`none`],queryFn:async()=>ir(o),enabled:!!o&&c===`containerlab`,retry:!1,staleTime:3e4}),Be=A({queryKey:o?[`containerlabTemplates`,o,me,ge]:[`containerlabTemplates`,`none`],queryFn:async()=>Or(o,{source:me,dir:ge}),enabled:!!o&&fe,retry:!1,staleTime:3e4}),Ve=A({queryKey:o?[`containerlabTemplate`,o,me,ge,ve]:[`containerlabTemplate`,`none`],queryFn:async()=>{if(!o)throw Error(`missing workspace`);return ve?Ar(o,{source:me,dir:ge,file:ve}):null},enabled:!!o&&fe&&!!ve,retry:!1,staleTime:3e4}),He=j({mutationFn:async()=>{if(!o)throw Error(`Select a workspace`);if(!je.trim())throw Error(`YAML is empty`);if(!/^\s*topology\s*:/m.test(je))throw Error(`YAML must contain a top-level 'topology:' section`);if(Me!==`containerlab`&&!Me.startsWith(`containerlab/`))throw Error(`Repo path must be under containerlab/`);let e=f&&m?.workspaceId===o?m:await Nr(o,{name:i,topologyYAML:je,templatesDir:Me,template:Ne}).then(e=>{let t={workspaceId:e.workspaceId,templatesDir:e.templatesDir,template:e.template,filePath:e.filePath,branch:e.branch};return h(t),t});if(c===`containerlab`){if(!u)throw Error(`Select a netlab server`);return Fr(o,{name:i,netlabServer:u,templateSource:`workspace`,templatesDir:e.templatesDir,template:e.template,autoDeploy:!0})}return Pr(o,{name:i,templateSource:`workspace`,templatesDir:e.templatesDir,template:e.template,autoDeploy:!0})},onSuccess:async e=>{k.success(`Deployment created`,{description:e.deployment?.name??i}),await r.invalidateQueries({queryKey:I.dashboardSnapshot()});let t=e.deployment?.id;be&&t&&window.open(`/dashboard/deployments/${t}`,`_blank`,`noopener,noreferrer`)},onError:e=>k.error(`Create deployment failed`,{description:e.message})}),Ue=j({mutationFn:async()=>{if(!o)throw Error(`Select a workspace`);if(!je.trim())throw Error(`YAML is empty`);if(!/^\s*topology\s*:/m.test(je))throw Error(`YAML must contain a top-level 'topology:' section`);if(Me!==`containerlab`&&!Me.startsWith(`containerlab/`))throw Error(`Repo path must be under containerlab/`);return Nr(o,{name:i,topologyYAML:je,templatesDir:Me,template:Ne})},onSuccess:e=>{h({workspaceId:e.workspaceId,templatesDir:e.templatesDir,template:e.template,filePath:e.filePath,branch:e.branch}),k.success(`Saved to repo`,{description:`${e.filePath} (${e.branch})`})},onError:e=>k.error(`Save failed`,{description:e.message})}),Ge=j({mutationFn:async()=>{if(!o)throw Error(`Select a workspace`);let e=ve.trim();if(!e)throw Error(`Select a template`);return Ar(o,{source:me,dir:ge,file:e})},onSuccess:e=>{le(`custom`),de(e.yaml),pe(!1),k.success(`Template imported`,{description:e.path})},onError:e=>k.error(`Import failed`,{description:e.message})}),Ke=e=>{e.preventDefault(),e.dataTransfer.dropEffect=`move`},qe=e=>{if(e.preventDefault(),!n.current||!C)return;let t=e.dataTransfer.getData(`application/x-skyforge-kind`);if(!t)return;let r=n.current.getBoundingClientRect(),i=C.screenToFlowPosition({x:e.clientX-r.left,y:e.clientY-r.top}),a=t===`linux`?`h`:t===`cisco`?`c`:t===`arista`?`a`:`n`,o=D.length+1,s=`${a}${o}`,c=new Set(D.map(e=>e.id));for(;c.has(s);)o++,s=`${a}${o}`;let l={id:s,position:i,data:{label:s,kind:t,image:``},type:`designerNode`};Se(e=>[...e,l]),ae(s)},Je=async()=>{if(!o){k.error(`Select a workspace first`);return}try{let e=m?.workspaceId===o?m:await Nr(o,{name:i,topologyYAML:je,templatesDir:Me,template:Ne}).then(e=>{let t={workspaceId:e.workspaceId,templatesDir:e.templatesDir,template:e.template,filePath:e.filePath,branch:e.branch};return h(t),t}),t=new URLSearchParams;t.set(`workspaceId`,o),t.set(`source`,`workspace`),t.set(`dir`,e.templatesDir),t.set(`file`,e.template);let n=`/dashboard/labs/map?${t.toString()}`;window.open(n,`_blank`,`noopener,noreferrer`)}catch(e){k.error(`Failed to open map`,{description:e.message})}},Ye=e=>{let t=e.target,n=t?.tagName?.toUpperCase?.()??``;if(n===`INPUT`||n===`TEXTAREA`||t?.isContentEditable||e.key!==`Delete`&&e.key!==`Backspace`)return;let r=new Set(D.filter(e=>e.selected).map(e=>String(e.id))),i=new Set(we.filter(e=>e.selected).map(e=>String(e.id)));r.size===0&&i.size===0||(e.preventDefault(),Se(e=>e.filter(e=>!r.has(String(e.id)))),Te(e=>e.filter(e=>!(i.has(String(e.id))||r.has(String(e.source))||r.has(String(e.target))))))},Xe=(0,M.useMemo)(()=>({designerNode:mc}),[]);return(0,F.jsxs)(`div`,{className:`h-full w-full p-4 flex flex-col gap-4 min-h-0`,children:[(0,F.jsxs)(`div`,{className:`flex flex-col gap-3 md:flex-row md:items-center md:justify-between`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(`div`,{className:`text-2xl font-bold tracking-tight`,children:`Lab Designer`}),(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Drag nodes, wire links, generate Containerlab YAML, and deploy.`})]}),(0,F.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,F.jsxs)(L,{variant:`outline`,size:`sm`,onClick:()=>pe(!0),disabled:!o,children:[(0,F.jsx)(_n,{className:`mr-2 h-4 w-4`}),`Import template`]}),(0,F.jsx)(L,{variant:`outline`,size:`sm`,onClick:Re,children:`Load draft`}),(0,F.jsx)(L,{variant:`outline`,size:`sm`,onClick:Le,children:`Save draft`}),(0,F.jsxs)(L,{variant:`outline`,size:`sm`,onClick:()=>Ue.mutate(),disabled:Ue.isPending,children:[(0,F.jsx)(x,{className:`mr-2 h-4 w-4`}),`Save config`]}),(0,F.jsxs)(L,{variant:`outline`,size:`sm`,onClick:Ie,children:[(0,F.jsx)(g,{className:`mr-2 h-4 w-4`}),`Download YAML`]})]})]}),(0,F.jsxs)(`div`,{className:`grid gap-4 lg:grid-cols-[1fr_420px] flex-1 min-h-0`,children:[(0,F.jsxs)(R,{className:`flex flex-col min-h-0`,children:[(0,F.jsx)(z,{className:`pb-3`,children:(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,F.jsx)(B,{children:`Topology`}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(L,{size:`sm`,variant:`outline`,onClick:()=>te(e=>!e),children:b?`Snap: on`:`Snap: off`}),(0,F.jsxs)(L,{size:`sm`,variant:w?`default`:`outline`,onClick:()=>{T(e=>{let t=!e;return t||E(``),t})},title:`Create links by clicking a source node, then a target node`,children:[(0,F.jsx)(Bt,{className:`mr-2 h-4 w-4`}),w?`Link: on`:`Link: off`]}),(0,F.jsxs)(L,{size:`sm`,variant:`outline`,onClick:Fe,disabled:D.length<2,children:[(0,F.jsx)(Qt,{className:`mr-2 h-4 w-4`}),`Auto-layout`]}),(0,F.jsxs)(L,{size:`sm`,variant:`outline`,onClick:Pe,children:[(0,F.jsx)(We,{className:`mr-2 h-4 w-4`}),`Add node`]})]})]})}),(0,F.jsx)(H,{className:`flex-1 min-h-0`,children:(0,F.jsxs)(`div`,{className:`flex h-full w-full border rounded-xl overflow-hidden bg-background/50`,children:[(0,F.jsxs)(`div`,{className:`w-[180px] border-r bg-background p-3`,children:[(0,F.jsx)(`div`,{className:`text-xs font-semibold text-muted-foreground`,children:`Palette`}),(0,F.jsx)(`div`,{className:`mt-2`,children:(0,F.jsx)(J,{value:ne,onChange:e=>S(e.target.value),placeholder:`Search…`,className:`h-8`})}),(0,F.jsx)(`div`,{className:`mt-3 space-y-2`,children:[{kind:`linux`,label:`Linux host`,category:`Hosts`},{kind:`cisco`,label:`Cisco device`,category:`Network`},{kind:`arista`,label:`Arista device`,category:`Network`}].filter(e=>{let t=ne.trim().toLowerCase();return t?`${e.label} ${e.kind} ${e.category}`.toLowerCase().includes(t):!0}).map(e=>(0,F.jsx)(`div`,{className:`cursor-grab select-none rounded-lg border bg-background px-3 py-2 text-sm hover:bg-accent`,draggable:!0,onDragStart:t=>t.dataTransfer.setData(`application/x-skyforge-kind`,e.kind),title:`Drag onto canvas`,children:e.label},e.kind))})]}),(0,F.jsxs)(`div`,{className:`flex-1 outline-none relative`,ref:n,onDrop:qe,onDragOver:Ke,tabIndex:0,onKeyDown:Ye,onMouseDown:e=>e.currentTarget.focus(),children:[w?(0,F.jsx)(`div`,{className:`absolute z-10 m-3 rounded-lg border bg-background/80 px-3 py-2 text-xs text-muted-foreground backdrop-blur`,children:oe?(0,F.jsxs)(F.Fragment,{children:[`Link mode: select target for `,(0,F.jsx)(`span`,{className:`font-mono text-foreground`,children:oe})]}):(0,F.jsx)(F.Fragment,{children:`Link mode: click a source node, then click a target node`})}):null,(0,F.jsxs)(rn,{nodes:D,edges:we,onNodesChange:Ce,onEdgesChange:Ee,onConnect:e=>{let t=e.source&&e.target?`${e.source} ↔ ${e.target}`:void 0;Te(n=>Pt({...e,label:t},n))},fitView:!0,onNodeClick:(e,t)=>{let n=String(t.id);if(w){if(!oe){E(n);return}if(oe===n){E(``);return}let e=`e-${oe}-${n}-${Date.now()}`;Te(t=>Pt({id:e,source:oe,target:n,label:`${oe} ↔ ${n}`},t)),E(``);return}ae(n)},onInit:re,snapToGrid:b,snapGrid:[12,12],nodeTypes:Xe,children:[(0,F.jsx)(zt,{}),(0,F.jsx)(at,{zoomable:!0,pannable:!0,className:`bg-background border rounded-lg`}),(0,F.jsx)($e,{gap:12,size:1})]})]})]})})]}),(0,F.jsxs)(`div`,{className:`space-y-6`,children:[(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{children:(0,F.jsx)(B,{children:`Lab`})}),(0,F.jsxs)(H,{className:`space-y-3`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Lab name`}),(0,F.jsx)(J,{value:i,onChange:e=>a(e.target.value)})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Workspace`}),(0,F.jsxs)(Y,{value:o,onValueChange:e=>s(e),children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:O.isLoading?`Loading…`:`Select workspace…`})}),(0,F.jsx)(Q,{children:(O.data?.workspaces??[]).map(e=>(0,F.jsx)($,{value:String(e.id),children:String(e.name??e.slug??e.id)},String(e.id)))})]})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Runtime`}),(0,F.jsxs)(Y,{value:c,onValueChange:e=>l(e),disabled:!o,children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:o?`Select runtime…`:`Select workspace first…`})}),(0,F.jsxs)(Q,{children:[(0,F.jsx)($,{value:`clabernetes`,children:`Clabernetes (in-cluster)`}),(0,F.jsx)($,{value:`containerlab`,children:`Containerlab (BYOS)`})]})]})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Repo path`}),(0,F.jsxs)(`div`,{className:`grid grid-cols-2 gap-2`,children:[(0,F.jsx)(J,{value:_,onChange:e=>ee(e.target.value),placeholder:`containerlab/designer`}),(0,F.jsx)(J,{value:v,onChange:e=>y(e.target.value),placeholder:`${i||`lab`}.clab.yml`})]}),(0,F.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,F.jsx)(L,{size:`sm`,variant:`outline`,onClick:()=>{navigator.clipboard?.writeText(`${Me}/${Ne}`),k.success(`Copied path`)},disabled:!o,children:`Copy path`}),(0,F.jsxs)(L,{size:`sm`,variant:`outline`,onClick:Je,disabled:!o,children:[(0,F.jsx)(dn,{className:`mr-2 h-4 w-4`}),`Open map`]})]}),(0,F.jsxs)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:[Me,`/`,Ne]})]}),(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3 rounded-lg border p-3`,children:[(0,F.jsxs)(`div`,{className:`min-w-0`,children:[(0,F.jsx)(`div`,{className:`text-sm font-medium`,children:`Use saved config`}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground truncate`,children:m?.workspaceId===o?`${m.filePath} (${m.branch})`:`Auto-saves before deploy`})]}),(0,F.jsx)(fo,{checked:f,onCheckedChange:e=>p(!!e)})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Netlab server`}),(0,F.jsxs)(Y,{value:u,onValueChange:e=>d(e),disabled:!o||c!==`containerlab`,children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:c===`containerlab`?o?ze.isLoading?`Loading…`:`Select server…`:`Select workspace first…`:`Not required for clabernetes…`})}),(0,F.jsx)(Q,{children:(ze.data?.servers??[]).map(e=>(0,F.jsx)($,{value:`ws:${String(e.id)}`,children:String(e.name)},String(e.id)))})]})]}),(0,F.jsx)(`div`,{children:(0,F.jsxs)(L,{className:`w-full`,disabled:He.isPending,onClick:()=>He.mutate(),children:[(0,F.jsx)(se,{className:`mr-2 h-4 w-4`}),He.isPending?`Creating…`:`Create deployment + deploy`]})}),(0,F.jsxs)(`div`,{className:`flex items-center justify-between rounded-lg border px-3 py-2`,children:[(0,F.jsxs)(`div`,{className:`min-w-0`,children:[(0,F.jsx)(`div`,{className:`text-sm font-medium`,children:`Open deployment on create`}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Keeps the Designer open in this tab.`})]}),(0,F.jsx)(fo,{checked:be,onCheckedChange:e=>xe(!!e)})]})]})]}),(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{children:(0,F.jsx)(B,{children:`Node`})}),(0,F.jsx)(H,{className:`space-y-4`,children:De?(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Name`}),(0,F.jsx)(J,{value:String(De.data?.label??De.id),onChange:e=>{let t=e.target.value;Se(e=>e.map(e=>e.id===De.id?{...e,data:{...e.data,label:t}}:e))}})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Kind`}),(0,F.jsx)(J,{value:String(De.data?.kind??``),onChange:e=>{let t=e.target.value;Se(e=>e.map(e=>e.id===De.id?{...e,data:{...e.data,kind:t}}:e))},placeholder:`linux, ceos, ...`})]}),(0,F.jsx)(cc,{value:String(De.data?.image??``),onChange:e=>{Se(t=>t.map(t=>t.id===De.id?{...t,data:{...t.data,image:e}}:t))}})]}):(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`Click a node to edit.`})})]}),(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{className:`pb-3`,children:(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,F.jsx)(B,{children:`YAML`}),(0,F.jsx)(`div`,{className:`flex items-center gap-2`,children:(0,F.jsxs)(L,{size:`sm`,variant:`outline`,onClick:()=>{navigator.clipboard?.writeText(je),k.success(`Copied YAML`)},children:[(0,F.jsx)(Et,{className:`mr-2 h-4 w-4`}),`Copy`]})})]})}),(0,F.jsxs)(H,{className:`space-y-3`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(L,{size:`sm`,variant:ce===`generated`?`default`:`outline`,onClick:()=>le(`generated`),children:`Generated`}),(0,F.jsx)(L,{size:`sm`,variant:ce===`custom`?`default`:`outline`,onClick:()=>{le(`custom`),ue.trim()||de(je)},children:`Custom`})]}),Ae.length?(0,F.jsx)(`div`,{className:`rounded-md border bg-amber-500/10 text-amber-900 dark:text-amber-200 px-3 py-2 text-xs`,children:Ae.slice(0,6).map(e=>(0,F.jsx)(`div`,{children:e},e))}):null,(0,F.jsx)(xs,{value:ce===`custom`?ue:ke,onChange:e=>de(e.target.value),readOnly:ce!==`custom`,className:`font-mono text-xs h-[320px]`})]})]})]})]}),(0,F.jsx)(Ri,{open:fe,onOpenChange:e=>pe(e),children:(0,F.jsxs)(Vi,{children:[(0,F.jsxs)(Hi,{children:[(0,F.jsx)(Wi,{children:`Import template`}),(0,F.jsx)(Gi,{children:`Load an existing containerlab YAML from templates/blueprints into the editor.`})]}),(0,F.jsxs)(`div`,{className:`space-y-3`,children:[(0,F.jsxs)(`div`,{className:`grid grid-cols-2 gap-3`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Source`}),(0,F.jsxs)(Y,{value:me,onValueChange:e=>{let t=e;he(t),_e(t===`workspace`?`containerlab/designer`:`containerlab`),ye(``)},children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{})}),(0,F.jsxs)(Q,{children:[(0,F.jsx)($,{value:`blueprints`,children:`Blueprints`}),(0,F.jsx)($,{value:`workspace`,children:`Workspace repo`})]})]})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Directory`}),(0,F.jsx)(J,{value:ge,onChange:e=>_e(e.target.value)})]})]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Template`}),(0,F.jsxs)(Y,{value:ve,onValueChange:e=>ye(e),disabled:!o,children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:Be.isLoading?`Loading…`:`Select template…`})}),(0,F.jsx)(Q,{children:(Be.data?.templates??[]).map(e=>(0,F.jsx)($,{value:e,children:e},e))})]}),Be.isError?(0,F.jsx)(`div`,{className:`text-xs text-destructive`,children:`Failed to list templates`}):null]}),(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(q,{children:`Preview`}),(0,F.jsx)(xs,{value:Ve.data?.yaml??``,readOnly:!0,placeholder:ve?Ve.isLoading?`Loading preview…`:`No preview`:`Select a template to preview…`,className:`font-mono text-xs h-[220px]`})]})]}),(0,F.jsxs)(Ui,{children:[(0,F.jsx)(L,{variant:`outline`,onClick:()=>pe(!1),children:`Cancel`}),(0,F.jsx)(L,{onClick:()=>Ge.mutate(),disabled:Ge.isPending||!ve,children:`Import`})]})]})})]})}var gc=Lt,_c=Jt,vc=St,yc=M.forwardRef(({className:e,sideOffset:t=4,...n},r)=>(0,F.jsx)(en,{ref:r,sideOffset:t,className:P(`z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2`,e),...n}));yc.displayName=en.displayName;var bc=Rn({workspace:Bn().optional().catch(``)});const xc=Dn(`/dashboard/deployments/new`)({validateSearch:e=>bc.parse(e),component:wc});var Sc=Rn({workspaceId:Bn().min(1,`Workspace is required`),name:Bn().min(1,`Deployment name is required`).max(100),kind:Wn([`netlab-c9s`,`netlab`,`containerlab`,`clabernetes`,`terraform`,`labpp`]),source:Wn([`workspace`,`blueprints`,`external`]),templateRepoId:Bn().optional(),template:Bn().min(1,`Template is required`),netlabServer:Bn().optional(),eveServer:Bn().optional(),forwardCollectorId:Bn().optional(),variableGroupId:Bn().optional(),env:Ln(Rn({key:Bn(),value:Bn()})).optional()});function Cc(e){let t=String(e??``).trim();if(!t)return``;try{return new URL(t).hostname||t}catch{return t.replace(/^https?:\/\//,``).split(`/`)[0]??t}}function wc(){let e=Tn(),t=En(),{workspace:n}=xc.useSearch(),[r,i]=(0,M.useState)(!1),[a,o]=(0,M.useState)(!1);rs(!0);let s=A({queryKey:I.dashboardSnapshot(),queryFn:$n,initialData:()=>t.getQueryData(I.dashboardSnapshot())??null,retry:!1,staleTime:1/0}),c=A({queryKey:I.workspaces(),queryFn:Qn,staleTime:3e4}).data?.workspaces??[],l=gn({resolver:yt(Sc),defaultValues:{workspaceId:n||``,name:``,kind:`netlab-c9s`,source:`blueprints`,templateRepoId:``,template:``,netlabServer:``,eveServer:``,forwardCollectorId:`none`,variableGroupId:`none`,env:[]}}),{watch:u,setValue:d,control:f}=l,{fields:p,append:m,remove:h}=sn({control:f,name:`env`}),g=u(`workspaceId`),_=u(`kind`),ee=u(`source`),v=u(`templateRepoId`),y=u(`template`),b=u(`forwardCollectorId`);u(`env`);let te=s.data?.templatesIndexUpdatedAt??``;(0,M.useEffect)(()=>{!g&&c.length>0&&d(`workspaceId`,c[0].id)},[g,c,d]),(0,M.useEffect)(()=>{d(`name`,`${(y||_).split(`/`).pop()||_}-${new Date().toISOString().replace(/[-:]/g,``).replace(/\..+/,``).slice(0,15)}`)},[y,_,d]);let x=(0,M.useMemo)(()=>c.find(e=>e.id===g)??null,[g,c]),ne=A({queryKey:I.workspaceNetlabServers(g),queryFn:async()=>ir(g),enabled:!!g,staleTime:3e4}),S=A({queryKey:[`workspaceEveServers`,g],queryFn:async()=>sr(g),enabled:!!g,staleTime:3e4}),C=A({queryKey:[`workspaceVariableGroups`,g],queryFn:async()=>yi(g),enabled:!!g,staleTime:3e4}),re=A({queryKey:I.userForwardCollectorConfigs(),queryFn:Hr,enabled:[`netlab-c9s`,`clabernetes`,`terraform`].includes(_),staleTime:3e4,retry:!1}),ie=(0,M.useMemo)(()=>(re.data?.collectors??[]).filter(e=>e&&typeof e.id==`string`&&typeof e.name==`string`).filter(e=>!e.decryptionFailed),[re.data?.collectors]);(0,M.useEffect)(()=>{if(![`netlab-c9s`,`clabernetes`,`terraform`].includes(_)){(b??`none`)!==`none`&&d(`forwardCollectorId`,`none`);return}if((b??`none`)!==`none`)return;let e=ie.find(e=>e.isDefault)??ie[0];e?.id&&d(`forwardCollectorId`,String(e.id))},[_,b,ie,d]);let w=(0,M.useMemo)(()=>_===`netlab`||_===`netlab-c9s`?ee===`workspace`?`workspace`:`blueprints`:_===`labpp`?`blueprints`:_===`containerlab`||_===`clabernetes`||_===`terraform`?ee:`workspace`,[_,ee]),T=A({queryKey:I.workspaceTemplates(g,_,w,v||void 0,void 0),enabled:!!g,queryFn:async()=>{let e={source:w};switch(w===`external`&&v&&(e.repo=v),_){case`netlab`:case`netlab-c9s`:return Tr(g,e);case`labpp`:return jr(g,e);case`containerlab`:case`clabernetes`:return Or(g,e);case`terraform`:return kr(g,e);default:return Tr(g,e)}},staleTime:5*6e4,refetchOnWindowFocus:!1});(0,M.useEffect)(()=>{te&&t.invalidateQueries({queryKey:[`workspaceTemplates`]})},[te,t]);let oe=T.data?.templates??[],E=A({queryKey:[`workspaceNetlabTemplate`,g,w,v,T.data?.dir,y],queryFn:async()=>{if(!g)throw Error(`workspaceId is required`);if(!y)throw Error(`template is required`);let e={source:w,template:y};return w===`external`&&v&&(e.repo=v),T.data?.dir&&(e.dir=T.data.dir),Er(g,e)},enabled:r&&!!g&&!!y&&(_===`netlab`||_===`netlab-c9s`),retry:!1,staleTime:3e4}),se=(x?.externalTemplateRepos??[]).filter(e=>!!e&&typeof e.id==`string`&&typeof e.repo==`string`),ce=!!x?.allowExternalTemplateRepos&&se.length>0,le=j({mutationFn:async e=>{let t={template:e.template};if(e.variableGroupId&&e.variableGroupId!==`none`&&(t.envGroupIds=[parseInt(e.variableGroupId,10)]),e.env&&e.env.length>0){let n={};for(let t of e.env)t.key.trim()&&(n[t.key.trim()]=t.value);Object.keys(n).length>0&&(t.environment=n)}if([`netlab-c9s`,`clabernetes`,`terraform`].includes(e.kind)){let n=String(e.forwardCollectorId??`none`).trim();n&&n!==`none`&&(t.forwardEnabled=!0,t.forwardCollectorId=n)}if(e.kind===`netlab`||e.kind===`containerlab`){let n=(e.netlabServer||x?.netlabServer||``).trim();if(!n)throw Error(`netlab server is required`);t.netlabServer=n,t.templateSource=w,w===`external`&&e.templateRepoId&&(t.templateRepo=e.templateRepoId),T.data?.dir&&(t.templatesDir=T.data.dir)}if(e.kind===`netlab-c9s`&&(t.templateSource=w,w===`external`&&e.templateRepoId&&(t.templateRepo=e.templateRepoId),T.data?.dir&&(t.templatesDir=T.data.dir)),e.kind===`clabernetes`&&(t.templateSource=w,w===`external`&&e.templateRepoId&&(t.templateRepo=e.templateRepoId),T.data?.dir&&(t.templatesDir=T.data.dir)),e.kind===`terraform`&&(t.templateSource=w,w===`external`&&e.templateRepoId&&(t.templateRepo=e.templateRepoId),T.data?.dir&&(t.templatesDir=T.data.dir)),e.kind===`labpp`){t.templateSource=`blueprints`,T.data?.dir&&(t.templatesDir=T.data.dir);let n=(e.eveServer||``).trim();if(!n)throw Error(`EVE-NG server is required`);t.eveServer=n}let n={name:e.name,type:e.kind,config:t};return Mr(e.workspaceId,n)},onSuccess:async(n,r)=>{k.success(`Deployment created successfully`,{description:`${r.name} is now queued for provisioning.`}),await t.invalidateQueries({queryKey:I.dashboardSnapshot()}),await e({to:`/dashboard/deployments`,search:{workspace:r.workspaceId}})},onError:e=>{k.error(`Failed to create deployment`,{description:e.message})}}),ue=j({mutationFn:async()=>{if(!g)throw Error(`Select a workspace first.`);if(!y)throw Error(`Select a template first.`);let e=new Map;for(let t of l.getValues(`env`)||[]){let n=(t?.key??``).trim();n&&e.set(n,String(t?.value??``))}let t=String(l.getValues(`variableGroupId`)??`none`),n=t===`none`?null:Number(t),r={...(n?me.find(e=>e.id===n)?.variables:void 0)??{}};for(let[t,n]of e.entries())r[t]=n;let i={source:w,template:y,environment:r};return w===`external`&&v&&(i.repo=v),T.data?.dir&&(i.dir=T.data.dir),Dr(g,i)},onSuccess:async t=>{let n=String(t?.task?.id??t?.task?.task_id??``).trim();k.success(`Validation queued`,{description:n?`Run ${n} started.`:`Validation run started.`}),n&&e({to:`/dashboard/runs/$runId`,params:{runId:n}})},onError:e=>{k.error(`Validation failed`,{description:String(e?.message??e)})}});function de(e){le.mutate(e)}let fe=ne.data?.servers??[],pe=S.data?.servers??[],me=C.data?.groups??[],he=fe.length>0,ge=pe.length>0,_e=fe.map(e=>({value:`ws:${e.id}`,label:Cc(e.apiUrl)||e.name}));return(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsx)(R,{variant:`glass`,children:(0,F.jsx)(z,{children:(0,F.jsxs)(`div`,{className:`flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between`,children:[(0,F.jsxs)(`div`,{children:[(0,F.jsx)(B,{children:`Create deployment`}),(0,F.jsx)(V,{children:`Configure and launch a new infrastructure deployment.`})]}),(0,F.jsx)(L,{variant:`outline`,onClick:()=>e({to:`/dashboard/deployments`,search:{workspace:g}}),children:`Cancel`})]})})}),(0,F.jsx)(R,{children:(0,F.jsx)(H,{className:`pt-6`,children:(0,F.jsx)(ds,{...l,children:(0,F.jsxs)(`form`,{onSubmit:l.handleSubmit(de),className:`space-y-8`,children:[(0,F.jsxs)(`div`,{className:`grid gap-6 md:grid-cols-2`,children:[(0,F.jsx)(ps,{control:l.control,name:`workspaceId`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`Workspace`}),(0,F.jsxs)(Y,{onValueChange:e.onChange,defaultValue:e.value,value:e.value,children:[(0,F.jsx)(vs,{children:(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`Select workspace`})})}),(0,F.jsx)(Q,{children:c.map(e=>(0,F.jsxs)($,{value:e.id,children:[e.name,` (`,e.slug,`)`]},e.id))})]}),(0,F.jsx)(bs,{})]})}),(0,F.jsx)(ps,{control:l.control,name:`kind`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`Provider`}),(0,F.jsxs)(Y,{onValueChange:t=>{e.onChange(t),l.setValue(`template`,``)},defaultValue:e.value,children:[(0,F.jsx)(vs,{children:(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`Select provider`})})}),(0,F.jsxs)(Q,{children:[(0,F.jsx)($,{value:`netlab-c9s`,children:`Netlab`}),he&&(0,F.jsx)($,{value:`netlab`,children:`Netlab (BYOS)`}),ge&&(0,F.jsx)($,{value:`labpp`,children:`LabPP`}),he&&(0,F.jsx)($,{value:`containerlab`,children:`Containerlab (BYOS)`}),(0,F.jsx)($,{value:`clabernetes`,children:`Containerlab`}),(0,F.jsx)($,{value:`terraform`,children:`Terraform`})]})]}),(0,F.jsx)(bs,{})]})}),[`netlab-c9s`,`clabernetes`,`terraform`].includes(_)&&(0,F.jsx)(ps,{control:l.control,name:`forwardCollectorId`,render:({field:e})=>(0,F.jsxs)(gs,{className:`rounded-md border p-3 md:col-span-2 space-y-2`,children:[(0,F.jsx)(_s,{children:`Forward collector`}),(0,F.jsxs)(ys,{children:[`Optional. Select a per-user in-cluster Collector. Configure collectors under`,` `,(0,F.jsx)(`code`,{className:`font-mono`,children:`Dashboard → Collector`}),`.`]}),re.isError?(0,F.jsx)(`div`,{className:`text-xs text-destructive`,children:`Failed to load collectors.`}):null,re.data&&ie.length===0?(0,F.jsx)(`div`,{className:`text-xs text-destructive`,children:`No collectors configured yet.`}):null,(0,F.jsxs)(Y,{value:String(e.value??`none`),onValueChange:t=>e.onChange(t),disabled:re.isLoading,children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`Select a collector (or None)`})}),(0,F.jsxs)(Q,{children:[(0,F.jsx)($,{value:`none`,children:`None`}),ie.map(e=>(0,F.jsx)($,{value:String(e.id),children:String(e.name)},String(e.id)))]})]})]})}),(0,F.jsx)(ps,{control:l.control,name:`source`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsxs)(_s,{className:`flex items-center gap-2`,children:[`Template source`,(0,F.jsx)(gc,{children:(0,F.jsxs)(_c,{children:[(0,F.jsx)(vc,{asChild:!0,children:(0,F.jsx)(mt,{className:`h-4 w-4 text-muted-foreground`})}),(0,F.jsx)(yc,{children:(0,F.jsx)(`p`,{children:`Git repository or URL containing deployment templates`})})]})})]}),(0,F.jsxs)(Y,{onValueChange:t=>{e.onChange(t),l.setValue(`templateRepoId`,``),l.setValue(`template`,``)},defaultValue:e.value,children:[(0,F.jsx)(vs,{children:(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`Select source`})})}),(0,F.jsxs)(Q,{children:[(0,F.jsx)($,{value:`workspace`,children:`Workspace repo`}),(0,F.jsx)($,{value:`blueprints`,children:`Blueprints`}),(0,F.jsx)($,{value:`external`,disabled:!ce||_!==`containerlab`&&_!==`clabernetes`&&_!==`terraform`,children:`External repo`})]})]}),!ce&&(_===`containerlab`||_===`clabernetes`||_===`terraform`)&&(0,F.jsx)(ys,{children:`External repos disabled or not configured for this workspace.`}),(0,F.jsx)(bs,{})]})}),w===`external`&&(0,F.jsx)(ps,{control:l.control,name:`templateRepoId`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`External repo`}),(0,F.jsxs)(Y,{onValueChange:t=>{e.onChange(t),l.setValue(`template`,``)},defaultValue:e.value,children:[(0,F.jsx)(vs,{children:(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`Select repo…`})})}),(0,F.jsx)(Q,{children:se.map(e=>(0,F.jsxs)($,{value:e.id,children:[e.name,` (`,e.repo,`)`]},e.id))})]}),(0,F.jsx)(bs,{})]})}),(_===`netlab`||_===`containerlab`)&&(0,F.jsx)(ps,{control:l.control,name:`netlabServer`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`Netlab server`}),(0,F.jsxs)(Y,{onValueChange:e.onChange,defaultValue:e.value||x?.netlabServer||``,value:e.value||x?.netlabServer||``,children:[(0,F.jsx)(vs,{children:(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`Select server…`})})}),(0,F.jsx)(Q,{children:_e.map(e=>(0,F.jsx)($,{value:e.value,children:e.label},e.value))})]}),ne.isLoading&&(0,F.jsx)(ys,{children:`Loading servers…`}),(0,F.jsx)(bs,{})]})}),_===`labpp`&&(0,F.jsx)(ps,{control:l.control,name:`eveServer`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`EVE-NG server`}),(0,F.jsxs)(Y,{onValueChange:e.onChange,defaultValue:e.value||``,value:e.value||``,children:[(0,F.jsx)(vs,{children:(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`Select server…`})})}),(0,F.jsx)(Q,{children:pe.map(e=>(0,F.jsx)($,{value:`ws:${e.id}`,children:Cc(e.apiUrl)||e.name},e.id))})]}),S.isLoading&&(0,F.jsx)(ys,{children:`Loading servers…`}),(0,F.jsx)(bs,{})]})}),(0,F.jsx)(ps,{control:l.control,name:`template`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,F.jsx)(_s,{children:`Template`}),(_===`netlab`||_===`netlab-c9s`)&&(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(L,{type:`button`,variant:`outline`,size:`sm`,disabled:!y,onClick:()=>i(!0),children:`View`}),(0,F.jsx)(L,{type:`button`,variant:`outline`,size:`sm`,disabled:!y||ue.isPending,onClick:()=>ue.mutate(),children:ue.isPending?(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(et,{className:`mr-2 h-3 w-3 animate-spin`}),` Validating…`]}):`Validate`})]})]}),(0,F.jsxs)(Y,{onValueChange:e.onChange,defaultValue:e.value,disabled:T.isLoading||oe.length===0,children:[(0,F.jsx)(vs,{children:(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:T.isLoading?`Loading…`:oe.length?`Select template…`:`No templates`})})}),(0,F.jsx)(Q,{children:oe.map(e=>(0,F.jsx)($,{value:e,children:e},e))})]}),T.isError&&(0,F.jsx)(`div`,{className:`text-xs text-destructive`,children:`Failed to load templates.`}),(0,F.jsx)(bs,{})]})}),(0,F.jsx)(ps,{control:l.control,name:`name`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{children:`Deployment name`}),(0,F.jsx)(vs,{children:(0,F.jsx)(J,{placeholder:`My Deployment`,...e})}),(0,F.jsx)(ys,{children:`Custom name for this specific deployment instance.`}),(0,F.jsx)(bs,{})]})})]}),(0,F.jsxs)(`div`,{className:`rounded-md border p-4 space-y-4`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,F.jsx)(_s,{children:`Environment Variables`}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(_===`netlab-c9s`||_===`netlab`)&&(0,F.jsx)(L,{type:`button`,variant:`outline`,size:`sm`,onClick:()=>o(!0),children:`Supported NETLAB_ vars`}),(0,F.jsxs)(L,{type:`button`,variant:`outline`,size:`sm`,onClick:()=>m({key:``,value:``}),children:[(0,F.jsx)(We,{className:`mr-2 h-3 w-3`}),` Add Variable`]})]})]}),(0,F.jsx)(`div`,{className:`grid gap-6 md:grid-cols-2`,children:(0,F.jsx)(ps,{control:l.control,name:`variableGroupId`,render:({field:e})=>(0,F.jsxs)(gs,{children:[(0,F.jsx)(_s,{className:`text-xs text-muted-foreground`,children:`Variable Group`}),(0,F.jsxs)(Y,{onValueChange:e.onChange,defaultValue:e.value||`none`,value:e.value||`none`,children:[(0,F.jsx)(vs,{children:(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`None`})})}),(0,F.jsxs)(Q,{children:[(0,F.jsx)($,{value:`none`,children:`None`}),me.map(e=>(0,F.jsx)($,{value:String(e.id),children:e.name},e.id))]})]})]})})}),p.length>0&&(0,F.jsx)(`div`,{className:`space-y-2`,children:p.map((e,t)=>(0,F.jsxs)(`div`,{className:`flex gap-2 items-start`,children:[_===`netlab-c9s`||_===`netlab`?(0,F.jsx)(ps,{control:l.control,name:`env.${t}.key`,render:({field:e})=>{let t=String(e.value??``).trim(),n=Ts.some(e=>e.key===t)?t:`__custom__`;return(0,F.jsxs)(gs,{className:`flex-1 space-y-2`,children:[(0,F.jsx)(vs,{children:(0,F.jsxs)(Y,{value:n,onValueChange:t=>{t===`__custom__`?e.onChange(``):e.onChange(t)},children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`Select env var…`})}),(0,F.jsxs)(Q,{children:[Ts.map(e=>(0,F.jsx)($,{value:e.key,children:e.label},e.key)),(0,F.jsx)($,{value:`__custom__`,children:`Custom…`})]})]})}),n===`__custom__`&&(0,F.jsx)(vs,{children:(0,F.jsx)(J,{...e,placeholder:`KEY`,className:`font-mono text-xs`})}),(0,F.jsx)(bs,{})]})}}):(0,F.jsx)(ps,{control:l.control,name:`env.${t}.key`,render:({field:e})=>(0,F.jsxs)(gs,{className:`flex-1`,children:[(0,F.jsx)(vs,{children:(0,F.jsx)(J,{...e,placeholder:`KEY`,className:`font-mono text-xs`})}),(0,F.jsx)(bs,{})]})}),(0,F.jsx)(ps,{control:l.control,name:`env.${t}.value`,render:({field:e})=>(0,F.jsxs)(gs,{className:`flex-1`,children:[(0,F.jsx)(vs,{children:(()=>{let n=String(l.getValues(`env.${t}.key`)??``).trim();if(Ds(n))return(0,F.jsx)(xs,{...e,placeholder:`One \`key=value\` per line.
Example:
addressing.p2p.ipv4=198.18.0.0/16`,className:`font-mono text-xs min-h-[120px]`});let r=Os(n);if(!r)return(0,F.jsx)(J,{...e,placeholder:`VALUE`,className:`font-mono text-xs`});let i=String(e.value??``).trim(),a=r.some(e=>e.value===i),o=i?a?i:`__custom__`:`none`;return(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsxs)(Y,{value:o,onValueChange:t=>{t===`none`?e.onChange(``):t===`__custom__`?e.onChange(i&&!a?i:``):e.onChange(t)},children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:`Select value…`})}),(0,F.jsxs)(Q,{children:[(0,F.jsx)($,{value:`none`,children:`None`}),r.map(e=>(0,F.jsx)($,{value:e.value,children:e.label},e.value)),(0,F.jsx)($,{value:`__custom__`,children:`Custom…`})]})]}),o===`__custom__`&&(0,F.jsx)(J,{...e,placeholder:`VALUE`,className:`font-mono text-xs`})]})})()}),(0,F.jsx)(bs,{})]})}),(0,F.jsx)(L,{type:`button`,variant:`ghost`,size:`icon`,onClick:()=>h(t),className:`shrink-0`,children:(0,F.jsx)(ae,{className:`h-4 w-4 text-muted-foreground`})})]},e.id))})]}),(0,F.jsx)(Ri,{open:a,onOpenChange:o,children:(0,F.jsxs)(Vi,{className:`max-w-2xl`,children:[(0,F.jsxs)(Hi,{children:[(0,F.jsx)(Wi,{children:`Supported Netlab overrides`}),(0,F.jsxs)(Gi,{children:[`These variables are passed into the Netlab generator. Use `,(0,F.jsx)(`span`,{className:`font-mono`,children:`NETLAB_*`}),` for native Netlab defaults, and`,` `,(0,F.jsx)(`span`,{className:`font-mono`,children:`SKYFORGE_NETLAB_SET_OVERRIDES`}),` for generator-only `,(0,F.jsx)(`span`,{className:`font-mono`,children:`netlab --set`}),` overrides.`]})]}),(0,F.jsx)(`div`,{className:`space-y-2 text-sm`,children:Ts.map(e=>(0,F.jsx)(`div`,{className:`flex items-start justify-between gap-3 rounded-md border p-3`,children:(0,F.jsxs)(`div`,{className:`min-w-0`,children:[(0,F.jsx)(`div`,{className:`font-medium`,children:e.label}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono break-all`,children:e.key})]})},e.key))})]})}),le.isError&&(0,F.jsx)(`div`,{className:`rounded-md bg-destructive/15 p-3 text-sm text-destructive border border-destructive/20`,children:le.error?.message||`Create failed.`}),(0,F.jsxs)(`div`,{className:`flex gap-3`,children:[(0,F.jsxs)(L,{type:`submit`,disabled:le.isPending,children:[le.isPending&&(0,F.jsx)(et,{className:`mr-2 h-4 w-4 animate-spin`}),le.isPending?`Creating…`:`Create Deployment`]}),(0,F.jsx)(L,{type:`button`,variant:`secondary`,onClick:()=>e({to:`/dashboard/deployments`,search:{workspace:g}}),disabled:le.isPending,children:`Back`})]})]})})})}),(0,F.jsx)(Ri,{open:r,onOpenChange:i,children:(0,F.jsxs)(Vi,{className:`max-w-4xl`,children:[(0,F.jsxs)(Hi,{children:[(0,F.jsx)(Wi,{children:`Netlab template`}),(0,F.jsx)(Gi,{className:`font-mono text-xs truncate`,children:String(E.data?.path??y)})]}),(0,F.jsxs)(`div`,{className:`space-y-2`,children:[E.isError&&(0,F.jsx)(`div`,{className:`text-sm text-destructive`,children:`Failed to load template.`}),(0,F.jsx)(xs,{readOnly:!0,value:String(E.data?.yaml??``),className:`h-[60vh] font-mono text-xs`,placeholder:E.isLoading?`Loading…`:`No template loaded.`})]})]})})]})}const Tc=Dn(`/dashboard/deployments/$deploymentId/`)({component:Ec,validateSearch:e=>{let t={};return typeof e.action==`string`&&e.action.trim()&&(t.action=e.action.trim()),typeof e.node==`string`&&e.node.trim()&&(t.node=e.node.trim()),t}});function Ec(){let{deploymentId:e}=Tc.useParams(),{action:t,node:n}=Tc.useSearch(),r=Tn(),i=En();rs(!0);let[a,o]=(0,M.useState)(!1),[s,c]=(0,M.useState)(!1),[l,u]=(0,M.useState)(``),d=A({queryKey:I.dashboardSnapshot(),queryFn:async()=>null,initialData:null,retry:!1,staleTime:1/0}),f=(0,M.useMemo)(()=>(d.data?.deployments??[]).find(t=>t.id===e),[d.data?.deployments,e]),p=String(f?.workspaceId??``),m=String(f?.type??``);(0,M.useEffect)(()=>{let e=!!(f?.config??{}).forwardEnabled,t=String((f?.config??{}).forwardCollectorId??``).trim();c(e),u(t)},[f?.id,f?.config]);let h=String(f?.activeTaskId??``);Fs(h,!!h);let _=A({queryKey:I.runLogs(h),queryFn:async()=>({cursor:0,entries:[]}),retry:!1,staleTime:1/0,enabled:!!h}),ee=async()=>{try{if(!f)throw Error(`deployment not found`);await pi(f.workspaceId,f.id),k.success(`Deployment starting`,{description:`${f.name} is queued to start.`})}catch(e){k.error(`Failed to start`,{description:e.message})}},v=async()=>{try{if(!f)throw Error(`deployment not found`);await mi(f.workspaceId,f.id),k.success(`Deployment stopping`,{description:`${f.name} is queued to stop.`})}catch(e){k.error(`Failed to stop`,{description:e.message})}},y=async()=>{try{if(!f)throw Error(`deployment not found`);await hi(f.workspaceId,f.id),k.success(`Deployment deleted`),await i.invalidateQueries({queryKey:I.dashboardSnapshot()}),r({to:`/dashboard/deployments`,search:{workspace:f.workspaceId}})}catch(e){k.error(`Failed to delete`,{description:e.message})}},b=f?.activeTaskStatus??f?.lastStatus??`unknown`,x=!!f?.activeTaskId,ne=(0,M.useMemo)(()=>{if(!f)return[];let e=(d.data?.runs??[]).filter(e=>String(e.workspaceId??``)===f.workspaceId),t=e.filter(e=>String(e.deploymentId??``)===f.id);return t.length>0?t:e},[f,d.data?.runs]),C=A({queryKey:I.deploymentTopology(p,e),queryFn:async()=>{if(!f)throw Error(`deployment not found`);return Rr(f.workspaceId,f.id)},enabled:!!f&&[`containerlab`,`netlab-c9s`,`clabernetes`].includes(m),retry:!1,staleTime:1e4}),re=j({mutationFn:async e=>{if(!f)throw Error(`deployment not found`);return Cr(f.workspaceId,f.id,e)},onSuccess:(e,t)=>{if(e?.skipped){k.message(`Save config skipped`,{description:e.message||`Node ${t}`});return}k.success(`Save config queued/applied`,{description:e.stdout||`Node ${t}`})},onError:e=>k.error(`Save config failed`,{description:e.message})}),ie=async()=>{if(!f)return;let e=C.data?.nodes??[];if(!e.length){k.message(`No nodes to save`);return}if(re.isPending)return;k.message(`Saving configs…`,{description:`Nodes: ${e.length}`});let t=e.map(e=>String(e.id)),n=0,r=0,i=0,a=0;if(await Promise.all(Array.from({length:Math.min(3,t.length)},async()=>{for(;n<t.length;){let e=t[n++];try{(await Cr(f.workspaceId,f.id,e))?.skipped?i++:r++}catch{a++}}})),a){k.error(`Save configs finished with errors`,{description:`ok=${r} skipped=${i} failed=${a}`});return}k.success(`Save configs finished`,{description:`ok=${r} skipped=${i}`})},w=()=>{try{if(!f){k.error(`Cannot download config`,{description:`Deployment not found.`});return}let e=new Blob([JSON.stringify(f.config??{},null,2)],{type:`application/json`}),t=document.createElement(`a`),n=String(f.name??`deployment`).replace(/[^a-zA-Z0-9._-]+/g,`_`);t.href=URL.createObjectURL(e),t.download=`${n}.config.json`,document.body.appendChild(t),t.click(),t.remove(),setTimeout(()=>URL.revokeObjectURL(t.href),5e3),k.success(`Downloaded config`)}catch(e){k.error(`Failed to download config`,{description:e.message})}},T=A({queryKey:I.userForwardCollectorConfigs(),queryFn:Hr,enabled:s,retry:!1,staleTime:3e4}),oe=T.data?.collectors??[],E=j({mutationFn:async e=>{if(!f)throw Error(`deployment not found`);return pr(f.workspaceId,f.id,e)},onSuccess:async()=>{k.success(`Forward settings updated`),await i.invalidateQueries({queryKey:I.dashboardSnapshot()})},onError:e=>k.error(`Failed to update Forward settings`,{description:e.message})}),se=j({mutationFn:async()=>{if(!f)throw Error(`deployment not found`);return mr(f.workspaceId,f.id)},onSuccess:async e=>{k.success(`Forward sync queued`,{description:`Run ${String(e.run?.id??``)}`}),await i.invalidateQueries({queryKey:I.dashboardSnapshot()})},onError:e=>k.error(`Failed to sync to Forward`,{description:e.message})});if(t&&n&&f){if(t===`terminal`)return(0,F.jsx)(`div`,{className:`h-screen w-screen bg-zinc-950 flex flex-col`,children:(0,F.jsx)(Us,{workspaceId:p,deploymentId:e,nodeId:n,className:`flex-1`})});if(t===`logs`)return(0,F.jsx)(`div`,{className:`h-screen w-screen bg-background flex flex-col`,children:(0,F.jsx)(Gs,{workspaceId:p,deploymentId:e,nodeId:n,className:`flex-1`})});if(t===`describe`)return(0,F.jsx)(`div`,{className:`h-screen w-screen bg-background flex flex-col`,children:(0,F.jsx)(qs,{workspaceId:p,deploymentId:e,nodeId:n,className:`flex-1`})})}return f?(0,F.jsxs)(`div`,{className:`space-y-6 p-6 pb-20`,children:[(0,F.jsxs)(`div`,{className:`flex flex-col gap-4 md:flex-row md:items-center md:justify-between`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,F.jsx)(wn,{to:`/dashboard/deployments`,className:ra({variant:`outline`,size:`icon`,className:`h-9 w-9`}),children:(0,F.jsx)(te,{className:`h-4 w-4`})}),(0,F.jsxs)(`div`,{children:[(0,F.jsxs)(`h1`,{className:`text-2xl font-bold tracking-tight flex items-center gap-3`,children:[f.name,(0,F.jsx)(Dc,{status:b})]}),(0,F.jsxs)(`p`,{className:`text-sm text-muted-foreground flex items-center gap-2 mt-1`,children:[(0,F.jsx)(`span`,{className:`font-mono text-xs bg-muted px-1.5 py-0.5 rounded`,children:f.id}),(0,F.jsx)(`span`,{children:`•`}),(0,F.jsx)(`span`,{className:`capitalize`,children:f.type})]})]})]}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsxs)(L,{variant:`outline`,size:`sm`,onClick:ee,disabled:x,children:[(0,F.jsx)(Ye,{className:`mr-2 h-4 w-4`}),` Start`]}),(0,F.jsxs)(L,{variant:`outline`,size:`sm`,onClick:v,disabled:x,children:[(0,F.jsx)(xe,{className:`mr-2 h-4 w-4`}),` Stop`]}),(0,F.jsxs)(L,{variant:`destructive`,size:`sm`,onClick:()=>o(!0),disabled:x,children:[(0,F.jsx)(ae,{className:`mr-2 h-4 w-4`}),` Delete`]})]})]}),(0,F.jsxs)(jo,{defaultValue:`topology`,className:`space-y-6`,children:[(0,F.jsxs)(Mo,{children:[(0,F.jsxs)(No,{value:`topology`,className:`gap-2`,children:[(0,F.jsx)(dt,{className:`h-4 w-4`}),` Topology`]}),(0,F.jsxs)(No,{value:`logs`,className:`gap-2`,children:[(0,F.jsx)(ue,{className:`h-4 w-4`}),` Logs & Events`]}),(0,F.jsxs)(No,{value:`config`,className:`gap-2`,children:[(0,F.jsx)(ke,{className:`h-4 w-4`}),` Configuration`]})]}),(0,F.jsxs)(Po,{value:`topology`,className:`space-y-6 animate-in fade-in-50`,children:[(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{className:`pb-3`,children:(0,F.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,F.jsxs)(`div`,{children:[(0,F.jsx)(B,{children:`Network Topology`}),(0,F.jsx)(V,{children:f.type===`containerlab`?`Derived from containerlab after deploy (includes resolved mgmt IPs).`:f.type===`netlab-c9s`||f.type===`clabernetes`?`Derived from clabernetes after deploy (includes resolved mgmt IPs).`:`Topology is provider-dependent; not yet implemented for this deployment type.`})]}),(0,F.jsx)(`div`,{className:`flex items-center gap-2`,children:(0,F.jsxs)(L,{variant:`outline`,size:`sm`,onClick:()=>{let e=window.location.pathname,t=e.endsWith(`/`)?e.slice(0,-1):e;window.open(`${t}/map`,`_blank`,`noopener,noreferrer`)},title:`Open the full-screen map view in a new tab`,children:[(0,F.jsx)(dn,{className:`mr-2 h-4 w-4`}),`Open map`]})})]})}),(0,F.jsx)(H,{children:(0,F.jsx)(Zs,{topology:C.data,workspaceId:f.workspaceId,deploymentId:f.id,enableTerminal:[`netlab-c9s`,`clabernetes`].includes(f.type)})})]}),C.data?.nodes?.length?(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{className:`pb-3`,children:(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,F.jsxs)(`div`,{children:[(0,F.jsx)(B,{children:`Nodes`}),(0,F.jsx)(V,{children:`Quick actions (opens in a new tab where applicable).`})]}),(0,F.jsx)(L,{size:`sm`,variant:`outline`,disabled:re.isPending,onClick:ie,children:re.isPending?`Saving…`:`Save all configs`})]})}),(0,F.jsx)(H,{children:(0,F.jsx)(`div`,{className:`space-y-2`,children:C.data.nodes.map(e=>{let t=String(e.id),n=String(e.kind??``),r=String(e.mgmtIp??``),i=String(e.status??``),a=`${window.location.pathname}?node=${encodeURIComponent(t)}`;return(0,F.jsxs)(`div`,{className:`flex flex-col gap-2 rounded-md border p-3 md:flex-row md:items-center md:justify-between`,children:[(0,F.jsxs)(`div`,{className:`min-w-0`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(`span`,{className:`font-mono text-xs`,children:t}),i?(0,F.jsx)(Za,{variant:`secondary`,className:`capitalize`,children:i}):null,n?(0,F.jsx)(`span`,{className:`text-xs text-muted-foreground truncate`,children:n}):null]}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate mt-1`,children:r||`—`})]}),(0,F.jsxs)(`div`,{className:`flex flex-wrap items-center gap-2`,children:[(0,F.jsx)(L,{size:`sm`,variant:`outline`,disabled:![`netlab-c9s`,`clabernetes`].includes(f.type),onClick:()=>window.open(`${a}&action=terminal`,`_blank`,`noopener,noreferrer`),children:`Terminal`}),(0,F.jsx)(L,{size:`sm`,variant:`outline`,onClick:()=>window.open(`${a}&action=logs`,`_blank`,`noopener,noreferrer`),children:`Logs`}),(0,F.jsx)(L,{size:`sm`,variant:`outline`,onClick:()=>window.open(`${a}&action=describe`,`_blank`,`noopener,noreferrer`),children:`Describe`}),(0,F.jsx)(L,{size:`sm`,variant:`outline`,disabled:re.isPending,onClick:()=>re.mutate(t),children:re.isPending?`Saving…`:`Save config`}),(0,F.jsx)(L,{size:`sm`,variant:`ghost`,onClick:()=>{if(!r.trim()){k.error(`No management IP available`);return}navigator.clipboard?.writeText(r),k.success(`Copied management IP`)},children:`Copy IP`})]})]},t)})})})]}):null]}),(0,F.jsx)(Po,{value:`logs`,className:`space-y-6 animate-in fade-in-50`,children:(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Logs & Events`}),(0,F.jsx)(V,{children:`Live task output.`})]}),(0,F.jsxs)(H,{children:[f.activeTaskId?(0,F.jsxs)(`div`,{className:`space-y-4`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,F.jsxs)(`div`,{className:`text-sm font-medium`,children:[`Active run: `,String(f.activeTaskId)]}),(0,F.jsx)(wn,{to:`/dashboard/runs/$runId`,params:{runId:String(f.activeTaskId)},className:ra({variant:`outline`,size:`sm`}),children:`Open run details`})]}),(0,F.jsx)(`div`,{className:`rounded-md border bg-zinc-950 p-4 font-mono text-xs text-zinc-100`,children:(0,F.jsx)(Oc,{entries:_.data?.entries??[]})})]}):(0,F.jsxs)(`div`,{className:`flex flex-col items-center justify-center py-10 text-center text-muted-foreground border-2 border-dashed rounded-lg`,children:[(0,F.jsx)(ue,{className:`h-10 w-10 mb-3 opacity-20`}),(0,F.jsx)(`p`,{children:`No active run.`}),(0,F.jsx)(`p`,{className:`text-xs mt-1`,children:`Start/stop/destroy will queue runs that appear here.`})]}),(0,F.jsxs)(`div`,{className:`mt-8 space-y-3`,children:[(0,F.jsx)(`div`,{className:`text-sm font-medium`,children:`Recent runs`}),(0,F.jsx)(`div`,{className:`space-y-2`,children:ne.length===0?(0,F.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:`No runs yet.`}):ne.slice(0,10).map(e=>{let t=String(e.id??``);return(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3 rounded-md border p-3`,children:[(0,F.jsxs)(`div`,{className:`min-w-0`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(`span`,{className:`font-mono text-xs`,children:t}),(0,F.jsx)(Za,{variant:`secondary`,className:`capitalize`,children:String(e.status??``)}),(0,F.jsx)(`span`,{className:`text-xs text-muted-foreground truncate`,children:String(e.tpl_alias??e.type??``)})]}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground truncate mt-1`,children:String(e.status_text??e.message??``)})]}),(0,F.jsx)(wn,{to:`/dashboard/runs/$runId`,params:{runId:t},className:ra({variant:`outline`,size:`sm`}),children:`View`})]},t)})})]})]})]})}),(0,F.jsxs)(Po,{value:`config`,className:`space-y-6 animate-in fade-in-50`,children:[(0,F.jsxs)(R,{children:[(0,F.jsxs)(z,{children:[(0,F.jsx)(B,{children:`Forward Networks`}),(0,F.jsx)(V,{children:`Optional: sync device IPs into Forward for collection.`})]}),(0,F.jsxs)(H,{className:`space-y-4`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,F.jsxs)(`div`,{className:`space-y-1`,children:[(0,F.jsx)(`div`,{className:`text-sm font-medium`,children:`Enable Forward collection`}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground`,children:`Requires configuring your Collector first.`})]}),(0,F.jsx)(fo,{checked:s,disabled:E.isPending,onCheckedChange:e=>{c(e);let t=e?l.trim():``;E.mutate({enabled:e,collectorConfigId:t||void 0})}})]}),s?(0,F.jsxs)(`div`,{className:`grid gap-3 md:grid-cols-2`,children:[(0,F.jsxs)(`div`,{className:`space-y-2`,children:[(0,F.jsx)(`div`,{className:`text-sm font-medium`,children:`Collector`}),(0,F.jsxs)(Y,{value:l,onValueChange:e=>{u(e),E.mutate({enabled:!0,collectorConfigId:e})},disabled:T.isLoading||T.isError||E.isPending,children:[(0,F.jsx)(Z,{children:(0,F.jsx)(X,{placeholder:T.isLoading?`Loading…`:T.isError?`Configure Collector first`:`Select collector…`})}),(0,F.jsx)(Q,{children:oe.map(e=>(0,F.jsx)($,{value:e.id,children:e.name},e.id))})]})]}),(0,F.jsx)(`div`,{className:`flex items-end gap-2`,children:(0,F.jsx)(L,{variant:`outline`,onClick:()=>se.mutate(),disabled:!l.trim()||se.isPending||E.isPending,children:se.isPending?`Queueing…`:`Sync now`})})]}):null]})]}),(0,F.jsxs)(R,{children:[(0,F.jsx)(z,{children:(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3`,children:[(0,F.jsxs)(`div`,{children:[(0,F.jsx)(B,{children:`Configuration`}),(0,F.jsx)(V,{children:`Read-only view of the deployment parameters.`})]}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsxs)(L,{size:`sm`,variant:`outline`,onClick:()=>{navigator.clipboard?.writeText(JSON.stringify(f.config??{},null,2)),k.success(`Copied config JSON`)},children:[(0,F.jsx)(Et,{className:`mr-2 h-4 w-4`}),`Copy`]}),(0,F.jsxs)(L,{size:`sm`,variant:`outline`,onClick:w,children:[(0,F.jsx)(g,{className:`mr-2 h-4 w-4`}),`Download`]})]})]})}),(0,F.jsx)(H,{children:(0,F.jsx)(`pre`,{className:`bg-muted p-4 rounded-lg overflow-auto font-mono text-xs max-h-[500px]`,children:JSON.stringify(f.config,null,2)})})]})]})]}),(0,F.jsx)(ho,{open:a,onOpenChange:o,children:(0,F.jsxs)(vo,{children:[(0,F.jsxs)(yo,{children:[(0,F.jsx)(xo,{children:`Delete deployment?`}),(0,F.jsxs)(So,{children:[`This will remove `,(0,F.jsx)(`strong`,{children:f.name}),` from Skyforge and trigger provider cleanup. This action cannot be undone.`]})]}),(0,F.jsxs)(bo,{children:[(0,F.jsx)(wo,{children:`Cancel`}),(0,F.jsx)(Co,{onClick:y,className:ra({variant:`destructive`}),children:`Delete Deployment`})]})]})})]}):d.isLoading||d.isFetching?(0,F.jsxs)(`div`,{className:`space-y-6 p-6`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,F.jsx)(K,{className:`h-10 w-32`}),(0,F.jsx)(K,{className:`h-10 w-48`})]}),(0,F.jsx)(K,{className:`h-[400px] w-full`})]}):(0,F.jsx)(`div`,{className:`p-6`,children:(0,F.jsx)(Ua,{icon:S,title:`Deployment not found`,description:`This deployment may have been deleted or you don't have access.`,action:{label:`Back to Deployments`,onClick:()=>r({to:`/dashboard/deployments`})}})})}function Dc({status:e}){let t=`secondary`,n=e.toLowerCase();return[`running`,`active`,`healthy`,`succeeded`,`success`].includes(n)&&(t=`default`),[`failed`,`error`,`stopped`,`crashloopbackoff`].includes(n)&&(t=`destructive`),(0,F.jsx)(Za,{variant:t,className:`capitalize`,children:e})}function Oc(e){let t=(0,M.useRef)(null);return(0,M.useEffect)(()=>{let e=t.current;e&&(e.scrollTop=e.scrollHeight)},[e.entries.length]),e.entries.length===0?(0,F.jsx)(`div`,{className:`text-zinc-500`,children:`Waiting for output…`}):(0,F.jsx)(`div`,{ref:t,className:`max-h-[65vh] overflow-auto whitespace-pre-wrap`,children:e.entries.map((e,t)=>(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`span`,{className:`text-zinc-500 select-none`,children:e.time?`${e.time} `:``}),(0,F.jsx)(`span`,{children:e.output})]},`${e.time}-${t}`))})}const kc=Dn(`/dashboard/deployments/$deploymentId/map`)({component:Ac});function Ac(){let{deploymentId:e}=kc.useParams();rs(!0);let t=A({queryKey:I.dashboardSnapshot(),queryFn:async()=>null,initialData:null,retry:!1,staleTime:1/0}),n=(0,M.useMemo)(()=>(t.data?.deployments??[]).find(t=>t.id===e),[e,t.data?.deployments]),r=String(n?.workspaceId??``),i=String(n?.type??``),a=n?.activeTaskStatus??n?.lastStatus??`unknown`,o=A({queryKey:I.deploymentTopology(r,e),queryFn:async()=>{if(!n)throw Error(`deployment not found`);return Rr(n.workspaceId,n.id)},enabled:!!n&&[`containerlab`,`netlab-c9s`,`clabernetes`].includes(i),retry:!1,staleTime:1e4});return n?(0,F.jsxs)(`div`,{className:`h-screen w-screen flex flex-col bg-background`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between gap-3 border-b px-4 py-3`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-3 min-w-0`,children:[(0,F.jsx)(wn,{to:`/dashboard/deployments/$deploymentId`,params:{deploymentId:e},className:ra({variant:`outline`,size:`icon`,className:`h-9 w-9`}),title:`Back to deployment`,children:(0,F.jsx)(te,{className:`h-4 w-4`})}),(0,F.jsxs)(`div`,{className:`min-w-0`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-2 min-w-0`,children:[(0,F.jsx)(`div`,{className:`font-semibold truncate`,children:n.name}),(0,F.jsx)(Za,{variant:`secondary`,className:`capitalize`,children:a}),(0,F.jsx)(Za,{variant:`outline`,className:`capitalize`,children:i||`unknown`})]}),(0,F.jsx)(`div`,{className:`text-xs text-muted-foreground font-mono truncate`,children:n.id})]})]}),(0,F.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,F.jsxs)(`a`,{href:`/dashboard/labs/designer?workspaceId=${encodeURIComponent(r)}&importDeploymentId=${encodeURIComponent(e)}`,target:`_blank`,rel:`noreferrer noopener`,className:ra({variant:`outline`,size:`sm`}),title:`Open this running topology in the Lab Designer (new tab)`,children:[(0,F.jsx)(Ft,{className:`mr-2 h-4 w-4`}),`Edit in Designer`]}),(0,F.jsxs)(wn,{to:`/dashboard/deployments/$deploymentId`,params:{deploymentId:e},className:ra({variant:`outline`,size:`sm`}),title:`Open the deployment page`,children:[(0,F.jsx)(dn,{className:`mr-2 h-4 w-4`}),`Details`]})]})]}),(0,F.jsx)(`div`,{className:`flex-1 min-h-0 p-3`,children:(0,F.jsx)(`div`,{className:`h-full`,children:(0,F.jsx)(Zs,{topology:o.data,workspaceId:n.workspaceId,deploymentId:n.id,enableTerminal:[`netlab-c9s`,`clabernetes`].includes(n.type),fullHeight:!0})})})]}):t.isLoading||t.isFetching?(0,F.jsxs)(`div`,{className:`h-screen w-screen p-6`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,F.jsx)(K,{className:`h-9 w-9`}),(0,F.jsx)(K,{className:`h-8 w-64`})]}),(0,F.jsx)(`div`,{className:`mt-6`,children:(0,F.jsx)(K,{className:`h-[75vh] w-full`})})]}):(0,F.jsx)(`div`,{className:`h-screen w-screen p-6`,children:(0,F.jsx)(Ua,{title:`Deployment not found`,description:`This deployment may have been deleted or you don't have access.`,action:{label:`Back`,onClick:()=>window.close()}})})}var jc=Wa.update({id:`/webhooks`,path:`/webhooks`,getParentRoute:()=>Na}),Mc=qa.update({id:`/syslog`,path:`/syslog`,getParentRoute:()=>Na}),Nc=ao.update({id:`/status`,path:`/status`,getParentRoute:()=>Na}),Pc=co.update({id:`/snmp`,path:`/snmp`,getParentRoute:()=>Na}),Fc=To.update({id:`/notifications`,path:`/notifications`,getParentRoute:()=>Na}),Ic=Fo.update({id:`/design`,path:`/design`,getParentRoute:()=>Na}),Lc=Lo.update({id:`/`,path:`/`,getParentRoute:()=>Na}),Rc=zo.update({id:`/dashboard/`,path:`/dashboard/`,getParentRoute:()=>Na}),zc=Vo.update({id:`/admin/`,path:`/admin/`,getParentRoute:()=>Na}),Bc=Uo.update({id:`/dashboard/s3`,path:`/dashboard/s3`,getParentRoute:()=>Na}),Vc=Ko.update({id:`/dashboard/pki`,path:`/dashboard/pki`,getParentRoute:()=>Na}),Hc=Jo.update({id:`/dashboard/forward`,path:`/dashboard/forward`,getParentRoute:()=>Na}),Uc=Zo.update({id:`/admin/settings`,path:`/admin/settings`,getParentRoute:()=>Na}),Wc=es.update({id:`/admin/governance`,path:`/admin/governance`,getParentRoute:()=>Na}),Gc=ns.update({id:`/dashboard/workspaces/`,path:`/dashboard/workspaces/`,getParentRoute:()=>Na}),Kc=cs.update({id:`/dashboard/deployments/`,path:`/dashboard/deployments/`,getParentRoute:()=>Na}),qc=Cs.update({id:`/dashboard/workspaces/new`,path:`/dashboard/workspaces/new`,getParentRoute:()=>Na}),Jc=js.update({id:`/dashboard/workspaces/$workspaceId`,path:`/dashboard/workspaces/$workspaceId`,getParentRoute:()=>Na}),Yc=Is.update({id:`/dashboard/runs/$runId`,path:`/dashboard/runs/$runId`,getParentRoute:()=>Na}),Xc=ac.update({id:`/dashboard/labs/map`,path:`/dashboard/labs/map`,getParentRoute:()=>Na}),Zc=pc.update({id:`/dashboard/labs/designer`,path:`/dashboard/labs/designer`,getParentRoute:()=>Na}),Qc=xc.update({id:`/dashboard/deployments/new`,path:`/dashboard/deployments/new`,getParentRoute:()=>Na}),$c=Tc.update({id:`/dashboard/deployments/$deploymentId/`,path:`/dashboard/deployments/$deploymentId/`,getParentRoute:()=>Na}),el={IndexRoute:Lc,DesignRoute:Ic,NotificationsRoute:Fc,SnmpRoute:Pc,StatusRoute:Nc,SyslogRoute:Mc,WebhooksRoute:jc,AdminGovernanceRoute:Wc,AdminSettingsRoute:Uc,DashboardForwardRoute:Hc,DashboardPkiRoute:Vc,DashboardS3Route:Bc,AdminIndexRoute:zc,DashboardIndexRoute:Rc,DashboardDeploymentsNewRoute:Qc,DashboardLabsDesignerRoute:Zc,DashboardLabsMapRoute:Xc,DashboardRunsRunIdRoute:Yc,DashboardWorkspacesWorkspaceIdRoute:Jc,DashboardWorkspacesNewRoute:qc,DashboardDeploymentsIndexRoute:Kc,DashboardWorkspacesIndexRoute:Gc,DashboardDeploymentsDeploymentIdMapRoute:kc.update({id:`/dashboard/deployments/$deploymentId/map`,path:`/dashboard/deployments/$deploymentId/map`,getParentRoute:()=>Na}),DashboardDeploymentsDeploymentIdIndexRoute:$c};const tl=Mn({routeTree:Na._addFileChildren(el)._addFileTypes(),context:{queryClient:void 0}});var nl=new Sn;Kn.createRoot(document.getElementById(`root`)).render((0,F.jsx)(M.StrictMode,{children:(0,F.jsx)(jn,{client:nl,children:(0,F.jsx)(kn,{router:tl,context:{queryClient:nl}})})}));